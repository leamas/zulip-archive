<html>
<head><meta charset="utf-8"><title>v3.0.0 beta testing · JavaScript_pi · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/index.html">JavaScript_pi</a></h2>
<h3>Topic: <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html">v3.0.0 beta testing</a></h3>

<hr>

<base href="https://opencpn.zulipchat.com">

<head><link href="https://leamas.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="425479185"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/425479185" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#425479185">(Mar 08 2024 at 09:25)</a>:</h4>
<p><span class="user-mention" data-user-id="399559">@Mike Rossiter</span>  JavaScript v3.0 beta is ready for testing on Windows and Linux please.<br>
Download the latest build from the <a href="https://app.circleci.com/pipelines/github/antipole2/JavaScript_pi/409/workflows/8f5b8a0e-9f1a-46a6-88c0-c58bfda43ce9">beta repository here</a>.<br>
To run the test suite you will need the  latest <a href="https://github.com/antipole2/JavaScript_pi/tree/468ec51ffdea5af000908824669b3c06d705c6cb/Tests_scripts">Test_scripts fold from here</a> or you can clone/fork the  <a href="https://github.com/antipole2/JavaScript_pi/tree/v3.0.0-beta">v3.0.0-beta branch </a> from the repository.  There are several additions to the test suite.</p>
<p>thanks</p>



<a name="425767214"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/425767214" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#425767214">(Mar 10 2024 at 11:51)</a>:</h4>
<p><span class="user-mention" data-user-id="554731">@Tony Voss</span>  On the case.</p>



<a name="425768423"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/425768423" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#425768423">(Mar 10 2024 at 12:09)</a>:</h4>
<p>Using Windows and installing, the intro screen appears but is blank and OpenCPN does not respond. The <em>.dll</em> and data folders are found in the correct place in the plugins folder. Same with OpenCPN 5.9.x. I will clone and build with Windows at this end and see what is happening.</p>



<a name="425771428"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/425771428" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#425771428">(Mar 10 2024 at 12:58)</a>:</h4>
<p>Please remind me how to use Trace.</p>



<a name="425771994"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/425771994" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#425771994">(Mar 10 2024 at 13:06)</a>:</h4>
<p>The trace statement is something like<br>
TRACE(nn, textString)<br>
where nn is a trace level.</p>
<p>In trace.h you have</p>
<div class="codehilite"><pre><span></span><code>#define TRACE_YES   false // if true, include TRACE code. Should be false in release
#define TRACE_MAX   33  // TRACE level range   (Level 0 always traced)
#define TRACE_MIN   33
</code></pre></div>
<p>Set TRACE_YES to true and the TRACE_MAX and TRACE_MIN to the range of tracing levels you want to trace.  So that should include the nn you chose above.<br>
Various numbers are used, so you could happen to get other tracing.  I have used up to 110.</p>



<a name="425777237"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/425777237" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#425777237">(Mar 10 2024 at 14:20)</a>:</h4>
<p>Disabled JS in opencpn.ini. This is the blank screen when trying to enable.<br>
<a href="/user_uploads/33951/ZGYR5InlB1FknOxunZsamSvM/1.jpg">1.jpg</a></p>
<div class="message_inline_image"><a href="/user_uploads/33951/ZGYR5InlB1FknOxunZsamSvM/1.jpg" title="1.jpg"><img src="/user_uploads/33951/ZGYR5InlB1FknOxunZsamSvM/1.jpg"></a></div>



<a name="425778225"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/425778225" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#425778225">(Mar 10 2024 at 14:32)</a>:</h4>
<p>The plot thickens. Installed the existing version from the catalog. Runs. Then replaced the .dll with the one from v3.0.0-beta. Runs with the v3.0.0-beta welcome console.<br>
The problem seems to be setting up the defaults if JS has not previously been installed.</p>



<a name="425778750"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/425778750" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#425778750">(Mar 10 2024 at 14:40)</a>:</h4>
<p>OK - please let me exercise the various setting up situations.  I have made changes in this area.  It will be more than a few minutes before I get around to it - Sunday lunch etc.  <span aria-label="yum" class="emoji emoji-1f60b" role="img" title="yum">:yum:</span></p>



<a name="425795891"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/425795891" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#425795891">(Mar 10 2024 at 18:52)</a>:</h4>
<p>Sorry screwed up this message.  Said things do not seem very robust if the section of .ini file not as expected.  And if OCPN thinks plug-in is installed but there is no section in the .ini file, it is not happy.<br>
Will get back to you.  First I have to get my system working again after messing it up.<br>
Tomorrow is a rare dry day and I need to work on the sliding back door.</p>



<a name="425870637"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/425870637" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#425870637">(Mar 11 2024 at 09:41)</a>:</h4>
<p><span class="user-mention" data-user-id="399559">@Mike Rossiter</span>  Wondered what state your .ini file is as far a JS plugin is concerned.<br>
Have tried  various things to test robustness.<br>
It seems that with an empty [Plugins/JavaScript_pi]  or missing section,  OCPN hangs in plugin loader before calling init().  I think it should be more robust and deal with it gracefully.</p>
<p>Anyhow, in latest beta pushed to GitHub c6473d9 but not built  remotely, I have tracing set for levels 1-5 and extra trace statement in  init and load config.  I also have extra wxLogMessage statements for various error conditions and even without errors if TRACE_YES is true.</p>
<p>Can you give it another go, please?</p>



<a name="425970516"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/425970516" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#425970516">(Mar 11 2024 at 17:04)</a>:</h4>
<p>I think the issue starts with <code>LoadConfig()</code>. On it tomorrow.</p>



<a name="426101353"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426101353" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426101353">(Mar 12 2024 at 11:09)</a>:</h4>
<p>This added to opencpn.ini:</p>
<div class="codehilite"><pre><span></span><code>[PlugIns/JavaScript_pi.dll]
bEnabled=1
</code></pre></div>
<p><code>LatestImportDir=D:\\Documents\\Github\\JavaScript_pi\\build</code></p>
<p><a href="/user_uploads/33951/VUKGd2gFiigXnhaA5qkFM7nv/2.jpg">2.jpg</a></p>
<div class="message_inline_image"><a href="/user_uploads/33951/VUKGd2gFiigXnhaA5qkFM7nv/2.jpg" title="2.jpg"><img src="/user_uploads/33951/VUKGd2gFiigXnhaA5qkFM7nv/2.jpg"></a></div><p>Then the freeze.</p>



<a name="426101685"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426101685" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426101685">(Mar 12 2024 at 11:11)</a>:</h4>
<p>Restart OpenCPN and a freeze again, with similar screen.</p>



<a name="426103938"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426103938" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426103938">(Mar 12 2024 at 11:26)</a>:</h4>
<p>Anything in the log from JavaSCript_pi?<br>
Please let me see your  [PlugIns/JavaScript_pi] section from the  .ini file</p>



<a name="426106004"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426106004" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426106004">(Mar 12 2024 at 11:40)</a>:</h4>
<p>Nothing in the log apart from compatibility testing.</p>
<blockquote>
<p>[PlugIns/JavaScript_pi] section from the .ini file</p>
</blockquote>
<p>Nothing in the .ini file other than already shown.</p>
<p>My feeling is that none of the defaults are loaded with LoadConfig() .<br>
Such as:</p>
<div class="codehilite"><pre><span></span><code>consolePosition.x =  pConf-&gt;Read ( name + _T ( &quot;:ConsolePosX&quot; ), 20L );
consolePosition.y =  pConf-&gt;Read ( name + _T ( &quot;:ConsolePosY&quot; ), 20L );
consoleSize.x =  pConf-&gt;Read ( name + _T ( &quot;:ConsoleSizeX&quot; ), 10L );
consoleSize.y =  pConf-&gt;Read ( name + _T ( &quot;:ConsoleSizeY&quot; ), 5L );
</code></pre></div>



<a name="426106714"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426106714" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426106714">(Mar 12 2024 at 11:44)</a>:</h4>
<p>Have you tried starting with a .conf file without any JavaScript_pi sections to try and reproduce the problem with the Mac?</p>



<a name="426107413"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426107413" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426107413">(Mar 12 2024 at 11:49)</a>:</h4>
<p>In my .ini file there are two separate JavaScript sections</p>
<div class="codehilite"><pre><span></span><code>[PlugIns/libjavascript_pi.dylib]
bEnabled=1
</code></pre></div>
<p>Which is managed by OCPN, including the enabled status<br>
and then there is another section</p>
<div class="codehilite"><pre><span></span><code>[PlugIns/JavaScript_pi]
</code></pre></div>
<p>which is where all my stuff is stored.</p>
<p>Other plugins have these two sections too e.g.</p>
<div class="codehilite"><pre><span></span><code>[PlugIns/libdashboard_pi.dylib]
bEnabled=0
[PlugIns/Dashboard]
Version=2
...
</code></pre></div>
<p>Starting without any [PlugIns/JavaScript_pi] or an empty section hangs OCPN in PluginLoader. (It should cope - I expect to report that).</p>



<a name="426107713"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426107713" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426107713">(Mar 12 2024 at 11:51)</a>:</h4>
<blockquote>
<p>[PlugIns/JavaScript_pi]<br>
which is where all my stuff is stored.</p>
</blockquote>
<p>That section is not created here.</p>



<a name="426108071"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426108071" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426108071">(Mar 12 2024 at 11:53)</a>:</h4>
<p>I wonder how anything has worked in the past.<br>
You must have had one in the past.  Could it have been deleted since?<br>
I will look at coping with no existing section.</p>



<a name="426108382"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426108382" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426108382">(Mar 12 2024 at 11:55)</a>:</h4>
<p>If I load the old (2.2) version from the catalog the sections are created perfectly. Then loading the new (3.0) version works.</p>



<a name="426108801"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426108801" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426108801">(Mar 12 2024 at 11:58)</a>:</h4>
<p>With 2.2 had it remembered your previous consoles or did you just get the default one named <code>JavaScript</code> ?</p>



<a name="426109015"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426109015" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426109015">(Mar 12 2024 at 11:59)</a>:</h4>
<p>You might also see <code>"Welcome to the JavaScript plugin\n\nRun your first script by clicking on the run button above.\n\nSee the Help panel right for documentation"</code></p>



<a name="426109469"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426109469" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426109469">(Mar 12 2024 at 12:01)</a>:</h4>
<p>I need to compare 2.2 and 3.0 in this respect.</p>



<a name="426111493"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426111493" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426111493">(Mar 12 2024 at 12:13)</a>:</h4>
<p><a href="/user_uploads/33951/QNX5251ASmt1UB9Hn2up5xBu/3.jpg">3.jpg</a></p>
<div class="message_inline_image"><a href="/user_uploads/33951/QNX5251ASmt1UB9Hn2up5xBu/3.jpg" title="3.jpg"><img src="/user_uploads/33951/QNX5251ASmt1UB9Hn2up5xBu/3.jpg"></a></div>



<a name="426112020"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426112020" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426112020">(Mar 12 2024 at 12:17)</a>:</h4>
<p>That's because v2.2 sorted things out and then 3.0 saw it was updating from 2.2.<br>
I really need to find why 3.0 failed without first starting 2.2.</p>
<p>Meanwhile, please checkout 3.0 as intended</p>
<blockquote>
<p>To run the test suite you will need the latest Test_scripts fold from here or you can clone/fork the v3.0.0-beta branch from the repository. There are several additions to the test suite.</p>
</blockquote>



<a name="426112539"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426112539" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426112539">(Mar 12 2024 at 12:20)</a>:</h4>
<p>Replaced LoadConfig() v3 with v2.2. The v3 plugin then imported ok, with nothing JS in the .ini file to start with.</p>
<p>Now testing with v3.</p>



<a name="426113418"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426113418" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426113418">(Mar 12 2024 at 12:25)</a>:</h4>
<p>I think I have it.  In v3 if it does not find the section, it looks where they used to be stored but,  if not found there, fails to switch back to the present-day location.</p>



<a name="426158784"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426158784" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426158784">(Mar 12 2024 at 15:55)</a>:</h4>
<p>Not having much luck with the test scripts.  Example:<br>
<em>JavaScript_pi\Tests_scripts\74_dialogue_test.js</em></p>
<div class="codehilite"><pre><span></span><code>L4  wrapUpWorks with error stack:Duktape context dump:
ctx: top=1, stack=[{}]

L4  Call stack: SyntaxError: source decode failed (line 8)
    at [anon] (eval:8) internal
    at [anon] (duk_lexer.c:314) internal
L5  JavaScript-&gt;message() SyntaxError: source decode failed (line 8)
L4  JavaScript-&gt;clearDialog()  (None)
L4  JavaScript-&gt;clearAlert()  (None)
L0  ------------------ Console JavaScript wrapped up
</code></pre></div>
<p>Found that the degree symbol had been introduced in the test script. Now looking at other scripts to see if we have the same problem.</p>



<a name="426158940"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426158940" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426158940">(Mar 12 2024 at 15:56)</a>:</h4>
<p>Once the degree symbol had been deleted the script ran successfully.</p>



<a name="426160898"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426160898" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426160898">(Mar 12 2024 at 16:04)</a>:</h4>
<p>The Position object now has a method to parse a position like 52º 23.67'N 3º 14'W<br>
Great applications with it.   Have just planned summer cruise by copying positions out of the sailing guide and pasting the waypoints into the chart <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span><br>
cleanString now converts superscript 0 to degree.<br>
So looks like Windows cannot cope with that?</p>



<a name="426161877"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426161877" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426161877">(Mar 12 2024 at 16:09)</a>:</h4>
<p>Does <code>writeTextFile</code> also use cleanString? 42 fails at the moment.</p>



<a name="426165652"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426165652" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426165652">(Mar 12 2024 at 16:24)</a>:</h4>
<p>Testscript. 42_writeTextFile.js<br>
Line 3 fplease change the third parameter from 0 to 1 so it reads<br>
<code>writeTextFile(data, "testWriteData",1);</code></p>



<a name="426166067"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426166067" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426166067">(Mar 12 2024 at 16:26)</a>:</h4>
<p>You can test characater cleaning in the tools.</p>
<p>You can now also do it in JavaScript with<br>
<code>cleanedString = cleanString(dirtyString);</code></p>



<a name="426167122"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426167122" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426167122">(Mar 12 2024 at 16:31)</a>:</h4>
<blockquote>
<p>Testscript. 42_writeTextFile.js<br>
Line 3 fplease change the third parameter from 0 to 1 so it reads<br>
writeTextFile(data, "testWriteData",1);</p>
</blockquote>
<p>No change.</p>



<a name="426168430"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426168430" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426168430">(Mar 12 2024 at 16:37)</a>:</h4>
<p>I am puzzled.  There is no test 42.  Yes the file exists  but it is not invoked directly by main.</p>



<a name="426169475"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426169475" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426169475">(Mar 12 2024 at 16:42)</a>:</h4>
<p>main.js failed for me so I went to individual scripts.<br>
main.js failed at line 225:<br>
<code>else printGreen("No errors\n");</code></p>



<a name="426170045"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426170045" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426170045">(Mar 12 2024 at 16:45)</a>:</h4>
<p>Very strange.  Try a one line script<br>
<code>printGreen("No errors\n");</code></p>



<a name="426170252"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426170252" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426170252">(Mar 12 2024 at 16:46)</a>:</h4>
<p>result: undefined</p>



<a name="426170417"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426170417" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426170417">(Mar 12 2024 at 16:47)</a>:</h4>
<p>But it did print "No errors"in green  first?</p>



<a name="426170830"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426170830" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426170830">(Mar 12 2024 at 16:48)</a>:</h4>
<p>Sorry, yes it did.</p>
<p>Just wondering if we need to have your work in LoadConfig() to make sure nothing is missing from the variables read from the config file.</p>



<a name="426172147"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426172147" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426172147">(Mar 12 2024 at 16:55)</a>:</h4>
<p>It might help if you knew what has been going on.<br>
Look here for the release notice: <a href="https://github.com/antipole2/JavaScript_pi/blob/v3.0.0-beta/Releast%20notice.md">https://github.com/antipole2/JavaScript_pi/blob/v3.0.0-beta/Releast%20notice.md</a><br>
and you can download the new user guide from here <a href="https://github.com/antipole2/JavaScript_pi/blob/v3.0.0-beta/documentation/JavaScript_plugin_user_guide.pdf">documentation/JavaScript_plugin_user_guide.pdf</a></p>



<a name="426173568"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426173568" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426173568">(Mar 12 2024 at 17:02)</a>:</h4>
<p>I am very close to finding the problem with loadConfig - narrowed it down to one line.<br>
So I'll fix fix that first.  But you might like to look at the release notice as it will indicate where work has been done.</p>
<p>I don't think that issue could lead to what you are seeing. <br>
When you say </p>
<blockquote>
<p>main.js failed at line 225:<br>
else printGreen("No errors\n");</p>
</blockquote>
<p>what do you mean? What was the error message?<br>
I am cooking this evening - Ynskje's day off and out.  So I will need to attend to that.  Also tomorrow I am using an almost dry day (!) to have an outside sliding door off to replace the seals and interlock which have arrived from the USA.</p>



<a name="426173784"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426173784" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426173784">(Mar 12 2024 at 17:03)</a>:</h4>
<p>Off to the kitchen now.</p>



<a name="426174606"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426174606" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426174606">(Mar 12 2024 at 17:07)</a>:</h4>
<p>SyntaxError: source decode failed (line 225)</p>
<p>I cleaned the topsides on Kamish yesterday. Rained here today.</p>



<a name="426198076"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426198076" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426198076">(Mar 12 2024 at 19:27)</a>:</h4>
<p>? seems to be replaced by degree symbol when the script is loaded. Seen in comment in <em>02 PosWayRoutes.js</em> line 33.</p>



<a name="426278992"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426278992" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426278992">(Mar 13 2024 at 08:05)</a>:</h4>
<p>Postponed door work until better weather.</p>



<a name="426280566"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426280566" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426280566">(Mar 13 2024 at 08:15)</a>:</h4>
<p>Have reworked and fixed loadConfig.  Pushed to repo.</p>
<p>In the config file, bool is represented by 0 or 1.  I had<br>
<code> bool configFound = pConf-&gt;Read ( _T( "ShowJavaScriptIcon" ), &amp;m_bJavaScriptShowIcon, 1 );
</code><br>
If not found, it used the default, which in this case sets a bool to 1 and not true or false.  Compiler does not (cannot) spot that.  Changed to <br>
<code> bool configFound = pConf-&gt;Read ( _T( "ShowJavaScriptIcon" ), &amp;m_bJavaScriptShowIcon, true );
</code><br>
and all is happy again.<br>
I have removed the complicated stuff rescuing pre v0.3  and deleting stuff in the old location for the config.  Much cleaner now.</p>



<a name="426281312"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426281312" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426281312">(Mar 13 2024 at 08:20)</a>:</h4>
<blockquote>
<p>main.js failed at line 225:<br>
else printGreen("No errors\n");</p>
</blockquote>
<p>Cannot understand this problem.  Fine here.<br>
Need to find issue.  Possibly some weird invisible character in source?<br>
Suggest you copy the line and paste into the field in the diagnostis tab of tools and 'clean' it.  It will dump character codes .</p>



<a name="426281686"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426281686" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426281686">(Mar 13 2024 at 08:22)</a>:</h4>
<p>? seems to be replaced by degree symbol when the script is loaded. Seen in comment in 02 PosWayRoutes.js line 33.<br>
please copy that lineand paste into the field in the diagnostis tab of tools and 'clean' it. It will dump character codes .  Can then see what Windows build is doing with it.</p>



<a name="426283087"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426283087" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426283087">(Mar 13 2024 at 08:31)</a>:</h4>
<p>We may be fouling Windows inability to cope with degree symbol?  In version3 we now have the ability to parse a position.  Please try this simple script:</p>
<div class="codehilite" data-code-language="JavaScript"><pre><span></span><code><span class="nx">Position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s2">"Position"</span><span class="p">);</span>

<span class="nx">pos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Position</span><span class="p">(</span><span class="mf">55</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">2</span><span class="p">);</span>
<span class="nx">print</span><span class="p">(</span><span class="nx">pos</span><span class="p">.</span><span class="nx">formatted</span><span class="p">,</span><span class="w"> </span><span class="s2">"\n"</span><span class="p">);</span>

<span class="nx">pos2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Position</span><span class="p">(</span><span class="s2">"52° 12.345'N 1° 1.234'W"</span><span class="p">);</span>
<span class="nx">print</span><span class="p">(</span><span class="nx">pos2</span><span class="p">.</span><span class="nx">formatted</span><span class="p">,</span><span class="w"> </span><span class="s2">"\n"</span><span class="p">);</span>
</code></pre></div>
<p>When I run it, I get</p>
<blockquote>
<p>55° 00.000'N 002° 0.000'W<br>
52° 12.345'N 001° 1.234'W</p>
</blockquote>
<p>If there are issues, please put the "52° 12.345'N 1° 1.234'W" string through the clean and dump process.</p>



<a name="426283952"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426283952" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426283952">(Mar 13 2024 at 08:37)</a>:</h4>
<blockquote>
<p>42 fails at the moment.</p>
</blockquote>
<p>It is no longer being used in the tests.</p>



<a name="426284480"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426284480" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426284480">(Mar 13 2024 at 08:41)</a>:</h4>
<p>Cleaned out everything JavaScript_pi. Updated my fork. Built a tarball. Installed fine. Only issue was that the Help window did not appear.</p>



<a name="426284814"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426284814" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426284814">(Mar 13 2024 at 08:43)</a>:</h4>
<p>Help window only presented when you have updated version.  Otherwise you need to access via the ? or in the tools.<br>
Does the test suite run OK now?</p>



<a name="426285180"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426285180" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426285180">(Mar 13 2024 at 08:45)</a>:</h4>
<p>Should have said Help Panel. This normally appears on a first install, with links to documentation etc. Having trouble with cut and paste on my PC. Will need to re-start the machine. Then breakfast!</p>



<a name="426285430"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426285430" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426285430">(Mar 13 2024 at 08:47)</a>:</h4>
<blockquote>
<p>This normally appears on a first install,</p>
</blockquote>
<p>Only if the version number has increased.  Not if you reinstall the same version.</p>
<p>BTW, links are to released version documentation and not v3.</p>



<a name="426299803"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426299803" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426299803">(Mar 13 2024 at 10:07)</a>:</h4>
<div class="codehilite"><pre><span></span><code>Position = require(&quot;Position&quot;);

pos = new Position(55, -2);
print(pos.formatted, &quot;\n&quot;);

pos2 = new Position(&quot;52° 12.345&#39;N 1° 1.234&#39;W&quot;);
print(pos2.formatted, &quot;\n&quot;);
</code></pre></div>
<blockquote>
<p>SyntaxError: source decode failed (line 3)</p>
</blockquote>
<p>Try cleaning with: <code>pos = new Position(55, -2);</code></p>
<div class="codehilite"><pre><span></span><code>[00]p [01]o [02]s [03]  [04]= [05]  [06]n [07]e [08]w [09]
[10]P [11]o [12]s [13]i [14]t [15]i [16]o [17]n [18]( [19]5
[20]5 [21], [22]  [23]- [24]2 [25]) [26];

Raw
pos = new Position(55, -2);
[00]70 [01]6F [02]73 [03]20 [04]3D [05]20 [06]6E [07]65 [08]77 [09]20
[10]50 [11]6F [12]73 [13]69 [14]74 [15]69 [16]6F [17]6E [18]28 [19]35
[20]35 [21]2C [22]20 [23]2D [24]32 [25]29 [26]3B

Cleaned
pos = new Position(55, -2);
[00]70 [01]6F [02]73 [03]20 [04]3D [05]20 [06]6E [07]65 [08]77 [09]20
[10]50 [11]6F [12]73 [13]69 [14]74 [15]69 [16]6F [17]6E [18]28 [19]35
[20]35 [21]2C [22]20 [23]2D [24]32 [25]29 [26]3B
</code></pre></div>
<p>I think the problem lies somewhere in <em>Position.</em></p>



<a name="426303963"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426303963" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426303963">(Mar 13 2024 at 10:29)</a>:</h4>
<p>Ran this.</p>
<div class="codehilite"><pre><span></span><code>pos = new Position(55, -2);
print(&quot;this&quot; + \n&quot;);
</code></pre></div>
<p><em>ReferenceError: identifier 'Position' undefined</em></p>



<a name="426306440"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426306440" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426306440">(Mar 13 2024 at 10:41)</a>:</h4>
<p>Yes - you have forgotten the Require to load it.<br>
Here is a script with the Position constructer included in-line.<br>
Unzip and load and run.  You should see which line it is failing on.<br>
<a href="/user_uploads/33951/jPLnlrGp1h2ooUTtlzSNtoOC/positionComplete.js.zip">positionComplete.js.zip</a></p>



<a name="426309452"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426309452" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426309452">(Mar 13 2024 at 10:54)</a>:</h4>
<p>My bad. Now with positionComplete:<br>
<em>SyntaxError: source decode failed (line 152)</em></p>



<a name="426311400"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426311400" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426311400">(Mar 13 2024 at 11:06)</a>:</h4>
<p>Line 152 invokes the  function starting at line 23 to build the formatted position.  This uses <code>String.fromCharCode(176)</code> to get a degree character, which is perhaps where Windows is failing - although I thought it worked previously.<br>
Try replacing  with xB0.  So line 27<br>
<code>            ("00" + parseInt(latAbs)).slice(-2) + String.fromCharCode(176) + " " +</code><br>
becomes<br>
<code>            ("00" + parseInt(latAbs)).slice(-2) + "\xB0" + " " +</code><br>
and similar change on line 30</p>



<a name="426311961"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426311961" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426311961">(Mar 13 2024 at 11:10)</a>:</h4>
<p>Yes ... it did work before. Same error with your changes.</p>



<a name="426312905"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426312905" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426312905">(Mar 13 2024 at 11:16)</a>:</h4>
<p>Try replacing both with something not taxing, like<br>
<code>       ("00" + parseInt(latAbs)).slice(-2) + "*" + " " +</code></p>



<a name="426313384"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426313384" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426313384">(Mar 13 2024 at 11:19)</a>:</h4>
<p>Same error.</p>



<a name="426313633"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426313633" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426313633">(Mar 13 2024 at 11:20)</a>:</h4>
<p>How about line 10:<br>
<code>pos = parsePosition(arguments[0]);</code><br>
This is a new addition.</p>



<a name="426315615"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426315615" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426315615">(Mar 13 2024 at 11:32)</a>:</h4>
<p>Yes.  Maybe the constructor is failing because the parsePosition function has several \xB0 in it.<br>
It has to cope with the seven or eight different ways people type a position  25.8', 25'8, 25'.8 etc.</p>
<p>Please try just this in a different console</p>
<p><code>print("Degree symbol is \xB0\n");</code></p>



<a name="426315802"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426315802" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426315802">(Mar 13 2024 at 11:33)</a>:</h4>
<p>*Degree symbol is °<br>
result: undefined*</p>



<a name="426316897"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426316897" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426316897">(Mar 13 2024 at 11:39)</a>:</h4>
<p>Line 82 change to <code>trace = true;</code></p>



<a name="426317046"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426317046" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426317046">(Mar 13 2024 at 11:40)</a>:</h4>
<p>Having trouble with boolean?:</p>
<div class="codehilite"><pre><span></span><code>latitude = -54;
lat = latitude&lt;0)?&quot;S&quot;:&quot;N&quot;;
print(lat, &quot;\n&quot;);
</code></pre></div>
<p>Could you correct this for me to test?</p>



<a name="426317334"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426317334" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426317334">(Mar 13 2024 at 11:42)</a>:</h4>
<blockquote>
<p>Line 82 change to trace = true;</p>
</blockquote>
<p>Same error.</p>



<a name="426317389"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426317389" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426317389">(Mar 13 2024 at 11:42)</a>:</h4>
<p>Missing opening ( around boolean expression, should be</p>
<div class="codehilite"><pre><span></span><code>latitude = -54;
lat = (latitude&lt;0)?&quot;S&quot;:&quot;N&quot;;
print(lat, &quot;\n&quot;);
</code></pre></div>



<a name="426317665"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426317665" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426317665">(Mar 13 2024 at 11:44)</a>:</h4>
<p>*S<br>
result: undefined*</p>



<a name="426317920"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426317920" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426317920">(Mar 13 2024 at 11:45)</a>:</h4>
<p>That's correct for what you programmed - assuming you included the * in your reply to me</p>



<a name="426318082"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426318082" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426318082">(Mar 13 2024 at 11:46)</a>:</h4>
<p>The * might be where you are trying to type back prime fr code?</p>



<a name="426318205"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426318205" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426318205">(Mar 13 2024 at 11:47)</a>:</h4>
<p>I was trying to italicize the text.</p>



<a name="426319858"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426319858" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426319858">(Mar 13 2024 at 11:57)</a>:</h4>
<p>Leaving trace = true, after that line 82 insert<br>
<code>return({latitude:60, longitude:-2});</code><br>
You should see that position returned from the parsing function.<br>
If that works, try moving the position further down the parsing function to see how far it gets without failing.</p>



<a name="426320482"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426320482" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426320482">(Mar 13 2024 at 12:01)</a>:</h4>
<p>Return fails. Only this:<br>
<em>SyntaxError: source decode failed (line 153)</em></p>



<a name="426323499"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426323499" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426323499">(Mar 13 2024 at 12:18)</a>:</h4>
<p>I am using nested functions.  Not strictly allowed but seen no problems on MacOS.<br>
Please try this script in a scratch console</p>
<div class="codehilite" data-code-language="JavaScript"><pre><span></span><code><span class="nx">print</span><span class="p">(</span><span class="nx">outer</span><span class="p">(),</span><span class="w"> </span><span class="s2">"\n"</span><span class="p">);</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">outer</span><span class="p">(){</span>
<span class="w">    </span><span class="kd">function</span><span class="w"> </span><span class="nx">inner</span><span class="p">(){</span>
<span class="w">        </span><span class="k">return</span><span class="p">(</span><span class="s2">"Hello"</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">inner</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>
</code></pre></div>



<a name="426323908"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426323908" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426323908">(Mar 13 2024 at 12:21)</a>:</h4>
<p>Hello<br>
result: undefined</p>



<a name="426325016"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426325016" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426325016">(Mar 13 2024 at 12:27)</a>:</h4>
<p>So it is not nested functions...</p>



<a name="426325303"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426325303" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426325303">(Mar 13 2024 at 12:28)</a>:</h4>
<p>My head hurts as well ;)</p>



<a name="426326584"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426326584" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426326584">(Mar 13 2024 at 12:36)</a>:</h4>
<p>OK, lets narrow it down. by commenting out code<br>
Lines 80-84 become</p>
<div class="codehilite" data-code-language="JavaScript"><pre><span></span><code><span class="w">      </span><span class="kd">function</span><span class="w"> </span><span class="nx">parsePosition</span><span class="p">(</span><span class="nx">text</span><span class="p">){</span>
<span class="w">        </span><span class="c1">// parse lat &amp; long into position object</span>
<span class="k">return</span><span class="p">({</span><span class="nx">latitude</span><span class="o">:</span><span class="mf">61</span><span class="p">,</span><span class="w"> </span><span class="nx">longitude</span><span class="o">:</span><span class="w"> </span><span class="o">-</span><span class="mf">2</span><span class="p">});</span>
<span class="err">/*</span>
<span class="w">        </span><span class="nx">trace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
</code></pre></div>
<p>and insert end of comment like this</p>
<div class="codehilite" data-code-language="JavaScript"><pre><span></span><code><span class="w">        </span><span class="kd">function</span><span class="w"> </span><span class="nx">bail</span><span class="p">(</span><span class="nx">message</span><span class="p">){</span>
<span class="w">            </span><span class="k">throw</span><span class="p">(</span><span class="nx">title</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">" "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">phase</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">" "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">message</span><span class="p">);</span>
<span class="w">            </span><span class="p">};</span>
<span class="o">*</span><span class="err">/</span>
<span class="w">        </span><span class="p">}</span>
</code></pre></div>
<p>Hopefully you get output</p>
<blockquote>
<p>55° 00.000'N 002° 0.000'W<br>
61° 00.000'N 002° 0.000'W<br>
result: undefined</p>
</blockquote>



<a name="426330451"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426330451" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426330451">(Mar 13 2024 at 12:48)</a>:</h4>
<p>Sorry: <br>
SyntaxError: source decode failed (line 156)</p>



<a name="426331479"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426331479" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426331479">(Mar 13 2024 at 12:51)</a>:</h4>
<p>Fresh copy of the test script which compiles OK for me.  Please adopt so we know we are working with the same thing.<br>
<a href="/user_uploads/33951/5fLfNpQV9xl6RnoflofCe1rm/positionComplete.js.zip">positionComplete.js.zip</a></p>



<a name="426332234"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426332234" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426332234">(Mar 13 2024 at 12:53)</a>:</h4>
<p>SyntaxError: source decode failed (line 28)</p>



<a name="426333729"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426333729" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426333729">(Mar 13 2024 at 12:57)</a>:</h4>
<p>OK looks like it is throwing up over "\xB0".  Let's restore it using fromCharCode lines 26-33 should now be</p>
<div class="codehilite" data-code-language="JavaScript"><pre><span></span><code><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
<span class="w">            </span><span class="p">(</span><span class="s2">"00"</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">latAbs</span><span class="p">)).</span><span class="nx">slice</span><span class="p">(</span><span class="o">-</span><span class="mf">2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">String</span><span class="p">.</span><span class="nx">fromCharCode</span><span class="p">(</span><span class="mf">176</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">            </span><span class="p">(</span><span class="s2">"00"</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="nx">latAbs</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mf">1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">60</span><span class="p">).</span><span class="nx">toFixed</span><span class="p">(</span><span class="mf">3</span><span class="p">)).</span><span class="nx">slice</span><span class="p">(</span><span class="o">-</span><span class="mf">6</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">"'"</span><span class="w"> </span><span class="o">+</span>
<span class="w">            </span><span class="p">((</span><span class="k">this</span><span class="p">.</span><span class="nx">latitude</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s2">"S "</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">"N "</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">            </span><span class="p">(</span><span class="s2">"00"</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">lonAbs</span><span class="p">)).</span><span class="nx">slice</span><span class="p">(</span><span class="o">-</span><span class="mf">3</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">String</span><span class="p">.</span><span class="nx">fromCharCode</span><span class="p">(</span><span class="mf">176</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">            </span><span class="p">(</span><span class="nx">lonAbs</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mf">1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">60</span><span class="p">).</span><span class="nx">toFixed</span><span class="p">(</span><span class="mf">3</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">"'"</span><span class="w"> </span><span class="o">+</span>
<span class="w">            </span><span class="p">((</span><span class="k">this</span><span class="p">.</span><span class="nx">longitude</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s2">"W"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">"E"</span><span class="p">)</span>
<span class="w">            </span><span class="p">)}</span>
</code></pre></div>



<a name="426334273"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426334273" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426334273">(Mar 13 2024 at 12:59)</a>:</h4>
<p>Still:<br>
SyntaxError: source decode failed (line 28)</p>



<a name="426334572"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426334572" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426334572">(Mar 13 2024 at 13:01)</a>:</h4>
<p>Hold on: your ? has come out as a decimal character when I copied your code across.</p>



<a name="426335010"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426335010" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426335010">(Mar 13 2024 at 13:03)</a>:</h4>
<p>Maybe use the Load button to load  the file rather than copying and pasting.</p>



<a name="426335629"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426335629" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426335629">(Mar 13 2024 at 13:06)</a>:</h4>
<p>Yes. Did that but lines 43 and 44 had the same problem, replacing ? by the decimal character..</p>



<a name="426335676"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426335676" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426335676">(Mar 13 2024 at 13:06)</a>:</h4>
<p>Off to lunch.</p>



<a name="426348612"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426348612" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426348612">(Mar 13 2024 at 14:09)</a>:</h4>
<p>Saved this as a .js file.</p>
<div class="codehilite"><pre><span></span><code>latitude = -55;
print((latitude &lt; 0) ? &quot;S &quot; : &quot;N &quot;);
</code></pre></div>
<p>When this is loaded:</p>
<div class="codehilite"><pre><span></span><code>latitude = -55;
print((latitude &lt; 0) ° &quot;S &quot; : &quot;N &quot;);
</code></pre></div>



<a name="426349646"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426349646" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426349646">(Mar 13 2024 at 14:15)</a>:</h4>
<p>In Diagnostics when I enter ?</p>
<div class="codehilite"><pre><span></span><code>[00]?

Raw
?
[00]3F

Cleaned
&amp;#xb0
[00]26 [01]23 [02]78 [03]62 [04]30
</code></pre></div>



<a name="426349806"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426349806" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426349806">(Mar 13 2024 at 14:16)</a>:</h4>
<p>So the ? character is not being left untouched when a file is loaded.</p>



<a name="426358439"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426358439" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426358439">(Mar 13 2024 at 14:54)</a>:</h4>
<p>New in v3 is cleaning superscript 0 to  real degree<br>
This is done in functions.cpp line 62 on.  I addd line 92<br>
<code>    given.Replace(superScript0, degree, true);</code><br>
and I commented out this next because I cannot remember why it is there,<br>
<code>//     given.Replace(degree, degreeText, true);</code><br>
Maybe Windows needed t?  But no mention of x3F anywhere.<br>
Thoughts?</p>



<a name="426360597"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426360597" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426360597">(Mar 13 2024 at 15:02)</a>:</h4>
<p>You can test in JavaScript with</p>
<div class="codehilite" data-code-language="JavaScript"><pre><span></span><code><span class="nx">print</span><span class="p">(</span><span class="nx">cleanString</span><span class="p">(</span><span class="s2">"?"</span><span class="p">),</span><span class="w"> </span><span class="s2">"\n"</span><span class="p">);</span>
</code></pre></div>



<a name="426360635"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426360635" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426360635">(Mar 13 2024 at 15:03)</a>:</h4>
<blockquote>
<p>But no mention of x3F anywhere.</p>
</blockquote>
<blockquote>
<p>//     given.Replace(degree, degreeText, true);</p>
</blockquote>
<p>Reverted but this made no difference.</p>



<a name="426360889"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426360889" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426360889">(Mar 13 2024 at 15:04)</a>:</h4>
<p>Going out for exercise after lunch - diabetes avoidance!</p>



<a name="426360921"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426360921" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426360921">(Mar 13 2024 at 15:04)</a>:</h4>
<p>&amp;#xb0<br>
result: undefined</p>



<a name="426373386"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426373386" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426373386">(Mar 13 2024 at 15:58)</a>:</h4>
<p>That's the extra one you reinstated.  But why is ? being seen as a degree?<br>
Please try this script:</p>
<div class="codehilite" data-code-language="JavaScript"><pre><span></span><code><span class="nx">test</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"?"</span><span class="p">;</span>
<span class="nx">print</span><span class="p">(</span><span class="nx">test</span><span class="p">,</span><span class="s2">"\t"</span><span class="p">,</span><span class="w"> </span><span class="nx">test</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="mf">0</span><span class="p">).</span><span class="nx">toString</span><span class="p">(</span><span class="mf">16</span><span class="p">),</span><span class="w"> </span><span class="s2">"\n"</span><span class="p">);</span>
<span class="nx">after</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">cleanString</span><span class="p">(</span><span class="nx">test</span><span class="p">);</span>
<span class="nx">print</span><span class="p">(</span><span class="nx">after</span><span class="p">,</span><span class="s2">"\t"</span><span class="p">,</span><span class="w"> </span><span class="nx">after</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="mf">0</span><span class="p">).</span><span class="nx">toString</span><span class="p">(</span><span class="mf">16</span><span class="p">),</span><span class="w"> </span><span class="s2">"\n"</span><span class="p">);</span>
</code></pre></div>
<p>I get</p>
<blockquote>
<p>?   3f<br>
?   3f<br>
result: undefined</p>
</blockquote>



<a name="426374357"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426374357" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426374357">(Mar 13 2024 at 16:02)</a>:</h4>
<p>?   3f<br>
°   NaN<br>
result: undefined</p>



<a name="426384626"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426384626" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426384626">(Mar 13 2024 at 16:50)</a>:</h4>
<p>So we know that ? is being compiled correctly to 0x3f.<br>
But it is being converted to º and your restored extra is  converting it to a string that is Not A Number.<br>
Only change I made is to add in functions.cpp line 93<br>
<code> given.Replace(superScript0, degree, true);</code><br>
where superScript0 is<br>
<code> const wxString superScript0 {"\u2070"};   // superscript 0 pretending to be degrees</code></p>
<p>Could this somehow be matching 0x3f ? Sounds impossible but only think I can think of.<br>
Can you comment out this conversion to check?</p>



<a name="426388932"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426388932" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426388932">(Mar 13 2024 at 17:10)</a>:</h4>
<p>Well done. That allowed the import of my simple test file without changing the ? character. I will play with the other file you sent.</p>



<a name="426389580"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426389580" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426389580">(Mar 13 2024 at 17:13)</a>:</h4>
<p>SyntaxError: source decode failed (line 153)<br>
With both <em>positionComplete.js</em> commented out section and raw.</p>



<a name="426389665"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426389665" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426389665">(Mar 13 2024 at 17:13)</a>:</h4>
<p>But the ? is retained on loading.</p>



<a name="426392601"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426392601" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426392601">(Mar 13 2024 at 17:28)</a>:</h4>
<p>I am not quite clear what you are sying.  I think that <code>positionComplete.js</code> fails at line 153, which is blank for me but probably my 154<br>
<code>pos = new Position(55, -2);</code><br>
I think the constructor is throwing the error.  Please</p>
<ol>
<li>comment out the second pos2  test at lines 157</li>
<li>comment out line 10 <code>pos = parsePosition(arguments[0]);</code></li>
<li>comment out lines 74-76</li>
<li>Adjust the existing commented out section to exclude the whole of the <code>function parsePosition</code>.  You will need to move the closing */ down one line<br>
Does that run and just do the pos.formatted thing?</li>
</ol>



<a name="426394397"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426394397" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426394397">(Mar 13 2024 at 17:38)</a>:</h4>
<blockquote>
<p>Does that run and just do the pos.formatted thing?</p>
</blockquote>
<p><em>SyntaxError: source decode failed (line 155)</em></p>



<a name="426395097"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426395097" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426395097">(Mar 13 2024 at 17:42)</a>:</h4>
<p>Which line of these is 155?</p>
<div class="codehilite"><pre><span></span><code>pos = new Position(55, -2);
print(pos.formatted, &quot;\n&quot;);
</code></pre></div>



<a name="426395279"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426395279" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426395279">(Mar 13 2024 at 17:43)</a>:</h4>
<p><em>print(pos.formatted, "\n");</em></p>



<a name="426395576"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426395576" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426395576">(Mar 13 2024 at 17:45)</a>:</h4>
<p>Have you still got <code>"\xB0 "</code> in lines 27 &amp; 30?</p>



<a name="426395781"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426395781" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426395781">(Mar 13 2024 at 17:46)</a>:</h4>
<blockquote>
<p>Have you still got "\xB0 " in lines 27 &amp; 30?</p>
</blockquote>
<p>Yes.</p>



<a name="426396302"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426396302" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426396302">(Mar 13 2024 at 17:48)</a>:</h4>
<p>Please replace both instances of <code>"\xB0"</code> with <code>String.fromCharCode(176)</code></p>



<a name="426396370"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426396370" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426396370">(Mar 13 2024 at 17:48)</a>:</h4>
<p>Just tried that. Same result.</p>



<a name="426396824"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426396824" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426396824">(Mar 13 2024 at 17:51)</a>:</h4>
<p>Just in case I am messing things up could you send me an update of the test file <em>positionComplete.js.</em></p>



<a name="426396995"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426396995" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426396995">(Mar 13 2024 at 17:52)</a>:</h4>
<p>I am away. BBL.</p>



<a name="426397062"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426397062" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426397062">(Mar 13 2024 at 17:52)</a>:</h4>
<p><a href="/user_uploads/33951/nRuMjC4r1gJHyqvX39RT9O2T/positionComplete.js.zip">positionComplete.js.zip</a></p>



<a name="426397425"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426397425" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426397425">(Mar 13 2024 at 17:54)</a>:</h4>
<p>Thanks. The same result:<br>
<em>SyntaxError: source decode failed (line 155)</em></p>



<a name="426399227"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426399227" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426399227">(Mar 13 2024 at 18:05)</a>:</h4>
<p>Attached is a different test with the v2.0.4 Position built in.<br>
Does this work?  I get</p>
<blockquote>
<p>55° 00.000'N 002° 0.000'W<br>
result: undefined</p>
</blockquote>
<p><a href="/user_uploads/33951/wdcCAO_bcB4LCIRe7VdxSk2v/oldPositionComplete.js.zip">oldPositionComplete.js.zip</a></p>



<a name="426412794"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426412794" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426412794">(Mar 13 2024 at 19:31)</a>:</h4>
<blockquote>
<p>55° 00.000'N 002° 0.000'W<br>
result: undefined</p>
</blockquote>



<a name="426413938"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426413938" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426413938">(Mar 13 2024 at 19:39)</a>:</h4>
<p>After line 64 in this latest file, add<br>
<code>   return this;</code><br>
and test again.</p>



<a name="426415256"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426415256" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426415256">(Mar 13 2024 at 19:47)</a>:</h4>
<p>Supper - back tomorrow</p>



<a name="426494191"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426494191" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426494191">(Mar 14 2024 at 08:54)</a>:</h4>
<p>I would expect the JavaScript engine to give the line number of the issue up to 2 nesting levels but it is not doing so in this case.  Perhaps this is because the issue is in a construction rather than a function call.<br>
I see no alternative but to add back in the new bits of Position a bit at a time until you see the problem.  You could do that, or I can but I will have to send you a file at each stage.</p>



<a name="426501770"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426501770" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426501770">(Mar 14 2024 at 09:36)</a>:</h4>
<p>Please can you send me a test file for each stage. Happy to test as they come.</p>



<a name="426502415"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426502415" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426502415">(Mar 14 2024 at 09:40)</a>:</h4>
<p>(1) Was adding  <code>return this</code> as above OK?</p>



<a name="426503264"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426503264" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426503264">(Mar 14 2024 at 09:44)</a>:</h4>
<p>Yes ... that was ok.</p>



<a name="426503890"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426503890" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426503890">(Mar 14 2024 at 09:48)</a>:</h4>
<p>55° 00.000'N 002° 0.000'W<br>
result: undefined</p>



<a name="426508180"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426508180" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426508180">(Mar 14 2024 at 10:12)</a>:</h4>
<p><a href="/user_uploads/33951/oEz9xmFYh52xPxwYKJ6vQUgM/Test2.js.zip">Test2.js.zip</a></p>
<p>Expect</p>
<blockquote>
<p>55° 00.000'N 002° 0.000'W<br>
61° 00.000'N 002° 0.000'W<br>
result: undefined</p>
</blockquote>



<a name="426508623"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426508623" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426508623">(Mar 14 2024 at 10:15)</a>:</h4>
<p>SyntaxError: source decode failed (line 80)<br>
When I remove lines 81 and 82 the result is ok.</p>



<a name="426509934"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426509934" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426509934">(Mar 14 2024 at 10:22)</a>:</h4>
<p><a href="/user_uploads/33951/0f9JVUsdFWitsrGp4MGDi-Cr/Test3.js.zip">Test3.js.zip</a></p>



<a name="426510319"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426510319" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426510319">(Mar 14 2024 at 10:24)</a>:</h4>
<p>SyntaxError: source decode failed (line 82)</p>



<a name="426512257"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426512257" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426512257">(Mar 14 2024 at 10:35)</a>:</h4>
<p><a href="/user_uploads/33951/kp_f4ePJNA8KqjKtJNgjssIk/Test4.js.zip">Test4.js.zip</a></p>



<a name="426512475"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426512475" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426512475">(Mar 14 2024 at 10:36)</a>:</h4>
<p>SyntaxError: source decode failed (line 82)</p>



<a name="426516581"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426516581" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426516581">(Mar 14 2024 at 11:00)</a>:</h4>
<p>Added tracing stuff - very close.<br>
<a href="/user_uploads/33951/BxVrJDPVlCgrw7rS4_1BxQTd/Test5.js.zip">Test5.js.zip</a></p>



<a name="426517153"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426517153" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426517153">(Mar 14 2024 at 11:03)</a>:</h4>
<p>SyntaxError: source decode failed (line 87)<br>
Line 87 has stopped the other print commands.</p>



<a name="426517396"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426517396" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426517396">(Mar 14 2024 at 11:05)</a>:</h4>
<p>If I remove the degree symbols in Line 87 things work.</p>



<a name="426517502"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426517502" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426517502">(Mar 14 2024 at 11:06)</a>:</h4>
<p>And output includes the degree symbols.</p>



<a name="426517988"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426517988" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426517988">(Mar 14 2024 at 11:09)</a>:</h4>
<p>So might this all be about degree symbols rather than an issue in the Position?<br>
Please try this one-liner<br>
<code>print("52° 12.345'N 1° 1.234'W","\n");</code></p>



<a name="426518180"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426518180" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426518180">(Mar 14 2024 at 11:10)</a>:</h4>
<p>SyntaxError: source decode failed (line 0)</p>



<a name="426518369"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426518369" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426518369">(Mar 14 2024 at 11:11)</a>:</h4>
<p>and if you paste <code>52º</code> into the cleanString test in Tools ?</p>



<a name="426518647"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426518647" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426518647">(Mar 14 2024 at 11:14)</a>:</h4>
<p>[00]5 [01]2 [02]º </p>
<p>Raw<br>
52º<br>
[00]35 [01]32 [02]BA </p>
<p>Cleaned<br>
52°<br>
[00]35 [01]32 [02]B0 </p>
<p>The degree symbols are different.  Do I revert the commenting out of the superscore character line?</p>



<a name="426519199"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426519199" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426519199">(Mar 14 2024 at 11:17)</a>:</h4>
<div class="codehilite"><pre><span></span><code>// given.Replace(superScript0, degree, true);
</code></pre></div>



<a name="426520013"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426520013" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426520013">(Mar 14 2024 at 11:23)</a>:</h4>
<p>Your pasted degree was actually 0xBA - the masculine ordinal.  This is a common mis-representation of degree.  maybe you got that by copying from Zulip.<br>
Anyhow, cleanString correctly changed that to 0xB0 - the degree symbol.<br>
Yes you can uncomment that superscript conversion but it is not being used here.<br>
It looks like the problem is again that the Windows JS engine cannot cope with degree 0xB0.</p>



<a name="426520843"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426520843" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426520843">(Mar 14 2024 at 11:28)</a>:</h4>
<p>Let's see whether it can process if  not compiled.<br>
Please change line  87 to<br>
<code>pos2 = new Position(fromClipboard());</code><br>
and before running the script, copy this position to the clipboard, from where it will read it.<br>
52° 12.345'N 1° 1.234'W</p>



<a name="426521351"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426521351" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426521351">(Mar 14 2024 at 11:31)</a>:</h4>
<div class="codehilite"><pre><span></span><code>arguments.length:2
55° 00.000&#39;N 002° 0.000&#39;W
arguments.length:1
Have arguments.length == 1
Type:string
In parse section
Done parse section
61° 00.000&#39;N 002° 0.000&#39;W
result: undefined
</code></pre></div>



<a name="426521654"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426521654" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426521654">(Mar 14 2024 at 11:33)</a>:</h4>
<p>Yes!   Conclusion: cannot compile degree symbol but a script can process it.<br>
Standby for testing further with the new Position .</p>



<a name="426522284"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426522284" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426522284">(Mar 14 2024 at 11:37)</a>:</h4>
<p>Please run Test6 with the position on your clipboard.<br>
<a href="/user_uploads/33951/6ZsltwaBa4XE1z3v06p2utTd/Test6.js.zip">Test6.js.zip</a></p>



<a name="426522620"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426522620" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426522620">(Mar 14 2024 at 11:39)</a>:</h4>
<div class="codehilite"><pre><span></span><code>55° 00.000&#39;N 002° 0.000&#39;W
parsePosition line 86 Error: internal error
called from Position line 10
called from line 154
</code></pre></div>



<a name="426523817"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426523817" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426523817">(Mar 14 2024 at 11:45)</a>:</h4>
<p>So earlier problem was that it was failing to compile with degree symbol.<br>
At least now we are getting the trace back.<br>
It is failing when matching a regular expression if the text to be matched as a degree in it.<br>
Will send you another test in a few moments,</p>



<a name="426525797"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426525797" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426525797">(Mar 14 2024 at 11:58)</a>:</h4>
<p>Please run this script with the position on the clipboard:</p>
<div class="codehilite" data-code-language="JavaScript"><pre><span></span><code><span class="nx">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fromClipboard</span><span class="p">();</span>
<span class="nx">print</span><span class="p">(</span><span class="s2">"Clipboard has: "</span><span class="p">,</span><span class="w"> </span><span class="nx">text</span><span class="p">,</span><span class="w"> </span><span class="s2">"\n"</span><span class="p">);</span>
<span class="nx">print</span><span class="p">(</span><span class="s2">"\xB0"</span><span class="p">,</span><span class="w"> </span><span class="s2">"\n"</span><span class="p">);</span>
<span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="nx">text</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s2">"\xB0"</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="nx">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">text</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="s2">"\xB0"</span><span class="p">,</span><span class="w"> </span><span class="s1">'*'</span><span class="p">);</span>
<span class="nx">print</span><span class="p">(</span><span class="s2">"Processed: "</span><span class="p">,</span><span class="w"> </span><span class="nx">text</span><span class="p">,</span><span class="w"> </span><span class="s2">"\n"</span><span class="p">);</span>
</code></pre></div>



<a name="426526108"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426526108" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426526108">(Mar 14 2024 at 12:00)</a>:</h4>
<div class="codehilite"><pre><span></span><code>Clipboard has: 52° 12.345&#39;N 1° 1.234&#39;W
°
Processed: 52° 12.345&#39;N 1° 1.234&#39;W
result: undefined
</code></pre></div>



<a name="426526581"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426526581" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426526581">(Mar 14 2024 at 12:03)</a>:</h4>
<p>That is disappointing.  The "\xB0" has compiled OK as it is printed correctly in line 3.<br>
But it is failing to match in the search and replace bit.<br>
Will have another go.</p>



<a name="426527023"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426527023" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426527023">(Mar 14 2024 at 12:06)</a>:</h4>
<p>147 messages were moved here from <a class="stream-topic" data-stream-id="349785" href="/#narrow/stream/349785-JavaScript_pi/topic/v3.2E0.20beta.20testing">#JavaScript_pi &gt; v3.0 beta testing</a> by <span class="user-mention silent" data-user-id="399559">Mike Rossiter</span>.</p>



<a name="426527176"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426527176" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426527176">(Mar 14 2024 at 12:07)</a>:</h4>
<p>This topic was moved here from <a class="stream-topic" data-stream-id="349785" href="/#narrow/stream/349785-JavaScript_pi/topic/.28no.20topic.29">#JavaScript_pi &gt; (no topic)</a> by <span class="user-mention silent" data-user-id="399559">Mike Rossiter</span>.</p>



<a name="426527592"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426527592" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426527592">(Mar 14 2024 at 12:09)</a>:</h4>
<p>Trying to get all the beta testing stuff together.</p>



<a name="426529911"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426529911" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426529911">(Mar 14 2024 at 12:24)</a>:</h4>
<p>Please run this with position on clipboard</p>
<div class="codehilite" data-code-language="JavaScript"><pre><span></span><code><span class="kd">var</span><span class="w"> </span><span class="nx">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fromClipboard</span><span class="p">();</span>
<span class="nx">print</span><span class="p">(</span><span class="s2">"Clipboard has: "</span><span class="p">,</span><span class="w"> </span><span class="nx">text</span><span class="p">,</span><span class="w"> </span><span class="s2">"\n"</span><span class="p">);</span>
<span class="nx">print</span><span class="p">(</span><span class="s2">"\xB0"</span><span class="p">,</span><span class="w"> </span><span class="s2">"\n"</span><span class="p">);</span>
<span class="nx">splut</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">text</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">"\xB0"</span><span class="p">);</span>
<span class="nx">print</span><span class="p">(</span><span class="nx">splut</span><span class="p">,</span><span class="w"> </span><span class="s2">"\n"</span><span class="p">);</span>
<span class="nx">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">splut</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s2">"*"</span><span class="p">);</span>
<span class="nx">print</span><span class="p">(</span><span class="s2">"\nProcessed: "</span><span class="p">,</span><span class="w"> </span><span class="nx">text</span><span class="p">,</span><span class="w"> </span><span class="s2">"\n"</span><span class="p">);</span>
</code></pre></div>



<a name="426530286"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426530286" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426530286">(Mar 14 2024 at 12:27)</a>:</h4>
<div class="codehilite"><pre><span></span><code>Clipboard has: 52° 12.345&#39;N 1° 1.234&#39;W
°
[&quot;52° 12.345&#39;N 1° 1.234&#39;W&quot;]

Processed: 52° 12.345&#39;N 1° 1.234&#39;W
result: undefined
</code></pre></div>



<a name="426531232"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426531232" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426531232">(Mar 14 2024 at 12:33)</a>:</h4>
<p>Blast - it is even failing  on Windows to spilt the string  at a degree character.  It seems unable to match it in any of the ways I have tried.<br>
Thinking...</p>



<a name="426535213"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426535213" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426535213">(Mar 14 2024 at 12:56)</a>:</h4>
<p>Please run this test with a position on the clipboard:</p>
<div class="codehilite" data-code-language="JavaScript"><pre><span></span><code><span class="kd">var</span><span class="w"> </span><span class="nx">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fromClipboard</span><span class="p">();</span>
<span class="nx">print</span><span class="p">(</span><span class="s2">"Clipboard has: "</span><span class="p">,</span><span class="w"> </span><span class="nx">text</span><span class="p">,</span><span class="w"> </span><span class="s2">"\n"</span><span class="p">);</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">text</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="nx">print</span><span class="p">(</span><span class="nx">text</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="nx">i</span><span class="p">),</span><span class="w"> </span><span class="s2">" "</span><span class="p">);</span>
</code></pre></div>



<a name="426535837"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426535837" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426535837">(Mar 14 2024 at 12:59)</a>:</h4>
<div class="codehilite"><pre><span></span><code>Clipboard has: 52° 12.345&#39;N 1° 1.234&#39;W
53 50 32 49 50 46 51 52 53 39 78 32 49 32 49 46 50 51 52 39 87 result: undefined
</code></pre></div>



<a name="426537912"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426537912" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426537912">(Mar 14 2024 at 13:11)</a>:</h4>
<p>BBL</p>



<a name="426548113"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426548113" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426548113">(Mar 14 2024 at 14:01)</a>:</h4>
<p>Working on a workaround for inability to handle º<br>
Another test, please<br>
<a href="/user_uploads/33951/sVCAo6E-CstAAIudC-okdkCY/Test7.js.zip">Test7.js.zip</a></p>



<a name="426548711"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426548711" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426548711">(Mar 14 2024 at 14:04)</a>:</h4>
<div class="codehilite"><pre><span></span><code>Clipboard has: 52° 12.345&#39;N 1° 1.234&#39;W
53 50 32 49 50 46 51 52 53 39 78 32 49 32 49 46 50 51 52 39 87
A: 52° 12.345&#39;N 1° 1.234&#39;W


[&quot;52° 12.345&#39;N 1° 1.234&#39;W&quot;]

B: 52° 12.345&#39;N 1° 1.234&#39;W
result: undefined
</code></pre></div>



<a name="426557257"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426557257" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426557257">(Mar 14 2024 at 14:43)</a>:</h4>
<p>That didn't work.  Please try this test:<br>
<a href="/user_uploads/33951/WCeOg9L4jZ33uL5AhUpO0-S-/Test8.js.zip">Test8.js.zip</a></p>



<a name="426557867"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426557867" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426557867">(Mar 14 2024 at 14:46)</a>:</h4>
<div class="codehilite"><pre><span></span><code>Clipboard has: 52° 12.345&#39;N 1° 1.234&#39;W
53 50 32 49 50 46 51 52 53 39 78 32 49 32 49 46 50 51 52 39 87
A: 52° 12.345&#39;N 1° 1.234&#39;W


[&quot;52° 12.345&#39;N 1° 1.234&#39;W&quot;]
53 50 32 49 50 46 51 52 53 39 78 32 49 32 49 46 50 51 52 39 87
result: undefined
</code></pre></div>



<a name="426559058"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426559058" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426559058">(Mar 14 2024 at 14:51)</a>:</h4>
<p>This one with position on clipboard, please.</p>
<div class="codehilite" data-code-language="JavaScript"><pre><span></span><code><span class="nx">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">cleanString</span><span class="p">(</span><span class="nx">fromClipboard</span><span class="p">());</span>
<span class="nx">print</span><span class="p">(</span><span class="nx">text</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">"\xB0"</span><span class="p">),</span><span class="w"> </span><span class="s2">"\n"</span><span class="p">);</span>
</code></pre></div>



<a name="426559835"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426559835" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426559835">(Mar 14 2024 at 14:55)</a>:</h4>
<div class="codehilite"><pre><span></span><code>[&quot;52° 12.345&#39;N 1° 1.234&#39;W&quot;]
result: undefined
</code></pre></div>



<a name="426563601"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426563601" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426563601">(Mar 14 2024 at 15:11)</a>:</h4>
<p>Despite all these tries, I have found no way of identifying º in a JS script not even with <code>String.fromCharCode(176)</code> etc.  It seems on Windows it is incapable of handling characters greater than x7F, even when using character codes.</p>
<p>The only solution I can think of is to clean it to something in the 7-bit code.  Could be * but potential confudion with a real *.<br>
I am toying with /x07 'Bell'.  It works on MacOS and prints as a bell symbol. I can pattern match it tool.  Please run the following to test if it can be matched on Windows.<br>
Thoughts?</p>
<div class="codehilite" data-code-language="JavaScript"><pre><span></span><code><span class="nx">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"This is a bell ding\x07dong"</span><span class="p">;</span>
<span class="nx">print</span><span class="p">(</span><span class="nx">text</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">"\x07"</span><span class="p">),</span><span class="w"> </span><span class="s2">"\n"</span><span class="p">);</span>
</code></pre></div>



<a name="426564113"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426564113" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426564113">(Mar 14 2024 at 15:14)</a>:</h4>
<div class="codehilite"><pre><span></span><code>[&quot;This is a bell ding&quot;,&quot;dong&quot;]
result: undefined
</code></pre></div>



<a name="426572262"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426572262" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426572262">(Mar 14 2024 at 15:50)</a>:</h4>
<p>Is it possible to use 'deg' in some way instead of the degree symbol? And then for output change deg to the symbol.</p>



<a name="426572429"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426572429" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426572429">(Mar 14 2024 at 15:51)</a>:</h4>
<p>Perhaps not. The symbol is not recognised by Windows.</p>



<a name="426573307"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426573307" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426573307">(Mar 14 2024 at 15:55)</a>:</h4>
<p>The result of your last test <strong>was good</strong>.  The text was split at x07.<br>
We can for Windowsonly transform to x07 in way in and back on way out.  So you will stil be able to us º in scripts and print it etc.</p>



<a name="426574977"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426574977" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426574977">(Mar 14 2024 at 16:02)</a>:</h4>
<p>Can probably even use ° in the Position parser too!</p>



<a name="426710921"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426710921" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426710921">(Mar 15 2024 at 10:08)</a>:</h4>
<p>Whoops!  Have discovered a rather serious oversight.<br>
Scripts were being filtered on Load rather than on Run.<br>
So script edited or pasted into the script pane were not being filtered.<br>
Not sure whether your woes with degree could have been down to this.</p>
<p>New build just now has gone into my <a href="https://cloudsmith.io/~opencpn/repos/javascript-alpha/packages/">alpha build repo here</a>.</p>
<p>Please test with this<br>
<a href="/user_uploads/33951/qEFdav0nWLM5RtYjydr0_e82/Test9.js.zip">Test9.js.zip</a><br>
 updated and expanded Position/test.</p>
<p>My output:</p>
<blockquote>
<p>55° 00.000'N 002° 0.000'W<br>
55° 12.342'N 002° 1.021'W<br>
A   54° 00.000'N 013° 12.340'W<br>
B   55° 12.000'N 013° 23.450'W<br>
C   56° 30.217'N 013° 44.950'W<br>
result: undefined</p>
</blockquote>



<a name="426713524"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426713524" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426713524">(Mar 15 2024 at 10:25)</a>:</h4>
<p><code>SyntaxError: source decode failed (line 27)</code><br>
Masculine ordinal appears in the loaded script: "º " (not this symbol).<br>
It does not like this ("'") either. Lines 28 and 31.</p>



<a name="426714147"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426714147" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426714147">(Mar 15 2024 at 10:29)</a>:</h4>
<p>Minutes symbol seems to be replaced by "\" in line 163.</p>



<a name="426717246"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426717246" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426717246">(Mar 15 2024 at 10:48)</a>:</h4>
<blockquote>
<p>Minutes symbol seems to be replaced by "\" in line 163.</p>
</blockquote>
<p>No that is correct.  The \ is an escape for  the " - degrees minutes and seconds</p>
<blockquote>
<p>Masculine ordinal appears in the loaded script: "º " (not this symbol).</p>
</blockquote>
<p>Quite likely.  It is cleaned into degree at run time now.  It may appear as any of the others like masculine ordinal.</p>
<p>I have gone back to using real º in the Position script but if that fails, try replacing º with \xB0 in lines 27, 30 &amp; 105 and on line 125 with \xB0</p>



<a name="426720783"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426720783" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426720783">(Mar 15 2024 at 11:09)</a>:</h4>
<p><code>SyntaxError: source decode failed (line 28)</code><br>
The "'" symbol?</p>



<a name="426721450"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426721450" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426721450">(Mar 15 2024 at 11:13)</a>:</h4>
<p>Trying to replace with \x27.</p>



<a name="426722738"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426722738" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426722738">(Mar 15 2024 at 11:21)</a>:</h4>
<p>All primes of any flavour are being cleaned to \x27.</p>
<p>I can have<br>
<code>print("'prime'\n");</code> which prints 'prime'.<br>
I can also write<br>
<code>print('prime2\n');</code> so I can use ' instead of " - useful if I want to have " inside.</p>
<p>I wonder whether in Windows it only sees it as a quote mark.  Try<br>
<code>print("\'prime3\'\n");</code> which works for me.</p>



<a name="426723023"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426723023" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426723023">(Mar 15 2024 at 11:23)</a>:</h4>
<div class="codehilite"><pre><span></span><code>&#39;prime3&#39;
result: undefined
</code></pre></div>



<a name="426723228"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426723228" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426723228">(Mar 15 2024 at 11:24)</a>:</h4>
<p>So escaping \' works. <br>
How about <code>print('prime2\n');</code>?</p>



<a name="426723551"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426723551" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426723551">(Mar 15 2024 at 11:26)</a>:</h4>
<div class="codehilite"><pre><span></span><code>prime2
result: undefined
</code></pre></div>



<a name="426723691"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426723691" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426723691">(Mar 15 2024 at 11:27)</a>:</h4>
<p>And this one <code>print("'prime'\n");</code> ?</p>



<a name="426723831"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426723831" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426723831">(Mar 15 2024 at 11:28)</a>:</h4>
<div class="codehilite"><pre><span></span><code>&#39;prime&#39;
result: undefined
</code></pre></div>



<a name="426724212"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426724212" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426724212">(Mar 15 2024 at 11:31)</a>:</h4>
<p>So why is line 28 failing?<br>
You could try escaping it \'<br>
Also line  31 at least.</p>



<a name="426725214"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426725214" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426725214">(Mar 15 2024 at 11:38)</a>:</h4>
<p>SyntaxError: source decode failed (line 28)</p>



<a name="426725401"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426725401" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426725401">(Mar 15 2024 at 11:39)</a>:</h4>
<p>and \x27 ?</p>



<a name="426725615"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426725615" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426725615">(Mar 15 2024 at 11:41)</a>:</h4>
<p>SyntaxError: source decode failed (line 28)</p>



<a name="426725835"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426725835" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426725835">(Mar 15 2024 at 11:42)</a>:</h4>
<p>Please run <code>print(123.5 % 1, "\n");</code></p>



<a name="426725949"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426725949" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426725949">(Mar 15 2024 at 11:43)</a>:</h4>
<p><code>print(123.5 % 1 * 60, "\n");</code></p>



<a name="426726133"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426726133" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426726133">(Mar 15 2024 at 11:44)</a>:</h4>
<p>0.5<br>
result: undefined</p>
<p>30<br>
result: undefined</p>



<a name="426726736"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426726736" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426726736">(Mar 15 2024 at 11:48)</a>:</h4>
<p>Line 28 should look like this:<br>
<code>("00" + (latAbs % 1 * 60).toFixed(3)).slice(-6) + "'" +</code></p>
<p>Please find out which bit is the problem.  Yo could try replacing ' with, say, x<br>
or insert returns (not within a string) so it is spread across more lines. <br>
Then the error message will point you closer.</p>



<a name="426729133"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426729133" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426729133">(Mar 15 2024 at 12:02)</a>:</h4>
<p>Back to the problem of the ternary operator ?. When I remove this in lines 29-31 I trace down to line 90, another ternary. I will try some if/else stuff.</p>



<a name="426729446"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426729446" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426729446">(Mar 15 2024 at 12:05)</a>:</h4>
<p>Hang on - earlier you said you had issues with ?<br>
Try <code>print("Question ?\n");</code></p>



<a name="426729682"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426729682" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426729682">(Mar 15 2024 at 12:06)</a>:</h4>
<p>SyntaxError: source decode failed (line 0)</p>



<a name="426729807"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426729807" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426729807">(Mar 15 2024 at 12:07)</a>:</h4>
<p>What is ? giving you in the Tools string cleaning inspector?<br>
Expect x3F</p>



<a name="426729952"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426729952" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426729952">(Mar 15 2024 at 12:08)</a>:</h4>
<p>[00]? </p>
<div class="codehilite"><pre><span></span><code>Raw
?
[00]3F

Cleaned
°
[00]B0
</code></pre></div>



<a name="426730009"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426730009" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426730009">(Mar 15 2024 at 12:08)</a>:</h4>
<p>Ah!  stand by...</p>



<a name="426730908"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426730908" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alec Leamas <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426730908">(Mar 15 2024 at 12:13)</a>:</h4>
<p>Isnt this about javascript using utf-16 a k a unicode internally?. The degrees codepoint is certainly not 0xB0, it is 0x00B0. And when trying to match single bytes things breaks. Or?</p>
<p>Sample node session:</p>
<div class="codehilite"><pre><span></span><code>&gt; console.log(&quot;degrees °&quot;)
degrees °
undefined
&gt; chars = [...&quot;degrees °&quot;]
[
  &#39;d&#39;, &#39;e&#39;, &#39;g&#39;,
  &#39;r&#39;, &#39;e&#39;, &#39;e&#39;,
  &#39;s&#39;, &#39; &#39;, &#39;°&#39;
]
&gt; console.log(chars)
[
  &#39;d&#39;, &#39;e&#39;, &#39;g&#39;,
  &#39;r&#39;, &#39;e&#39;, &#39;e&#39;,
  &#39;s&#39;, &#39; &#39;, &#39;°&#39;
]
undefined
</code></pre></div>
<p>Just tell me if I should shut up...</p>



<a name="426731133"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426731133" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426731133">(Mar 15 2024 at 12:14)</a>:</h4>
<p>x3F is not anywhere in the string cleaning  functions.cpp line 62 on.<br>
It was working before - only thing new is cleaning superscript 0 to degree.<br>
Let's try commenting that out.  Will you do or do you want me to do and rebuild?</p>



<a name="426731279"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426731279" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426731279">(Mar 15 2024 at 12:15)</a>:</h4>
<p>Sounds unlikely but is ? being sen as supescript 0 and turned into degree?</p>



<a name="426731593"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426731593" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426731593">(Mar 15 2024 at 12:17)</a>:</h4>
<p>I think the engine is 8 bit ASCII</p>



<a name="426731599"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426731599" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426731599">(Mar 15 2024 at 12:17)</a>:</h4>
<p>(deleted)</p>



<a name="426731876"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426731876" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426731876">(Mar 15 2024 at 12:18)</a>:</h4>
<p>I don't have your latest alpha code but I will recompile yesterdays with superscript commented out.</p>



<a name="426732586"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426732586" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426732586">(Mar 15 2024 at 12:22)</a>:</h4>
<p>Yesterdays does not clean the script window careful.<br>
The plugin is here <code>https://github.com/antipole2/JavaScript_pi/tree/v3.0.0-beta</code></p>



<a name="426732694"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426732694" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426732694">(Mar 15 2024 at 12:23)</a>:</h4>
<p>It is only the builds that went into my alpha repo accidentally</p>



<a name="426732869"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426732869" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426732869">(Mar 15 2024 at 12:24)</a>:</h4>
<p>Did a manual clean of the degree symbol and with Test9 it went as far as line 155 before failing. StandBy for a new build.</p>



<a name="426734688"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426734688" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426734688">(Mar 15 2024 at 12:36)</a>:</h4>
<p>Restored cleaning sub-prime in your latest code.</p>
<div class="codehilite"><pre><span></span><code>(&quot;00&quot; + parseInt(latAbs)).slice(-2) + &quot;&amp;#xb0 &quot; +
            (&quot;00&quot; + (latAbs % 1 * 60).toFixed(3)).slice(-6) + &quot;&#39;&quot; +
            ((this.latitude &lt; 0) ° &quot;S &quot; : &quot;N &quot;) +
</code></pre></div>
<p>The ? has been replaced by the degree symbol. Back where we started!!!</p>



<a name="426735488"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426735488" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426735488">(Mar 15 2024 at 12:41)</a>:</h4>
<p>Manually change degree to ?</p>
<div class="codehilite"><pre><span></span><code>55&amp;#xb0 00.000&#39;N 002&amp;#xb0 0.000&#39;W
55&amp;#xb0 12.342&#39;N 002&amp;#xb0 1.021&#39;W
parsePosition lat not a number
</code></pre></div>



<a name="426736533"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426736533" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426736533">(Mar 15 2024 at 12:47)</a>:</h4>
<p>What do you have in the script?  Degree is being escaped but &amp;# is from where?<br>
Try simple print one-liners to make sure you can do say<br>
<code>print("º?\n");</code></p>



<a name="426737391"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426737391" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426737391">(Mar 15 2024 at 12:52)</a>:</h4>
<p>Lines 27 &amp; 30 - the escape should be \xB0 not \B0 if that is hat you have?</p>



<a name="426738479"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426738479" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426738479">(Mar 15 2024 at 12:59)</a>:</h4>
<p>As a script it loaded as:<br>
print("&amp;#xb0°\n");<br>
SyntaxError: source decode failed (line 0)<br>
When copied into window:<br>
rint("º?\n");<br>
SyntaxError: source decode failed (line 0)</p>
<p>In functions.cpp you have:<br>
<code>const wxString degreeText   {"&amp;#xb0"};</code><br>
Will try changing that to "\xBO"</p>



<a name="426739530"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426739530" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426739530">(Mar 15 2024 at 13:04)</a>:</h4>
<p>BBL</p>



<a name="426739565"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426739565" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426739565">(Mar 15 2024 at 13:04)</a>:</h4>
<p>I have removed clean on load as it is clened on run.  But had better restore clean on load for windows sake.<br>
In JavaScriptgui_impl.cpp uncomment line  133</p>



<a name="426748775"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426748775" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426748775">(Mar 15 2024 at 13:55)</a>:</h4>
<p>Compiled the wrong branch of JS. Starting again.</p>



<a name="426748889"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426748889" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426748889">(Mar 15 2024 at 13:56)</a>:</h4>
<p>Lunch</p>



<a name="426754673"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426754673" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426754673">(Mar 15 2024 at 14:28)</a>:</h4>
<p>With 133 commented out I tested the ? symbol.</p>
<div class="codehilite"><pre><span></span><code>00]?

Raw
?
[00]3F

Cleaned
°
[00]B0
</code></pre></div>
<p>With 133 uncommented "°" appears instead of "?".</p>



<a name="426757084"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426757084" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426757084">(Mar 15 2024 at 14:40)</a>:</h4>
<p>Not clear to me,  I think you said it made a differenec but I see none in your bit above?<br>
NB I now clean in the console method in JavaScriotgui_impl.h line 559 so it gets cleaned even if you past in or edit.  So the one at line 133 should be redundant - otherwise cleaning twice.<br>
Must pop out for an hour.</p>



<a name="426767488"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426767488" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426767488">(Mar 15 2024 at 15:28)</a>:</h4>
<p>Back now.  Where are we at?</p>



<a name="426767925"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426767925" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426767925">(Mar 15 2024 at 15:30)</a>:</h4>
<p>cut and paste is giving me problems. Restarting the pc.</p>



<a name="426769388"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426769388" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426769388">(Mar 15 2024 at 15:37)</a>:</h4>
<p>This is what I have when loading Test9:        </p>
<div class="codehilite"><pre><span></span><code>(&quot;00&quot; + parseInt(latAbs)).slice(-2) + &quot;º &quot; +
            (&quot;00&quot; + (latAbs % 1 * 60).toFixed(3)).slice(-6) + &quot;&#39;&quot; +
            ((this.latitude &lt; 0) ? &quot;S &quot; : &quot;N &quot;) +
</code></pre></div>
<p>When I test the ? character all is well but we have the  masculine ordinal:<br>
<a href="/user_uploads/33951/s-wf9JziSCtbS-wj3IDDkMCi/4.jpg">4.jpg</a></p>
<div class="message_inline_image"><a href="/user_uploads/33951/s-wf9JziSCtbS-wj3IDDkMCi/4.jpg" title="4.jpg"><img src="/user_uploads/33951/s-wf9JziSCtbS-wj3IDDkMCi/4.jpg"></a></div>



<a name="426770438"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426770438" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426770438">(Mar 15 2024 at 15:42)</a>:</h4>
<p>When you view it in the script pane, you may see the masculine ordinal but it is cleaned before it gets into the JavaScript engine.<br>
You can confirm that by running the simple script</p>
<div class="codehilite" data-code-language="JavaScript"><pre><span></span><code><span class="nx">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"'°º⁰ primes ‘’‛’′´`º"</span><span class="p">;</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">text</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="nx">print</span><span class="p">(</span><span class="nx">text</span><span class="p">.</span><span class="nx">charAt</span><span class="p">(</span><span class="nx">i</span><span class="p">),</span><span class="w"> </span><span class="s2">"\t"</span><span class="p">,</span><span class="w"> </span><span class="nx">text</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="nx">i</span><span class="p">),</span><span class="w"> </span><span class="s2">"\n"</span><span class="p">);</span>
</code></pre></div>
<p>When I run that I get</p>
<blockquote>
<p>'   39<br>
°   176<br>
°   176<br>
°   176<br>
    32<br>
p   112<br>
r   114<br>
i   105<br>
m   109<br>
e   101<br>
s   115<br>
    32<br>
'   39<br>
'   39<br>
'   39<br>
'   39<br>
'   39<br>
'   39<br>
'   39<br>
°   176</p>
</blockquote>



<a name="426770699"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426770699" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426770699">(Mar 15 2024 at 15:43)</a>:</h4>
<p>My result:<br>
result: undefined</p>



<a name="426772590"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426772590" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426772590">(Mar 15 2024 at 15:53)</a>:</h4>
<p>Warning in my compiler:<br>
<code>'\u2070' cannot be represented in the current code page (1252)</code></p>



<a name="426775148"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426775148" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426775148">(Mar 15 2024 at 16:05)</a>:</h4>
<p>Line 111 in functions.cpp is perhaps the culprit.</p>



<a name="426777731"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426777731" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426777731">(Mar 15 2024 at 16:18)</a>:</h4>
<p>__WXMSW__ is being used to determine the OS. It should be __WINDOWS__.</p>



<a name="426778339"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426778339" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426778339">(Mar 15 2024 at 16:21)</a>:</h4>
<p>__WXMSW__ is for GUI stuff, I think.</p>



<a name="426778964"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426778964" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426778964">(Mar 15 2024 at 16:25)</a>:</h4>
<blockquote>
<p>'\u2070' cannot be represented in the current code page (1252)<br>
This relates to superscript 0 and is only a warning.  However, its possible there is one ib the tests.  I have seen it used in the wild for the degree symbol.  Have to think about how to handle that.  Might it end up getting confused with '?' ?</p>
</blockquote>
<p>Regarding Line 111 in functions.cpp, I had forgottem about that and have been getting strings from the duk stack without going via that.  It only affects Windows and if the script when run has generated "\u00C2\u00b0", which we must have seen sometime in the past.  It does not impact what goes into the engine - only what it delivers out.</p>
<p>Snag is, I get strings off the stack in many places and not always from the top - sometimes further down.  I can, maybe should, generalise it but it will take some hours.</p>
<p>Shall I change __WXMSW__  to _WINDOWS__ throughout?</p>



<a name="426779517"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426779517" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426779517">(Mar 15 2024 at 16:27)</a>:</h4>
<blockquote>
<p>Shall I change __WXMSW__ to _WINDOWS__ throughout?</p>
</blockquote>
<p>No, it only applies to lines 85 - 124.</p>



<a name="426780103"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426780103" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426780103">(Mar 15 2024 at 16:31)</a>:</h4>
<p>When I load Test9 now, from file, the ordinal has been replaced by degree. But when I reopen OpenCPN and it loads from config the ordinal is back.</p>



<a name="426780400"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426780400" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426780400">(Mar 15 2024 at 16:32)</a>:</h4>
<p>And the script fails at line 27. Testing the degree symbol:</p>
<div class="codehilite"><pre><span></span><code>[00]°

Raw
°
[00]B0

Cleaned
°
[00]B0
</code></pre></div>



<a name="426780837"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426780837" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426780837">(Mar 15 2024 at 16:34)</a>:</h4>
<p>Probably because you reactivated line 133.  So if you Load it, it gets a preliminary clean.  But when it gets loaded from file on start-up, it does not.  Either way, it gets cleaned just before compilation now..</p>



<a name="426781206"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426781206" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426781206">(Mar 15 2024 at 16:36)</a>:</h4>
<p>In line 27, do you have º or \xb0 ?</p>



<a name="426781308"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426781308" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426781308">(Mar 15 2024 at 16:37)</a>:</h4>
<p>The degree symbol, not \xb0.</p>



<a name="426781420"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426781420" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426781420">(Mar 15 2024 at 16:37)</a>:</h4>
<p>Try \xb0 please</p>



<a name="426781759"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426781759" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426781759">(Mar 15 2024 at 16:39)</a>:</h4>
<p>I haveone of each in lines 27 &amp; 30 just to keep an eye on them :-)</p>



<a name="426782052"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426782052" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426782052">(Mar 15 2024 at 16:41)</a>:</h4>
<p>Changing all the degrees to \xb0 it gets as far as line 155 in Test9.</p>



<a name="426782084"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426782084" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426782084">(Mar 15 2024 at 16:41)</a>:</h4>
<p>BBL. A cup of tea calls.</p>



<a name="426782396"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426782396" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426782396">(Mar 15 2024 at 16:42)</a>:</h4>
<p>That's when it first executes lines 27 &amp; 30.  What is the error?</p>



<a name="426789475"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426789475" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426789475">(Mar 15 2024 at 17:20)</a>:</h4>
<p>SyntaxError: source decode failed (line 155)</p>



<a name="426789515"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426789515" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426789515">(Mar 15 2024 at 17:20)</a>:</h4>
<p>I have been typing degree as masculine ordinal, so that is what has been in the files I sent you.  But it should not matter as it now gets cleaned to degree \xb0 just before compiling.<br>
So I don't understand why switching in \xb0 makes any difference for you.  If you copy the masculine ordinal (or whatever) out of the script window and paste it into the cleaner in tools, does it get converted to degree \xb0 ?<br>
It is vital that the symbol is converted before compilation.  If you are using the update from me this morning, that should be happening.</p>
<p>I have discovered that if a script is reloaded on start up and automatically run, it was not getting cleaned.  I have fixed that here but I doubt that was your situation.</p>



<a name="426789996"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426789996" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426789996">(Mar 15 2024 at 17:22)</a>:</h4>
<blockquote>
<p>does it get converted to degree \xb0 ?</p>
</blockquote>
<p>Yes it does.</p>
<div class="codehilite"><pre><span></span><code>[00]º

Raw
º
[00]BA

Cleaned
°
[00]B0
</code></pre></div>



<a name="426790247"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426790247" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426790247">(Mar 15 2024 at 17:24)</a>:</h4>
<p>Are you sure you have a call to <code>JScleanString</code> in <code>void doRunCommand(Brief brief){</code> - file JavaScriptgui_impl.h ?</p>



<a name="426790720"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426790720" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426790720">(Mar 15 2024 at 17:26)</a>:</h4>
<blockquote>
<p>Are you sure you have a call to JScleanString</p>
</blockquote>
<p>Yes, confirmed.</p>



<a name="426790826"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426790826" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426790826">(Mar 15 2024 at 17:27)</a>:</h4>
<p>I will renew my source code from your repo and rebuild.</p>



<a name="426792397"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426792397" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426792397">(Mar 15 2024 at 17:36)</a>:</h4>
<p>Please try this script</p>
<div class="codehilite" data-code-language="JavaScript"><pre><span></span><code><span class="nx">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"º"</span><span class="p">;</span>
<span class="nx">print</span><span class="p">(</span><span class="nx">text</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="mf">0</span><span class="p">),</span><span class="w"> </span><span class="s2">"\n"</span><span class="p">);</span>
</code></pre></div>
<p>where the 'degree' is actually the masculine ordinal.  To check that it is getting converted as it appears in your script pane.  It does here.</p>



<a name="426792736"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426792736" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426792736">(Mar 15 2024 at 17:38)</a>:</h4>
<p>SyntaxError: source decode failed (line 0)</p>



<a name="426793094"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426793094" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426793094">(Mar 15 2024 at 17:40)</a>:</h4>
<p>Would a string.replace in Functions.cpp be any good?</p>



<a name="426793369"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426793369" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426793369">(Mar 15 2024 at 17:42)</a>:</h4>
<p>That is what we have at line 92 - yes?<br>
That test works here OK.</p>



<a name="426793511"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426793511" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426793511">(Mar 15 2024 at 17:43)</a>:</h4>
<p>Replacing A_stringDeg but not ordinal.</p>



<a name="426793524"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426793524" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426793524">(Mar 15 2024 at 17:43)</a>:</h4>
<p>and the tools utility calls the same function.</p>



<a name="426793664"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426793664" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426793664">(Mar 15 2024 at 17:44)</a>:</h4>
<p>^^</p>



<a name="426794016"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426794016" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426794016">(Mar 15 2024 at 17:46)</a>:</h4>
<p>That cleaning is only done when preparing output to print.  It is not used at all in script input.</p>



<a name="426794299"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426794299" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426794299">(Mar 15 2024 at 17:48)</a>:</h4>
<p>It is beginning to look like the JavaScript engine cannot handle the degree symbol in source on Windows but can on Mac.</p>



<a name="426794601"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426794601" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426794601">(Mar 15 2024 at 17:50)</a>:</h4>
<p>Do you agree?</p>



<a name="426794833"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426794833" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426794833">(Mar 15 2024 at 17:52)</a>:</h4>
<p>Found this:<br>
<em>grrr... and never mind the fact that my Windows PC decided to use character sets that map degree symbol to \u00f8 instead of \u00b0!</em></p>



<a name="426794977"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426794977" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426794977">(Mar 15 2024 at 17:53)</a>:</h4>
<p><a href="https://stackoverflow.com/questions/4901133/json-and-escaping-characters">https://stackoverflow.com/questions/4901133/json-and-escaping-characters</a></p>



<a name="426795805"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426795805" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426795805">(Mar 15 2024 at 17:58)</a>:</h4>
<p>Got the degree symbol from the Windows character map. Tested in cleaning:</p>
<div class="codehilite"><pre><span></span><code>Raw
°
[00]B0

Cleaned
&amp;#xb0
[00]26 [01]23 [02]78 [03]62 [04]30
</code></pre></div>



<a name="426796462"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426796462" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426796462">(Mar 15 2024 at 18:02)</a>:</h4>
<p>Where does this leave us?<br>
Perhaps we have to go back to my other plan B - using \x07 (bell) internally.<br>
A quick test is straight forward.<br>
In functions.cpp, uncomment line 74 to turn the degre into BELL.<br>
In the test script, replace all degrees or \xb0 with \x07<br>
It should then run but the prited output will lack any degree symbol.  That I can quckily fix.<br>
But I woke up in the night realising there are twenty other places that would need fixing.</p>



<a name="426796768"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426796768" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426796768">(Mar 15 2024 at 18:05)</a>:</h4>
<p>Are - we don't want &amp;#xb0  May be an extra change on the end to \xB0 ?</p>



<a name="426796795"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426796795" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426796795">(Mar 15 2024 at 18:05)</a>:</h4>
<p>Sorry ...  BB tomorrow.</p>



<a name="426802413"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426802413" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426802413">(Mar 15 2024 at 18:42)</a>:</h4>
<p>One of my sons arrives from Leeds this evening with my grandson for a rare visit. I will be rather taken up with this over the weekend. Possibly back Sunday more likely Monday.</p>



<a name="426805742"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426805742" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426805742">(Mar 15 2024 at 19:07)</a>:</h4>
<blockquote>
<p>Cleaned<br>
&amp;#xb0</p>
</blockquote>
<p>Are you sure JScleanString line 95 is commented out?<br>
<code>//     given.Replace(degree, degreeText, true);</code><br>
If not, that would explain the tools cleaning.<br>
(I don't recall why it was created but I commented it out in V3 because I didn't know why it was there.)<br>
But it is present in plugin v2.  So does it have to be in?   Very puzzled.</p>
<p>Can you have a play?  Afraid I cannot do anything here as it is not an issue on Mac.</p>



<a name="426886704"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/426886704" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#426886704">(Mar 16 2024 at 12:17)</a>:</h4>
<p><a href="/user_uploads/33951/cRgiuE9BRTooEsY0TXMq9ZaO/positionComplete.js">positionComplete.js</a></p>
<p>On Run ... Replace the ordinals with circumflex ^ . Replace degree symbol with circumflex.</p>
<p>Removed the ordinal from <code>dmsPattern</code>.</p>
<p>In output change the circumflex back to the degree symbol.</p>
<p>I think the superscore0 replacement was causing the ? to change character.</p>
<p><a href="https:///github.com/Rasbats/JavaScript_pi/tree/v3.0.0-beta">https://github.com/Rasbats/JavaScript_pi/tree/v3.0.0-beta</a></p>



<a name="427169299"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/427169299" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#427169299">(Mar 17 2024 at 17:09)</a>:</h4>
<p>I have pushed some commits to my fork of JS. Some tests failed and I have tried to fix some of these. The commits reference these.</p>



<a name="427173098"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/427173098" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#427173098">(Mar 17 2024 at 17:25)</a>:</h4>
<p>I am back on this.  So, we seem to be agreed that we have to use a substitute character for degree inside the plugin.  I have defined a macro DEGREE for this in version.h and presently have it set to \u0007 (bell) but it can be changed in a single point.<br>
I am keeping the degree in the scripts as it gets cleaned to DEGREE and should be able to keep it in the tests too as it gets cleaned to DEGREE. <br>
In Position I am keeping the degree/ordinal but excaping it as a precaution in case DEGREE is set to something like circumflex.<br>
I will shortly push a version for you to try, please.<br>
I will look at your mods but I think many unnecessary, so suggest you hold off a mo.</p>



<a name="427174946"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/427174946" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#427174946">(Mar 17 2024 at 17:33)</a>:</h4>
<p>The test scripts include a number of deliberate errors to test error handling - as in the comments.<br>
Your edits are fixing them <span aria-label="face with hand over mouth" class="emoji emoji-1f92d" role="img" title="face with hand over mouth">:face_with_hand_over_mouth:</span></p>



<a name="427175164"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/427175164" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#427175164">(Mar 17 2024 at 17:34)</a>:</h4>
<p>Problem was that they caused OpenCPN to crash!</p>



<a name="427175427"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/427175427" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#427175427">(Mar 17 2024 at 17:36)</a>:</h4>
<p>Not here and you have run them previously.  This is an important finding...</p>



<a name="427177092"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/427177092" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#427177092">(Mar 17 2024 at 17:43)</a>:</h4>
<p>Please run this test (documented in the Technical Guide)<br>
<code>JS_throw_test(1,2);</code><br>
If the two arguments are unequal, it returns their sum, which will become the result.</p>
<p>Then, if the two arguments are made equal, it will thrown an error within the plugin C++ code and it should show as an error in the script.  It should not crash OCPN and does not here.</p>



<a name="427179215"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/427179215" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#427179215">(Mar 17 2024 at 17:53)</a>:</h4>
<p>Works as expected. Let's sort the degree symbole first. Tests again later.</p>



<a name="427180048"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/427180048" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#427180048">(Mar 17 2024 at 17:57)</a>:</h4>
<p>Just pushed beta-k and it is building for the beta repository too, so you can install from there.<br>
Here is the test file.<br>
<a href="/user_uploads/33951/BMNeHmKrvAoMRQilVv09iz-G/Test10.js.zip">Test10.js.zip</a><br>
If we go this way, there are several places I am going to have to fix up, like reading from or to file  and messageBox and, worst of all,  onDialogue but I will hold off until we have confirmed the approach.</p>



<a name="427180164"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/427180164" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#427180164">(Mar 17 2024 at 17:57)</a>:</h4>
<p>Supper calls <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span></p>



<a name="427197538"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/427197538" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#427197538">(Mar 17 2024 at 19:18)</a>:</h4>
<p>Test10 works.<br>
But my copy/paste has failed again.</p>



<a name="427199003"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/427199003" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#427199003">(Mar 17 2024 at 19:25)</a>:</h4>
<p>So let's go with this approach.<br>
What failed with copy/paste? I need to fix those APIs for DEGREE substitution</p>



<a name="427202934"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/427202934" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#427202934">(Mar 17 2024 at 19:42)</a>:</h4>
<p>Please do a test in the  tools dump string  with the following data.<br>
<code>?º⁰</code><br>
where the third character is a superscript 0.  I cannot type that but had to use the character viewer to put it in.  It should dump before cleaning as x2070 thus</p>
<blockquote>
<p>00]? [01]º [0002]⁰ </p>
<p>Raw<br>
?º⁰<br>
[00]3F [01]BA [02]2070 </p>
<p>Cleaned<br>
?<br>
[00]3F [01]07 [02]07</p>
</blockquote>



<a name="427376475"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/427376475" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#427376475">(Mar 18 2024 at 07:56)</a>:</h4>
<p>Test10</p>
<div class="codehilite"><pre><span></span><code>55° 00.000&#39;N 002° 0.000&#39;W
55° 12.342&#39;N 002° 1.021&#39;W
A   54° 00.000&#39;N 013° 12.340&#39;W
B   55° 12.000&#39;N 013° 23.450&#39;W
C   56° 30.217&#39;N 013° 44.950&#39;W
result: undefined
</code></pre></div>
<p>?º⁰</p>
<div class="codehilite"><pre><span></span><code>[00]? [01]º [0002]⁰

Raw
?º⁰
[00]3F [01]BA [02]2070

Cleaned
?⁰
[00]3F [01]07 [02]2070
</code></pre></div>



<a name="427377616"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/427377616" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#427377616">(Mar 18 2024 at 08:00)</a>:</h4>
<p>copy/paste is a Windows 10 problem and a restart fixes it at the moment.<br>
Boating today.</p>



<a name="427515712"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/427515712" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#427515712">(Mar 18 2024 at 15:44)</a>:</h4>
<p>version.h now contains</p>
<div class="codehilite"><pre><span></span><code>#define DEGREE        {&quot;\u00B0&quot;}    // real degree character
#ifdef __WINDOWS__
#define PSEUDODEGREE  {&quot;\u0007&quot;}    // substitute character for degree - bell
#else
#define PSEUDODEGREE  DEGREE    // keep it as real degree
#endif
</code></pre></div>
<p>I have now fixed up the twelve areas where I have to go PSEUDODEGREE &lt;-&gt;DEGREE on way in or. out - error messages, messageBox, to and from clipboard, file input and output etc. etc.  Worst was the onDialogue feature. where the dialogue specification and its interpretation has to be fixed up.  Bloody Windows <span aria-label="rage" class="emoji emoji-1f621" role="img" title="rage">:rage:</span> <br>
Still not completely hidden as I explain in this addition to the User Guide</p>
<blockquote>
<p><strong>Note for Windows users about the degree symbol</strong><br>
On Windows, the JavaScript engine cannot handle the degree symbol ° (code \u00B0).<br>
To work around this, the plugin changes all incoming occurrences of ° (including in scripts), to an alternative code (\u0007 - bell) and all out-going occurrences of this alternative back to °.  This is mostly invisible to the user.<br>
However, if you print the actual character code, you will see the substitute. <br>
This will also be the case if you examine the JSON representation of the symbol or match it by character code.</p>
</blockquote>
<p>The string dump you sent me shows that superscript 0 is seen as \x2070 in C++ so it is now cleaned to DEGREE.  Not sure why it was still giving trouble before.  Now it goes directly to DEGREE.  Please test again.</p>
<p>Latest beta-l build inmy beta repo has the updated Position object, so you can test with, say,</p>
<div class="codehilite" data-code-language="JavaScript"><pre><span></span><code><span class="nx">Position</span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s2">"Position"</span><span class="p">);</span>
<span class="nx">print</span><span class="p">(</span><span class="ow">new</span><span class="w"> </span><span class="nx">Position</span><span class="p">(</span><span class="s2">"28.5ºN 3º 12'34E"</span><span class="p">).</span><span class="nx">formatted</span><span class="p">,</span><span class="w"> </span><span class="s2">"\n"</span><span class="p">);</span>
</code></pre></div>
<p>If this all viable, please try the test suite again.  It runs OK for me.</p>



<a name="427538862"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/427538862" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#427538862">(Mar 18 2024 at 17:28)</a>:</h4>
<p>Correction to the above...<br>
Superscript 0 is cleaned to PSEUDODEGREE</p>



<a name="427566747"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/427566747" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#427566747">(Mar 18 2024 at 20:12)</a>:</h4>
<div class="codehilite"><pre><span></span><code>28 30.000&#39;N 003 12.340&#39;E
result: undefined
</code></pre></div>
<p>The BEL is left in the output window.</p>



<a name="427567272"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/427567272" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#427567272">(Mar 18 2024 at 20:16)</a>:</h4>
<p>Test <em>12_runtime_error_main.js</em> causes OpenCPN to crash.</p>



<a name="427568813"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/427568813" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#427568813">(Mar 18 2024 at 20:26)</a>:</h4>
<div class="codehilite"><pre><span></span><code>The BEL is left in the output window.
</code></pre></div>
<p>Screenshot please.</p>
<blockquote>
<p>Test 12_runtime_error_main.js causes OpenCPN to crash.</p>
</blockquote>
<p>Does it crash if you run that script directly, rather than invoking from the main test program?</p>



<a name="427570056"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/427570056" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#427570056">(Mar 18 2024 at 20:33)</a>:</h4>
<p>If it crashes when run directly, please confirm whether</p>
<div class="codehilite" data-code-language="JavaScript"><pre><span></span><code><span class="nx">JS_throw_test</span><span class="p">(</span><span class="mf">2</span><span class="p">,</span><span class="mf">2</span><span class="p">);</span>
</code></pre></div>
<p>throws an error within the plugin correctly, while</p>
<div class="codehilite" data-code-language="JavaScript"><pre><span></span><code><span class="nx">onSeconds</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="nx">doit</span><span class="p">);</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">doit</span><span class="p">(){</span>
<span class="w">    </span><span class="nx">print</span><span class="p">(</span><span class="s2">"Hello"</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
</code></pre></div>
<p>crashes OCPN.</p>



<a name="427570845"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/427570845" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#427570845">(Mar 18 2024 at 20:38)</a>:</h4>
<p><a href="/user_uploads/33951/KwSKhZII_ex5hFfauDA96v38/5.jpg">5.jpg</a></p>
<div class="message_inline_image"><a href="/user_uploads/33951/KwSKhZII_ex5hFfauDA96v38/5.jpg" title="5.jpg"><img src="/user_uploads/33951/KwSKhZII_ex5hFfauDA96v38/5.jpg"></a></div><p>Test 12 crashes when run directly as well as when invoked from main.</p>
<p><code>JS_throw_test(2,2);</code> works correctly.</p>
<div class="codehilite"><pre><span></span><code>onSeconds(1, doit);
function doit(){
    print(&quot;Hello&quot;);
    }
</code></pre></div>
<p>crashes directly.</p>



<a name="427572897"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/427572897" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#427572897">(Mar 18 2024 at 20:53)</a>:</h4>
<p>Back tomorrow</p>



<a name="427628423"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/427628423" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#427628423">(Mar 19 2024 at 06:35)</a>:</h4>
<p>Please run this script:</p>
<div class="codehilite" data-code-language="JavaScript"><pre><span></span><code><span class="nx">Position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s2">"Position"</span><span class="p">);</span>
<span class="nx">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Position</span><span class="p">(</span><span class="s2">"28.5ºN 3º 12'34E"</span><span class="p">).</span><span class="nx">formatted</span><span class="p">,</span><span class="w"> </span><span class="s2">"\n"</span><span class="p">;</span>
<span class="nx">messageBox</span><span class="p">(</span><span class="nx">text</span><span class="p">);</span>
<span class="nx">alert</span><span class="p">(</span><span class="nx">text</span><span class="p">);</span>
<span class="nx">toClipboard</span><span class="p">(</span><span class="nx">text</span><span class="p">);</span>
</code></pre></div>
<p>and advise whether the degree symbol is correct in the dialogue, alert and on the clipboard.</p>



<a name="427628695"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/427628695" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#427628695">(Mar 19 2024 at 06:38)</a>:</h4>
<p>Re the crash, the timer function has been completely re-implemented in v3.m. That error is now thrown within a console method.  On reflection, that is rather chancing it but it works here on MacOS.  I need to restructure to avoid.</p>



<a name="427654419"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/427654419" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#427654419">(Mar 19 2024 at 09:51)</a>:</h4>
<p><a href="/user_uploads/33951/5OUuoi3-FeDF96VsP1-p_xsi/6.jpg">6.jpg</a><br>
<a href="/user_uploads/33951/ubGj4tHYq7jwugEIGvoOUmMg/7.jpg">7.jpg</a></p>
<div class="message_inline_image"><a href="/user_uploads/33951/5OUuoi3-FeDF96VsP1-p_xsi/6.jpg" title="6.jpg"><img src="/user_uploads/33951/5OUuoi3-FeDF96VsP1-p_xsi/6.jpg"></a></div><div class="message_inline_image"><a href="/user_uploads/33951/ubGj4tHYq7jwugEIGvoOUmMg/7.jpg" title="7.jpg"><img src="/user_uploads/33951/ubGj4tHYq7jwugEIGvoOUmMg/7.jpg"></a></div><p>And the clipboard:<br>
<code>28 30.000'N 003 12.340'E</code> <br>
The bell symbol appears. Has the output been cleaned?</p>



<a name="427781630"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/427781630" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#427781630">(Mar 19 2024 at 17:54)</a>:</h4>
<p>New timer mechanism now moved out of console mothod.  Long battle with getting timers to reliably go away on script termination  <span aria-label="face with spiral eyes" class="emoji emoji-1f635-200d-1f4ab" role="img" title="face with spiral eyes">:face_with_spiral_eyes:</span> </p>
<p>Beta m now in my repository.</p>
<p>Please check it throws an error safely with</p>
<div class="codehilite" data-code-language="JavaScript"><pre><span></span><code><span class="nx">onSeconds</span><span class="p">(</span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="nx">func</span><span class="p">);</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">func</span><span class="p">(){</span>
<span class="w">    </span><span class="nx">print</span><span class="p">(</span><span class="s2">"Should not get here\n"</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
</code></pre></div>
<p>Also please run the timer tests.</p>
<p><code>OCPNonNMEA0183()</code> &amp; <code>OCPNonNMEA2000()</code> will have the same problem as onSeconds had.  I will rework them once you have confirmed the new onSeconds tests are OK.</p>



<a name="427782610"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/427782610" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#427782610">(Mar 19 2024 at 17:59)</a>:</h4>
<p><strong>The degree problem</strong><br>
A mystery.  Yes I am uncleaning.  I did a test forcing it to use \x0007 here on MacOS and all output was correct.<br>
Please try this script to see what code is being produced at the end.  I am showing the formatted text in an alert as it is simpler.</p>
<div class="codehilite" data-code-language="JavaScript"><pre><span></span><code><span class="nx">Position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s2">"Position"</span><span class="p">);</span>
<span class="nx">pos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Position</span><span class="p">(</span><span class="mf">55</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">2</span><span class="p">);</span>
<span class="nx">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">pos</span><span class="p">.</span><span class="nx">formatted</span><span class="p">;</span>
<span class="nx">print</span><span class="p">(</span><span class="nx">text</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="mf">2</span><span class="p">),</span><span class="w"> </span><span class="s2">"\n"</span><span class="p">);</span>
<span class="nx">alert</span><span class="p">(</span><span class="nx">pos</span><span class="p">.</span><span class="nx">formatted</span><span class="p">,</span><span class="w"> </span><span class="s2">"\n"</span><span class="p">);</span>
</code></pre></div>
<p>When I run this with the fiddle to make it use \x0007, it prints <strong>7</strong></p>



<a name="427783988"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/427783988" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#427783988">(Mar 19 2024 at 18:07)</a>:</h4>
<div class="codehilite"><pre><span></span><code>onSeconds(2, func);
function func(){
    print(&quot;Should not get here\n&quot;);
    }
</code></pre></div>
<p>Causes a crash.</p>
<div class="codehilite"><pre><span></span><code>Position = require(&quot;Position&quot;);
pos = new Position(55, -2);
text = pos.formatted;
print(text.charCodeAt(2), &quot;\n&quot;);
alert(pos.formatted, &quot;\n&quot;);
</code></pre></div>
<p>Prints 7 in output. The alert has a square character.<br>
<a href="/user_uploads/33951/q7UZGzTnD1A-rjVSPSjKXZ2k/8.jpg">8.jpg</a></p>
<div class="message_inline_image"><a href="/user_uploads/33951/q7UZGzTnD1A-rjVSPSjKXZ2k/8.jpg" title="8.jpg"><img src="/user_uploads/33951/q7UZGzTnD1A-rjVSPSjKXZ2k/8.jpg"></a></div>



<a name="427868234"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/427868234" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#427868234">(Mar 20 2024 at 07:35)</a>:</h4>
<p>I have to use a rare dry day to tackle the sliding back door - which is exposed to the sea.</p>
<p>I am sorry to give you work but I see no alternative but to ask you to dig in a bit as I cannot reproduce here.</p>
<p><strong>Degree character problem</strong></p>
<p>Is Windows failing because of an issue with the bell charcater?<br>
In version.h line 35, try setting PSEUDODEGREE to something printable such as {"\u005E"} (^)</p>
<p><strong>Crash when throwing error </strong></p>
<p>JS_throw_test does not use the <code>throw_error </code>method.</p>
<p>I suspect if you run this single line script, you will get the crash<br>
<code>messageBox("One", 2, 3, 4);</code><br>
Turn on tracing level 4.  In trace.h set TRACE_YES to <code>true</code><br>
and both TRACE_MAX and TRACE_MIN to 4.<br>
Trouble is, you lose the trace when it crashes and even if you direct the trace to the log file, it does not get into there when it crashes so soon after - I think.<br>
So we have to experiment.</p>
<p>In JavaScriptgui_imp.h you have line 771 as<br>
<code>void wrapUp(Completions reason) {    // clean down and maybe destroy ctx</code><br>
Insert <code>return;</code> immediately after that so it does nothing.</p>
<p>If it does not crash, move the return to the beginning of <code>wrapUpWorks</code> just below the above.</p>
<p>NB Both these will leave the duktape stack unreleased, so you will have a big memory leak.  So avoid running too many times without restarting OCPN.</p>
<p>I will try and check back at intervals.</p>



<a name="427890725"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/427890725" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#427890725">(Mar 20 2024 at 10:05)</a>:</h4>
<blockquote>
<p>Is Windows failing because of an issue with the bell charcater?</p>
</blockquote>
<p>No, I added this to <code>JScleanOutput</code>:<br>
<code>given.Replace(PSEUDODEGREE, DEGREE, true);</code> <br>
and the alert was correct.</p>
<p><a href="/user_uploads/33951/bNq3Ej3g8XhsCRhd21BqXF8G/9.jpg">9.jpg</a></p>
<div class="message_inline_image"><a href="/user_uploads/33951/bNq3Ej3g8XhsCRhd21BqXF8G/9.jpg" title="9.jpg"><img src="/user_uploads/33951/bNq3Ej3g8XhsCRhd21BqXF8G/9.jpg"></a></div>



<a name="427905552"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/427905552" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#427905552">(Mar 20 2024 at 11:23)</a>:</h4>
<p><em>JSExtensions.cpp</em> Line 527. Compile error mpTimersVector undeclared. I am going to comment out this TRACE at the moment.</p>



<a name="427905966"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/427905966" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#427905966">(Mar 20 2024 at 11:26)</a>:</h4>
<p>Probably needs pConsole-&gt;mpTimersVector since I moved it out of the method.</p>



<a name="427906476"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/427906476" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#427906476">(Mar 20 2024 at 11:29)</a>:</h4>
<blockquote>
<p>Probably needs pConsole-&gt;mpTimersVector since I moved it out of the method.</p>
</blockquote>
<p>That fixes it.</p>



<a name="427907799"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/427907799" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#427907799">(Mar 20 2024 at 11:38)</a>:</h4>
<p>Placing return; did not work.<br>
In ThrowError() commenting out:</p>
<div class="codehilite"><pre><span></span><code>if (!duk_is_error(ctx, -1)){
            // we do not have an error object on the stack
            duk_push_error_object(ctx, DUK_ERR_ERROR, _(&quot;Console &quot;) + mConsoleName + _(&quot; - &quot;) + message);  // convert message to error object
            }
</code></pre></div>
<p>Stopped the crash. Not sure where to go from here.</p>



<a name="427922529"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/427922529" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#427922529">(Mar 20 2024 at 13:03)</a>:</h4>
<blockquote>
<p>No, I added this to JScleanOutput:<br>
given.Replace(PSEUDODEGREE, DEGREE, true);<br>
and the alert was correct.</p>
</blockquote>
<p>Already had that in my latest push to GitHub</p>
<div class="codehilite" data-code-language="JavaScript"><pre><span></span><code><span class="nx">wxString</span><span class="w"> </span><span class="nx">js_formOutput</span><span class="p">(</span><span class="nx">duk_context</span><span class="w"> </span><span class="o">*</span><span class="nx">ctx</span><span class="p">){</span>
<span class="w">    </span><span class="nx">duk_idx_t</span><span class="w"> </span><span class="nx">nargs</span><span class="p">;</span><span class="w">  </span><span class="c1">// number of args in call</span>
<span class="w">    </span><span class="nx">wxString</span><span class="w"> </span><span class="nx">output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">wxEmptyString</span><span class="p">;</span>

<span class="w">    </span><span class="nx">nargs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">duk_get_top</span><span class="p">(</span><span class="nx">ctx</span><span class="p">);</span>
<span class="c1">//   MAYBE_DUK_DUMP</span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kr">int</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">&lt;</span><span class="nx">nargs</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">){</span>
<span class="w">        </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="nx">duk_int_t</span><span class="w"> </span><span class="nx">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">duk_get_type</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span><span class="w"> </span><span class="nx">i</span><span class="p">)){</span>
<span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="nx">DUK_TYPE_STRING</span><span class="o">:</span>
<span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="nx">DUK_TYPE_NUMBER</span><span class="o">:</span>
<span class="w">                </span><span class="nx">output</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="nx">duk_to_string</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span><span class="nx">i</span><span class="p">);</span><span class="w">  </span><span class="c1">// mangles º character on Windows!</span>
<span class="w">                </span><span class="k">break</span><span class="p">;</span>
<span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="nx">DUK_TYPE_BOOLEAN</span><span class="o">:</span>
<span class="w">                </span><span class="nx">output</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">((</span><span class="nx">duk_to_boolean</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span><span class="nx">i</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mf">1</span><span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s2">"true"</span><span class="o">:</span><span class="s2">"false"</span><span class="p">);</span>
<span class="w">                </span><span class="k">break</span><span class="p">;</span>
<span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="nx">DUK_TYPE_OBJECT</span><span class="o">:</span>
<span class="w">                </span><span class="nx">duk_json_encode</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span><span class="w"> </span><span class="nx">i</span><span class="p">);</span>
<span class="w">                </span><span class="nx">output</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="nx">duk_to_string</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span><span class="nx">i</span><span class="p">);</span>
<span class="w">                </span><span class="k">break</span><span class="p">;</span>
<span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="nx">DUK_TYPE_NULL</span><span class="o">:</span>
<span class="w">                </span><span class="k">break</span><span class="p">;</span>
<span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="nx">DUK_TYPE_UNDEFINED</span><span class="o">:</span>
<span class="w">                </span><span class="nx">findConsoleByCtx</span><span class="p">(</span><span class="nx">ctx</span><span class="p">)</span><span class="o">-&gt;</span><span class="nx">throw_error</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span><span class="w"> </span><span class="s2">"output - arg "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">to_string</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">" is undefined"</span><span class="p">);</span>
<span class="w">            </span><span class="k">default</span><span class="o">:</span>
<span class="w">                </span><span class="nx">findConsoleByCtx</span><span class="p">(</span><span class="nx">ctx</span><span class="p">)</span><span class="o">-&gt;</span><span class="nx">throw_error</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span><span class="w"> </span><span class="s2">"output - arg "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">to_string</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">" of unexpected type "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">to_string</span><span class="p">(</span><span class="nx">type</span><span class="p">));</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="nx">output</span><span class="p">.</span><span class="nx">Replace</span><span class="p">(</span><span class="nx">PSEUDODEGREE</span><span class="p">,</span><span class="w"> </span><span class="nx">DEGREE</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span><span class="w"> </span><span class="c1">// internally, we are using DEGREE to represent degree - convert any back</span>
<span class="err">#</span><span class="nx">ifdef</span><span class="w"> </span><span class="nx">__WXMSW__</span>
<span class="w">    </span><span class="nx">wxString</span><span class="w"> </span><span class="nx">JScleanOutput</span><span class="p">(</span><span class="nx">wxString</span><span class="w"> </span><span class="nx">given</span><span class="p">);</span>
<span class="w">    </span><span class="nx">output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">JScleanOutput</span><span class="p">(</span><span class="nx">output</span><span class="p">);</span><span class="w"> </span><span class="c1">// clean for Windows only</span>
<span class="err">#</span><span class="nx">endif</span>
<span class="w">    </span><span class="k">return</span><span class="p">(</span><span class="nx">output</span><span class="p">);</span>
</code></pre></div>
<p>Note I have it outside the Windows bit. so it is executed on all platforms.  This so that any platform can change the PSEUDODEGREE character.  I alsonow  have this all over the place and not only when stuff is going throughg js_formOutput.<br>
I cannot rceall why we have the JScleanOutput for Windows.  It may not be necessary now we have other things sorted.  Can we get rid of it?</p>



<a name="427923665"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/427923665" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#427923665">(Mar 20 2024 at 13:08)</a>:</h4>
<blockquote>
<p>I cannot rceall why we have the JScleanOutput for Windows. It may not be necessary now we have other things sorted. Can we get rid of it?</p>
</blockquote>
<p>Without this I have a rogue symbol in the alert box. In the console output it is not needed.</p>
<p>Boat things early this afternoon.</p>



<a name="427924237"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/427924237" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#427924237">(Mar 20 2024 at 13:11)</a>:</h4>
<blockquote>
<p>In ThrowError() commenting out:<br>
if (!duk_is_error(ctx, -1)){<br>
            // we do not have an error object on the stack<br>
            duk_push_error_object(ctx, DUK_ERR_ERROR, _("Console ") + mConsoleName + _(" - ") + message);  // convert message to error object<br>
            }</p>
</blockquote>
<p>Please insert just before the commented out <code>if (!duk_is_error(ctx, -1)){</code> insert</p>
<div class="codehilite"><pre><span></span><code>TRACE(4, pConsole-&gt;dukDump( ));
</code></pre></div>
<p>as per the technical guide p14 <em>Obtaining dumps from with code</em><br>
Then get the error to throw and let me have that bit of the trace.  I should be able to see what is on the Duktape stack.</p>



<a name="427928968"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/427928968" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#427928968">(Mar 20 2024 at 13:35)</a>:</h4>
<p>With the <code>if(!duk_is_err()</code>bit commented out, what error message if any is shown in the output pane?</p>



<a name="427958724"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/427958724" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#427958724">(Mar 20 2024 at 15:41)</a>:</h4>
<div class="codehilite"><pre><span></span><code>L4  setConsoleMinClientSize text JavaScript, size X:52 Y: 15
L4  Constructed console JavaScript size x 1066 y 949  minSize x 134 y 39
L0  ------------------ Console JavaScript about to run
L4  JavaScript-&gt;throw_error() messageBox called with invalid number of args
L4  Duktape context dump:
ctx: top=4, stack=[&quot;One&quot;,2,3,4]

L4  JavaScript-&gt;afterwards() with dukOutcome 1 and status now (no status)
L4  JavaScript-&gt;run() completed with outcome 0
L4  JavaScript-&gt;wrapUpWorks() with status 0 and now HAD_ERROR
Duktape context dump:
ctx: top=1, stack=[4]

L4  No brief

L4  wrapUpWorks with error stack:Duktape context dump:
ctx: top=1, stack=[4]

L4  JavaScript-&gt;clearDialog()  (None)
L4  JavaScript-&gt;clearAlert()  (None)
L0  ------------------ Console JavaScript wrapped up
</code></pre></div>
<blockquote>
<p>With the if(!duk_is_err()bit commented out, what error message if any is shown in the output pane?</p>
</blockquote>
<p>Just "4".</p>



<a name="427963567"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/427963567" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#427963567">(Mar 20 2024 at 16:03)</a>:</h4>
<p>Question:  when that section is not commented out, if there is, say, a compile error, does it show the appropriate error message or crash OCPN?  I think it likely shows error OK as you have been reporting the problems with degree in a script.<br>
Please let me have the trace/dump for a compile error.</p>



<a name="427965692"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/427965692" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#427965692">(Mar 20 2024 at 16:12)</a>:</h4>
<p>A crash obviously.<br>
Windows debug:<br>
<code>Unhandled exception at 0x77236D13 (ntdll.dll) in opencpn.exe: 0xC0000374: A heap has been corrupted (parameters: 0x77273960).</code></p>
<p>In trace window only this (frozen):</p>
<div class="codehilite"><pre><span></span><code>L4  setConsoleMinClientSize text JavaScript, size X:52 Y: 15
L4  Constructed console JavaScript size x 1066 y 949  minSize x 134 y 39
L0  ------------------ Console JavaScript about to run
L4  JavaScript-&gt;throw_error() messageBox called with invalid number of args
L4  Duktape context dump:
ctx: top=4, stack=[&quot;One&quot;,2,3,4]
</code></pre></div>



<a name="427966363"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/427966363" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#427966363">(Mar 20 2024 at 16:15)</a>:</h4>
<p>Please cause a compiler error - invalid JavaScript.  Say just run<br>
a = b;<br>
(b is undefined and compile will throw an error)</p>



<a name="427966925"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/427966925" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#427966925">(Mar 20 2024 at 16:17)</a>:</h4>
<div class="codehilite"><pre><span></span><code>Tracing levels 4 - 4
ReferenceError: identifier &#39;b&#39; undefined
</code></pre></div>



<a name="427985110"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/427985110" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#427985110">(Mar 20 2024 at 17:47)</a>:</h4>
<p>Sorry ... should have included this. No crash.</p>
<div class="codehilite"><pre><span></span><code>L4  setConsoleMinClientSize text JavaScript, size X:52 Y: 15
L4  Constructed console JavaScript size x 1066 y 949  minSize x 134 y 39
L0  ------------------ Console JavaScript about to run
L4  JavaScript-&gt;afterwards() with dukOutcome 1 and status now (no status)
L4  JavaScript-&gt;run() completed with outcome 0
L4  JavaScript-&gt;wrapUpWorks() with status 0 and now HAD_ERROR
Duktape context dump:
ctx: top=1, stack=[{}]

L4  No brief

L4  wrapUpWorks with error stack:Duktape context dump:
ctx: top=1, stack=[{}]

L4  Call stack: ReferenceError: identifier &#39;b&#39; undefined
    at [anon] (duk_js_var.c:1239) internal
    at eval (eval:1) preventsyield
L4  JavaScript-&gt;clearDialog()  (None)
L4  JavaScript-&gt;clearAlert()  (None)
L0  ------------------ Console JavaScript wrapped up
</code></pre></div>



<a name="428068042"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/428068042" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#428068042">(Mar 21 2024 at 07:11)</a>:</h4>
<p>With a compiler generated error (and no crash) the stack only has the error object on it.<br>
With my calls, the stack still has the remains of the API  arguments on it.<br>
So, let's clear those off before putting our error object onto it.</p>
<p>Here is the revised throw_error</p>
<div class="codehilite" data-code-language="JavaScript"><pre><span></span><code><span class="w">    </span><span class="ow">void</span><span class="w"> </span><span class="nx">throw_error</span><span class="p">(</span><span class="nx">duk_context</span><span class="w"> </span><span class="o">*</span><span class="nx">ctx</span><span class="p">,</span><span class="w"> </span><span class="nx">wxString</span><span class="w"> </span><span class="nx">message</span><span class="p">){</span>
<span class="w">        </span><span class="c1">// throw an error from within c++ code called from running script</span>
<span class="w">        </span><span class="c1">// either there is an error object on the stack or a message</span>
<span class="w">        </span><span class="c1">// ! do not call otherwise</span>
<span class="w">        </span><span class="nx">message</span><span class="p">.</span><span class="nx">Replace</span><span class="p">(</span><span class="nx">PSEUDODEGREE</span><span class="p">,</span><span class="w"> </span><span class="nx">DEGREE</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span><span class="w">    </span><span class="c1">// internally, we are using DEGREE to represent degree - convert any back</span>
<span class="w">        </span><span class="nx">TRACE</span><span class="p">(</span><span class="mf">4</span><span class="p">,</span><span class="w"> </span><span class="nx">mConsoleName</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">"-&gt;throw_error() "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">message</span><span class="p">);</span>
<span class="w">        </span><span class="nx">m_result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">wxEmptyString</span><span class="p">;</span><span class="w">    </span><span class="c1">// supress result</span>
<span class="w">        </span><span class="nx">m_explicitResult</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span><span class="w">    </span><span class="c1">// supress result</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">duk_is_error</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">1</span><span class="p">)){</span>
<span class="w">            </span><span class="c1">// we do not have an error object on the stack</span>
<span class="w">            </span><span class="kr">int</span><span class="w"> </span><span class="nx">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">duk_get_top</span><span class="p">(</span><span class="nx">ctx</span><span class="p">);</span><span class="w">  </span><span class="c1">// number of items on stack</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">n</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="nx">duk_pop_n</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span><span class="w"> </span><span class="nx">n</span><span class="p">);</span><span class="w">   </span><span class="c1">// clear stack</span>
<span class="w">            </span><span class="nx">duk_push_error_object</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span><span class="w"> </span><span class="nx">DUK_ERR_ERROR</span><span class="p">,</span><span class="w"> </span><span class="nx">_</span><span class="p">(</span><span class="s2">"Console "</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">mConsoleName</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">_</span><span class="p">(</span><span class="s2">" - "</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">message</span><span class="p">);</span><span class="w">  </span><span class="c1">// convert message to error object</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="nx">m_hadError</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="w">        </span><span class="nx">mRunningMain</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">        </span><span class="nx">duk_throw</span><span class="p">(</span><span class="nx">ctx</span><span class="p">);</span><span class="w">   </span><span class="c1">// we don't come back from this</span>
<span class="w">        </span><span class="p">}</span>
</code></pre></div>



<a name="428069908"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/428069908" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#428069908">(Mar 21 2024 at 07:30)</a>:</h4>
<p>About to crash but I used Visual Studio debug. This was the result in the TRACE:</p>
<div class="codehilite"><pre><span></span><code>L4  setConsoleMinClientSize text JavaScript, size X:52 Y: 15
L4  Constructed console JavaScript size x 1066 y 949  minSize x 134 y 39
L0  ------------------ Console JavaScript about to run
L4  JavaScript-&gt;throw_error() messageBox called with invalid number of args
L4  JavaScript-&gt;afterwards() with dukOutcome 1 and status now (no status)
L4  JavaScript-&gt;run() completed with outcome 0
L4  JavaScript-&gt;wrapUpWorks() with status 0 and now HAD_ERROR
Duktape context dump:
ctx: top=1, stack=[{}]

L4  No brief

L4  wrapUpWorks with error stack:Duktape context dump:
ctx: top=1, stack=[{}]

L4  Call stack: Error: Console JavaScript - messageBox called with invalid number of args
    at [anon] (D:\Documents\Github\JavaScript_pi\src\JavaScriptgui_impl.h:1102) internal
    at [anon] () native strict preventsyield
    at eval (eval:1) preventsyield
L4  wholeLine:    at eval (eval:1
L4  JavaScript-&gt;clearDialog()  (None)
L4  JavaScript-&gt;clearAlert()  (None)
L0  ------------------ Console JavaScript wrapped up
</code></pre></div>



<a name="428070117"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/428070117" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#428070117">(Mar 21 2024 at 07:31)</a>:</h4>
<p><a href="/user_uploads/33951/QcSX9ADClOJEOvhSSnRsoCWn/10.jpg">10.jpg</a></p>
<div class="message_inline_image"><a href="/user_uploads/33951/QcSX9ADClOJEOvhSSnRsoCWn/10.jpg" title="10.jpg"><img src="/user_uploads/33951/QcSX9ADClOJEOvhSSnRsoCWn/10.jpg"></a></div>



<a name="428070671"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/428070671" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#428070671">(Mar 21 2024 at 07:37)</a>:</h4>
<p><a href="/user_uploads/33951/uuviDibatOBoTiBT3ufQ-Pu1/11.jpg">11.jpg</a></p>
<div class="message_inline_image"><a href="/user_uploads/33951/uuviDibatOBoTiBT3ufQ-Pu1/11.jpg" title="11.jpg"><img src="/user_uploads/33951/uuviDibatOBoTiBT3ufQ-Pu1/11.jpg"></a></div>



<a name="428071247"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/428071247" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#428071247">(Mar 21 2024 at 07:42)</a>:</h4>
<p>If ctx is empty does <code>duk_throw(ctx)</code> work?</p>



<a name="428071391"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/428071391" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#428071391">(Mar 21 2024 at 07:43)</a>:</h4>
<p>Boating today.</p>



<a name="428071405"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/428071405" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#428071405">(Mar 21 2024 at 07:43)</a>:</h4>
<blockquote>
<p>If ctx is empty does duk_throw(ctx) work?<br>
No - but the throw is before ctx is destroyed - or should be - but hang on - edit coming...</p>
</blockquote>



<a name="428076071"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/428076071" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#428076071">(Mar 21 2024 at 08:18)</a>:</h4>
<p>Please replace  wrapup (from line 771 in JavaScriptgui_imp.h) with this:</p>
<div class="codehilite" data-code-language="JavaScript"><pre><span></span><code><span class="w">    </span><span class="ow">void</span><span class="w"> </span><span class="nx">wrapUp</span><span class="p">(</span><span class="nx">Completions</span><span class="w"> </span><span class="nx">reason</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">    </span><span class="c1">// clean down and maybe destroy ctx</span>
<span class="w">        </span><span class="nx">wrapUpWorks</span><span class="p">(</span><span class="nx">reason</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">isBusy</span><span class="p">()){</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">mpCtx</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nx">nullptr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// for safety - nasty consequences if no context</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">reason</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nx">DONE</span><span class="p">){</span><span class="w">    </span><span class="c1">// save the enduring variable</span>
<span class="w">                    </span><span class="nx">TRACE</span><span class="p">(</span><span class="mf">4</span><span class="p">,</span><span class="w"> </span><span class="nx">mConsoleName</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">"-&gt;wrapUp() will save _remember"</span><span class="p">);</span>
<span class="w">                    </span><span class="nx">duk_push_global_object</span><span class="p">(</span><span class="nx">mpCtx</span><span class="p">);</span>
<span class="w">                    </span><span class="kr">int</span><span class="w"> </span><span class="nx">OK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">duk_get_prop_literal</span><span class="p">(</span><span class="nx">mpCtx</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="s2">"_remember"</span><span class="p">);</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">OK</span><span class="p">)</span><span class="w"> </span><span class="nx">m_remembered</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">duk_json_encode</span><span class="p">(</span><span class="nx">mpCtx</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">1</span><span class="p">);</span>
<span class="w">                    </span><span class="k">else</span><span class="w"> </span><span class="nx">m_remembered</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"{}"</span><span class="p">;</span><span class="w">   </span><span class="c1">// play safe - if no -remember set as undefined</span>
<span class="w">                    </span><span class="nx">duk_pop</span><span class="p">(</span><span class="nx">mpCtx</span><span class="p">);</span>
<span class="w">                    </span><span class="p">}</span>
<span class="w">                </span><span class="nx">TRACE</span><span class="p">(</span><span class="mf">4</span><span class="p">,</span><span class="w"> </span><span class="nx">mConsoleName</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">"-&gt;wrapUp() destroying ctx"</span><span class="p">);</span>
<span class="w">                </span><span class="nx">duk_destroy_heap</span><span class="p">(</span><span class="nx">mpCtx</span><span class="p">);</span>
<span class="w">                </span><span class="nx">mpCtx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">nullptr</span><span class="p">;</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="nx">TRACE</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="s2">"------------------ Console "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">mConsoleName</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">" wrapped up"</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
</code></pre></div>



<a name="428081975"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/428081975" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#428081975">(Mar 21 2024 at 08:59)</a>:</h4>
<p>Sorry ... same error at <code>duk_throw(ctx)</code>.  Back tonight.</p>



<a name="428082053"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/428082053" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#428082053">(Mar 21 2024 at 08:59)</a>:</h4>
<p>p.s. my line numbers differ a little because of auto formatting.</p>



<a name="428192890"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/428192890" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#428192890">(Mar 21 2024 at 18:31)</a>:</h4>
<p>Mike - hope you had a good day at the boat.<br>
Please work with beta n just pushed to GitHub at 18:28 but not built remotely.</p>
<p>JS_throw_test extended such that<br>
JS_throw_test(1, 1)<br>
 throws error by pushing error object to stack and throwing</p>



<a name="428195843"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/428195843" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#428195843">(Mar 21 2024 at 18:49)</a>:</h4>
<p>Above sent too soon and I cannot edit it any more - please ignore that.</p>
<p>Mike - hope you had a good day at the boat.<br>
Please work with beta n just pushed to GitHub at 18:28 but not built remotely.  It has TRACE level 4.</p>
<p>JS_throw_test extended such that<br>
<code>JS_throw_test(1, 1) // both arguments equal</code><br>
 throws error by pushing error object to stack and throwing.  Works correctly?<br>
<code>JS_throw_test(0,0 ) // both arguments zero</code><br>
invokes throw_error method.  Crashes Windows?<br>
The trace from the two looks identical apart from the extra trace statement within throw_ error apart from the following:<br>
The error objects pushed to the stack are slightly different DUK_ERR_TYPE_ERROR and DUK_ERR_ERROR.  These types are <a href="https://duktape.org/api#defines.5">explained here</a>.  The one that works has DUK_ERR_TYPE_ERROR whereas the one that fails is DUK_ERR_ERROR.  I have not harmonised them because DUK_ERR_ERROR seems more appropriate but is the one used in the failing version.<br>
Another difference was setting <code>m_hadError = true;</code> but that did not do anything and I have now commented it out.  Also  <code>mRunningMain = false;</code> but that is only relevant when there are call-backs, which is not the case in these tests.</p>
<p>Other straws to grasp at:</p>
<ol>
<li>Does running the crashing script in a virgin console that has never run anything before behave differently?</li>
<li>Might be worth checking whether the crash occurs with the plugin v2.  We could have overlooked it.</li>
</ol>
<p>Sorry to land you with all this work but I am unable to pursue myself.</p>



<a name="428200080"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/428200080" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#428200080">(Mar 21 2024 at 19:18)</a>:</h4>
<p><code>JS_throw_test(1, 1)</code></p>
<div class="codehilite"><pre><span></span><code>L4  setConsoleMinClientSize text JavaScript, size X:52 Y: 15
L4  Constructed console JavaScript size x 1066 y 949  minSize x 134 y 39
L0  ------------------ Console JavaScript about to run
L4  JavaScript-&gt;afterwards() with dukOutcome 1 and status now (no status)
L4  JavaScript-&gt;run() completed with outcome 0
L4  JavaScript-&gt;wrapUpWorks() with status 0 and now HAD_ERROR
Duktape context dump:
ctx: top=1, stack=[{}]

L4  No brief

L4  wrapUpWorks with error stack:Duktape context dump:
ctx: top=1, stack=[{}]

L4  Call stack: TypeError: the arguments match - duk_throw
    at [anon] (D:\Documents\Github\JavaScript_pi\src\JSExtensions.cpp:1011) internal
    at [anon] () native strict preventsyield
    at eval (eval:1) preventsyield
L4  wholeLine:    at eval (eval:1
L4  JavaScript-&gt;clearDialog()  (None)
L4  JavaScript-&gt;clearAlert()  (None)
L4  JavaScript-&gt;wrapUp() destroying ctx
L0  ------------------ Console JavaScript wrapped up
</code></pre></div>
<p><code>line 1 TypeError: the arguments match - duk_throw</code></p>



<a name="428201430"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/428201430" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#428201430">(Mar 21 2024 at 19:26)</a>:</h4>
<p>JS_throw_test(0, 0)<br>
Crash</p>
<div class="codehilite"><pre><span></span><code>L4  setConsoleMinClientSize text JavaScript, size X:52 Y: 15
L4  Constructed console JavaScript size x 1066 y 949  minSize x 134 y 39
L0  ------------------ Console JavaScript about to run
L4  JavaScript-&gt;throw_error() the arguments are both zero - throw_error
L4  JavaScript-&gt;throw_error() pushing error object to stack
L4  JavaScript-&gt;afterwards() with dukOutcome 1 and status now (no status)
L4  JavaScript-&gt;run() completed with outcome 0
L4  JavaScript-&gt;wrapUpWorks() with status 0 and now HAD_ERROR
Duktape context dump:
ctx: top=1, stack=[{}]

L4  No brief

L4  wrapUpWorks with error stack:Duktape context dump:
ctx: top=1, stack=[{}]

L4  Call stack: Error: Console JavaScript - the arguments are both zero - throw_error
    at [anon] (D:\Documents\Github\JavaScript_pi\src\JavaScriptgui_impl.h:989) internal
    at [anon] () native strict preventsyield
    at eval (eval:1) preventsyield
L4  wholeLine:    at eval (eval:1
L4  JavaScript-&gt;clearDialog()  (None)
L4  JavaScript-&gt;clearAlert()  (None)
L4  JavaScript-&gt;wrapUp() destroying ctx
L0  ------------------ Console JavaScript wrapped up
</code></pre></div>
<p>Debug shows error at <code>duk_throw(ctx)</code><br>
After debug this in output:<br>
<code>line 1 Error: Console JavaScript - the arguments are both zero - throw_error</code></p>



<a name="428203606"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/428203606" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#428203606">(Mar 21 2024 at 19:38)</a>:</h4>
<p>In both cases, the stack dump shows just one thing - the  error object on the stack as expected.<br>
<code>ctx: top=1, stack=[{}]</code><br>
I am perplexed.  Only reason <code>duk_throw(ctx)</code> might fail is if invalid ctx.  Biut trce does not reveal any difference and, if a programming error, it would show here on MacOS.</p>
<p>Please check with v2 . You will need to use, say, <code>messageBox(1,2,3,4);</code></p>



<a name="428290687"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/428290687" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#428290687">(Mar 22 2024 at 09:28)</a>:</h4>
<p>Try changing error type in throw_error (line 989) to DUK_ERR_TYPE_ERROR</p>



<a name="428295817"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/428295817" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#428295817">(Mar 22 2024 at 09:57)</a>:</h4>
<blockquote>
<p>Please check with v2 . You will need to use, say, messageBox(1,2,3,4);</p>
</blockquote>
<p>Crash :(</p>



<a name="428295882"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/428295882" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#428295882">(Mar 22 2024 at 09:57)</a>:</h4>
<p>Now trying changing error type.</p>



<a name="428312654"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/428312654" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#428312654">(Mar 22 2024 at 11:46)</a>:</h4>
<p>With JS_throw_test(1, 1)<br>
<code>line 1 TypeError: the arguments match - duk_throw</code><br>
With JS_throw_test(0, 0)<br>
<code>line 1 TypeError: Console JavaScript - the arguments are both zero - throw_error</code></p>
<p>With JS_throw_test(0, 0) the debug always finds the line <code>duk_throw(ctx);</code></p>



<a name="428312960"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/428312960" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#428312960">(Mar 22 2024 at 11:48)</a>:</h4>
<p>Are you saying it crashes OCPN with DUK_ERR_TYPE_ERROR ?</p>



<a name="428313842"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/428313842" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#428313842">(Mar 22 2024 at 11:55)</a>:</h4>
<p>Maybe it cannot cope with duk_throw(ctx) from within a method?  <span aria-label="thinking" class="emoji emoji-1f914" role="img" title="thinking">:thinking:</span></p>



<a name="428314889"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/428314889" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#428314889">(Mar 22 2024 at 12:01)</a>:</h4>
<blockquote>
<p>Are you saying it crashes OCPN with DUK_ERR_TYPE_ERROR ?</p>
</blockquote>
<p>Yes it does.</p>
<p>Is <code>duk_throw(ctx)</code> needed? This works:</p>
<div class="codehilite"><pre><span></span><code>wxStyledTextCtrl* output_window = m_Output;
output_window-&gt;AppendText(message);
</code></pre></div>



<a name="428317331"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/428317331" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#428317331">(Mar 22 2024 at 12:17)</a>:</h4>
<p><code>duk_throw</code>  throws the value on top of the stack.<br>
If no values?</p>



<a name="428318326"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/428318326" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#428318326">(Mar 22 2024 at 12:23)</a>:</h4>
<p>Ah... but the throw is needed to stop the script and unwind the call stack.  It could be in a function called from a JavaScript function called from a function etc.</p>
<p>The throw_error method checks if there is already an error object on the top of the stack, such as when there is a compiler error (line 984).  If not it pushes one with our custom message.  The traces I have seen show the object (only) on the stack.The trace should be showing that it has.  Is it showing in the trace from line 999?</p>



<a name="428319558"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/428319558" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#428319558">(Mar 22 2024 at 12:30)</a>:</h4>
<div class="codehilite"><pre><span></span><code>L4  setConsoleMinClientSize text JavaScript, size X:52 Y: 15
L4  Constructed console JavaScript size x 816 y 949  minSize x 134 y 39
L0  ------------------ Console JavaScript about to run
L4  JavaScript-&gt;throw_error() the arguments are both zero - throw_error
L4  JavaScript-&gt;throw_error() pushing error object to stack

After debug:

L4  JavaScript-&gt;afterwards() with dukOutcome 1 and status now (no status)
L4  JavaScript-&gt;run() completed with outcome 0
L4  JavaScript-&gt;wrapUpWorks() with status 0 and now HAD_ERROR
Duktape context dump:
ctx: top=1, stack=[{}]

L4  No brief

L4  wrapUpWorks with error stack:Duktape context dump:
ctx: top=1, stack=[{}]

L4  Call stack: TypeError: Console JavaScript - the arguments are both zero - throw_error
    at [anon] (D:\Documents\Github\JavaScript_pi\src\JavaScriptgui_impl.h:1107) internal
    at [anon] () native strict preventsyield
    at eval (eval:1) preventsyield
L4  wholeLine:    at eval (eval:1
L4  JavaScript-&gt;clearDialog()  (None)
L4  JavaScript-&gt;clearAlert()  (None)
L4  JavaScript-&gt;wrapUp() destroying ctx
L0  ------------------ Console JavaScript wrapped up
</code></pre></div>



<a name="428320863"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/428320863" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#428320863">(Mar 22 2024 at 12:37)</a>:</h4>
<p>Yes the trace shows it is pushing the error object.<br>
Please try the following</p>
<ol>
<li>in throw error, comment out the throw at line 993</li>
<li>paste a copy of the throw into jstest after the call to throw_error.  File JSextensions.cpp after line 1016.</li>
<li>Test with JS_throw_test(0,0);</li>
</ol>
<p>With this, the only difference between JS_throw_test(1,1) which is OK and JS_throw_test(0,0) which crashes is how the error object it pushed on (and the error code it uses).</p>



<a name="428321916"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/428321916" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#428321916">(Mar 22 2024 at 12:43)</a>:</h4>
<p>No crash.</p>
<div class="codehilite"><pre><span></span><code>L4  setConsoleMinClientSize text JavaScript, size X:52 Y: 15
L4  Constructed console JavaScript size x 816 y 949  minSize x 134 y 39
L0  ------------------ Console JavaScript about to run
L4  JavaScript-&gt;throw_error() the arguments are both zero - throw_error
L4  JavaScript-&gt;throw_error() pushing error object to stack
L4  JavaScript-&gt;afterwards() with dukOutcome 1 and status now (no status)
L4  JavaScript-&gt;run() completed with outcome 0
L4  JavaScript-&gt;wrapUpWorks() with status 0 and now HAD_ERROR
Duktape context dump:
ctx: top=1, stack=[{}]

L4  No brief

L4  wrapUpWorks with error stack:Duktape context dump:
ctx: top=1, stack=[{}]

L4  Call stack: TypeError: Console JavaScript - the arguments are both zero - throw_error
    at [anon] (D:\Documents\Github\JavaScript_pi\src\JavaScriptgui_impl.h:1107) internal
    at [anon] () native strict preventsyield
    at eval (eval:1) preventsyield
L4  wholeLine:    at eval (eval:1
L4  JavaScript-&gt;clearDialog()  (None)
L4  JavaScript-&gt;clearAlert()  (None)
L4  JavaScript-&gt;wrapUp() destroying ctx
L0  ------------------ Console JavaScript wrapped up
</code></pre></div>
<p>In output:<br>
<code>line 1 TypeError: Console JavaScript - the arguments are both zero - throw_error</code></p>



<a name="428322284"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/428322284" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#428322284">(Mar 22 2024 at 12:45)</a>:</h4>
<p>Hooray!  At last <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span> <br>
Conclusion:  Windows cannot cope with throw within a method and probably a function when there is  a C++ call to be unwound.  Do you agree?</p>



<a name="428322502"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/428322502" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#428322502">(Mar 22 2024 at 12:46)</a>:</h4>
<p>Agreed. Are there unintended consequences?</p>



<a name="428322710"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/428322710" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#428322710">(Mar 22 2024 at 12:48)</a>:</h4>
<p>I need to rework all throws within the plugin.  Tedious but not difficult.  Will push an update version and advise.</p>



<a name="428362714"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/428362714" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#428362714">(Mar 22 2024 at 16:04)</a>:</h4>
<p>Needed to change 95 instances like<br>
<code>if (&lt;some condition) throw_error(ctx, "the error message");</code><br>
to</p>
<div class="codehilite" data-code-language="JavaScript"><pre><span></span><code><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">some</span><span class="w"> </span><span class="nx">condition</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">prep_for_throw</span><span class="p">(</span><span class="nx">pConsole</span><span class="o">-&gt;</span><span class="nx">mpCtx</span><span class="p">,</span><span class="w"> </span><span class="s2">"the error message"</span><span class="p">);</span>
<span class="w">      </span><span class="k">throw</span><span class="p">(</span><span class="nx">pConsole</span><span class="o">-&gt;</span><span class="nx">mpCtx</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
</code></pre></div>
<p>Build beta-m pushed to GitHub and build in my beta repo.</p>
<p>I fear there could still be a problem with file name working.<br>
Please run the one-liner<br>
<code>readTextFile("??");</code><br>
which will open a dialogue to choose the file to read.  If you cancel the dialogue, it throws an error from within a function - not a method.</p>
<p>If all is well, please run the diagnostic suite.</p>



<a name="428365872"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/428365872" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#428365872">(Mar 22 2024 at 16:19)</a>:</h4>
<p>Looking good. Only problem so far with Position/Waypoint/Route:</p>
<div class="codehilite"><pre><span></span><code>Reading back waypoint

Reading back updated waypoint
Constructing fullwaypoint failed: Mark Test mark is at 51° 00.000&#39;N 011° 0.000&#39;E Mark Test mark is at 51 00.000&#39;N 011 0.000&#39;E

Waypoint tests completed with error(s)

*** Route tests ***
Readback of route matched
Retrieved route updated:
Route: Changed route name from: New from string to: New to string
0 {&quot;position&quot;:{&quot;latitude&quot;:60,&quot;longitude&quot;:-1},&quot;GUID&quot;:&quot;43fcffff-7070-4c84-b850-dea3073f0000&quot;,&quot;markName&quot;:&quot;TestWP0&quot;,&quot;description&quot;:&quot;Description of WP0&quot;,&quot;creationDateTime&quot;:1711124287,&quot;isVisible&quot;:true,&quot;iconName&quot;:&quot;circle&quot;,&quot;hyperlinkList&quot;:[]}
1 {&quot;position&quot;:{&quot;latitude&quot;:59.1,&quot;longitude&quot;:-0.10000000000000009},&quot;GUID&quot;:&quot;70ceffff-db8f-41a4-895d-04e45621ffff&quot;,&quot;markName&quot;:&quot;TestWP1&quot;,&quot;description&quot;:&quot;Description of WP1&quot;,&quot;creationDateTime&quot;:1711124287,&quot;isVisible&quot;:true,&quot;iconName&quot;:&quot;circle&quot;,&quot;hyperlinkList&quot;:[]}
2 {&quot;position&quot;:{&quot;latitude&quot;:50,&quot;longitude&quot;:3},&quot;GUID&quot;:&quot;&quot;,&quot;markName&quot;:&quot;ReplacedMark&quot;,&quot;description&quot;:&quot;Replaced Description&quot;,&quot;creationDateTime&quot;:&quot;&quot;,&quot;isVisible&quot;:true,&quot;iconName&quot;:&quot;anchor&quot;,&quot;hyperlinkList&quot;:[]}
3 {&quot;position&quot;:{&quot;latitude&quot;:60.3,&quot;longitude&quot;:-1.3},&quot;GUID&quot;:&quot;5c42ffff-2224-44b5-b1d0-8fd15b87ffff&quot;,&quot;markName&quot;:&quot;TestWP3&quot;,&quot;description&quot;:&quot;Description of WP3&quot;,&quot;creationDateTime&quot;:1711124287,&quot;isVisible&quot;:true,&quot;iconName&quot;:&quot;circle&quot;,&quot;hyperlinkList&quot;:[]}

Route tests completed OK

*** Track tests ***
Track tests OK
result: Tests ran to completion
</code></pre></div>



<a name="428366241"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/428366241" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#428366241">(Mar 22 2024 at 16:21)</a>:</h4>
<p>Read text file:</p>
<div class="codehilite"><pre><span></span><code>This is line one
This is line two
This is line three
This is line four
This is line five
This is line six
This is line seven
This is line eight
result: Read local text file failed
</code></pre></div>



<a name="428368484"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/428368484" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#428368484">(Mar 22 2024 at 16:32)</a>:</h4>
<p>Only those 2. N2k not available.</p>



<a name="428371443"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/428371443" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#428371443">(Mar 22 2024 at 16:47)</a>:</h4>
<p>Problem with waypoint is that test script had a fromCharCode() to generate a degree, which is now handled by our good work.  SO I have replaced that with a degree character, which should get handled correctly.  Here is an update for test file <code>02_PosWayRouteTests.js</code><br>
<a href="/user_uploads/33951/d1Jl63GBWn08WpG987-k5qdA/02_PosWayRouteTests.js.zip">02_PosWayRouteTests.js.zip</a></p>



<a name="428371791"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/428371791" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#428371791">(Mar 22 2024 at 16:48)</a>:</h4>
<p>Read text file issue could  be because Windows file is slightly different.  Please run this and let me have the output</p>
<div class="codehilite" data-code-language="JavaScript"><pre><span></span><code><span class="nx">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">readTextFile</span><span class="p">(</span><span class="s2">"textFile.txt"</span><span class="p">);</span>
<span class="nx">print</span><span class="p">(</span><span class="s2">"File length is "</span><span class="p">,</span><span class="w"> </span><span class="nx">text</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span><span class="w"> </span><span class="s2">" and file is\n'"</span><span class="p">,</span><span class="w"> </span><span class="nx">text</span><span class="p">,</span><span class="w"> </span><span class="s2">"'\n"</span><span class="p">);</span>
</code></pre></div>



<a name="428373972"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/428373972" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#428373972">(Mar 22 2024 at 17:00)</a>:</h4>
<blockquote>
<p>N2k not available.</p>
</blockquote>
<p>Which was the test that gave you this and what was the output please?<br>
(I can't find it right now.)</p>



<a name="428380004"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/428380004" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#428380004">(Mar 22 2024 at 17:36)</a>:</h4>
<p>Bell symbol appears :</p>
<div class="codehilite"><pre><span></span><code>Present time: 1711128833
JavaScript plugin v3.0 Patch 0 Beta m

*** Position tests ***
Latest fix was at 2024-03-22 17:33:53.371+00:00
Position 59 42.996&#39;N 072 21.852&#39;W
Present navigational information not available
Position tests completed OK

*** Waypoint tests ***
43 existing waypoints
No active waypoint

Reading back waypoint

Reading back updated waypoint
Waypoint tests completed OK

*** Route tests ***
Readback of route matched
Retrieved route updated:
Route: Changed route name from: New from string to: New to string
0 {&quot;position&quot;:{&quot;latitude&quot;:60,&quot;longitude&quot;:-1},&quot;GUID&quot;:&quot;5f21ffff-e639-476e-b008-a125391b0000&quot;,&quot;markName&quot;:&quot;TestWP0&quot;,&quot;description&quot;:&quot;Description of WP0&quot;,&quot;creationDateTime&quot;:1711128833,&quot;isVisible&quot;:true,&quot;iconName&quot;:&quot;circle&quot;,&quot;hyperlinkList&quot;:[]}
1 {&quot;position&quot;:{&quot;latitude&quot;:59.1,&quot;longitude&quot;:-0.10000000000000009},&quot;GUID&quot;:&quot;3afd0000-9c35-41c6-8224-bb015f63ffff&quot;,&quot;markName&quot;:&quot;TestWP1&quot;,&quot;description&quot;:&quot;Description of WP1&quot;,&quot;creationDateTime&quot;:1711128833,&quot;isVisible&quot;:true,&quot;iconName&quot;:&quot;circle&quot;,&quot;hyperlinkList&quot;:[]}
2 {&quot;position&quot;:{&quot;latitude&quot;:50,&quot;longitude&quot;:3},&quot;GUID&quot;:&quot;&quot;,&quot;markName&quot;:&quot;ReplacedMark&quot;,&quot;description&quot;:&quot;Replaced Description&quot;,&quot;creationDateTime&quot;:&quot;&quot;,&quot;isVisible&quot;:true,&quot;iconName&quot;:&quot;anchor&quot;,&quot;hyperlinkList&quot;:[]}
3 {&quot;position&quot;:{&quot;latitude&quot;:60.3,&quot;longitude&quot;:-1.3},&quot;GUID&quot;:&quot;2b250000-941f-4e3c-a31e-2fdc38270000&quot;,&quot;markName&quot;:&quot;TestWP3&quot;,&quot;description&quot;:&quot;Description of WP3&quot;,&quot;creationDateTime&quot;:1711128833,&quot;isVisible&quot;:true,&quot;iconName&quot;:&quot;circle&quot;,&quot;hyperlinkList&quot;:[]}

Route tests completed OK

*** Track tests ***
Track tests OK
result: Tests ran to completion
</code></pre></div>
<div class="codehilite"><pre><span></span><code>L0  ------------------ Console PluginTests about to run
L4  PluginTests-&gt;prep_for_throw() OCPNGetSingleWaypoint called with non-existant GUID abc
L4  PluginTests-&gt;prep_for_throw() pushing error object to stack
L4  PluginTests-&gt;prep_for_throw() OCPNdeleteRoute called with non-existant GUID aaa
L4  PluginTests-&gt;prep_for_throw() pushing error object to stack
L4  PluginTests-&gt;prep_for_throw() OCPNgetRoute called with non-existant GUID 4871ffff-5c2a-47ec-a4d2-88e74aa7ffff
L4  PluginTests-&gt;prep_for_throw() pushing error object to stack
L4  PluginTests-&gt;prep_for_throw() OCPNdeleteTrack called with non-existant GUID aaa
L4  PluginTests-&gt;prep_for_throw() pushing error object to stack
L4  PluginTests-&gt;prep_for_throw() OCPNdeleteTrack called with non-existant GUID [object Object]
L4  PluginTests-&gt;prep_for_throw() pushing error object to stack
L4  PluginTests-&gt;afterwards() with dukOutcome 0 and status now (no status)
L4  PluginTests-&gt;run() completed with outcome 2
L4  PluginTests-&gt;wrapUpWorks() with status 2 and now DONE
Duktape context dump:
ctx: top=0, stack=[]

L4  No brief

L4  PluginTests-&gt;clearDialog()  (None)
L4  PluginTests-&gt;clearAlert()  (None)
L4  PluginTests-&gt;wrapUp() will save _remember
L4  PluginTests-&gt;wrapUp() destroying ctx
L0  ------------------ Console PluginTests wrapped up
</code></pre></div>



<a name="428380353"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/428380353" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#428380353">(Mar 22 2024 at 17:38)</a>:</h4>
<div class="codehilite"><pre><span></span><code>File length is 150 and file is
&#39;This is line one
This is line two
This is line three
This is line four
This is line five
This is line six
This is line seven
This is line eight&#39;
result: undefined
</code></pre></div>



<a name="428380825"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/428380825" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#428380825">(Mar 22 2024 at 17:41)</a>:</h4>
<p>N2k inn 110_n2k_encode_decode.js<br>
<code>line 78 TypeError: [object Error] not callable</code></p>
<div class="codehilite"><pre><span></span><code>L0  ------------------ Console PluginTests about to run
L4  PluginTests-&gt;prep_for_throw() SyntaxError: parse error (line 1, end of input)
L4  PluginTests-&gt;prep_for_throw() pushing error object to stack
L4  PluginTests-&gt;afterwards() with dukOutcome 1 and status now (no status)
L4  PluginTests-&gt;run() completed with outcome 0
L4  PluginTests-&gt;wrapUpWorks() with status 0 and now HAD_ERROR
Duktape context dump:
ctx: top=1, stack=[{}]

L4  No brief

L4  wrapUpWorks with error stack:Duktape context dump:
ctx: top=1, stack=[{}]

L4  Call stack: TypeError: [object Error] not callable
    at [anon] (duk_js_call.c:1349) internal
    at NMEA2000 (C:\Users\rasba\AppData\Local\opencpn\plugins\JavaScript_pi\data\scripts\NMEA2000.js:29) construct
    at eval (eval:78) preventsyield
L4  wholeLine:    at eval (eval:78
L4  PluginTests-&gt;clearDialog()  (None)
L4  PluginTests-&gt;clearAlert()  (None)
L4  PluginTests-&gt;wrapUp() destroying ctx
L0  ------------------ Console PluginTests wrapped up
</code></pre></div>



<a name="428384153"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/428384153" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#428384153">(Mar 22 2024 at 18:02)</a>:</h4>
<p>Had to reinstall OpenCPN 02_PosWayRouteTests.js is OK. No bel.</p>



<a name="428384807"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/428384807" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#428384807">(Mar 22 2024 at 18:05)</a>:</h4>
<p><strong>Problem with readTextFile</strong><br>
The test just compares the file text with a JavaScript string.  Bu the character count from the read file is 150 whereas for me it is 143.  Looks like Windows has both a CR &amp; LF as new line, whereas MacOS &amp; Unix/linux has just \n.<br>
Please run this and let me have the output</p>
<div class="codehilite" data-code-language="JavaScript"><pre><span></span><code><span class="nx">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">readTextFile</span><span class="p">(</span><span class="s2">"textFile.txt"</span><span class="p">);</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">text</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="nx">print</span><span class="p">(</span><span class="nx">text</span><span class="p">.</span><span class="nx">charAt</span><span class="p">(</span><span class="nx">i</span><span class="p">),</span><span class="w"> </span><span class="s2">"\t"</span><span class="p">,</span><span class="w"> </span><span class="nx">text</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="nx">i</span><span class="p">).</span><span class="nx">toString</span><span class="p">(</span><span class="mf">16</span><span class="p">),</span><span class="w"> </span><span class="s2">"\n"</span><span class="p">);</span>
</code></pre></div>



<a name="428385474"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/428385474" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#428385474">(Mar 22 2024 at 18:10)</a>:</h4>
<p>Re problems with constructor not callable, I REALLY REALLY hope that this is not the case.  Please run the following and report:</p>
<div class="codehilite" data-code-language="JavaScript"><pre><span></span><code><span class="nx">Position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s2">"Position"</span><span class="p">);</span>
<span class="nx">posA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Position</span><span class="p">;</span>
<span class="nx">posB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Position</span><span class="p">(</span><span class="mf">60</span><span class="p">,</span><span class="w"> </span><span class="mf">1</span><span class="p">);</span>
<span class="nx">print</span><span class="p">(</span><span class="nx">posB</span><span class="p">,</span><span class="w"> </span><span class="s2">"\n"</span><span class="p">);</span>
</code></pre></div>



<a name="428385491"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/428385491" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#428385491">(Mar 22 2024 at 18:10)</a>:</h4>
<p>Supper calls</p>



<a name="429063386"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429063386" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429063386">(Mar 23 2024 at 08:52)</a>:</h4>
<p>The file:</p>
<div class="codehilite"><pre><span></span><code>Tracing levels 4 - 4
T   54
h   68
i   69
s   73
    20
i   69
s   73
    20
l   6c
i   69
n   6e
e   65
    20
o   6f
n   6e
e   65

    d

    a
T   54
h   68
i   69
s   73
    20
i   69
s   73
    20
l   6c
i   69
n   6e
e   65
    20
t   74
w   77
o   6f

    d

    a
T   54
h   68
i   69
s   73
    20
i   69
s   73
    20
l   6c
i   69
n   6e
e   65
    20
t   74
h   68
r   72
e   65
e   65

    d

    a
T   54
h   68
i   69
s   73
    20
i   69
s   73
    20
l   6c
i   69
n   6e
e   65
    20
f   66
o   6f
u   75
r   72

    d

    a
T   54
h   68
i   69
s   73
    20
i   69
s   73
    20
l   6c
i   69
n   6e
e   65
    20
f   66
i   69
v   76
e   65

    d

    a
T   54
h   68
i   69
s   73
    20
i   69
s   73
    20
l   6c
i   69
n   6e
e   65
    20
s   73
i   69
x   78

    d

    a
T   54
h   68
i   69
s   73
    20
i   69
s   73
    20
l   6c
i   69
n   6e
e   65
    20
s   73
e   65
v   76
e   65
n   6e

    d

    a
T   54
h   68
i   69
s   73
    20
i   69
s   73
    20
l   6c
i   69
n   6e
e   65
    20
e   65
i   69
g   67
h   68
t   74
result: undefined
</code></pre></div>
<div class="codehilite"><pre><span></span><code>L4  setConsoleMinClientSize text JavaScript, size X:52 Y: 15
L4  Constructed console JavaScript size x 738 y 881  minSize x 134 y 39
L0  ------------------ Console JavaScript about to run
L4  JavaScript-&gt;afterwards() with dukOutcome 0 and status now (no status)
L4  JavaScript-&gt;run() completed with outcome 2
L4  JavaScript-&gt;wrapUpWorks() with status 2 and now DONE
Duktape context dump:
ctx: top=0, stack=[]

L4  No brief

L4  JavaScript-&gt;clearDialog()  (None)
L4  JavaScript-&gt;clearAlert()  (None)
L4  JavaScript-&gt;wrapUp() will save _remember
L4  JavaScript-&gt;wrapUp() destroying ctx
L0  ------------------ Console JavaScript wrapped up
</code></pre></div>



<a name="429063497"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429063497" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429063497">(Mar 23 2024 at 08:53)</a>:</h4>
<p>The position:</p>
<div class="codehilite"><pre><span></span><code>{&quot;latitude&quot;:60,&quot;longitude&quot;:1}
result: undefined
</code></pre></div>
<div class="codehilite"><pre><span></span><code>L0  ------------------ Console JavaScript about to run
L4  JavaScript-&gt;afterwards() with dukOutcome 0 and status now (no status)
L4  JavaScript-&gt;run() completed with outcome 2
L4  JavaScript-&gt;wrapUpWorks() with status 2 and now DONE
Duktape context dump:
ctx: top=0, stack=[]

L4  No brief

L4  JavaScript-&gt;clearDialog()  (None)
L4  JavaScript-&gt;clearAlert()  (None)
L4  JavaScript-&gt;wrapUp() will save _remember
L4  JavaScript-&gt;wrapUp() destroying ctx
L0  ------------------ Console JavaScript wrapped up
</code></pre></div>



<a name="429063668"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429063668" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429063668">(Mar 23 2024 at 08:56)</a>:</h4>
<p>Thanks.  Re text file, I need to drop Window's CR on all text file read ops.  Update to follow.</p>



<a name="429065024"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429065024" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429065024">(Mar 23 2024 at 09:20)</a>:</h4>
<p>Re problem with NK, please run following and report (Do not need trace).</p>
<div class="codehilite" data-code-language="JavaScript"><pre><span></span><code><span class="nx">descriptor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s2">"pgnDescriptors"</span><span class="p">)(</span><span class="mf">126992</span><span class="p">);</span>
<span class="nx">print</span><span class="p">(</span><span class="nx">descriptor</span><span class="p">.</span><span class="nx">Id</span><span class="p">,</span><span class="w"> </span><span class="s2">"\n"</span><span class="p">);</span>
</code></pre></div>
<p>PS Will be on conference call for an ahour or so on non-marine matters from 10:00</p>



<a name="429066288"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429066288" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429066288">(Mar 23 2024 at 09:41)</a>:</h4>
<p>If the above fails to print <code>systemTime</code>, please try this alternative:</p>
<div class="codehilite" data-code-language="JavaScript"><pre><span></span><code><span class="nx">descriptor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">require</span><span class="p">(</span><span class="s2">"pgnDescriptors"</span><span class="p">))(</span><span class="mf">126992</span><span class="p">);</span>
<span class="nx">print</span><span class="p">(</span><span class="nx">descriptor</span><span class="p">.</span><span class="nx">Id</span><span class="p">,</span><span class="w"> </span><span class="s2">"\n"</span><span class="p">);</span>
</code></pre></div>



<a name="429069369"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429069369" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429069369">(Mar 23 2024 at 10:31)</a>:</h4>
<p>Neither message works for me:<br>
<code>TypeError: [object Error] not callable</code></p>



<a name="429073314"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429073314" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429073314">(Mar 23 2024 at 11:34)</a>:</h4>
<p>Please try this:</p>
<div class="codehilite" data-code-language="JavaScript"><pre><span></span><code><span class="nx">Descriptor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s2">"pgnDescriptors"</span><span class="p">);</span>
<span class="nx">st</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Descriptor</span><span class="p">(</span><span class="mf">126992</span><span class="p">);</span>
<span class="nx">print</span><span class="p">(</span><span class="nx">st</span><span class="p">.</span><span class="nx">Id</span><span class="p">,</span><span class="w"> </span><span class="s2">"\n"</span><span class="p">);</span>
</code></pre></div>



<a name="429075129"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429075129" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429075129">(Mar 23 2024 at 12:04)</a>:</h4>
<p>and this one:</p>
<div class="codehilite" data-code-language="JavaScript"><pre><span></span><code><span class="nx">st</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s2">"pgnDescriptors"</span><span class="p">)(</span><span class="mf">126992</span><span class="p">);</span>
<span class="nx">print</span><span class="p">(</span><span class="nx">st</span><span class="p">.</span><span class="nx">Id</span><span class="p">,</span><span class="w"> </span><span class="s2">"\n"</span><span class="p">);</span>
</code></pre></div>



<a name="429075362"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429075362" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429075362">(Mar 23 2024 at 12:07)</a>:</h4>
<p><a href="https://github.com/opencpn/OpenCPN/issues/1">#1</a> TypeError: [object Error] not constructable<br>
<a href="https://github.com/opencpn/OpenCPN/issues/2">#2</a> TypeError: [object Error] not callable</p>



<a name="429077314"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429077314" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429077314">(Mar 23 2024 at 12:36)</a>:</h4>
<p>Now this, please:</p>
<div class="codehilite" data-code-language="JavaScript"><pre><span></span><code><span class="nx">pgnDescriptors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s2">"pgnDescriptors"</span><span class="p">);</span>
<span class="nx">print</span><span class="p">(</span><span class="s2">"A\t"</span><span class="p">,</span><span class="w"> </span><span class="ow">typeof</span><span class="w"> </span><span class="nx">pgnDescriptors</span><span class="p">,</span><span class="w"> </span><span class="s2">"\n"</span><span class="p">);</span>
<span class="nx">stDescriptor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">pgnDescriptors</span><span class="p">(</span><span class="mf">126992</span><span class="p">);</span>
<span class="nx">print</span><span class="p">(</span><span class="s2">"B\t"</span><span class="p">,</span><span class="w"> </span><span class="ow">typeof</span><span class="w"> </span><span class="nx">stDescriptor</span><span class="p">,</span><span class="w"> </span><span class="s2">"\n"</span><span class="p">);</span>
<span class="nx">print</span><span class="p">(</span><span class="s2">"C\t"</span><span class="p">,</span><span class="w"> </span><span class="nx">stDescriptor</span><span class="p">.</span><span class="nx">Id</span><span class="p">,</span><span class="w"> </span><span class="s2">"\n"</span><span class="p">);</span>
</code></pre></div>



<a name="429077457"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429077457" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429077457">(Mar 23 2024 at 12:38)</a>:</h4>
<div class="codehilite"><pre><span></span><code>A   object
TypeError: [object Error] not callable
</code></pre></div>



<a name="429077726"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429077726" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429077726">(Mar 23 2024 at 12:41)</a>:</h4>
<p>Oh... on MacOS,  I get<br>
`A      function<br>
Need to think about this.</p>



<a name="429079711"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429079711" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429079711">(Mar 23 2024 at 13:11)</a>:</h4>
<p>Now this, please:</p>
<div class="codehilite" data-code-language="JavaScript"><pre><span></span><code><span class="nx">Position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s2">"Position"</span><span class="p">);</span>
<span class="nx">print</span><span class="p">(</span><span class="s2">"X\t"</span><span class="p">,</span><span class="w"> </span><span class="ow">typeof</span><span class="w"> </span><span class="nx">Position</span><span class="p">,</span><span class="w"> </span><span class="s2">"\n"</span><span class="p">);</span>
</code></pre></div>



<a name="429089493"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429089493" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429089493">(Mar 23 2024 at 15:22)</a>:</h4>
<p>To address the text compare issue on Windows, I am now cleaning \r\n to \n.<br>
Hopefully this will fix the read text file issues.</p>
<p>I cannot understand why on Windows <code>require("pgnDescriptors")</code>is compiling to an object, but onMacOS to a function, which is correct.  Grasping at staws here, but the only difference I can presently see between this and other files that compile to a function is that pgnDescriptors has a comment block in front of the start of the function.  Possibly Duktape is seeing it does not start with <code>function</code> and discounting it as a function.  So I have moved the comment block inside the function body.</p>
<p>beta-p pushed to GitHub and build to beta repo 23 Mar 15:12</p>
<p>Please run  tests affected by CR LF</p>
<ol>
<li>Read text file</li>
<li>Read remote text file</li>
<li>Files object</li>
</ol>
<p>Also please run</p>
<div class="codehilite" data-code-language="JavaScript"><pre><span></span><code><span class="nx">Position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s2">"Position"</span><span class="p">);</span>
<span class="nx">print</span><span class="p">(</span><span class="s2">"X\t"</span><span class="p">,</span><span class="w"> </span><span class="ow">typeof</span><span class="w"> </span><span class="nx">Position</span><span class="p">,</span><span class="w"> </span><span class="s2">"\n"</span><span class="p">);</span>

<span class="nx">pgnDescriptors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s2">"pgnDescriptors"</span><span class="p">);</span>
<span class="nx">print</span><span class="p">(</span><span class="s2">"A\t"</span><span class="p">,</span><span class="w"> </span><span class="ow">typeof</span><span class="w"> </span><span class="nx">pgnDescriptors</span><span class="p">,</span><span class="w"> </span><span class="s2">"\n"</span><span class="p">);</span>
<span class="nx">stDescriptor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">pgnDescriptors</span><span class="p">(</span><span class="mf">126992</span><span class="p">);</span>
<span class="nx">print</span><span class="p">(</span><span class="s2">"B\t"</span><span class="p">,</span><span class="w"> </span><span class="ow">typeof</span><span class="w"> </span><span class="nx">stDescriptor</span><span class="p">,</span><span class="w"> </span><span class="s2">"\n"</span><span class="p">);</span>
<span class="nx">print</span><span class="p">(</span><span class="s2">"C\t"</span><span class="p">,</span><span class="w"> </span><span class="nx">stDescriptor</span><span class="p">.</span><span class="nx">Id</span><span class="p">,</span><span class="w"> </span><span class="s2">"\n"</span><span class="p">);</span>
</code></pre></div>



<a name="429089618"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429089618" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429089618">(Mar 23 2024 at 15:24)</a>:</h4>
<p>(deleted)</p>



<a name="429090230"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429090230" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429090230">(Mar 23 2024 at 15:33)</a>:</h4>
<div class="codehilite"><pre><span></span><code>X   function
result: undefined
</code></pre></div>
<p>And the second:</p>
<p><code>line 1 Error: Console JavaScript - SyntaxError: parse error (line 1, end of input)</code></p>



<a name="429090667"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429090667" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429090667">(Mar 23 2024 at 15:39)</a>:</h4>
<p>Read text file</p>
<div class="codehilite"><pre><span></span><code>This is line one
This is line two
This is line three
This is line four
This is line five
This is line six
This is line seven
This is line eight
result: Read local text file matched
</code></pre></div>
<p>Read remote text file<br>
<code>result: Read remote text file matched</code></p>
<p>Files object</p>
<div class="codehilite"><pre><span></span><code>{&quot;id&quot;:10877,&quot;fileString&quot;:&quot;D:\\Documents\\Github\\JavaScript_pi\\Tests_scripts\\00_main.js&quot;}
getAllText and getTextLine testSeek to start gives: 0
Seek to midway gives: 5123
Eof at midway gives: false
Tell gives: 5123
Seek to end gives: 11204
Eof at end gives: true
Write test
Append test
Update test
Byte test
result: Files OK
</code></pre></div>



<a name="429090796"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429090796" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429090796">(Mar 23 2024 at 15:41)</a>:</h4>
<p>All good on files.<br>
So the one liner<br>
<code>pgnDescriptors = require("pgnDescriptors");</code><br>
gets a parse error end of input ?</p>



<a name="429091227"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429091227" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429091227">(Mar 23 2024 at 15:46)</a>:</h4>
<p>Double check:<br>
<code>line 1 Error: Console PluginTests - SyntaxError: parse error (line 1, end of input)</code></p>



<a name="429091477"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429091477" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429091477">(Mar 23 2024 at 15:49)</a>:</h4>
<p>Cannot see anything wrong with js.<br>
Please run the above test with TRACE level max &amp; min set to 45.</p>



<a name="429092253"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429092253" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429092253">(Mar 23 2024 at 15:58)</a>:</h4>
<p>JSExtensions.js. after line 473<br>
<code> pConsole-&gt;prep_for_throw(ctx, "require - " + fileNameGiven + " not in built-in scripts");</code><br>
add missing line<br>
<code>               duk_throw(ctx);</code><br>
Missed when I did all those edits yesterday.<br>
Would only explain problem if  file not being found.</p>



<a name="429092543"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429092543" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429092543">(Mar 23 2024 at 16:02)</a>:</h4>
<p>Without edit:</p>
<div class="codehilite"><pre><span></span><code>L0  ------------------ Console PluginTests about to run
L0  ------------------ Console PluginTests wrapped up
L0  ------------------ Console PluginTests about to run
L45 Require - fileGivenName: pgnDescriptors
L45 Require - looking for built-in script
L45 Require - looking to load built-in script: C:\Users\rasba\AppData\Local\opencpn\plugins\JavaScript_pi\data\scripts\pgnDescriptors.js
L45 Require - found built-in script
L45 Require - resolved to: C:\Users\rasba\AppData\Local\opencpn\plugins\JavaScript_pi\data\scripts\pgnDescriptors.js
L0  ------------------ Console PluginTests wrapped up
</code></pre></div>



<a name="429092849"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429092849" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429092849">(Mar 23 2024 at 16:06)</a>:</h4>
<p>With edit:<br>
<code>line 1 TypeError: invalid args</code></p>
<div class="codehilite"><pre><span></span><code>L0  ------------------ Console PluginTests about to run
L45 Require - fileGivenName: pgnDescriptors
L45 Require - looking for built-in script
L45 Require - looking to load built-in script: C:\Users\rasba\AppData\Local\opencpn\plugins\JavaScript_pi\data\scripts\pgnDescriptors.js
L0  ------------------ Console PluginTests wrapped up
</code></pre></div>



<a name="429093709"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429093709" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429093709">(Mar 23 2024 at 16:18)</a>:</h4>
<p>So if the condition at line 472 is true, without the edit it was falling through and trying to read non file - hence 'end of file message'<br>
But file string looks OK?  So why would the condition be true.<br>
Now with edit, why are we not seeing the error from line 473?<br>
Looks like it is not throwing and trying to compile and failing.</p>
<p>Tea break!</p>



<a name="429096364"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429096364" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429096364">(Mar 23 2024 at 16:54)</a>:</h4>
<p>Not checking for read error when reading the file.<br>
After now line 490<br>
<code>    outcome = getTextFile(resolved, &amp;script);</code><br>
insert</p>
<div class="codehilite" data-code-language="JavaScript"><pre><span></span><code><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">outcome</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nx">wxEmptyString</span><span class="p">){</span>
<span class="w">        </span><span class="nx">pConsole</span><span class="o">-&gt;</span><span class="nx">prep_for_throw</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span><span class="w"> </span><span class="s2">"require readTextFile error: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">outcome</span><span class="p">);</span>
<span class="w">        </span><span class="nx">duk_throw</span><span class="p">(</span><span class="nx">ctx</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
</code></pre></div>
<p>With this added, please try<br>
<code>pgnDescriptors = require("pgnDescriptors");</code> again.</p>
<p>Another thought... this file is large.  Possibly getting a buffer overrun so if the above does not reveal the problem, I have other tacks to try.</p>



<a name="429168318"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429168318" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429168318">(Mar 24 2024 at 07:52)</a>:</h4>
<p>Another thing to try...</p>
<p>In a spare console, load the descriptors function into the script pane using the Load button.  Browse to the file which is at <code>C:\Users\rasba\AppData\Local\opencpn\plugins\JavaScript_pi\data\scripts\pgnDescriptors.js</code></p>
<p>Run this.  It should compile and with just Result: undefined as output.</p>
<p>Keep this extra console around for further testing.</p>



<a name="429170613"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429170613" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429170613">(Mar 24 2024 at 08:20)</a>:</h4>
<blockquote>
<p>With this added, please try</p>
</blockquote>
<p><code>line 1 TypeError: invalid args</code></p>
<blockquote>
<p>With this added, please try</p>
</blockquote>
<p><code>line 75 TypeError: invalid args</code></p>
<p><a href="/user_uploads/33951/-53CvygOVWwIs0sN7jdzM9Yb/12.jpg">12.jpg</a></p>
<div class="message_inline_image"><a href="/user_uploads/33951/-53CvygOVWwIs0sN7jdzM9Yb/12.jpg" title="12.jpg"><img src="/user_uploads/33951/-53CvygOVWwIs0sN7jdzM9Yb/12.jpg"></a></div><p>Is this the right way round?</p>
<p>Boating again today.</p>



<a name="429170855"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429170855" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429170855">(Mar 24 2024 at 08:23)</a>:</h4>
<p><a href="https://meet.jit.si/570087640978805#config.startWithVideoMuted=true">Join voice call.</a></p>



<a name="429171225"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429171225" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429171225">(Mar 24 2024 at 08:26)</a>:</h4>
<p>Can we spek before you go off?  TRy joining call.</p>



<a name="429247965"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429247965" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429247965">(Mar 24 2024 at 21:05)</a>:</h4>
<p>Sorry ... missed this. Is 1000 tomorrow any good.</p>



<a name="429248087"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429248087" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429248087">(Mar 24 2024 at 21:07)</a>:</h4>
<p>Fine. 10:00am.</p>



<a name="429348495"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429348495" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429348495">(Mar 25 2024 at 10:38)</a>:</h4>
<p>line 1 Error: Console PluginTests - require readTextFile error: readTextFile D:\Documents\Github\JavaScript_pi\Tests_scripts\DocumentsMy OpenCPN bugsJavaScript_pipgnDescriptors.js not found</p>



<a name="429349178"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429349178" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429349178">(Mar 25 2024 at 10:41)</a>:</h4>
<p>D:\Documents\Github\JavaScript_pi\Tests_scripts\DocumentspgnDescriptors.js not found</p>



<a name="429350594"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429350594" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429350594">(Mar 25 2024 at 10:47)</a>:</h4>
<p>result: function getDescriptor() { [ecmascript code] }</p>



<a name="429352667"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429352667" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429352667">(Mar 25 2024 at 10:56)</a>:</h4>
<p>L45 Require - fileGivenName: ??<br>
L45 Require - hunting for script<br>
L45 Require - resolved to: C:\Users\rasba\AppData\Local\opencpn\plugins\JavaScript_pi\data\scripts\pgnDescriptors.js<br>
L0  ------------------ Console PluginTests wrapped up</p>



<a name="429354986"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429354986" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429354986">(Mar 25 2024 at 11:06)</a>:</h4>
<p>L101    resolveFileName mode 0 toPrompt 0 prompt <br>
L101    resolveFileName fullPath:C:\Documents\Github\JavaScript_pi\Tests_scripts\Users<br>
asbaAppDataLocalopencpnpluginsJavaScript_pidatascriptspgnDescriptors.js<br>
L0  ------------------ Console PluginTests wrapped up</p>



<a name="429370234"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429370234" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429370234">(Mar 25 2024 at 12:01)</a>:</h4>
<p>To simplify testing of the resolveFileName code, you can use just this simple js to invoke it:</p>
<div class="codehilite" data-code-language="JavaScript"><pre><span></span><code><span class="nx">getFileString</span><span class="p">(</span><span class="s2">"??"</span><span class="p">);</span>
</code></pre></div>
<p>Or put whattever you want in the "  "</p>



<a name="429401980"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429401980" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429401980">(Mar 25 2024 at 13:26)</a>:</h4>
<p>Just pushed beta-q to GitHub and beta repo.<br>
(1) Trace window now belongs to plugin and gets deleted on plugin deinit<br>
(2) readTextFile now preallocates a buffer for the data.  Hopefully, it will cope with the large file.<br>
Please try with this test script:</p>
<div class="codehilite" data-code-language="JavaScript"><pre><span></span><code><span class="nx">desc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s2">"pgnDescriptors"</span><span class="p">);</span>
<span class="nx">desc</span><span class="p">(</span><span class="mf">126992</span><span class="p">).</span><span class="nx">Id</span><span class="p">;</span>
</code></pre></div>
<p>Expected output:</p>
<blockquote>
<p>result: systemTime</p>
</blockquote>
<p>This should work without first needing to resolve the missing \\ you are looking  into as it loads from the built-in scripts.  SO you can just load from my beta repo.<br>
If there is still a problem, you can turn on TRACE at level 64 to see how big it  things the file is.</p>



<a name="429430335"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429430335" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429430335">(Mar 25 2024 at 15:00)</a>:</h4>
<p><a href="/user_uploads/33951/dwFl_wBLNDlFGKjQKxEMwsKA/13.jpg">13.jpg</a></p>
<div class="message_inline_image"><a href="/user_uploads/33951/dwFl_wBLNDlFGKjQKxEMwsKA/13.jpg" title="13.jpg"><img src="/user_uploads/33951/dwFl_wBLNDlFGKjQKxEMwsKA/13.jpg"></a></div>



<a name="429441116"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429441116" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429441116">(Mar 25 2024 at 15:36)</a>:</h4>
<p>My pre-allocation of buffer space is working OK.  I have run that test line 4,400 times in a loop OK so the space is getting relased OK.<br>
The trace shows the file is tge right size (allowing for Windws adding CR before each LF.</p>
<p>Please load  and run this all-in-one test:<br>
<a href="/user_uploads/33951/LY1N8-UuYFMqN23fAaOTCKes/getDescriptor_test.js.zip">getDescriptor_test.js.zip</a></p>



<a name="429441658"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429441658" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429441658">(Mar 25 2024 at 15:38)</a>:</h4>
<p>result: undefined</p>



<a name="429442084"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429442084" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429442084">(Mar 25 2024 at 15:39)</a>:</h4>
<p>Did it print <code>systemTime</code> before the result?</p>



<a name="429443324"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429443324" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429443324">(Mar 25 2024 at 15:43)</a>:</h4>
<p>No <code>systemTime</code> printed.</p>



<a name="429443340"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429443340" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429443340">(Mar 25 2024 at 15:43)</a>:</h4>
<p><a href="#narrow/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing/near/429442084">A message</a> was moved here from <a class="stream-topic" data-stream-id="349785" href="/#narrow/stream/349785-JavaScript_pi/topic/.28no.20topic.29">#JavaScript_pi &gt; (no topic)</a> by <span class="user-mention silent" data-user-id="554731">Tony Voss</span>.</p>



<a name="429443566"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429443566" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429443566">(Mar 25 2024 at 15:44)</a>:</h4>
<p>2 messages were moved here from <a class="stream-topic" data-stream-id="349785" href="/#narrow/stream/349785-JavaScript_pi/topic/.28no.20topic.29">#JavaScript_pi &gt; (no topic)</a> by <span class="user-mention silent" data-user-id="554731">Tony Voss</span>.</p>



<a name="429444942"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429444942" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429444942">(Mar 25 2024 at 15:47)</a>:</h4>
<p>And the script starts ?</p>
<div class="codehilite" data-code-language="JavaScript"><pre><span></span><code><span class="nx">print</span><span class="p">(</span><span class="nx">getDescriptor</span><span class="p">(</span><span class="mf">126992</span><span class="p">).</span><span class="nx">Id</span><span class="p">,</span><span class="w"> </span><span class="s2">"\n"</span><span class="p">);</span>


<span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">getDescriptor</span><span class="p">(</span><span class="nx">pgn</span><span class="p">,</span><span class="w"> </span><span class="nx">optionsArg</span><span class="p">){</span>
<span class="w">    </span><span class="err">/*</span>
</code></pre></div>
<p>Please replace the first line with</p>
<div class="codehilite" data-code-language="JavaScript"><pre><span></span><code><span class="nx">print</span><span class="p">(</span><span class="s2">"Before call\n"</span><span class="p">);</span>
<span class="nx">print</span><span class="p">(</span><span class="nx">getDescriptor</span><span class="p">(</span><span class="mf">126992</span><span class="p">).</span><span class="nx">Id</span><span class="p">,</span><span class="w"> </span><span class="s2">"\n"</span><span class="p">);</span>
<span class="nx">print</span><span class="p">(</span><span class="s2">"After call\n"</span><span class="p">);</span>
</code></pre></div>
<p>and run again</p>



<a name="429448457"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429448457" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429448457">(Mar 25 2024 at 15:57)</a>:</h4>
<p><a href="/user_uploads/33951/rnqc4NCSCrPiBiB-5usMM9aY/14.jpg">14.jpg</a></p>
<div class="message_inline_image"><a href="/user_uploads/33951/rnqc4NCSCrPiBiB-5usMM9aY/14.jpg" title="14.jpg"><img src="/user_uploads/33951/rnqc4NCSCrPiBiB-5usMM9aY/14.jpg"></a></div>



<a name="429450070"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429450070" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429450070">(Mar 25 2024 at 16:02)</a>:</h4>
<p>Very weird - not even printing the before statement!<br>
Try commenting out line 2 so it does not call the function.</p>



<a name="429450728"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429450728" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429450728">(Mar 25 2024 at 16:04)</a>:</h4>
<p>result: undefined</p>



<a name="429451746"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429451746" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429451746">(Mar 25 2024 at 16:07)</a>:</h4>
<p>So the presence of the getDescriptor function means the print statements do not run and yet the script runs m enough to terminate with <code>result undefined</code> ?</p>



<a name="429452531"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429452531" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429452531">(Mar 25 2024 at 16:10)</a>:</h4>
<p>Yes. With just the lines:</p>
<div class="codehilite"><pre><span></span><code>print(&quot;Before call\n&quot;);
print(getDescriptor(126992).Id, &quot;\n&quot;);
print(&quot;After call\n&quot;);
</code></pre></div>
<p>The result is the correct print.</p>



<a name="429453162"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429453162" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429453162">(Mar 25 2024 at 16:12)</a>:</h4>
<p>Let's speak.</p>



<a name="429453233"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429453233" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429453233">(Mar 25 2024 at 16:12)</a>:</h4>
<p>OK.</p>



<a name="429453292"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429453292" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429453292">(Mar 25 2024 at 16:12)</a>:</h4>
<p><a href="https://meet.jit.si/541554131652509#config.startWithVideoMuted=true">Join voice call.</a></p>



<a name="429457349"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429457349" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429457349">(Mar 25 2024 at 16:27)</a>:</h4>
<p><code>print("Middle '", getDescriptor(126992).Id, "'\n");</code></p>



<a name="429477406"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429477406" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429477406">(Mar 25 2024 at 17:51)</a>:</h4>
<p>Pushed beta-r.<br>
Cleans umlauts on Windows only but I tested it on Mac</p>
<blockquote>
<p>[00]ü [01]  [02]ö <br>
Raw<br>
ü ö<br>
[00]FC [01]20 [02]F6 <br>
Cleaned<br>
ue oe<br>
[00]75 [01]65 [02]20 [03]6F [04]65</p>
</blockquote>
<p>Reming.ote builds just complet</p>



<a name="429480288"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429480288" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429480288">(Mar 25 2024 at 18:05)</a>:</h4>
<p>ReferenceError: identifier 'getDescriptor' undefined</p>



<a name="429480730"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429480730" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429480730">(Mar 25 2024 at 18:08)</a>:</h4>
<p>Supper calls.<br>
Are you testing with the all-in-one script with the print before, middle and after?</p>



<a name="429481027"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429481027" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429481027">(Mar 25 2024 at 18:10)</a>:</h4>
<p>Was with one line. With all three:</p>
<div class="codehilite"><pre><span></span><code>Before call
ReferenceError: identifier &#39;getDescriptor&#39; undefined
</code></pre></div>



<a name="429481154"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429481154" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429481154">(Mar 25 2024 at 18:11)</a>:</h4>
<p>Where is getDescriptor?</p>



<a name="429487192"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429487192" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429487192">(Mar 25 2024 at 18:50)</a>:</h4>
<p>Better speak tomorrow.   I will be available first thing.  Let me know when you available.</p>



<a name="429489421"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429489421" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429489421">(Mar 25 2024 at 19:03)</a>:</h4>
<p>Is 1000 ok?</p>



<a name="429490918"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429490918" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429490918">(Mar 25 2024 at 19:12)</a>:</h4>
<p>Sorry ... did not have the getDescriptor function in the console!!!</p>



<a name="429620187"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429620187" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429620187">(Mar 26 2024 at 10:04)</a>:</h4>
<p>Just pushed latest beta-s and built. Let me know when you have tried it with the getDescriptor included and ready to talk.</p>



<a name="429620279"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429620279" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429620279">(Mar 26 2024 at 10:04)</a>:</h4>
<p>Ok.</p>



<a name="429620358"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429620358" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429620358">(Mar 26 2024 at 10:05)</a>:</h4>
<p><a href="https://meet.jit.si/810787084015076#config.startWithVideoMuted=true">Join voice call.</a></p>



<a name="429621186"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429621186" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429621186">(Mar 26 2024 at 10:09)</a>:</h4>
<p>Whoops - compile error in that - stand by</p>



<a name="429621863"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429621863" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429621863">(Mar 26 2024 at 10:13)</a>:</h4>
<p>Fixed in Beta t - also building remotely now</p>



<a name="429623145"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429623145" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429623145">(Mar 26 2024 at 10:20)</a>:</h4>
<div class="codehilite" data-code-language="JavaScript"><pre><span></span><code><span class="nx">getDescriptor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s2">"pgnDescriptors"</span><span class="p">);</span>

<span class="nx">print</span><span class="p">(</span><span class="s2">"Before call\n"</span><span class="p">);</span>
<span class="nx">print</span><span class="p">(</span><span class="nx">getDescriptor</span><span class="p">(</span><span class="mf">126992</span><span class="p">).</span><span class="nx">Id</span><span class="p">,</span><span class="w"> </span><span class="s2">"\n"</span><span class="p">);</span>
<span class="nx">print</span><span class="p">(</span><span class="s2">"After call\n"</span><span class="p">);</span>
</code></pre></div>



<a name="429628371"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429628371" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429628371">(Mar 26 2024 at 10:49)</a>:</h4>
<div class="codehilite" data-code-language="JavaScript"><pre><span></span><code><span class="w">            </span><span class="s2">"RangeMin"</span><span class="o">:</span><span class="mf">0</span><span class="p">,</span>
<span class="w">            </span><span class="s2">"RangeMax"</span><span class="o">:</span><span class="mf">16777213</span><span class="p">}</span>

<span class="w">        </span><span class="p">]</span>
<span class="w">    </span><span class="p">};</span>
</code></pre></div>



<a name="429638948"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429638948" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429638948">(Mar 26 2024 at 11:58)</a>:</h4>
<div class="codehilite"><pre><span></span><code>948             &quot;Description&quot;:&quot;&#39;δ~i~&#39; in table 20-VI in ICD-GPS-200&quot;,
775             &quot;Description&quot;:&quot;&#39;̇Ω&#39; in table 20-VI in ICD-GPS-200&quot;,
8486                &quot;Description&quot;:&quot;&#39;̇Ω&#39; in table 20-VI in ICD-GPS-200&quot;,
8730                &quot;Description&quot;:&quot;&#39;√ a&#39; in table 20-VI in ICD-GPS-200&quot;,
8486                &quot;Description&quot;:&quot;&#39;Ω~0~&#39; in table 20-VI in ICD-GPS-200&quot;,
969             &quot;Description&quot;:&quot;&#39;ω&#39; in table 20-VI in ICD-GPS-200&quot;,
</code></pre></div>



<a name="429639752"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429639752" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429639752">(Mar 26 2024 at 12:03)</a>:</h4>
<div class="codehilite"><pre><span></span><code>    &quot;PGN&quot;:129541,
    &quot;Id&quot;:&quot;gpsAlmanacData&quot;,
    &quot;Description&quot;:&quot;GPS Almanac Data&quot;,
</code></pre></div>



<a name="429639871"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429639871" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429639871">(Mar 26 2024 at 12:04)</a>:</h4>
<p>I am removing the found characters and testing.</p>



<a name="429639921"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429639921" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429639921">(Mar 26 2024 at 12:04)</a>:</h4>
<p>Why not omit that PGN for now</p>



<a name="429639960"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429639960" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429639960">(Mar 26 2024 at 12:04)</a>:</h4>
<p>Ok.</p>



<a name="429640583"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429640583" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429640583">(Mar 26 2024 at 12:08)</a>:</h4>
<p>That works. Great stuff.</p>



<a name="429640766"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429640766" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429640766">(Mar 26 2024 at 12:09)</a>:</h4>
<p>Now can you please remove that PGN from the copy in data and then try this:</p>
<div class="codehilite" data-code-language="JavaScript"><pre><span></span><code><span class="nx">getDescriptor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s2">"pgnDescriptors"</span><span class="p">);</span>

<span class="nx">print</span><span class="p">(</span><span class="s2">"Before call\n"</span><span class="p">);</span>
<span class="nx">print</span><span class="p">(</span><span class="nx">getDescriptor</span><span class="p">(</span><span class="mf">126992</span><span class="p">).</span><span class="nx">Id</span><span class="p">,</span><span class="w"> </span><span class="s2">"\n"</span><span class="p">);</span>
<span class="nx">print</span><span class="p">(</span><span class="s2">"After call\n"</span><span class="p">);</span>
</code></pre></div>



<a name="429641238"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429641238" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429641238">(Mar 26 2024 at 12:12)</a>:</h4>
<p>Brilliant:</p>
<div class="codehilite"><pre><span></span><code>Before call
systemTime
After call
result: undefined
</code></pre></div>



<a name="429641504"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429641504" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429641504">(Mar 26 2024 at 12:14)</a>:</h4>
<p>Please now run the N2k decode/encode test</p>



<a name="429641573"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429641573" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429641573">(Mar 26 2024 at 12:14)</a>:</h4>
<p>110_n2k_encode_decode.js</p>



<a name="429641714"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429641714" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429641714">(Mar 26 2024 at 12:15)</a>:</h4>
<div class="codehilite"><pre><span></span><code>{
    &quot;PGN&quot;: 126992,
    &quot;id&quot;: &quot;systemTime&quot;,
    &quot;description&quot;: &quot;System Time&quot;,
    &quot;timestamp&quot;: &quot;undefined&quot;,
    &quot;priority&quot;: &quot;undefined&quot;,
    &quot;desination&quot;: &quot;undefined&quot;,
    &quot;origin&quot;: &quot;undefined&quot;,
    &quot;sid&quot;: &quot;undefined&quot;,
    &quot;source&quot;: &quot;undefined&quot;,
    &quot;date&quot;: &quot;undefined&quot;,
    &quot;time&quot;: &quot;undefined&quot;
}


Testing pgn 126992
Test 0 decode passed

Testing pgn 129540
Test 1 decode passed

Testing pgn 129029
Test 2 decode passed

Testing pgn 129285
Test 3 decode passed

Testing pgn 126996
Test 4 decode passed

Total time in main decode tests 503ms

Testing decode method with pgn 129540
Decode method passed

All decode tests passed

Encoding pgn 126992
Test 0 encode OK

Encoding pgn 129540
Test 1 encode OK

Encoding pgn 129029
Test 2 encode OK

Encoding pgn 129285
Test 3 encode OK

Encoding pgn 126996
Test 4 encode OK

Total time in encode tests 497ms
All encode tests passed
result: All tests passed
</code></pre></div>



<a name="429641820"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429641820" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429641820">(Mar 26 2024 at 12:16)</a>:</h4>
<p><a href="https://meet.jit.si/125688810952382#config.startWithVideoMuted=true">Join voice call.</a></p>



<a name="429672865"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429672865" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429672865">(Mar 26 2024 at 14:52)</a>:</h4>
<p>Testing on Linux:<br>
<a href="https://github.com/opencpn/OpenCPN/issues/1">#1</a> Removed Test Script 43 from 00_main.js. Not found. <br>
<a href="https://github.com/opencpn/OpenCPN/issues/2">#2</a> Parking consoles not working. <br>
<code>FindConsoleByCtx failed to match console</code><br>
Press OK and OpenCPN crashes<br>
Run from 44_parking.js and 00_main. js same result.</p>
<p>Parking button and  also scripts move consoles to top of screen but do not minimize them.</p>



<a name="429675565"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429675565" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429675565">(Mar 26 2024 at 15:03)</a>:</h4>
<p>Have put 129541 as an optional add on - <a href="https://github.com/antipole2/JavaScripts-shared/blob/main/descriptor129541/descriptor129541.adoc">see here</a>.</p>
<p>Will look at Linux issues now.</p>



<a name="429680948"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429680948" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429680948">(Mar 26 2024 at 15:27)</a>:</h4>
<blockquote>
<p><a href="https://github.com/opencpn/OpenCPN/issues/1">#1</a> Removed Test Script 43 from 00_main.js. Not found.<br>
File name had case mismatch.  Fixed for next try.</p>
</blockquote>
<p><a href="https://github.com/opencpn/OpenCPN/issues/2">#2</a><br>
This is programming error and having failed to find the console, there is no sane way out.<br>
Please clarify how you got there.  Did you press a parking button or run the parking test script?</p>



<a name="429681262"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429681262" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429681262">(Mar 26 2024 at 15:28)</a>:</h4>
<p>With some consoles parked but not minimised, please do a dump from the diagnostics tab of the tool and let me have it.</p>



<a name="429681735"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429681735" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429681735">(Mar 26 2024 at 15:30)</a>:</h4>
<p><a href="https://github.com/opencpn/OpenCPN/issues/3">#3</a> n2k encode/decode</p>
<div class="codehilite"><pre><span></span><code>Testing pgn 129540
script timed out
</code></pre></div>
<p>Removed this from n2k script</p>
<div class="codehilite"><pre><span></span><code>Testing pcn 129029
Script timed out
</code></pre></div>
<p>Now removing descriptors to try and trace the issue. Maybe I need the script you used this morning.</p>



<a name="429683929"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429683929" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429683929">(Mar 26 2024 at 15:40)</a>:</h4>
<p>Is your Linux machine old and slow?  Might it really be timing out?<br>
Do you get some output?  How far does it get before the time-out?</p>



<a name="429684698"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429684698" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429684698">(Mar 26 2024 at 15:43)</a>:</h4>
<blockquote>
<p>Is your Linux machine old and slow? </p>
</blockquote>
<p>Yes.<br>
Some output from Test 1</p>



<a name="429684745"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429684745" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429684745">(Mar 26 2024 at 15:43)</a>:</h4>
<p>Line 127 of the test script is<br>
<code>timeAlloc(1000);   // more time may be needed</code><br>
because I reckoned it might be running out of time by then.<br>
Try giving it more time with, say,<br>
<code>timeAlloc(3000);   // more time may be needed</code><br>
placed near the beginning</p>



<a name="429685094"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429685094" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429685094">(Mar 26 2024 at 15:45)</a>:</h4>
<blockquote>
<p>This is programming error and having failed to find the console, there is no sane way out.<br>
Please clarify how you got there. Did you press a parking button or run the parking test script?</p>
</blockquote>
<p>Both tried.</p>



<a name="429685178"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429685178" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429685178">(Mar 26 2024 at 15:45)</a>:</h4>
<p>JavaScript plugin version 3.0<br>
JavaScript patch 0<br>
JavaScript tools window DPI scaling factor 1.000000<br>
wxWidgets version 3.2.2.0 or 3202<br>
OCPN API version 1.18<br>
Duktape version 20700<br>
Not using svg<br>
pJavaScript_pi-&gt;m_pconfig                   0x009c726000<br>
pJavaScript_pi-&gt;m_parent_window         0x009cef35b0<br>
pJavaScript_pi-&gt;m_floatOnTop                false<br>
pJavaScript_pi-&gt;mRememberToggleStatus   false<br>
favouriteFiles:<br>
recentFiles:<br>
    /home/mike/Documents/JavaScript_pi/Tests_scripts/110_n2k_encode_decode.js<br>
    /home/mike/Documents/JavaScript_pi/Tests_scripts/00_main.js<br>
    /home/mike/Documents/JavaScript_pi/Tests_scripts/54_stop_explicit_callback.js<br>
N2K pgn registrations: none<br>
pJavaScript_pi-&gt;mpFirstConsole  0x009e61a240</p>
<p>----------Console PluginTests----------<br>
Console name:       PluginTests<br>
this:                   0x009e61a240<br>
mpNextConsole:      nullptr<br>
mStatus:                (no status)<br>
mRunningMain:       false<br>
m_time_to_allocate: 1000ms<br>
m_timeout_check_counter:    0<br>
mWaitingCached:     true<br>
mWaiting:           false<br>
mpMessageDialog:    nullptr<br>
isBusy():               false<br>
isWaiting():            false<br>
auto_run:           false<br>
position:               screen x:274 y:347  DIP x:274 y:347<br>
Size():             x:738 y:600 DIP x:738 y:600 MinSize() x:142 y:37<br>
m_parked:           true<br>
isParked():         false<br>
parked Location     74  27  size 142    37<br>
notParked location  235 90  size 738    600<br>
Messages callback table<br>
    OCPN_CORE_SIGNALK<br>
    OCPN_OPENGL_CONFIG<br>
    OpenCPN Config<br>
    WMM_VARIATION_BOAT<br>
m_timerActionBusy:  false<br>
Timers callback table<br>
    (empty)<br>
Menus callback table<br>
    (empty)<br>
m_dialog:           None<br>
m_alert:                None<br>
m_NMEAmessageFunction:      <br>
m_streamMessageCntlsVector  &lt;empty&gt;<br>
m_activeLegFunction:        <br>
m_exitFunction: <br>
m_closeButtonFunction:  <br>
m_explicitResult:       false<br>
m_result:               <br>
mscriptToBeRun: false<br>
No brief<br>
mConsoleRepliesAwaited  0<br>
m_remembered    <br>
wxFile ids - none<br>
No Duktape context</p>
<hr>
<p>pJavaScript_pi-&gt;mpBin       nullptr</p>
<p>End of dump</p>



<a name="429685642"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429685642" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429685642">(Mar 26 2024 at 15:47)</a>:</h4>
<p>I'll look at the dump now.</p>
<p>The tests take 334ms on my MacBook M2.  I can well imagine your old machine needs longer.  Suggest you refrain from messing with the descriptors.  They are loading OK or you would not ave got as far as you have.</p>



<a name="429685973"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429685973" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429685973">(Mar 26 2024 at 15:49)</a>:</h4>
<p>But the PGN where it stops is 129540, the one before 129541 which caused the Windows problem.</p>



<a name="429686793"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429686793" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429686793">(Mar 26 2024 at 15:52)</a>:</h4>
<p>129540 is big compared with th others.  The script runs all the decoding tests with only the default time of 1000ms for all three.  It does not allocate more time between each test (as written at present).  Feels like it is just running out of time.</p>



<a name="429687119"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429687119" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429687119">(Mar 26 2024 at 15:54)</a>:</h4>
<p>Tried 5000 at line 127 but still times out.</p>



<a name="429687826"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429687826" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429687826">(Mar 26 2024 at 15:57)</a>:</h4>
<p>That is after all the decoding tests have completed.<br>
Put it near the beginning, say before the loop at line 83</p>
<p>PS I can tell you how to turn on tracing within the decoding if w have to go there.</p>



<a name="429688093"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429688093" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429688093">(Mar 26 2024 at 15:58)</a>:</h4>
<p>Or give it 2000 ms per test by placing inside the loop at the start</p>



<a name="429688430"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429688430" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429688430">(Mar 26 2024 at 16:00)</a>:</h4>
<p>Same and same again with these edits.</p>



<a name="429689387"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429689387" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429689387">(Mar 26 2024 at 16:04)</a>:</h4>
<p>Test script line 88, near end set <code>trace:true</code></p>



<a name="429690801"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429690801" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429690801">(Mar 26 2024 at 16:10)</a>:</h4>
<div class="codehilite"><pre><span></span><code>Testing pgn 126992
NMEA2000 called with arg type number
arg is number 126992
parse for pgn 126992
Test 0 decode passed

Testing pgn 129540
NMEA2000 called with arg type number
arg is number 129540
Script timed out
</code></pre></div>



<a name="429692534"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429692534" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429692534">(Mar 26 2024 at 16:19)</a>:</h4>
<p>My line 83<br>
<code>for (t = 0; t &lt; tests.length; t++){</code><br>
change to <code>t = 1</code> to omit first test.<br>
Then on my line 88 change to trace:3<br>
This will cause it to print the descriptor as it has constructed it.</p>



<a name="429692998"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429692998" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429692998">(Mar 26 2024 at 16:22)</a>:</h4>
<div class="codehilite"><pre><span></span><code>{
    &quot;PGN&quot;: 126992,
    &quot;id&quot;: &quot;systemTime&quot;,
    &quot;description&quot;: &quot;System Time&quot;,
    &quot;timestamp&quot;: &quot;undefined&quot;,
    &quot;priority&quot;: &quot;undefined&quot;,
    &quot;desination&quot;: &quot;undefined&quot;,
    &quot;origin&quot;: &quot;undefined&quot;,
    &quot;sid&quot;: &quot;undefined&quot;,
    &quot;source&quot;: &quot;undefined&quot;,
    &quot;date&quot;: &quot;undefined&quot;,
    &quot;time&quot;: &quot;undefined&quot;
}


Testing pgn 129540
NMEA2000 called with arg type number
arg is number 129540

{
    &quot;PGN&quot;: 129540,
    &quot;Id&quot;: &quot;gnssSatsInView&quot;,
    &quot;Description&quot;: &quot;GNSS Sats in View&quot;,
    &quot;Type&quot;: &quot;Fast&quot;,
    &quot;Complete&quot;: true,
    &quot;Length&quot;: 3,
    &quot;RepeatingFieldSet1Size&quot;: 7,
    &quot;RepeatingFieldSet1StartField&quot;: 5,
    &quot;RepeatingFieldSet1CountField&quot;: 4,
    &quot;Fields&quot;: [
        0,
        {
            &quot;Order&quot;: 1,
            &quot;Id&quot;: &quot;sid&quot;,
            &quot;Name&quot;: &quot;SID&quot;,
            &quot;BitLength&quot;: 8,
            &quot;BitOffset&quot;: 0,
            &quot;BitStart&quot;: 0,
            &quot;Type&quot;: &quot;Integer&quot;,
            &quot;Resolution&quot;: 1,
            &quot;Signed&quot;: false,
            &quot;RangeMin&quot;: 0,
            &quot;RangeMax&quot;: 253
        },
        {
            &quot;Order&quot;: 2,
            &quot;Id&quot;: &quot;rangeResidualMode&quot;,
            &quot;Name&quot;: &quot;Range Residual Mode&quot;,
            &quot;BitLength&quot;: 2,
            &quot;BitOffset&quot;: 8,
            &quot;BitStart&quot;: 0,
            &quot;Type&quot;: &quot;Lookup table&quot;,
            &quot;Resolution&quot;: 1,
            &quot;Signed&quot;: false,
            &quot;RangeMin&quot;: 0,
            &quot;RangeMax&quot;: 2,
            &quot;EnumValues&quot;: [
                {
                    &quot;name&quot;: &quot;Range residuals were used to calculate data&quot;,
                    &quot;value&quot;: 0
                },
                {
                    &quot;name&quot;: &quot;Range residuals were calculated after the position&quot;,
                    &quot;value&quot;: 1
                }
            ]
        },
        {
            &quot;Order&quot;: 3,
            &quot;Id&quot;: &quot;reserved&quot;,
            &quot;Name&quot;: &quot;Reserved&quot;,
            &quot;BitLength&quot;: 6,
            &quot;BitOffset&quot;: 10,
            &quot;BitStart&quot;: 2,
            &quot;Resolution&quot;: 1,
            &quot;Signed&quot;: false
        },
        {
            &quot;Order&quot;: 4,
            &quot;Id&quot;: &quot;satsInView&quot;,
            &quot;Name&quot;: &quot;Sats in View&quot;,
            &quot;BitLength&quot;: 8,
            &quot;BitOffset&quot;: 16,
            &quot;BitStart&quot;: 0,
            &quot;Type&quot;: &quot;Integer&quot;,
            &quot;Resolution&quot;: 1,
            &quot;Signed&quot;: false,
            &quot;RangeMin&quot;: 0,
            &quot;RangeMax&quot;: 253
        },
        {
            &quot;Order&quot;: 5,
            &quot;Id&quot;: &quot;prn&quot;,
            &quot;Name&quot;: &quot;PRN&quot;,
            &quot;BitLength&quot;: 8,
            &quot;BitOffset&quot;: 24,
            &quot;BitStart&quot;: 0,
            &quot;Type&quot;: &quot;Integer&quot;,
            &quot;Resolution&quot;: 1,
            &quot;Signed&quot;: false,
            &quot;RangeMin&quot;: 0,
            &quot;RangeMax&quot;: 253
        },
        {
            &quot;Order&quot;: 6,
            &quot;Id&quot;: &quot;elevation&quot;,
            &quot;Name&quot;: &quot;Elevation&quot;,
            &quot;BitLength&quot;: 16,
            &quot;BitOffset&quot;: 32,
            &quot;BitStart&quot;: 0,
            &quot;Units&quot;: &quot;rad&quot;,
            &quot;Type&quot;: &quot;Number&quot;,
            &quot;Resolution&quot;: 0.0001,
            &quot;Signed&quot;: true,
            &quot;RangeMin&quot;: -3.2767,
            &quot;RangeMax&quot;: 3.2765
        },
        {
            &quot;Order&quot;: 7,
            &quot;Id&quot;: &quot;azimuth&quot;,
            &quot;Name&quot;: &quot;Azimuth&quot;,
            &quot;BitLength&quot;: 16,
            &quot;BitOffset&quot;: 48,
            &quot;BitStart&quot;: 0,
            &quot;Units&quot;: &quot;rad&quot;,
            &quot;Type&quot;: &quot;Number&quot;,
            &quot;Resolution&quot;: 0.0001,
            &quot;Signed&quot;: false,
            &quot;RangeMin&quot;: 0,
            &quot;RangeMax&quot;: 6.5533
        },
        {
            &quot;Order&quot;: 8,
            &quot;Id&quot;: &quot;snr&quot;,
            &quot;Name&quot;: &quot;SNR&quot;,
            &quot;BitLength&quot;: 16,
            &quot;BitOffset&quot;: 64,
            &quot;BitStart&quot;: 0,
            &quot;Units&quot;: &quot;dB&quot;,
            &quot;Type&quot;: &quot;Number&quot;,
            &quot;Resolution&quot;: 0.01,
            &quot;Signed&quot;: false,
            &quot;RangeMin&quot;: 0,
            &quot;RangeMax&quot;: 655.33
        },
        {
            &quot;Order&quot;: 9,
            &quot;Id&quot;: &quot;rangeResiduals&quot;,
            &quot;Name&quot;: &quot;Range residuals&quot;,
            &quot;BitLength&quot;: 32,
            &quot;BitOffset&quot;: 80,
            &quot;BitStart&quot;: 0,
            &quot;Type&quot;: &quot;Integer&quot;,
            &quot;Resolution&quot;: 1,
            &quot;Signed&quot;: true,
            &quot;RangeMin&quot;: -2147483647,
            &quot;RangeMax&quot;: 2147483645
        },
        {
            &quot;Order&quot;: 10,
            &quot;Id&quot;: &quot;status&quot;,
            &quot;Name&quot;: &quot;Status&quot;,
            &quot;BitLength&quot;: 4,
            &quot;BitOffset&quot;: 112,
            &quot;BitStart&quot;: 0,
            &quot;Type&quot;: &quot;Lookup table&quot;,
            &quot;Resolution&quot;: 1,
            &quot;Signed&quot;: false,
            &quot;RangeMin&quot;: 0,
            &quot;RangeMax&quot;: 13,
            &quot;EnumValues&quot;: [
                {
                    &quot;name&quot;: &quot;Not tracked&quot;,
                    &quot;value&quot;: 0
                },
                {
                    &quot;name&quot;: &quot;Tracked&quot;,
                    &quot;value&quot;: 1
                },
                {
                    &quot;name&quot;: &quot;Used&quot;,
                    &quot;value&quot;: 2
                },
                {
                    &quot;name&quot;: &quot;Not tracked+Diff&quot;,
                    &quot;value&quot;: 3
                },
                {
                    &quot;name&quot;: &quot;Tracked+Diff&quot;,
                    &quot;value&quot;: 4
                },
                {
                    &quot;name&quot;: &quot;Used+Diff&quot;,
                    &quot;value&quot;: 5
                }
            ]
        },
        {
            &quot;Order&quot;: 11,
            &quot;Id&quot;: &quot;reserved11&quot;,
            &quot;Name&quot;: &quot;Reserved&quot;,
            &quot;BitLength&quot;: 4,
            &quot;BitOffset&quot;: 116,
            &quot;BitStart&quot;: 4,
            &quot;Resolution&quot;: 1,
            &quot;Signed&quot;: false
        }
    ]
}

Repeating fields - repeat1Size:7    repeat1StartField:5 repeat1CountField:4 repeatName:satsInView
parse for pgn 129540
Test 1 decode passed

Testing pgn 129029
NMEA2000 called with arg type number
arg is number 129029
Script timed out
</code></pre></div>



<a name="429693667"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429693667" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429693667">(Mar 26 2024 at 16:25)</a>:</h4>
<p>Better to talk<br>
<a href="https://meet.jit.si/316026523466844#config.startWithVideoMuted=true">Join voice call.</a></p>



<a name="429701917"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429701917" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429701917">(Mar 26 2024 at 17:09)</a>:</h4>
<p>I need. to start cooking for this evening, but will keep an eye on Zulip from the kitchen.<br>
I am perplexed.  When the tests start with t = 0, it completed the 0'th test and times out on 1.<br>
When you start with t -= 1, it completes test 1 (which it timed out on previously), and times out on the next.<br>
So it always completes the first and times out on the second, whether you start on 0 or 1.<br>
That seems like a lack of time issue.  I thought you had added <code>timeAlloc(3000); </code> just inside the loop so it gets a fresh 3 seconds at the start of each test?  Is that still there?</p>



<a name="429707804"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429707804" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429707804">(Mar 26 2024 at 17:42)</a>:</h4>
<p>Increased time in the loop to 9000 and all tests run.<br>
Time taken 2802 ms</p>



<a name="429707984"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429707984" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429707984">(Mar 26 2024 at 17:43)</a>:</h4>
<p>Time in encode 3543 ms</p>



<a name="429709525"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429709525" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429709525">(Mar 26 2024 at 17:52)</a>:</h4>
<p>Now for parking.<br>
Still not sure when you hit that message.<br>
With two console, neither running, please park one if you can.  I understand it will move up but not minimise.<br>
Then take a dump and let me have that.</p>



<a name="429710234"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429710234" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429710234">(Mar 26 2024 at 17:55)</a>:</h4>
<div class="codehilite"><pre><span></span><code>JavaScript plugin version 3.0
JavaScript patch 0
JavaScript tools window DPI scaling factor 1.000000
wxWidgets version 3.2.2.0 or 3202
OCPN API version 1.18
Duktape version 20700
Not using svg
pJavaScript_pi-&gt;m_pconfig                   0x00897ad730
pJavaScript_pi-&gt;m_parent_window         0x008a01c570
pJavaScript_pi-&gt;m_floatOnTop                false
pJavaScript_pi-&gt;mRememberToggleStatus   false
favouriteFiles:
recentFiles:
    /home/mike/Documents/JavaScript_pi/Tests_scripts/110_n2k_encode_decode.js
    /home/mike/Documents/JavaScript_pi/Tests_scripts/74_dialogue_test.js
    /home/mike/Documents/JavaScript_pi/Tests_scripts/00_main.js
    /home/mike/Documents/JavaScript_pi/Tests_scripts/54_stop_explicit_callback.js
N2K pgn registrations: none
pJavaScript_pi-&gt;mpFirstConsole  0x008b74e1d0

----------Console PluginTests----------
Console name:       PluginTests
this:                   0x008b74e1d0
mpNextConsole:      0x008de878c0
mStatus:                (no status)
mRunningMain:       false
m_time_to_allocate: 1000ms
m_timeout_check_counter:    -454893342
mWaitingCached:     true
mWaiting:           false
mpMessageDialog:    nullptr
isBusy():               false
isWaiting():            false
auto_run:           false
position:               screen x:487 y:101  DIP x:487 y:101
Size():             x:738 y:600 DIP x:738 y:600 MinSize() x:142 y:37
m_parked:           false
isParked():         false
parked Location     74  27  size 142    37
notParked location  398 100 size 738    600
Messages callback table
    OCPN_CORE_SIGNALK
    OCPN_OPENGL_CONFIG
    OpenCPN Config
    WMM_VARIATION_BOAT
m_timerActionBusy:  false
Timers callback table
    (empty)
Menus callback table
    (empty)
m_dialog:           None
m_alert:                None
m_NMEAmessageFunction:
m_streamMessageCntlsVector  &lt;empty&gt;
m_activeLegFunction:
m_exitFunction:
m_closeButtonFunction:
m_explicitResult:       false
m_result:
mscriptToBeRun: false
No brief
mConsoleRepliesAwaited  0
m_remembered
wxFile ids - none
No Duktape context

----------Console test----------
Console name:       test
this:                   0x008de878c0
mpNextConsole:      nullptr
mStatus:                (no status)
mRunningMain:       false
m_time_to_allocate: 1000ms
m_timeout_check_counter:    -1
mWaitingCached:     true
mWaiting:           false
mpMessageDialog:    nullptr
isBusy():               false
isWaiting():            false
auto_run:           false
position:               screen x:221 y:27   DIP x:221 y:27
Size():             x:738 y:600 DIP x:738 y:600 MinSize() x:93 y:37
m_parked:           true
isParked():         true
parked Location     221 27  size 93 37
notParked location  313 119 size 738    600
Messages callback table
    WMM_VARIATION_BOAT
m_timerActionBusy:  false
Timers callback table
    (empty)
Menus callback table
    (empty)
m_dialog:           None
m_alert:                None
m_NMEAmessageFunction:
m_streamMessageCntlsVector  &lt;empty&gt;
m_activeLegFunction:
m_exitFunction:
m_closeButtonFunction:
m_explicitResult:       false
m_result:
mscriptToBeRun: false
No brief
mConsoleRepliesAwaited  0
m_remembered
wxFile ids - none
No Duktape context

----------------------------------------------------

pJavaScript_pi-&gt;mpBin       nullptr

End of dump
</code></pre></div>



<a name="429712433"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429712433" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429712433">(Mar 26 2024 at 18:09)</a>:</h4>
<p>Re issue <a href="https://github.com/opencpn/OpenCPN/issues/1">#1</a>, in <code>Tests_scripts/00_main.js</code> line 67, the file name should be <code>"43_files.js"</code> (lower case).</p>



<a name="429712628"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429712628" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429712628">(Mar 26 2024 at 18:10)</a>:</h4>
<p>Must attend to meal now - back tomorrow.</p>



<a name="429818544"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429818544" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429818544">(Mar 27 2024 at 09:42)</a>:</h4>
<p>Files Object now working from 00_main.js and the script itself.</p>



<a name="429818847"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429818847" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429818847">(Mar 27 2024 at 09:44)</a>:</h4>
<p>Good.  I have found issues with parking.  Am working on it, so please hold off further testing.</p>



<a name="429852330"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429852330" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429852330">(Mar 27 2024 at 12:52)</a>:</h4>
<p>Bit of a red herring on parking.  Anyhow, sorted now.<br>
Just pushed beta-u to GitHub and build into beta repo.<br>
Re Linux, please check if still have parking problem.</p>
<ol>
<li>With a console unparked, take a dump via the tools</li>
<li>Park it using the park button.</li>
<li>Does it minimise correctly?  If not, please take another dump.</li>
</ol>
<p>The pgn descriptors now lack the one causing the problem.<br>
The main test script has the fix for the mixed case file name.</p>
<p>thanks</p>



<a name="429855106"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429855106" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429855106">(Mar 27 2024 at 13:08)</a>:</h4>
<p>And if problem screen shot of wrong sized parked console</p>



<a name="429870121"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429870121" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429870121">(Mar 27 2024 at 14:19)</a>:</h4>
<div class="codehilite"><pre><span></span><code>JavaScript plugin version 3.0
JavaScript patch 0
JavaScript tools window DPI scaling factor 1.000000
wxWidgets version 3.2.2.0 or 3202
OCPN API version 1.18
Duktape version 20700
Not using svg
pJavaScript_pi-&gt;m_pconfig                   0x00e85f3000
pJavaScript_pi-&gt;m_parent_window         0x00e8caa000
pJavaScript_pi-&gt;m_floatOnTop                false
pJavaScript_pi-&gt;mRememberToggleStatus   false
favouriteFiles:
recentFiles:
    /home/mike/Documents/JavaScript_pi/Tests_scripts/00_main.js
    /home/mike/Documents/JavaScript_pi/Tests_scripts/43_files.js
    /home/mike/Documents/JavaScript_pi/Tests_scripts/110_n2k_encode_decode.js
    /home/mike/Documents/JavaScript_pi/Tests_scripts/74_dialogue_test.js
    /home/mike/Documents/JavaScript_pi/Tests_scripts/54_stop_explicit_callback.js
N2K pgn registrations: none
pJavaScript_pi-&gt;mpFirstConsole  0x00eae980a0

----------Console PluginTests----------
Console name:       PluginTests
this:                   0x00eae980a0
mpNextConsole:      nullptr
mStatus:                DONE
mRunningMain:       false
m_time_to_allocate: 1000ms
m_timeout_check_counter:    1
mWaitingCached:     true
mWaiting:           false
mpMessageDialog:    nullptr
isBusy():               false
isWaiting():            false
auto_run:           false
position:               screen x:414 y:121  DIP x:414 y:121
Size():             x:738 y:600 DIP x:738 y:600 MinSize() x:142 y:37
m_parked:           true
isParked():         false
parked Location     74  27  size 142    37
notParked location  231 77  size 738    600
Messages callback table
    OCPN_CORE_SIGNALK
    OCPN_OPENGL_CONFIG
    OpenCPN Config
    WMM_VARIATION_BOAT
m_timerActionBusy:  false
Timers callback table
    (empty)
Menus callback table
    (empty)
m_dialog:           None
m_alert:                None
m_NMEAmessageFunction:
m_streamMessageCntlsVector  &lt;empty&gt;
m_activeLegFunction:
m_exitFunction:
m_closeButtonFunction:
m_explicitResult:       false
m_result:               undefined
mscriptToBeRun: false
No brief
mConsoleRepliesAwaited  0
m_remembered
wxFile ids - none
No Duktape context

----------------------------------------------------

pJavaScript_pi-&gt;mpBin       nullptr

End of dump
</code></pre></div>
<p><a href="/user_uploads/33951/_9l3EwTnujyiTiFzYBZe75ZF/Screenshot-from-2024-03-27-14-18-00.png">Screenshot-from-2024-03-27-14-18-00.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/33951/_9l3EwTnujyiTiFzYBZe75ZF/Screenshot-from-2024-03-27-14-18-00.png" title="Screenshot-from-2024-03-27-14-18-00.png"><img src="/user_uploads/33951/_9l3EwTnujyiTiFzYBZe75ZF/Screenshot-from-2024-03-27-14-18-00.png"></a></div>



<a name="429870579"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429870579" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429870579">(Mar 27 2024 at 14:21)</a>:</h4>
<div class="codehilite"><pre><span></span><code>JavaScript plugin version 3.0
JavaScript patch 0
JavaScript tools window DPI scaling factor 1.000000
wxWidgets version 3.2.2.0 or 3202
OCPN API version 1.18
Duktape version 20700
Not using svg
pJavaScript_pi-&gt;m_pconfig                   0x00e85f3000
pJavaScript_pi-&gt;m_parent_window         0x00e8caa000
pJavaScript_pi-&gt;m_floatOnTop                false
pJavaScript_pi-&gt;mRememberToggleStatus   false
favouriteFiles:
recentFiles:
    /home/mike/Documents/JavaScript_pi/Tests_scripts/00_main.js
    /home/mike/Documents/JavaScript_pi/Tests_scripts/43_files.js
    /home/mike/Documents/JavaScript_pi/Tests_scripts/110_n2k_encode_decode.js
    /home/mike/Documents/JavaScript_pi/Tests_scripts/74_dialogue_test.js
    /home/mike/Documents/JavaScript_pi/Tests_scripts/54_stop_explicit_callback.js
N2K pgn registrations: none
pJavaScript_pi-&gt;mpFirstConsole  0x00eae980a0

----------Console PluginTests----------
Console name:       PluginTests
this:                   0x00eae980a0
mpNextConsole:      nullptr
mStatus:                DONE
mRunningMain:       false
m_time_to_allocate: 1000ms
m_timeout_check_counter:    1
mWaitingCached:     true
mWaiting:           false
mpMessageDialog:    nullptr
isBusy():               false
isWaiting():            false
auto_run:           false
position:               screen x:74 y:27    DIP x:74 y:27
Size():             x:738 y:600 DIP x:738 y:600 MinSize() x:142 y:37
m_parked:           true
isParked():         true
parked Location     74  27  size 142    37
notParked location  414 121 size 738    600
Messages callback table
    OCPN_CORE_SIGNALK
    OCPN_OPENGL_CONFIG
    OpenCPN Config
    WMM_VARIATION_BOAT
m_timerActionBusy:  false
Timers callback table
    (empty)
Menus callback table
    (empty)
m_dialog:           None
m_alert:                None
m_NMEAmessageFunction:
m_streamMessageCntlsVector  &lt;empty&gt;
m_activeLegFunction:
m_exitFunction:
m_closeButtonFunction:
m_explicitResult:       false
m_result:               undefined
mscriptToBeRun: false
No brief
mConsoleRepliesAwaited  0
m_remembered
wxFile ids - none
No Duktape context

----------------------------------------------------

pJavaScript_pi-&gt;mpBin       nullptr

End of dump
</code></pre></div>



<a name="429880555"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429880555" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429880555">(Mar 27 2024 at 14:59)</a>:</h4>
<p>On Linux, you have a parked console which has not shrunk.  Please</p>
<ol>
<li>Unpark it by clicking on the Close button.  It should spring back to where it was before it was parked.  (If it deletes it was not parked).</li>
<li>Repark it usung the button.</li>
<li>Is it still too big or does it shrink this time?</li>
</ol>
<p>By the way, the parking button should be the letter P on a blue background.  On teh screenshot you sent it was solid red. Is that so?  And why?</p>



<a name="429883515"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429883515" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429883515">(Mar 27 2024 at 15:12)</a>:</h4>
<p>Unpark - springs back<br>
Repark - still too big.<br>
Windows - blue button, no "P".<br>
Linux - red button, no "P". I don't know the reason. <br>
BTW on my Linux display the tools captions are not shown.  Tried changing screen properties but this did not help. My graphics card is rubbish. This may be the reason.</p>



<a name="429884455"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429884455" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429884455">(Mar 27 2024 at 15:16)</a>:</h4>
<p>Looks like Linux has something difficult about setting window size. <br>
Have tracing to investigate.  I could give you the extra statements. Are you building on Linux? <br>
Otherwise I can remote build for you.</p>



<a name="429884928"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429884928" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429884928">(Mar 27 2024 at 15:18)</a>:</h4>
<p>Sorry ... not building on Linux here.</p>



<a name="429884995"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429884995" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429884995">(Mar 27 2024 at 15:18)</a>:</h4>
<p>OK will build for you.</p>



<a name="429888187"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429888187" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429888187">(Mar 27 2024 at 15:32)</a>:</h4>
<p>Just built into my <strong>alpha repo</strong> <a href="https://cloudsmith.io/~opencpn/repos/javascript-alpha/packages/">https://cloudsmith.io/~opencpn/repos/javascript-alpha/packages/</a> version with extra tracing.<br>
Please park a console and let me have the trace.</p>



<a name="429889064"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429889064" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429889064">(Mar 27 2024 at 15:36)</a>:</h4>
<div class="codehilite"><pre><span></span><code>L25 PluginTests OnPark start
L25 PluginTests-&gt;isParked() already false
L25 PluginTests-&gt;getLocation()returning position    521 119 size 738    600
L25 PluginTests-&gt;park() parking called with minSize X:142  Y:37
L25 PluginTests-&gt;park() readback of client size X:142  Y:0
L25 PluginTests-&gt;park() readback of size X:142  Y:37
L25 PluginTests-&gt;park() reparking
L25 PluginTests-&gt;setLocation() setting position 74  27  size 142    37
L25 PluginTests-&gt;park() finished reparking
L25 PluginTests OnPark finished
</code></pre></div>



<a name="429899087"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429899087" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429899087">(Mar 27 2024 at 16:20)</a>:</h4>
<p>It appears that SetSize( ) just does not do anything.  It its the size OK in that I can read it back with GetSize but the displayed size does not change.  You could try moving the console window in case it lacks a redraw?<br>
I have just pushed another alpha build that that sets the window height bigger than the minimum I was using - in case it cannot cope with that.  If it is resized, it will be smaller but   twice the normal parked height.</p>



<a name="429900990"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429900990" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429900990">(Mar 27 2024 at 16:29)</a>:</h4>
<p>That works. Good. Now to run the parking test.</p>



<a name="429901311"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429901311" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429901311">(Mar 27 2024 at 16:31)</a>:</h4>
<p>You mean it made the window smaller but twice height as normal?  <br>
Hold off the parking tests - not finished yet.</p>



<a name="429910096"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429910096" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429910096">(Mar 27 2024 at 17:15)</a>:</h4>
<p>Parked consoles about 1.5 times minimum. Consoles D and E overlap 70%.</p>



<a name="429911319"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429911319" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429911319">(Mar 27 2024 at 17:23)</a>:</h4>
<p>Just pushed/building another at 17:20, with Y set to 1 rather than 0 in Linux only.  Could give much smaller oversize.<br>
Console test script too complicated until basics sorted.<br>
Please test and park two consoles and let me have screen shot and trace.<br>
Thanks</p>



<a name="429912020"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429912020" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429912020">(Mar 27 2024 at 17:27)</a>:</h4>
<div class="codehilite"><pre><span></span><code>L25 second OnPark start
L25 second-&gt;isParked() already false
L25 second-&gt;getLocation()returning position 309 91  size 738    600
L25 second-&gt;park() parking called with minSize X:114  Y:37
L25 second-&gt;park() readback of client size X:114  Y:1
L25 second-&gt;park() readback of size X:114  Y:38
L25 second-&gt;park() parking first time
L25 PluginTests-&gt;isParked() already false
L25 second-&gt;setLocation() setting position  221 27  size 114    38
L25 second-&gt;park() parking at X:221  Y:27 frame
L25 second OnPark finished
L25 PluginTests OnPark start
L25 PluginTests-&gt;isParked() already false
L25 PluginTests-&gt;getLocation()returning position    340 92  size 828    616
L25 PluginTests-&gt;park() parking called with minSize X:142  Y:37
L25 PluginTests-&gt;park() readback of client size X:142  Y:1
L25 PluginTests-&gt;park() readback of size X:142  Y:38
L25 PluginTests-&gt;park() reparking
L25 PluginTests-&gt;setLocation() setting position 74  27  size 142    38
L25 PluginTests-&gt;park() readback of parked size X:142  Y:38
L25 PluginTests-&gt;park() finished re-parking
L25 PluginTests OnPark finished
</code></pre></div>



<a name="429912385"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429912385" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429912385">(Mar 27 2024 at 17:29)</a>:</h4>
<p><a href="/user_uploads/33951/jeFyVf71qcuOz0j5kmcRPdxL/Screenshot-from-2024-03-27-17-28-23.png">Screenshot-from-2024-03-27-17-28-23.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/33951/jeFyVf71qcuOz0j5kmcRPdxL/Screenshot-from-2024-03-27-17-28-23.png" title="Screenshot-from-2024-03-27-17-28-23.png"><img src="/user_uploads/33951/jeFyVf71qcuOz0j5kmcRPdxL/Screenshot-from-2024-03-27-17-28-23.png"></a></div>



<a name="429912661"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429912661" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429912661">(Mar 27 2024 at 17:30)</a>:</h4>
<p>Yes!!  OK please run test script and screenshot if not right.</p>



<a name="429913463"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429913463" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429913463">(Mar 27 2024 at 17:35)</a>:</h4>
<p>Just that overlap with consoles D and E at the start. After re-sizing at step 2 of the script the overlap disappears.</p>



<a name="429913539"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429913539" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429913539">(Mar 27 2024 at 17:35)</a>:</h4>
<p>screenshot please</p>



<a name="429914878"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429914878" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429914878">(Mar 27 2024 at 17:43)</a>:</h4>
<p><a href="/user_uploads/33951/BfmE5zh26pPxQeO4R5WePIgL/Screenshot-from-2024-03-27-17-39-39.png">Screenshot-from-2024-03-27-17-39-39.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/33951/BfmE5zh26pPxQeO4R5WePIgL/Screenshot-from-2024-03-27-17-39-39.png" title="Screenshot-from-2024-03-27-17-39-39.png"><img src="/user_uploads/33951/BfmE5zh26pPxQeO4R5WePIgL/Screenshot-from-2024-03-27-17-39-39.png"></a></div><p><a href="/user_uploads/33951/1rCNh-Aw6Z9sGBsoDLKSDna3/Screenshot-from-2024-03-27-17-40-28.png">Screenshot-from-2024-03-27-17-40-28.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/33951/1rCNh-Aw6Z9sGBsoDLKSDna3/Screenshot-from-2024-03-27-17-40-28.png" title="Screenshot-from-2024-03-27-17-40-28.png"><img src="/user_uploads/33951/1rCNh-Aw6Z9sGBsoDLKSDna3/Screenshot-from-2024-03-27-17-40-28.png"></a></div><p><a href="/user_uploads/33951/JmI6szI3I-C3OqMyXVVp-fuc/Screenshot-from-2024-03-27-17-41-19.png">Screenshot-from-2024-03-27-17-41-19.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/33951/JmI6szI3I-C3OqMyXVVp-fuc/Screenshot-from-2024-03-27-17-41-19.png" title="Screenshot-from-2024-03-27-17-41-19.png"><img src="/user_uploads/33951/JmI6szI3I-C3OqMyXVVp-fuc/Screenshot-from-2024-03-27-17-41-19.png"></a></div>



<a name="429916258"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429916258" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429916258">(Mar 27 2024 at 17:51)</a>:</h4>
<p>Parked console can be re-sized. Also returns to correct size when closed.</p>



<a name="429916545"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429916545" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429916545">(Mar 27 2024 at 17:53)</a>:</h4>
<p>So its only the first step that is wrong.</p>



<a name="429917496"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429917496" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429917496">(Mar 27 2024 at 17:58)</a>:</h4>
<p>At step one when Console E is overlapping Console D, please take a dump.</p>



<a name="429946572"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/429946572" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#429946572">(Mar 27 2024 at 20:49)</a>:</h4>
<p><span class="user-mention silent" data-user-id="554731">Tony Voss</span> <a href="#narrow/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing/near/429917496">said</a>:</p>
<blockquote>
<p>At step one when Console E is overlapping Console D, please take a dump.</p>
</blockquote>
<p>Then after the dump, while the consoles still overlap, use the Tools to change a console name - eg, ConsoleA -&gt; ConsoleX.  My hunch the overlapping will be corrected?</p>



<a name="430038939"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/430038939" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#430038939">(Mar 28 2024 at 10:42)</a>:</h4>
<p>This morning we have all the consoles piled up on top of one another.</p>
<div class="codehilite"><pre><span></span><code>L0  ------------------ Console PluginTests about to run
L25 PluginTests-&gt;isParked() already false
L25 ConsoleA-&gt;isParked() already false
L25 ConsoleA-&gt;getLocation()returning position   339 76  size 738    600
L25 ConsoleA-&gt;park() parking called with minSize X:130  Y:37
L25 ConsoleA-&gt;park() readback of client size X:130  Y:1
L25 ConsoleA-&gt;park() readback of size X:130  Y:38
L25 ConsoleA-&gt;park() parking first time
L25 PluginTests-&gt;isParked() already false
L25 ConsoleA-&gt;setLocation() setting position    745 27  size 130    38
L25 ConsoleA-&gt;park() parking at X:745  Y:27 frame
L25 1-&gt;isParked() already false
L25 1-&gt;getLocation()returning position  333 74  size 738    600
L25 1-&gt;park() parking called with minSize X:74  Y:37
L25 1-&gt;park() readback of client size X:74  Y:1
L25 1-&gt;park() readback of size X:74  Y:38
L25 1-&gt;park() parking first time
L25 PluginTests-&gt;isParked() already false
L25 ConsoleA-&gt;isParked() found is parked
L25 1-&gt;setLocation() setting position   880 27  size 74 38
L25 1-&gt;park() parking at X:880  Y:27 frame
L25 ConsoleC__Long-&gt;isParked() already false
L25 ConsoleC__Long-&gt;getLocation()returning position 339 83  size 738    600
L25 ConsoleC__Long-&gt;park() parking called with minSize X:175  Y:37
L25 ConsoleC__Long-&gt;park() readback of client size X:175  Y:1
L25 ConsoleC__Long-&gt;park() readback of size X:175  Y:38
L25 ConsoleC__Long-&gt;park() parking first time
L25 PluginTests-&gt;isParked() already false
L25 ConsoleA-&gt;isParked() found is parked
L25 1-&gt;isParked() found is parked
L25 ConsoleC__Long-&gt;setLocation() setting position  959 27  size 175    38
L25 ConsoleC__Long-&gt;park() parking at X:959  Y:27 frame
L25 ConsoleD-&gt;isParked() already false
L25 ConsoleD-&gt;getLocation()returning position   337 86  size 738    600
L25 ConsoleD-&gt;park() parking called with minSize X:130  Y:37
L25 ConsoleD-&gt;park() readback of client size X:130  Y:1
L25 ConsoleD-&gt;park() readback of size X:130  Y:38
L25 ConsoleD-&gt;park() parking first time
L25 PluginTests-&gt;isParked() already false
L25 ConsoleA-&gt;isParked() found is parked
L25 1-&gt;isParked() found is parked
L25 ConsoleC__Long-&gt;isParked() found is parked
L25 ConsoleD-&gt;setLocation() setting position    1139    27  size 130    38
L25 ConsoleD-&gt;park() parking at X:1139  Y:27 frame
L25 ConsoleE-&gt;isParked() already false
L25 ConsoleE-&gt;getLocation()returning position   361 102 size 738    600
L25 ConsoleE-&gt;park() parking called with minSize X:128  Y:37
L25 ConsoleE-&gt;park() readback of client size X:128  Y:1
L25 ConsoleE-&gt;park() readback of size X:128  Y:38
L25 ConsoleE-&gt;park() parking first time
L25 PluginTests-&gt;isParked() already false
L25 ConsoleA-&gt;isParked() found is parked
L25 1-&gt;isParked() found is parked
L25 ConsoleC__Long-&gt;isParked() found is parked
L25 ConsoleD-&gt;isParked() found is parked
L25 ConsoleE-&gt;setLocation() setting position    1274    27  size 128    38
L25 ConsoleE-&gt;park() parking at X:1274  Y:27 frame
L25 PluginTests-&gt;isParked() already false
L25 PluginTests-&gt;isParked() already false
L25 1-&gt;setLocation() setting position   745 27  size 74 38
L25 ConsoleC__Long-&gt;setLocation() setting position  824 27  size 175    38
L25 ConsoleD-&gt;setLocation() setting position    1004    27  size 130    38
L25 ConsoleE-&gt;setLocation() setting position    1139    27  size 128    38
L25 ConsoleC__Long-&gt;setLocation() setting position  745 27  size 175    38
L25 ConsoleD-&gt;setLocation() setting position    925 27  size 130    38
L25 ConsoleE-&gt;setLocation() setting position    1060    27  size 128    38
L25 ConsoleD-&gt;setLocation() setting position    745 27  size 130    38
L25 ConsoleE-&gt;setLocation() setting position    880 27  size 128    38
L25 ConsoleE-&gt;setLocation() setting position    745 27  size 128    38
L25 PluginTests-&gt;isParked() already false
L0  ------------------ Console PluginTests wrapped up
</code></pre></div>
<p><a href="/user_uploads/33951/X_bWxLy7krOQW3sq9HGH7AwK/Screenshot-from-2024-03-28-10-39-09.png">Screenshot-from-2024-03-28-10-39-09.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/33951/X_bWxLy7krOQW3sq9HGH7AwK/Screenshot-from-2024-03-28-10-39-09.png" title="Screenshot-from-2024-03-28-10-39-09.png"><img src="/user_uploads/33951/X_bWxLy7krOQW3sq9HGH7AwK/Screenshot-from-2024-03-28-10-39-09.png"></a></div><p>Trying a restart of the pc to see if things change.</p>



<a name="430039817"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/430039817" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#430039817">(Mar 28 2024 at 10:48)</a>:</h4>
<p>No difference ... the positions of the consoles have been saved in the wrong place.</p>



<a name="430040467"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/430040467" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#430040467">(Mar 28 2024 at 10:52)</a>:</h4>
<p>It could be the start position for placement of the consoles is incorrect.</p>



<a name="430048668"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/430048668" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#430048668">(Mar 28 2024 at 11:44)</a>:</h4>
<p>Out today at a couple of appointments.  Will try and check in here. <br>
Please capture relevant section of .ini file where they were saved. <br>
In Parking section of tools you can display the current parking parameters. <br>
If you delete one of them (unpark and then close button again) do the rest sort themselves out or stay piled on top of each other?<br>
Fresh beta-v this morning in beta repo with tracing off.</p>



<a name="430053380"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/430053380" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#430053380">(Mar 28 2024 at 12:06)</a>:</h4>
<p>Cleared the .conf file of parking information and the test is back to normal. OpenCPN had crashed at one point. Not known where. This may have caused my problem with the incorrect placing.</p>



<a name="430054055"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/430054055" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#430054055">(Mar 28 2024 at 12:10)</a>:</h4>
<p>If parking settings are wrong after restore at reload, you can reset to platform defaults in parking pane.</p>



<a name="430054138"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/430054138" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#430054138">(Mar 28 2024 at 12:10)</a>:</h4>
<p>Leaving the consoles from the test in position this is how the conf looked.</p>
<div class="codehilite"><pre><span></span><code>ParkingBespoke=1
ParkingStub=63
ParkingLevel=27
ParkingFirstX=74
ParkingSep=5
PluginTests\:Parked=0
PluginTests\:ConsolePosX=336
PluginTests\:ConsolePosY=163
PluginTests\:ConsoleSizeX=738
PluginTests\:ConsoleSizeY=600
PluginTests\:DialogPosX=20
PluginTests\:DialogPosY=20
PluginTests\:AlertPosX=20
PluginTests\:AlertPosY=20
PluginTests\:AutoRun=0
PluginTests\:LoadFile=/home/mike/Documents/JavaScript_pi/Tests_scripts/44_parking.js
PluginTests\:_remember=
PluginTests\:UnparkedLocationSet=0
PluginTests\:UnparkedLocationPosX=0
PluginTests\:UnparkedLocationPosY=0
PluginTests\:UnparkedLocationSizeX=0
PluginTests\:UnparkedLocationSizeY=0
PluginTests\:ParkedLocationSet=0
PluginTests\:ParkedLocationPosX=0
PluginTests\:ParkedLocationPosY=0
PluginTests\:ParkedLocationSizeX=0
PluginTests\:ParkedLocationSizeY=0
</code></pre></div>



<a name="430054231"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/430054231" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#430054231">(Mar 28 2024 at 12:11)</a>:</h4>
<p>I had already changed parking settings from the default to a custom setting.</p>



<a name="430057553"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/430057553" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#430057553">(Mar 28 2024 at 12:32)</a>:</h4>
<p>Is 'normal' with the overlapped consoles?  And does editing a console name or deleting one straightn them out?</p>



<a name="430058344"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/430058344" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#430058344">(Mar 28 2024 at 12:36)</a>:</h4>
<p><a href="/user_uploads/33951/HYoK3GI12UDevOo15kqeXGIV/Screenshot-from-2024-03-28-12-36-14.png">Screenshot-from-2024-03-28-12-36-14.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/33951/HYoK3GI12UDevOo15kqeXGIV/Screenshot-from-2024-03-28-12-36-14.png" title="Screenshot-from-2024-03-28-12-36-14.png"><img src="/user_uploads/33951/HYoK3GI12UDevOo15kqeXGIV/Screenshot-from-2024-03-28-12-36-14.png"></a></div>



<a name="430058359"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/430058359" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#430058359">(Mar 28 2024 at 12:36)</a>:</h4>
<p>No overlapped consoles now.</p>



<a name="430058683"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/430058683" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#430058683">(Mar 28 2024 at 12:39)</a>:</h4>
<p>So what remains to be sorted before release of v3?  I take it Windows is still OK?</p>



<a name="430059263"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/430059263" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#430059263">(Mar 28 2024 at 12:42)</a>:</h4>
<blockquote>
<p>I take it Windows is still OK?</p>
</blockquote>
<p>I will test beta-v with Windows.</p>



<a name="430061217"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/430061217" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#430061217">(Mar 28 2024 at 12:54)</a>:</h4>
<p><a href="/user_uploads/33951/LE4qRetEH8XW4glrVQLgORZD/15.jpg">15.jpg</a></p>
<div class="message_inline_image"><a href="/user_uploads/33951/LE4qRetEH8XW4glrVQLgORZD/15.jpg" title="15.jpg"><img src="/user_uploads/33951/LE4qRetEH8XW4glrVQLgORZD/15.jpg"></a></div>



<a name="430067756"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/430067756" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#430067756">(Mar 28 2024 at 13:31)</a>:</h4>
<p>Don't understand.  It is trying to read a file that  exists.  File string is correct.  Is the file still there?<br>
If stuck, you could in JSextensions.cpp change line 947 from<br>
<code>pConsole-&gt;prep_for_throw(ctx, "_wxFile unable to open file " + filePath);</code><br>
to<br>
<code>pConsole-&gt;prep_for_throw(ctx, wxString::Format("_wxFile unable to open file %s error %d", filePath, control.pFile-&gt;GetLastError()));
</code><br>
This should add the error code to the error message.  This line compiles but I have not tested it - am on the go.<br>
Code is platform dependent and you would need to interpret it.</p>
<p>This all worked before,  and I have not changed anything there I think.  The test works fine for me on MacOS.  Hope you can find what is up.</p>



<a name="430068405"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/430068405" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#430068405">(Mar 28 2024 at 13:34)</a>:</h4>
<p>Have tested that change.  It does give the error number.  If I run with non existant file I get<br>
error 2.</p>



<a name="430073438"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/430073438" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#430073438">(Mar 28 2024 at 14:00)</a>:</h4>
<p>Sorry ... directory for the test scripts was wrong. All ok.</p>



<a name="430076093"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/430076093" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#430076093">(Mar 28 2024 at 14:11)</a>:</h4>
<p>So we are all go for release?</p>



<a name="430079533"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/430079533" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#430079533">(Mar 28 2024 at 14:26)</a>:</h4>
<p>Position/Waypoint/Route test:<br>
Position 33 21.480'N 079 16.920'W<br>
The bell symbol appears.<br>
Is this important?</p>



<a name="430079897"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/430079897" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#430079897">(Mar 28 2024 at 14:28)</a>:</h4>
<p>Nothing else I can see that stops release.</p>



<a name="430080716"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/430080716" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#430080716">(Mar 28 2024 at 14:31)</a>:</h4>
<p>Oh ... poistionParseTests.js  -  reference to a Position,js file on your computer. Needs changing.</p>



<a name="430081591"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/430081591" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#430081591">(Mar 28 2024 at 14:35)</a>:</h4>
<p>Please change to require (“Position”); and retry.</p>



<a name="430082219"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/430082219" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#430082219">(Mar 28 2024 at 14:37)</a>:</h4>
<p>Thanks ... used <code>Position = require("Position");</code><br>
Lots of BELs</p>
<div class="codehilite"><pre><span></span><code>0   {&quot;latitude&quot;:20.506666666666668,&quot;longitude&quot;:-5.508333333333333}  20 30.400&#39;N 005 30.500&#39;W
1   {&quot;latitude&quot;:-2.05,&quot;longitude&quot;:5.508333333333334}    02 03.000&#39;S 005 30.500&#39;E
2   {&quot;latitude&quot;:20.506666666666668,&quot;longitude&quot;:-5.508333333333334}  20 30.400&#39;N 005 30.500&#39;W
3   {&quot;latitude&quot;:20.5,&quot;longitude&quot;:-5}    20 30.000&#39;N 005 0.000&#39;W
0 error(s)
throwTest 0 threw parsePosition  not lat long pair
throwTest 1 threw parsePosition lat out of range
throwTest 2 threw parsePosition lon not a number
throwTest 3 threw parsePosition lat out of range
0 missed throw error(s)
result: Success
</code></pre></div>



<a name="430082359"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/430082359" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#430082359">(Mar 28 2024 at 14:38)</a>:</h4>
<p>Must go to dentist</p>



<a name="430118244"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/430118244" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#430118244">(Mar 28 2024 at 16:51)</a>:</h4>
<p>In version.h we have</p>
<div class="codehilite" data-code-language="C++"><pre><span></span><code><span class="cp">#define DEGREE        {"\u00B0"}    </span><span class="c1">// real degree character</span>
<span class="cp">#ifdef __WINDOWS__</span>
<span class="cp">#define PSEUDODEGREE  {"\u0007"}    </span><span class="c1">// substitute character for degree - bell</span>
<span class="cp">#else</span>
<span class="cp">#define PSEUDODEGREE  DEGREE    </span><span class="c1">// keep it as real degree</span>
<span class="cp">#endif</span>
</code></pre></div>
<p>which is how you get º turned into BELL.<br>
Then in JSextensions.cpp line 107, the output is filtered by<br>
<code>   output.Replace(PSEUDODEGREE, DEGREE, true); // internally, we are using PSEUDODEGREE to represent degree - convert any back</code></p>
<p>So mystified why you are seeing BELL.</p>
<p>This simple script will test:</p>
<div class="codehilite" data-code-language="JavaScript"><pre><span></span><code><span class="nx">print</span><span class="p">(</span><span class="s2">"Bell prints as "</span><span class="p">,</span><span class="w"> </span><span class="nb">String</span><span class="p">.</span><span class="nx">fromCharCode</span><span class="p">(</span><span class="mh">0x07</span><span class="p">),</span><span class="w"> </span><span class="s2">"\n"</span><span class="p">);</span>
</code></pre></div>
<p>You should see it print º<br>
This assumes  <code>#ifdef __WINDOWS__</code> is working.</p>



<a name="430127797"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/430127797" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#430127797">(Mar 28 2024 at 17:26)</a>:</h4>
<div class="codehilite"><pre><span></span><code>Bell prints as 
result: undefined
</code></pre></div>
<p>What a pain.</p>



<a name="430129479"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/430129479" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#430129479">(Mar 28 2024 at 17:34)</a>:</h4>
<p>Do you get the degree with<br>
<code>print("Bell prints as ", String.fromCharCode(0xB0), "\n");</code></p>



<a name="430130978"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/430130978" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#430130978">(Mar 28 2024 at 17:41)</a>:</h4>
<p>Yes ...<br>
Need to restart my pc to show output.</p>



<a name="430131394"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/430131394" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#430131394">(Mar 28 2024 at 17:44)</a>:</h4>
<p>Bell prints as °<br>
result: undefined</p>



<a name="430132478"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/430132478" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#430132478">(Mar 28 2024 at 17:49)</a>:</h4>
<p>In JSextensions.cpp change lines 107 to be</p>
<div class="codehilite" data-code-language="C++"><pre><span></span><code><span class="w">    </span><span class="n">TRACE</span><span class="p">(</span><span class="mi">123</span><span class="p">,</span><span class="w"> </span><span class="s">"Before: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">output</span><span class="p">);</span>
<span class="w">    </span><span class="n">output</span><span class="p">.</span><span class="n">Replace</span><span class="p">(</span><span class="n">PSEUDODEGREE</span><span class="p">,</span><span class="w"> </span><span class="n">DEGREE</span><span class="p">,</span><span class="w"> </span><span class="nb">true</span><span class="p">);</span><span class="w"> </span><span class="c1">// internally, we are using DEGREE to represent degree - convert any back</span>
<span class="w">    </span><span class="n">TRACE</span><span class="p">(</span><span class="mi">123</span><span class="p">,</span><span class="w"> </span><span class="s">"After: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">output</span><span class="p">);</span>
</code></pre></div>
<p>and turn on tracing for 123</p>



<a name="430132942"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/430132942" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#430132942">(Mar 28 2024 at 17:51)</a>:</h4>
<p>Then run</p>
<div class="codehilite" data-code-language="JavaScript"><pre><span></span><code><span class="nx">print</span><span class="p">(</span><span class="s2">"Degree prints as º\n"</span><span class="p">);</span>
</code></pre></div>



<a name="430133102"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/430133102" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#430133102">(Mar 28 2024 at 17:52)</a>:</h4>
<p>BBL</p>



<a name="430133159"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/430133159" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#430133159">(Mar 28 2024 at 17:53)</a>:</h4>
<p>Then get a Mac <span aria-label="speechless" class="emoji emoji-1f636" role="img" title="speechless">:speechless:</span></p>



<a name="430134988"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/430134988" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#430134988">(Mar 28 2024 at 18:02)</a>:</h4>
<div class="codehilite"><pre><span></span><code>Tracing levels 123 - 123
Degree prints as 
result: undefined
</code></pre></div>
<div class="codehilite"><pre><span></span><code>L0  ------------------ Console JavaScript about to run
L123    Before: Degree prints as 

L123    After: Degree prints as 

L0  ------------------ Console JavaScript wrapped up
</code></pre></div>



<a name="430135119"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/430135119" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#430135119">(Mar 28 2024 at 18:02)</a>:</h4>
<p>News and shower.</p>



<a name="430141265"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/430141265" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#430141265">(Mar 28 2024 at 18:34)</a>:</h4>
<p>Please try removing the curly braces around the definitions, so in versions.h it becomes</p>
<div class="codehilite" data-code-language="C++"><pre><span></span><code><span class="cp">#define DEGREE        "\u00B0"  </span><span class="c1">// real degree character</span>
<span class="cp">#ifdef __WINDOWS__</span>
<span class="cp">#define PSEUDODEGREE    "\u0007"    </span><span class="c1">// substitute character for degree - bell</span>
<span class="cp">#else</span>
<span class="cp">#define PSEUDODEGREE  DEGREE    </span><span class="c1">// keep it as real degree</span>
</code></pre></div>



<a name="430141567"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/430141567" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#430141567">(Mar 28 2024 at 18:36)</a>:</h4>
<p>Explanation: we are defining a one-character string - not a character</p>



<a name="430147731"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/430147731" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#430147731">(Mar 28 2024 at 19:18)</a>:</h4>
<p>I seem to have compiled version t no v. It will have to wait until tomorrow to recompile.</p>



<a name="430147925"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/430147925" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#430147925">(Mar 28 2024 at 19:20)</a>:</h4>
<p>Will compile for you - stand by</p>



<a name="430148614"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/430148614" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#430148614">(Mar 28 2024 at 19:25)</a>:</h4>
<p>beta-w building now into my beta repo - give it a moment</p>



<a name="430215472"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/430215472" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#430215472">(Mar 29 2024 at 07:36)</a>:</h4>
<p>Assuming the above looks all OK, please run this final check on Windows....</p>
<p>Copy this script into a console</p>
<div class="codehilite" data-code-language="JavaScript"><pre><span></span><code><span class="nx">Position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s2">"Position"</span><span class="p">);</span>
<span class="nx">print</span><span class="p">(</span><span class="ow">new</span><span class="w"> </span><span class="nx">Position</span><span class="p">(</span><span class="nx">fromClipboard</span><span class="p">()).</span><span class="nx">formatted</span><span class="p">,</span><span class="w"> </span><span class="s2">"\n"</span><span class="p">);</span>
</code></pre></div>
<p>Then copy this next line to your clipboard<br>
<code>50.333333ºN 3º 20'W</code><br>
Run the script and the result  should be<br>
<code>50° 20.000'N 003° 20.000'W</code></p>



<a name="430221504"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/430221504" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#430221504">(Mar 29 2024 at 08:35)</a>:</h4>
<p>50 20.000'N 003 20.000'W<br>
result: undefined<br>
The BEL is still with us. BEL is a non-printing character on Windows. On the Mac?</p>



<a name="430223878"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/430223878" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#430223878">(Mar 29 2024 at 08:55)</a>:</h4>
<p>Tried replacing PSEUDODEGREE  bel with ^. Did not work.</p>



<a name="430225948"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/430225948" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#430225948">(Mar 29 2024 at 09:13)</a>:</h4>
<p>When it was working, I think I recall, we were using things like<br>
<code>const wxString o_umlaut    {"\u00F6"};</code><br>
Maybe try that.  You or me to edit?</p>



<a name="430232951"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/430232951" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#430232951">(Mar 29 2024 at 10:11)</a>:</h4>
<p>Added this to JScleanOuput:<br>
<code>given.Replace(PSEUDODEGREE, "\u00B0", true);</code><br>
And the degree symbol prints correctly</p>



<a name="430233598"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/430233598" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#430233598">(Mar 29 2024 at 10:17)</a>:</h4>
<p>positionParseTests still needs correcting for users etc.<br>
With that corrected the test runs with all the correct degree symbols in place.</p>



<a name="430244394"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/430244394" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#430244394">(Mar 29 2024 at 11:48)</a>:</h4>
<p>Now we have the new way of defining DEGREE and PSUDODEGREE, what you have<br>
<code>given.Replace(PSEUDODEGREE, "\u00B0", true);</code><br>
must be the same as <br>
<code>given.Replace(PSEUDODEGREE, DEGREE, true);</code></p>
<p>I have put this into JScleanString , made the other Window bits of what was already there Windows only and now use JScleanString for all outputs, so it is done in one place.</p>
<p>I have tested using something else for PSEUDODEGREE and inspected it using that code and output is OK on MacOS.</p>
<p>Please try beta-x pushed and built in my beta repo.<br>
Please inspect output from 38_positionParseTests.js to check degree symbols correct and also the clipboard test from my message at 07:36 today.<br>
<span aria-label="hand with index finger and thumb crossed" class="emoji emoji-1faf0" role="img" title="hand with index finger and thumb crossed">:hand_with_index_finger_and_thumb_crossed:</span>  <span aria-label="hand with index finger and thumb crossed" class="emoji emoji-1faf0" role="img" title="hand with index finger and thumb crossed">:hand_with_index_finger_and_thumb_crossed:</span>  <span aria-label="hand with index finger and thumb crossed" class="emoji emoji-1faf0" role="img" title="hand with index finger and thumb crossed">:hand_with_index_finger_and_thumb_crossed:</span></p>



<a name="430250268"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/430250268" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#430250268">(Mar 29 2024 at 12:40)</a>:</h4>
<p>beta-x is good for both parseTests and clipboard. Looks good for release.</p>



<a name="430250699"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/430250699" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#430250699">(Mar 29 2024 at 12:44)</a>:</h4>
<p>Phew!  At last!  Great to hatch this at Easter  <span aria-label="hatching" class="emoji emoji-1f423" role="img" title="hatching">:hatching:</span> <span aria-label="hatching" class="emoji emoji-1f423" role="img" title="hatching">:hatching:</span>  <span aria-label="hatching" class="emoji emoji-1f423" role="img" title="hatching">:hatching:</span></p>



<a name="430271147"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/430271147" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#430271147">(Mar 29 2024 at 15:16)</a>:</h4>
<p>The release build on circleci is not running for MacOS because of CONCURRENCY LIMIT.<br>
I guess this is because I have reached some limit for my free plan?  It says I have used 1,392 credits. But also says <code>Open source credits 33,403 credits of 400,000 used</code><br>
When can I proceed? It looks like I get 30,000 per month.  Do I have to wait to the end of April?</p>



<a name="430271437"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/430271437" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#430271437">(Mar 29 2024 at 15:18)</a>:</h4>
<p>Beginning of April should be Ok. Still Easter ;)</p>



<a name="433450231"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/v3.0.0%20beta%20testing/near/433450231" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alec Leamas <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing.html#433450231">(Apr 16 2024 at 06:27)</a>:</h4>
<p>Hi,</p>
<p>Any idea what this is: ? "Mystified"</p>
<div class="codehilite"><pre><span></span><code>ld: warning: ignoring file &#39;/usr/local/Cellar/openssl@3/3.2.1/lib/libssl.3.dylib&#39;: found architecture &#39;x86_64&#39;, required architecture &#39;arm64&#39;
ld: warning: ignoring file &#39;/usr/local/Cellar/openssl@3/3.2.1/lib/libcrypto.3.dylib&#39;: found architecture &#39;x86_64&#39;, required architecture &#39;arm64&#39;
ld: Undefined symbols:
  _ASN1_INTEGER_set, referenced from:
      generate_x509(evp_pkey_st*, std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt;&gt;) in certificates.cpp.o
  _ASN1_OCTET_STRING_free, referenced from:
      cs_cert_set_subject_alt_name(x509_st*, std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt;&gt;) in certificates.cpp.o
      cs_cert_set_subject_alt_name(x509_st*, std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt;&gt;) in certificates.cpp.o
  _ASN1_OCTET_STRING_new, referenced from:
      cs_cert_set_subject_alt_name(x509_st*, std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt;&gt;) in certificates.cpp.o
      cs_cert_set_subject_alt_name(x509_st*, std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt;&gt;) in certificates.cpp.o
  _ASN1_OCTET_STRING_set, referenced from:
      cs_cert_set_subject_alt_name(x509_st*, std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt;&gt;) in certificates.cpp.o
  _BIO_free, referenced from:
      ix::SocketOpenSSL::openSSLAddCARootsFromString(std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt;&gt;) in libixwebsocket.a[arm64][3`
</code></pre></div>
<p>Complete log:  <a href="https://app.circleci.com/pipelines/github/leamas/OpenCPN/4964/workflows/1a253a18-e09a-4f58-9213-2fcc226157a0/jobs/10604">https://app.circleci.com/pipelines/github/leamas/OpenCPN/4964/workflows/1a253a18-e09a-4f58-9213-2fcc226157a0/jobs/10604</a></p>



<hr><p>Last updated: Jan 26 2025 at 03:13 UTC</p>
</html>