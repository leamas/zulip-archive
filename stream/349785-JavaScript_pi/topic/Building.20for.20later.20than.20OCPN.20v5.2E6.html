<html>
<head><meta charset="utf-8"><title>Building for later than OCPN v5.6 · JavaScript_pi · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/index.html">JavaScript_pi</a></h2>
<h3>Topic: <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html">Building for later than OCPN v5.6</a></h3>

<hr>

<base href="https://opencpn.zulipchat.com">

<head><link href="https://leamas.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="319650767"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/319650767" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#319650767">(Jan 05 2023 at 18:53)</a>:</h4>
<p>Can you please advise how I build for the new OCPN?  I want to do local builds at first and I guess I need a different <a href="http://circleci-build-macos.sh">circleci-build-macos.sh</a> and maybe other stuff too?  As I understand it, we need to use later versions of wxWidgets.<br>
The test suite now reports the configuration so we can be sure we have the right components.</p>



<a name="319738455"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/319738455" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#319738455">(Jan 06 2023 at 08:43)</a>:</h4>
<p>You have the update-templates script in your repo. You run it with <em>sd3.2.1</em> i.e. </p>
<div class="codehilite"><pre><span></span><code>$bash update-templates sd3.2.1
</code></pre></div>
<p>It will push the wxWidgets 3.2 builds to Cloudsmith.</p>
<p>You get a new  <em>circleci-build-macos.sh</em>. You can use this script to build a local tarball for OpenCPN 5.8. I had problems with the icons in the toolbar. Interested to see if that problem has gone away.</p>



<a name="319746059"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/319746059" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#319746059">(Jan 06 2023 at 09:37)</a>:</h4>
<p>So we end up with both wx312 and wx32 builds in the repository.  For alpha, selecting the right one to install is a manual matter.<br>
For beta and release, does the OCPN catalogue update know which to look for?</p>



<a name="319751320"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/319751320" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#319751320">(Jan 06 2023 at 10:14)</a>:</h4>
<blockquote>
<p>For beta and release, does the OCPN catalogue update know which to look for?</p>
</blockquote>
<p>Yes it does. The metadata xml files for these plugins includes the string 'wx32' and the catalog knows which plugins are then available for 5.7/5.8.</p>



<a name="322088064"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/322088064" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#322088064">(Jan 18 2023 at 15:57)</a>:</h4>
<p>Tried a build using the sd3.2.2 template. On Winodws the toolbar images do not appear. <br>
<a href="https://cloudsmith.io/~mike-rossiter/repos/javascript-alpha/packages/">https://cloudsmith.io/~mike-rossiter/repos/javascript-alpha/packages/</a><br>
Holds my alpha builds.</p>



<a name="324049477"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/324049477" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#324049477">(Jan 27 2023 at 13:24)</a>:</h4>
<p><span class="user-mention silent" data-user-id="399559">Mike Rossiter</span> <a href="#narrow/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6/near/319738455">said</a>:</p>
<blockquote>
<p>You have the update-templates script in your repo. You run it with <em>sd3.2.1</em> i.e. </p>
<div class="codehilite"><pre><span></span><code>$bash update-templates sd3.2.1
</code></pre></div>
<p>It will push the wxWidgets 3.2 builds to Cloudsmith.</p>
<p>You get a new  <em>circleci-build-macos.sh</em>. You can use this script to build a local tarball for OpenCPN 5.8. I had problems with the icons in the toolbar. Interested to see if that problem has gone away.</p>
</blockquote>
<p>Is this still the way to build for 3.2?  (Things might have moved on since Jan 5)</p>



<a name="324085725"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/324085725" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#324085725">(Jan 27 2023 at 15:52)</a>:</h4>
<p>We found some isssues with sd3.2.1. Latest tag to update is sd3.2.2-beta1.</p>



<a name="324119761"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/324119761" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#324119761">(Jan 27 2023 at 17:59)</a>:</h4>
<p>Well, I ran b<code>ash update-templates sd3.2.1</code>, and reran it as instructed<br>
Then ran <code>circleci-build-macos.sh</code>which gave errors:</p>
<blockquote>
<p>git submodule update --init opencpn-libs<br>
error: pathspec 'opencpn-libs' did not match any file(s) known to git</p>
</blockquote>
<p>and</p>
<blockquote>
<p>CMake Error at CMakeLists.txt:40 (add_subdirectory):<br>
 add_subdirectory given source "opencpn-libs/api-17" which is not an existing directory.</p>
</blockquote>
<p>I note that api-17 resides in libs and not opencpn-libs<br>
Not sure where to go from here.<br>
I attach the Terminal log.  Pleas can you advise?<br>
<a href="/user_uploads/33951/v1b5M6X6LQCzUoeat0CjkLl-/Terminal-Saved-Output.txt">Terminal-Saved-Output.txt</a></p>



<a name="324121318"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/324121318" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#324121318">(Jan 27 2023 at 18:06)</a>:</h4>
<p>BBL</p>



<a name="324121435"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/324121435" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#324121435">(Jan 27 2023 at 18:06)</a>:</h4>
<p>It is all about adding a git sub-module, opencpn-libs.</p>



<a name="324122864"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/324122864" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#324122864">(Jan 27 2023 at 18:13)</a>:</h4>
<p>Sorry - you will have to spell that out for me<br>
By the way,  OCPN5.7 used API18, does it not?</p>



<a name="324138723"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/324138723" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#324138723">(Jan 27 2023 at 19:34)</a>:</h4>
<p>5.7 has API 18. Mainly functions to work with communications like NMEA2000.<br>
If you look in my ShipDriver repo you will find an opencpn-libs folder. README.md has instructions for adding the git sub-module. Alec's idea was to try and get consistency across the many libs the plugins use.</p>



<a name="324413224"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/324413224" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alec Leamas <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#324413224">(Jan 29 2023 at 10:35)</a>:</h4>
<p>As Mike said: In  local build you need to clone the sources according to the instructions in README.md (there are other ways to achieve the same result, this is what's documented).</p>



<a name="324413788"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/324413788" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alec Leamas <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#324413788">(Jan 29 2023 at 10:40)</a>:</h4>
<p><span class="user-mention" data-user-id="554731">@Tony Voss</span>  Oops, not README.md but INSTALL.md. Sorry.</p>



<a name="324898350"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/324898350" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#324898350">(Jan 31 2023 at 12:28)</a>:</h4>
<p>I have managed to get to local build using the new sd3.1.4  and attempting to build for latest OCPN I have, which is  5.7.1+dd8acc0 (later than public beta 2 because that crashes on MacOS).<br>
I am building on a M2 MacBook but testing on an X86.<br>
First local build says it was x86 but when Plugin Manager tried to install, it said it was incompatible arm.  (The message flashes up too briefly to study).<br>
I then patched <a href="http://circi-build-macos.sh">circi-build-macos.sh</a>  thus:</p>
<div class="codehilite" data-code-language="CMake"><pre><span></span><code><span class="w">  </span><span class="err">-DCMAKE_BUILD_TYPE=Release</span><span class="w"> </span><span class="err">\</span>
<span class="w">  </span><span class="err">-DCMAKE_INSTALL_PREFIX=</span><span class="w"> </span><span class="err">\</span>
<span class="w">  </span><span class="err">-DCMAKE_OSX_DEPLOYMENT_TARGET=10.10</span><span class="w"> </span><span class="err">\</span>
<span class="w">  </span><span class="err">-DOCPN_TARGET_TUPLE="darwin-wx32;10;x86_64"</span><span class="w"> </span><span class="err">\</span>
<span class="w">  </span><span class="err">-DCMAKE_OSX_ARCHITECTURES=x86_64</span><span class="w"> </span><span class="err">\</span><span class="w">                </span><span class="err">***</span><span class="w"> </span><span class="err">Tony</span><span class="w"> </span><span class="err">added</span><span class="w"> </span><span class="err">this</span><span class="w"> </span><span class="err">line***</span>
<span class="w">  </span><span class="err">..</span>
</code></pre></div>
<p>This time Plugin Manager accepted it and started to activate it.  Lots of stuff logged in OCPN log file ending with</p>
<div class="codehilite"><pre><span></span><code>11:45:24.640    INFO plugin_loader.cpp:1394 PlugInManager:  /Users/Tony/Library/Application Support/OpenCPN/Contents/PlugIns/libJavaScript_pi.dylib
11:45:24.640    INFO plugin_loader.cpp:1395         Plugin common name: javascript
11:45:24.640    INFO plugin_loader.cpp:1397         API Version detected: 117
11:45:24.640    INFO plugin_loader.cpp:1398         PlugIn Version detected: 2.0.0
</code></pre></div>
<p>whereupon OCPN crashed -  somewhere in wxWidgets - I think getting fonts.<br>
So it looks like Plugin Manager got as far as interrogating the plugin  for its details</p>
<p>Should I report this elsewhere or is this sufficient?</p>



<a name="324900817"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/324900817" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#324900817">(Jan 31 2023 at 12:40)</a>:</h4>
<p>It might be worth updating to <em>sd3.2.2</em>. This will produce builds for all supported OS and may change other stuff which will allow the plugin to be loaded. Saw that Hakan did this for <em>ais-vd_pi</em>.</p>



<a name="324901699"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/324901699" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alec Leamas <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#324901699">(Jan 31 2023 at 12:45)</a>:</h4>
<p>That commit is unfortunately not the complete truth. TL;DR Use darwin-wx32.</p>
<p>Background: We have since long moved to using wx315 on MacOS without changing the ABI name. That is, "no suffix" means wx315 on MAcOS.  OTOH, we now have also wx32 plugins, these are the only ones we build.  To make it possible for core opencpn to distinguish these  we use a API named ´darwin-wx32` for the new plugins.</p>
<p>The complete truth is in the plugins project, in the file <em>ocpn-plugin.xsd</em>. Look for "xs:element name="target". Note that only the master branch is fully  updated; it is this branch which is used when validating.</p>



<a name="324902894"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/324902894" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alec Leamas <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#324902894">(Jan 31 2023 at 12:51)</a>:</h4>
<blockquote>
<p>What do I need to do to take advantage of your fix Mike? Update script? Rebuild?</p>
</blockquote>
<p>It's in <em>UPDATE_TEMPLATES.md</em>. If you have the file in the top directory you don't need to bother with the first step Bootstrapping, just go straight to <em>2. Run Script</em></p>



<a name="324903300"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/324903300" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alec Leamas <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#324903300">(Jan 31 2023 at 12:53)</a>:</h4>
<p>Well, then that is a bug... can you file it?</p>



<a name="324903646"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/324903646" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alec Leamas <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#324903646">(Jan 31 2023 at 12:55)</a>:</h4>
<p>OTOH, we won't update 3.1 any more... and this is not an issue for main opencpn since it won't load the old plugins anyway.</p>



<a name="324903650"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/324903650" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#324903650">(Jan 31 2023 at 12:55)</a>:</h4>
<p>I will do that.</p>



<a name="324904142"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/324904142" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alec Leamas <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#324904142">(Jan 31 2023 at 12:57)</a>:</h4>
<p>Yes, please do. We need to think this through.</p>



<a name="324904659"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/324904659" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alec Leamas <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#324904659">(Jan 31 2023 at 12:59)</a>:</h4>
<p><span class="user-mention" data-user-id="554731">@Tony Voss</span> I suggest that you just replace <em>darwin-wx-32</em> with <em>darwin</em> for now. That should make it. IN all cases using <em>darwin-wx32</em> is plain wrong since 3.1 builds the "old" wxWidgets version.</p>



<a name="325686209"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/325686209" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#325686209">(Feb 03 2023 at 17:28)</a>:</h4>
<p>Updated to SD3.2.2, added <code> -DCMAKE_OSX_ARCHITECTURES=x86_64</code> to <a href="http://circi-build-macos.sh">circi-build-macos.sh</a> as above.<br>
Local build ran fine.  Imported into OCPN beta 3.<br>
On plugin activation it crashed  within plugin manager as before after logging</p>
<div class="codehilite"><pre><span></span><code>PlugIns/libJavaScript_pi.dylib
17:15:51.790    INFO plugin_loader.cpp:1395         Plugin common name: javascript
17:15:51.790    INFO plugin_loader.cpp:1397         API Version detected: 117
17:15:51.790    INFO plugin_loader.cpp:1398         PlugIn Version detected: 2.0.0
</code></pre></div>
<p>Not sure why it says v2.0.0 as the tarball is v2.0.1and that's what plugin manager sees when importing it.  Anyhow, that is minor.</p>
<p>BTW, if I set the API to 118 <a href="http://circi-build-macos.sh">circi-build-macos.sh</a> fails to find the 118 lib.</p>



<a name="325844105"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/325844105" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#325844105">(Feb 04 2023 at 15:26)</a>:</h4>
<p><span class="user-mention" data-user-id="399559">@Mike Rossiter</span>  Now able to build JS plugin for OCPN 5.7 but it still crashes when being loaded.<br>
Log shows</p>
<div class="codehilite"><pre><span></span><code>PlugIns/libJavaScript_pi.dylib
14:15:51.790    INFO plugin_loader.cpp:1395         Plugin common name: javascript
14:15:51.790    INFO plugin_loader.cpp:1397         API Version detected: 118
14:15:51.790    INFO plugin_loader.cpp:1398         PlugIn Version detected: 2.0.0
</code></pre></div>
<p>So PluginLoader has been able to construct the plugin and  interrogate the plugin OK but before it gets to call init() it crashes.  See log extract.<br>
PluginLoader is in LoadPluginCandidate, which has called<br>
<code>wxImage: :SaveFile(wxString const&amp;, wxString const&amp;)</code><br>
I seem to recall you had issues with finding images/icons??  Any clues?<br>
<a href="/user_uploads/33951/928hcsmrHxCb8nkSOyJjwItN/Screenshot-2023-02-04-at-15.19.10.png">Screenshot-2023-02-04-at-15.19.10.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/33951/928hcsmrHxCb8nkSOyJjwItN/Screenshot-2023-02-04-at-15.19.10.png" title="Screenshot-2023-02-04-at-15.19.10.png"><img src="/user_uploads/33951/928hcsmrHxCb8nkSOyJjwItN/Screenshot-2023-02-04-at-15.19.10.png"></a></div>



<a name="325848140"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/325848140" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#325848140">(Feb 04 2023 at 15:53)</a>:</h4>
<p>My JS built locally installs fine. Just the icon missing in the toolbar. I will flash up my Mac Mini.</p>



<a name="325867913"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/325867913" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#325867913">(Feb 04 2023 at 18:24)</a>:</h4>
<p>Unable to load a local build into the latest beta <a href="https://github.com/opencpn/OpenCPN/issues/3">#3</a>. Plugin is incompatible. We had this a long time ago. Also the plugin is "jailed", where I thought this had been taken out of the code.</p>



<a name="325874604"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/325874604" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#325874604">(Feb 04 2023 at 19:33)</a>:</h4>
<p>So where now?</p>



<a name="325878020"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/325878020" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alec Leamas <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#325878020">(Feb 04 2023 at 20:18)</a>:</h4>
<p>The first step is to run opencpn with --loglevel debug and post opencpn.log. this should show why the plugin is deemed incompatible.</p>



<a name="325884943"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/325884943" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#325884943">(Feb 04 2023 at 21:57)</a>:</h4>
<p><span class="user-mention silent" data-user-id="399559">Mike Rossiter</span> <a href="#narrow/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6/near/325867913">said</a>:</p>
<blockquote>
<p>Unable to load a local build into the latest beta <a href="https://github.com/opencpn/OpenCPN/issues/3">#3</a>. Plugin is incompatible. We had this a long time ago. Also the plugin is "jailed", where I thought this had been taken out of the code.</p>
</blockquote>
<p>Mike... you are not seeing what I am seeing. (I assume this is when you run on MacOS.)<br>
If you look in the log file you will probably see why it is deemed incompatible.  Likely you omitted to add<br>
<code>-DCMAKE_OSX_ARCHITECTURES=x86_64</code> to <a href="http://circi-build-macos.sh">circi-build-macos.sh</a> as above and hence built an arm version - which is indeed incompatible.  (Ignore the x86 in the tarball name - it can be arm inside.)<br>
When I build an x86 one, it is deemed compatible but crashes during activation as I described.</p>



<a name="325889637"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/325889637" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#325889637">(Feb 04 2023 at 22:58)</a>:</h4>
<p>The x86_64   in  <code> -DOCPN_TARGET_TUPLE="darwin-wx32;10;x86_64"</code> does not work to get x86 code.</p>



<a name="325936776"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/325936776" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#325936776">(Feb 05 2023 at 10:29)</a>:</h4>
<blockquote>
<p>omitted to add<br>
-DCMAKE_OSX_ARCHITECTURES=x86_64</p>
</blockquote>
<p>I am using a clone of your repo. <em>circleci-build-macos.sh</em> already edited.<br>
Log shows:</p>
<div class="codehilite" data-code-language="18"><pre><span></span><code>Users/mikerossiter/Library/Application Support/OpenCPN/Contents/
PlugIns/libJavaScript_pi.dylib': dlopen(/Users/mikerossiter/Library/
Application Support/OpenCPN/Contents/PlugIns/libJavaScript_pi.dylib,
2): Symbol not found: _wxTheAssertHandler
Referenced from: /Users/mikerossiter/Library/Application Support/
OpenCPN/Contents/PlugIns/libJavaScript_pi.dylib
Expected in: /Applications/OpenCPN.app/Contents/MacOS/../
Frameworks/libwx_baseu-3.2.dylib
in /Users/mikerossiter/Library/Application Support/OpenCPN/
Contents/PlugIns/libJavaScript_pi.dylib```


I am using Homebrew wxWidgets to compile the plugin. Wonder if that is the problem. We have been here before.
</code></pre></div>



<a name="325938329"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/325938329" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#325938329">(Feb 05 2023 at 10:43)</a>:</h4>
<p>A private build of wxWidgets for the MacOS build of OpenCPN 5.7.1 is being used:<br>
<a href="https://download.opencpn.org/s/Djqm4SXzYjF8nBw/download">https://download.opencpn.org/s/Djqm4SXzYjF8nBw/download</a><br>
Is this wxWidgets 3.2.0 or 3.2.1?<br>
We had this problem with Windows and resolved it by using official binaries for 3.2.1.<br>
<span class="user-mention" data-user-id="399510">@Alec Leamas</span> : Help please!</p>



<a name="325938948"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/325938948" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alec Leamas <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#325938948">(Feb 05 2023 at 10:49)</a>:</h4>
<p>On my way out...</p>
<p>We use a wxWidgets 3.2 built from source.  In main opencpn Dave has made a build which is downloaded as an anonymous binary.</p>
<p>In shipdriver we rebuild from sources, but caches the result. Ww cannot use pre-built sources sonce the compilation  flags must match -- the flags we use are synchronized with Dave.</p>
<p>You can see what't going on in the file  <em>cmake/MacosWxwidgets.cmake</em>. This build is cached in the circleci build environment and also reused when making local builds</p>



<a name="325939143"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/325939143" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alec Leamas <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#325939143">(Feb 05 2023 at 10:50)</a>:</h4>
<p>... I'm talking about 5.7 beta/5.8 now,  nothing else</p>



<a name="325939671"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/325939671" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alec Leamas <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#325939671">(Feb 05 2023 at 10:54)</a>:</h4>
<p>... and yes, this is tested. But, Dave has a habit of unannounced changes...</p>



<a name="325954194"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/325954194" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#325954194">(Feb 05 2023 at 12:48)</a>:</h4>
<p>The crash reports are not consistently the same but frequently follow an ominously long list of repeating</p>
<div class="codehilite"><pre><span></span><code>11 libwx_osx_cocoau_core-3.1.2.0.0.dylib           0x141cbf904 wxStockGDI::GetFont(wxStockGDI::Item) + 228
12  libwx_osx_cocoau_core-3.1.2.0.0.dylib          0x141cbf924 wxStockGDI::GetFont(wxStockGDI::Item) + 260
13  libwx_osx_cocoau_core-3.1.2.0.0.dylib          0x141c4d8ed wxSystemSettingsNative::GetFont(wxSystemFont) + 45
</code></pre></div>
<p>so it looks like an issue setting wxWidgets up.  There is an ancient 2007 post on this <a href="https://forums.wxwidgets.org/viewtopic.php?t=14039">here</a> but  our situation is surely different now.</p>



<a name="325967870"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/325967870" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#325967870">(Feb 05 2023 at 14:29)</a>:</h4>
<p>Finally compiled wxWidgets for MacOS using the same parameters as Dave. And then JavaScript_pi, which installed.<br>
Used a modified: <em>cmake/MacosWxwidgets.cmake</em> as part of the build process.<br>
If you already have wxWidgets installed the script normally finds and tries to use it, from usr/local/lib <code> ($(wxStatus) EQUAL 0 )</code><br>
If you comment out "return ()" in <em>cmake/MacosWxwidgets.cmake</em> it assumes you will compile wxWidgets again. This results in an updated wxWidgets in usr/local/lib, compiled with Dave's parameters. Running <a href="http://circleci-build-macos.sh">circleci-build-macos.sh</a> then uses these wxWidgets and the build runs and the plugin installs/runs ok, for me. The icons blanked out problem remains.<br>
This is a total hack, but similar to the game we played with Windows.</p>



<a name="325994567"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/325994567" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#325994567">(Feb 05 2023 at 17:59)</a>:</h4>
<p>Mike... did as you said and commented out that return() and re-ran <a href="http://circleci-build-macos.sh">circleci-build-macos.sh</a>.<br>
On the make tarball thereafter it did a big compile and installed new libraries in /usr/local/lib<br>
before erroring out with <br>
<code>Undefined symbols for architecture arm64:</code><br>
for a load of symbols including TIFF in their names.<br>
Anyhow, I restored the return() statement and ran <a href="http://circleci-build-macos.sh">circleci-build-macos.sh</a>  again and then make tarball.<br>
This appeared to work but the plugin crashed on load:</p>
<div class="codehilite"><pre><span></span><code>libc++.1.dylib                      0x7ff812462f77 std::__1::basic_string&lt;wchar_t, std::__1::char_traits&lt;wchar_t&gt;, std::__1::allocator&lt;wchar_t&gt; &gt;::operator=(std::__1::basic_string&lt;wchar_t, std::__1::char_traits&lt;wchar_t&gt;, std::__1::allocator&lt;wchar_t&gt; &gt; const&amp;) + 9
1   libwx_baseu-3.1.2.0.0.dylib            0x13672b4f8 wxArrayString::Add(wxString const&amp;, unsigned long) + 232
2   libwx_osx_cocoau_core-3.1.2.0.0.dylib          0x13d42902c wxImage::SaveFile(wxString const&amp;, wxString const&amp;) const + 108
3   OpenCPN                                0x1095bb256 PluginLoader::LoadPluginCandidate(wxString, bool) + 4454
4   OpenCPN                                0x1095b7892 PluginLoader::LoadPlugInDirectory(wxString const&amp;, bool) + 1874
5   OpenCPN                                0x1095b5264 PluginLoader::LoadAllPlugIns(bool) + 1268
6   OpenCPN                                0x109376121 run_update_dialog(PluginListPanel*, PlugInContainer*, bool, char const*, bool) + 5505
7   OpenCPN                                0x1093739ee pluginUtilHandler::OnPluginUtilAction(wxCommandEvent&amp;) + 206
8   libwx_baseu-3.2.0.1.0.dylib            0x10a4ba4df wxEventHashTable::HandleEvent(wxEvent&amp;, wxEvtHandler*) + 367
9   libwx_baseu-3.2.0.1.0.dylib            0x10a4bb23a wxEvtHandler::ProcessEventLocally(wxEvent&amp;) + 90
</code></pre></div>
<p>Now what is interesting here is that OCPN was called from libwx_baseu-3.2.0.1.0.dylib but when LoadPluginCandidate called wxImage::SaveFile, it used code from a wx3.1.2 dylib <span aria-label="oh no" class="emoji emoji-1f615" role="img" title="oh no">:oh_no:</span> <br>
Checking back - I am definitely using sd3.2.2 but the build appears to be using wx3.1.2:</p>
<div class="codehilite"><pre><span></span><code>Tony@Laing build-osx % make tarball
[100%] Generating tarball-conf-stamp
-- Cmake version: 3.25.1.
-- Build uses 8 processors
-- Building: tarball
-- Building for target-release darwin-wx32-10
-- Selected upload repository: o p e n c p n / j a v a s c r i p t - a l p h a
&#39;wx-config&#39; &#39;--version&#39;
3.1.2
-- Found Gettext: /usr/local/opt/gettext/bin/msgmerge (found version &quot;0.21&quot;)
-- Found OpenGL: /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX13.1.sdk/System/Library/Frameworks/OpenGL.framework
-- Found wxWidgets: -L/usr/local/lib;;;-framework IOKit;-framework Carbon;-framework Cocoa;-framework AudioToolbox;-framework System;-framework OpenGL;-lwx_baseu-3.1;-lwx_osx_cocoau_core-3.1;-lwx_baseu_net-3.1;-lwx_baseu_xml-3.1;-lwx_osx_cocoau_html-3.1;-lwx_osx_cocoau_stc-3.1;-lwx_osx_cocoau_aui-3.1;-lwx_osx_cocoau_gl-3.1 (found version &quot;3.1.2&quot;)
-- Using bundled tinyxml
-- Configuring done
-- Generating done
-- Build files have been written to: /Users/Tony/OpenCPN_project/JavaScript-project/JavaScript_pi/build-osx
</code></pre></div>
<p>and later</p>
<div class="codehilite"><pre><span></span><code>fix-macos-libs.sh: Revised library paths:
    @executable_path/../Frameworks//libwx_baseu-3.1.dylib (compatibility version 1.0.0, current version 1.0.0)
    @executable_path/../Frameworks//libwx_osx_cocoau_core-3.1.dylib (compatibility version 1.0.0, current version 1.0.0)
    @executable_path/../Frameworks//libwx_baseu_net-3.1.dylib (compatibility version 1.0.0, current version 1.0.0)
    @executable_path/../Frameworks//libwx_baseu_xml-3.1.dylib (compatibility version 1.0.0, current version 1.0.0)
    @executable_path/../Frameworks//libwx_osx_cocoau_html-3.1.dylib (compatibility version 1.0.0, current version 1.0.0)
    @executable_path/../Frameworks//libwx_osx_cocoau_stc-3.1.dylib (compatibility version 1.0.0, current version 1.0.0)
    @executable_path/../Frameworks//libwx_osx_cocoau_aui-3.1.dylib (compatibility version 1.0.0, current version 1.0.0)
    @executable_path/../Frameworks//libwx_osx_cocoau_gl-3.1.dylib (compatibility version 1.0.0, current version 1.0.0)
</code></pre></div>
<p>'Nuff said.</p>



<a name="326002585"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/326002585" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alec Leamas <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#326002585">(Feb 05 2023 at 19:13)</a>:</h4>
<blockquote>
<p>If you comment out "return ()" in cmake/MacosWxwidgets.cmake it assumes you will compile wxWidgets again</p>
</blockquote>
<p>What that code does is to run the wx-config command. This is installed  when wxWidgets is installed, that it runs means there is a wxWidgets installation available. My thinking has been that either this should be used or removed. </p>
<p>You seem to have a case which should run a recompilation even though there is a wxWidgets installation in place. This might be a bit hairy, I'm not  convinced that the installation routines removes the old libs before installing the new. The result <strong>might</strong> be that both the old system and the new are installed in  parallel. </p>
<p>Needless to say, this seems risky. Wouldn't it be better to remove the existing wxWidgets installation first if it shouldn't be used?</p>



<a name="326002641"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/326002641" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alec Leamas <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#326002641">(Feb 05 2023 at 19:13)</a>:</h4>
<p>Another aspect is that the cmake code might need some comments...</p>



<a name="326002873"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/326002873" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alec Leamas <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#326002873">(Feb 05 2023 at 19:16)</a>:</h4>
<p><span class="user-mention" data-user-id="399559">@Mike Rossiter</span>  ^</p>



<a name="326063183"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/326063183" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#326063183">(Feb 06 2023 at 08:13)</a>:</h4>
<p>On Windows we can keep the wxWidgets installations well separated and use as required for local builds.<br>
On MacOS I only had wxWidgets 3.2.1 installed. I think Tony has other wxWidgets in <em>usr/local</em>, which are not removed. The wxWidgets build  from cmake starts by putting the wxWidgets libs in the <em>_deps</em> directory of the plugin repo, I think. Is it possible to use these libs iso already installed ones, when <em>cirecleci-macos-build.sh</em> is run?</p>



<a name="326063253"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/326063253" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#326063253">(Feb 06 2023 at 08:13)</a>:</h4>
<p>Boating jobs today.</p>



<a name="326081668"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/326081668" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alec Leamas <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#326081668">(Feb 06 2023 at 09:57)</a>:</h4>
<p>The "build form source" macos code installs into /usr/local, effectively colliding with other installations. This is probably something to fix. We could make an installation into some directory local to the project and use that. Some work, but doable.</p>
<p>We should probably add a  cmake variable which forces a rebuild even if there is an installation in /usr/local, like FORCE_WX_BUILD. </p>
<p>The test that there is a wxWidgets installation in the beginning could be enhanced so it not just checked that it exists but also that it is actually 3.2, forcing a rebuild otherwise.</p>



<a name="326082764"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/326082764" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alec Leamas <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#326082764">(Feb 06 2023 at 10:03)</a>:</h4>
<p><span class="user-mention" data-user-id="399559">@Mike Rossiter</span>  <a href="https://github.com/Rasbats/shipdriver_pi/issues/495">https://github.com/Rasbats/shipdriver_pi/issues/495</a></p>



<a name="326185635"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/326185635" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#326185635">(Feb 06 2023 at 16:34)</a>:</h4>
<blockquote>
<p>checked that it exists but also that it is actually 3.2</p>
</blockquote>
<p>Even if 3.2 is present it may not have been made with the same parameters as Dave. For instance I used Homebrew wxWidgets (3.2.1) . These allowed a build of JavaScript_pi but the result was not compatible with OpenCPN 5.7.1 beta 3.</p>



<a name="326186688"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/326186688" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alec Leamas <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#326186688">(Feb 06 2023 at 16:38)</a>:</h4>
<p>Yes, that is the reason we need also something like FORCE_WX_BUILD, see above</p>



<a name="327801413"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/327801413" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#327801413">(Feb 14 2023 at 15:16)</a>:</h4>
<p>Hope I am not jumping the gun here... have given tags: sd3.2.1-beta1 / sd3.2.3-beta1 a whirl.<br>
Still got <em>arm</em> conflict as the <a href="http://circleci-build-macos.sh">circleci-build-macos.sh</a> file does not have <code>-DCMAKE_OSX_ARCHITECTURES=x86_64</code> in it after the template update.  The <code>-DOCPN_TARGET_TUPLE="darwin-wx32;10;x86_64"</code> does not seem to fix all places x86 is needed.</p>
<p>Having tried to build the tarball when I discovered this, it seems I had to reinstall the template and fix the build file as above before attempting to make a tarball (when lots gets compiled).</p>
<p>$ make tarball comes up with two errors.Fairly early on I got</p>
<div class="codehilite" data-code-language="CMake"><pre><span></span><code><span class="w">  </span><span class="err">math</span><span class="w"> </span><span class="err">does</span><span class="w"> </span><span class="err">not</span><span class="w"> </span><span class="err">recognize</span><span class="w"> </span><span class="err">sub-command</span><span class="w"> </span><span class="err">_nproc</span>
<span class="err">Call</span><span class="w"> </span><span class="nb">Stack</span><span class="w"> </span><span class="p">(</span><span class="s">most</span><span class="w"> </span><span class="s">recent</span><span class="w"> </span><span class="s">call</span><span class="w"> </span><span class="s">first</span><span class="p">)</span><span class="err">:</span>
<span class="w">  </span><span class="err">CMakeLists.txt:</span><span class="nb">84</span><span class="w"> </span><span class="p">(</span><span class="s">include</span><span class="p">)</span>
</code></pre></div>
<p>and at the end I then got (probably consequentially),</p>
<div class="codehilite"><pre><span></span><code>wx_osx_cocoau_core-3.2.0.1.0.dylib] Error 1
CMake Error at cmake/MacosWxwidgets.cmake:98 (message):
  Cannot locate wx-config tool at
  /Users/Tony/OpenCPN_project/JavaScript-project/JavaScript_pi/cache/lib/wx/config/osx_cocoa-unicode-3.2
Call Stack (most recent call first):
  CMakeLists.txt:84 (include)

-- Configuring incomplete, errors occurred!
</code></pre></div>
<p>Should I have done something about installing a sub-module, like I was told to do a while back?  I think it got lost when I went back to the old build system.</p>



<a name="327807486"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/327807486" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#327807486">(Feb 14 2023 at 15:40)</a>:</h4>
<blockquote>
<p>sd3.2.3-beta1</p>
</blockquote>
<p>Testing here for my fork of JS_pi. ShipDriver is building ok with this template, online.</p>



<a name="327817146"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/327817146" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#327817146">(Feb 14 2023 at 16:21)</a>:</h4>
<p><span class="user-mention silent" data-user-id="399559">Mike Rossiter</span> <a href="#narrow/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6/near/327807486">said</a>:</p>
<blockquote>
<blockquote>
<p>sd3.2.3-beta1</p>
</blockquote>
<p>Testing here for my fork of JS_pi. ShipDriver is building ok with this template, online.</p>
</blockquote>
<p>What tag do I have to use to get sd3.2.3-beta1?  Just [sd3.2.3-beta1] ?</p>



<a name="327817853"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/327817853" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#327817853">(Feb 14 2023 at 16:24)</a>:</h4>
<p>bash update-templates sd3.2.3-beta1</p>
<p>I am having errors with branch v2.1.0-wx3.2. What branch should I be using?</p>



<a name="327831038"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/327831038" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#327831038">(Feb 14 2023 at 17:22)</a>:</h4>
<p>v2.1.0 is my start on making use of OCPN5.8 - not been able to test anything yet. Please leave that.</p>
<p>Have created a branch v2.0.2-wx32, which uses sd3.2.3 to build latest sound version.<br>
It builds - the alphas are in my repositary.  You could try the Windows build.</p>
<p>However, the MacOS tarball will not import.  Plugin Loader just says <em>incompatible plugin</em> and puts nothing in the log as to why <span aria-label="face exhaling" class="emoji emoji-1f62e-200d-1f4a8" role="img" title="face exhaling">:face_exhaling:</span> <br>
I have checked and the remote circleci-build-macos file has my patch for x86 in it.</p>
<p>My text editor insists on displaying the name of <code>MacosWxwidgets.cmake</code> in red.  It doesn't like it and probably finds it invalid cmake.<br>
This could explain the error I got (detailed above) when trying a local build.</p>



<a name="327832944"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/327832944" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alec Leamas <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#327832944">(Feb 14 2023 at 17:31)</a>:</h4>
<blockquote>
<p>However, the MacOS tarball will not import. Plugin Loader just says incompatible plugin and puts nothing in the log as to why <span aria-label="face exhaling" class="emoji emoji-1f62e-200d-1f4a8" role="img" title="face exhaling">:face_exhaling:</span></p>
</blockquote>
<p>Please run with --loglevel debug, try to import the plugin, exit opencpn and attach the log file here. I'm sure it tells us what's wrong.</p>



<a name="327833841"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/327833841" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alec Leamas <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#327833841">(Feb 14 2023 at 17:35)</a>:</h4>
<blockquote>
<p>Have created a branch v2.0.2-wx32, which uses sd3.2.3 to build latest sound version.</p>
</blockquote>
<p>That is  v2.0.2-wx3.2, right?</p>
<blockquote>
<p>My text editor insists on displaying the name of MacosWxwidgets.cmake in red. It doesn't like it and probably finds it invalid cmake.<br>
This could explain the error I got (detailed above) when trying a local build.</p>
</blockquote>
<p>Probably not. It builds locally for me, and cmake is by definition platform agnostic. It might be about your editor barfing on some constructs it doesn't recognize</p>



<a name="327834163"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/327834163" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alec Leamas <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#327834163">(Feb 14 2023 at 17:37)</a>:</h4>
<p>On a sidenote you have just too many compilation warnings, you need to take care of them. Sooner or later one of them will turn out as being important.</p>



<a name="327837937"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/327837937" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alec Leamas <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#327837937">(Feb 14 2023 at 17:53)</a>:</h4>
<p>New data point: v2.0.2-wx3.2 builds OK on circleci.  Flatpak and Android builds fails on known bugs fixed in later versions. I'll if I can make a PR for you .,</p>



<a name="327841265"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/327841265" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#327841265">(Feb 14 2023 at 18:09)</a>:</h4>
<p>Yes <code>v2.0.2-wx3.2</code><br>
<code>I'll if I can make a PR for you .</code> <span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span><br>
Sorry Alec... am struggling to launch OCPN from terminal - not done it before.<br>
With applications folder as terminal cd<br>
<code>Open OpenCPN --args --loglevel debug</code><br>
says no such file.  Will work on it but am going out tonight.  Back tomorrow.</p>



<a name="327845659"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/327845659" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alec Leamas <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#327845659">(Feb 14 2023 at 18:30)</a>:</h4>
<p>If you have installed from a package, it is in /Applications. That is,  start it with <code>/Applications/OpenCPN.app/Contents/MacOS/OpenCPN --loglevel debug</code></p>



<a name="327845866"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/327845866" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alec Leamas <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#327845866">(Feb 14 2023 at 18:31)</a>:</h4>
<p>One the command line, there is no need for Open. Just run the binary...</p>



<a name="327994552"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/327994552" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#327994552">(Feb 15 2023 at 12:26)</a>:</h4>
<p>Able to launch now but cannot find any way to have a Toolbar when launched from Terminal with or without debug.<br>
Launching normally -&gt; Toolbar<br>
Launch from Terminal -&gt; No Toolbar to be seen anywhere</p>



<a name="328007866"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/328007866" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alec Leamas <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#328007866">(Feb 15 2023 at 13:26)</a>:</h4>
<p>your installation is certainly broken. What version have you installed, and how?</p>



<a name="328014819"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/328014819" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alec Leamas <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#328014819">(Feb 15 2023 at 13:48)</a>:</h4>
<p>I have installed a package from "some" 5.7.1 build. Now building current master, will be able to install it later.</p>
<p>If you have installed it from a .pkg file (like the official 5.6.2 distribution) it is seemingly installed in /usr/local i. e., use <code>/usr/local/bin/OpenCPN.app/Contents/MacOS/OpenCPN --loglevel debug</code>. This would mean that you have a somehow broken installation in /Applications/OpenCPN.</p>
<p>Off for a while.</p>



<a name="328032747"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/328032747" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#328032747">(Feb 15 2023 at 15:04)</a>:</h4>
<p>Only a very ancient OCPN in /usr/local/bin from 2020 which I have now removed to avoid any complications.<br>
I installed Beta <a href="https://github.com/opencpn/OpenCPN/issues/3">#3</a> from the link which downloaded a .pkg.  This puts it in /Applications and puts nothing in /usr/local/bin<br>
Am using a separate account to avoid the preference fils and plugins tangling with my 5.6.2 installation.<br>
But I have just re-downloaded it onto a different (Mac Venturer) computer and still see the same problem.  No toolbar when launched via terminal but OK if launched directly.<br>
I can launch OCPN5.5.2 from Terminal and see the toolbar OK<br>
But if I launch Beta <a href="https://github.com/opencpn/OpenCPN/issues/3">#3</a> directly, I see the toolbar.  But if I launch via Terminal, no toolbar.</p>



<a name="328037071"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/328037071" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#328037071">(Feb 15 2023 at 15:21)</a>:</h4>
<p><span class="user-mention silent" data-user-id="399510">Alec Leamas</span> <a href="#narrow/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6/near/327834163">said</a>:</p>
<blockquote>
<p>On a sidenote you have just too many compilation warnings, you need to take care of them. Sooner or later one of them will turn out as being important.</p>
</blockquote>
<p>Yes... annoying.  But most are from compiling the duktape JavaScript engine  so outside my control and I don't think it wise to go in and rework it.  Hopefully, some future update to that will eliminate them.  The others are from Xcode elements.<br>
I think I have dealt with mine since JS v2.0.1. <br>
I do read through them before to check for things I ought to deal with.</p>



<a name="328041232"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/328041232" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#328041232">(Feb 15 2023 at 15:37)</a>:</h4>
<p>Having a problem with the toolbar icon showing for Windows. It appears black,  then grey when toggled. non-svg is ok. Still playing.</p>



<a name="328049008"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/328049008" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alec Leamas <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#328049008">(Feb 15 2023 at 16:09)</a>:</h4>
<p><span class="user-mention" data-user-id="554731">@Tony Voss</span> on phone, busy until late today or tomorrow BBL</p>



<a name="328100515"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/328100515" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alec Leamas <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#328100515">(Feb 15 2023 at 20:16)</a>:</h4>
<p>Hm... I have downloaded the latest beta found at  <a href="https://dl.cloudsmith.io/public/david-register/opencpn-unstable/raw/files/OpenCPN_5.7.1.pkg">https://dl.cloudsmith.io/public/david-register/opencpn-unstable/raw/files/OpenCPN_5.7.1.pkg</a>. It works for me in my virtual (virtualbox) Catalina machine.</p>
<p>However, there are no working  OpenGL drivers on this box, I get a message <em>Unable to create basic Accelerated OpenGL renderer</em>  and <em>Core image is now using the software  OpenGL renderer. This will be slow</em></p>
<p>Given <span class="user-mention" data-user-id="399559">@Mike Rossiter</span> 's comment above., is this the reason it works for me? What happens if you use not only <em>--loglevel debug</em> but also <em>-no_opengl</em> ?</p>



<a name="328124601"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/328124601" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#328124601">(Feb 15 2023 at 22:59)</a>:</h4>
<p><span class="user-mention silent" data-user-id="399510">Alec Leamas</span> <a href="#narrow/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6/near/328100515">said</a>:</p>
<blockquote>
<p>What happens if you use not only <em>--loglevel debug</em> but also <em>-no_opengl</em> ?</p>
</blockquote>
<p>No difference</p>



<a name="328171416"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/328171416" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alec Leamas <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#328171416">(Feb 16 2023 at 07:49)</a>:</h4>
<p>Seems to be about your machine then, somehow.</p>
<p>Things to do: start with --loglevel debug, bring OpenCPN into focus (click on it). Then exit, and submit opencpn.log here so we can have a look.</p>



<a name="328187836"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/328187836" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#328187836">(Feb 16 2023 at 09:25)</a>:</h4>
<p>Attached are the log and terminal outputs.<br>
To keep things simple, this was on an Intel MacBook with no attached screen.<br>
Thanks for looking into it.</p>
<p><a href="/user_uploads/33951/1gTW5mCKkYGuWNaPmMPv9qKQ/terminal.txt">terminal.txt</a><br>
<a href="/user_uploads/33951/M9ctoQ36CRX-gktJZ11LVUbr/log.txt">log.txt</a></p>
<p>Will be away for a bit this morning.</p>



<a name="328210821"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/328210821" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#328210821">(Feb 16 2023 at 11:19)</a>:</h4>
<p>My problem (Windows):</p>
<p><a href="/user_uploads/33951/l3G4oxcObk7mFIVNMoPyFS_-/missing-icon1.png">missing-icon1.png</a> <a href="/user_uploads/33951/WlN5n6b1nzy9WpxzvAjKV218/missing-icon2.png">missing-icon2.png</a> <a href="/user_uploads/33951/33jMAtypg39P5IJ95X0YAOiA/opencpn.log.txt">opencpn.log.txt</a></p>
<div class="message_inline_image"><a href="/user_uploads/33951/l3G4oxcObk7mFIVNMoPyFS_-/missing-icon1.png" title="missing-icon1.png"><img src="/user_uploads/33951/l3G4oxcObk7mFIVNMoPyFS_-/missing-icon1.png"></a></div><div class="message_inline_image"><a href="/user_uploads/33951/WlN5n6b1nzy9WpxzvAjKV218/missing-icon2.png" title="missing-icon2.png"><img src="/user_uploads/33951/WlN5n6b1nzy9WpxzvAjKV218/missing-icon2.png"></a></div>



<a name="328211132"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/328211132" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#328211132">(Feb 16 2023 at 11:21)</a>:</h4>
<p>Same issue if I import the tarball from Cloudsmith.</p>



<a name="328219456"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/328219456" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alec Leamas <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#328219456">(Feb 16 2023 at 12:05)</a>:</h4>
<p><span class="user-mention" data-user-id="554731">@Tony Voss</span>   Just s shot in the dark: Did you see this:?</p>
<div class="codehilite"><pre><span></span><code>09:18:14.805   ERROR fileconf.cpp:608 file &#39;/Users/Tony/Library/Preferences/opencpn/opencpn.ini&#39;, line 154: &#39;=&#39; expected.
</code></pre></div>



<a name="328234295"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/328234295" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alec Leamas <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#328234295">(Feb 16 2023 at 13:18)</a>:</h4>
<p>Another  thing: You are now using an installation in /Applications, right? If so, it might make sense  to make sure there is nothing left in /usr/local/bin -- not really sure how MacOS loads things, but multiple installations certainly <strong>could</strong> be a problem.</p>



<a name="328235112"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/328235112" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#328235112">(Feb 16 2023 at 13:22)</a>:</h4>
<p>Line 154 contained <code>Sometest:asd</code>.  No idea how it got there but have removed it.  No difference.<br>
The other system I am testing on did not have that erroneous line anywhere in the .ini file.<br>
I have tried starting with no .ini file at all, forcing it to create one from scratch.  Terminal launch problem still there.<br>
I have also tried removing the opencpn folder from Preferences, forcing it to create a new one.  Terminal launch problem still there.</p>



<a name="328265949"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/328265949" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#328265949">(Feb 16 2023 at 15:23)</a>:</h4>
<p><span class="user-mention silent" data-user-id="399510">Alec Leamas</span> <a href="#narrow/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6/near/328234295">said</a>:</p>
<blockquote>
<p>Another  thing: You are now using an installation in /Applications, right? If so, it might make sense  to make sure there is nothing left in /usr/local/bin -- not really sure how MacOS loads things, but multiple installations certainly <strong>could</strong> be a problem.</p>
</blockquote>
<p>Yes - in /Applications. No OpenCPN in /local/bin.<br>
Note that OCPN5.6.2 behaves as expected including when launched by Terminal.<br>
OCPN5.7B3 is OK when launched normally but not when from Terminal.  I suspect OCPN5.7, at least B3.</p>



<a name="328281220"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/328281220" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alec Leamas <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#328281220">(Feb 16 2023 at 16:29)</a>:</h4>
<p>yes... is B3 the same link as I used (see above)?</p>



<a name="328290714"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/328290714" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#328290714">(Feb 16 2023 at 17:12)</a>:</h4>
<p>The one in your link was of slightly later date.  I have installed that and it is no different.  No toolbar if launched via terminal.</p>



<a name="328623118"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/328623118" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alec Leamas <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#328623118">(Feb 18 2023 at 08:06)</a>:</h4>
<p>You should file a bug about this. I cannot really help you since I cannot reproduce.</p>



<a name="328639415"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/328639415" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#328639415">(Feb 18 2023 at 10:25)</a>:</h4>
<p><a href="https://github.com/OpenCPN/OpenCPN/issues/3014">https://github.com/OpenCPN/OpenCPN/issues/3014</a></p>



<a name="328663370"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/328663370" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#328663370">(Feb 18 2023 at 12:58)</a>:</h4>
<p><span class="user-mention silent" data-user-id="399510">Alec Leamas</span> <a href="#narrow/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6/near/327832944">said</a>:</p>
<blockquote>
<blockquote>
<p>However, the MacOS tarball will not import. Plugin Loader just says incompatible plugin and puts nothing in the log as to why <span aria-label="face exhaling" class="emoji emoji-1f62e-200d-1f4a8" role="img" title="face exhaling">:face_exhaling:</span></p>
</blockquote>
<p>Please run with --loglevel debug, try to import the plugin, exit opencpn and attach the log file here. I'm sure it tells us what's wrong.</p>
</blockquote>
<p>Managed to try and load plugin with trace by using old Mac running Catalina.  Log from moment of attempting to load plugin is as follows.  Not much to go on.</p>
<div class="codehilite"><pre><span></span><code>12:50:42.820 MESSAGE comm_bridge.cpp:181    ***GPS Watchdog timeout at Lat:57.494   Lon: -4.2344
12:50:47.406   DEBUG plugin_handler.cpp:311 Plugin compatibility check Final: REJECTED:  javascript
12:50:47.820 MESSAGE comm_bridge.cpp:181    ***GPS Watchdog timeout at Lat:57.494   Lon: -4.2344
12:50:52.819 MESSAGE comm_bridge.cpp:181    ***GPS Watchdog timeout at Lat:57.494   Lon: -4.2344
12:50:57.819 MESSAGE comm_bridge.cpp:181    ***GPS Watchdog timeout at Lat:57.494   Lon: -4.2344
12:51:00.757 MESSAGE chcanv.cpp:2393 Metrics:  m_display_size_mm: 331     g_Platform-&gt;getDisplaySize():  1440:900
12:51:00.758 MESSAGE chcanv.cpp:2398 wxDisplaySize(): 1440 900
12:51:00.794 MESSAGE glChartCanvas.cpp:554 BuildFBO 3
12:51:00.794 MESSAGE glChartCanvas.cpp:1009 OpenGL-&gt; Framebuffer OK, size = 1964
12:51:00.802 MESSAGE glChartCanvas.cpp:554 BuildFBO 3
12:51:00.802 MESSAGE glChartCanvas.cpp:1009 OpenGL-&gt; Framebuffer OK, size = 1964
12:51:00.806 MESSAGE glChartCanvas.cpp:554 BuildFBO 3
12:51:00.807 MESSAGE glChartCanvas.cpp:1009 OpenGL-&gt; Framebuffer OK, size = 1964
12:51:00.815 MESSAGE glChartCanvas.cpp:554 BuildFBO 3
12:51:00.815 MESSAGE glChartCanvas.cpp:1009 OpenGL-&gt; Framebuffer OK, size = 1964
12:51:02.819 MESSAGE comm_bridge.cpp:181    ***GPS Watchdog timeout at Lat:57.494   Lon: -4.2344
12:51:05.235 MESSAGE ocpn_frame.cpp:5456 Got quitflag from SIGNAL
12:51:05.335 MESSAGE plugin_loader.cpp:553 PlugInManager: Deactivating PlugIn: /Users/tony/Library/Application Support/OpenCPN/Contents/PlugIns/libJavaScript_pi.dylib
12:51:05.343 MESSAGE ocpn_frame.cpp:1776 opencpn::MyFrame exiting cleanly.
</code></pre></div>



<a name="338017812"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/338017812" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#338017812">(Feb 25 2023 at 15:10)</a>:</h4>
<p>Crazy but ...<br>
Your icons use text (alphanumeric symbols) e.g. {JS} when the svg is constructed. These are not recognised by Windows (blank icons).<br>
Raised an issue with <span class="user-mention" data-user-id="517002">@Dave Register</span> :<br>
<a href="https://github.com/OpenCPN/OpenCPN/issues/3025">https://github.com/OpenCPN/OpenCPN/issues/3025</a><br>
The reason may be that cairo is no longer available in the installation for Windows.<br>
<a href="https://forums.wxwidgets.org/viewtopic.php?t=44708">https://forums.wxwidgets.org/viewtopic.php?t=44708</a><br>
May need another set of icons if the bug cannot be fixed.</p>



<a name="338019246"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/338019246" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#338019246">(Feb 25 2023 at 15:18)</a>:</h4>
<p>We need another set of icons!!! May be another route but is it worth it?</p>



<a name="338024295"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/338024295" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#338024295">(Feb 25 2023 at 15:48)</a>:</h4>
<p><span class="user-mention silent" data-user-id="399559">Mike Rossiter</span> <a href="#narrow/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6/near/338019246">said</a>:</p>
<blockquote>
<p>We need another set of icons!!! May be another route but is it worth it?</p>
</blockquote>
<p>Bit in your hands here, Mike, as you built the icons for me. <br>
If I understand it right, problem arises because the icon was generated from text chars {JS} rather than an image?  And even though ther is no mention of Cairo in the .svg file, wxWidgets uses that to implement it?  SO all text-based icons are a no no?</p>
<p>Other plugins have what is clearly image-based icons.  Should I produce image files for the icons?<br>
What file format and what sizes?<br>
You got me to convert to monochrome for the tool bar to conform with a convention but I note that many of the icons in the plugins panes are coloured - so presumably some colour is allowed there.</p>



<a name="338026642"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/338026642" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#338026642">(Feb 25 2023 at 16:03)</a>:</h4>
<p>The icons used to work fine! </p>
<blockquote>
<p>You got me to convert to monochrome for the tool bar to conform with a convention but I note that many of the icons in the plugins panes are coloured</p>
</blockquote>
<p>From Dave, I think, there was an attempt to standardise on a narrow range of monochrome colours for the toolbar. Obviously not so for the options panel. Not sure if this is still the case.</p>
<p>I tried using a bitmap but no luck with this so far. And I think the quality will not be good. Still playing with this.</p>



<a name="338028372"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/338028372" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#338028372">(Feb 25 2023 at 16:14)</a>:</h4>
<p>I can turn text into png etc. if that helps.  Let me know if I can help.  For the options panel I fancy going back to red as in the documentation.</p>



<a name="338029184"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/338029184" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#338029184">(Feb 25 2023 at 16:20)</a>:</h4>
<p>Thanks. The icons for options and toolbar are all 32x32. If you could come up with some png to use that would help.</p>



<a name="338034558"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/338034558" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#338034558">(Feb 25 2023 at 16:58)</a>:</h4>
<p>Here's a sample in different formats - actually 64x64 in red.  Let me know which format is best and I can generate the monochrome ones.  `do you want them only 32x32 or shall I give you 64x64 to keep quality up until you do whatever you do? <a href="/user_uploads/33951/Z4djQqYzX4T-qpw-Cp-DQVbg/JS_icons.zip">JS_icons.zip</a></p>



<a name="338035164"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/338035164" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#338035164">(Feb 25 2023 at 17:02)</a>:</h4>
<p>Thanks again. I think we could just use bitmaps iso svg, which could improve the quality for the toolbar.</p>



<a name="338041017"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/338041017" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#338041017">(Feb 25 2023 at 17:49)</a>:</h4>
<p>Is this any good?<br>
<a href="/user_uploads/33951/NutBUPa4vzRgIcQpH_vdixOw/JS_icon_64_red-1.svg">JS_icon_64_red-1.svg</a></p>



<a name="338041114"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/338041114" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#338041114">(Feb 25 2023 at 17:50)</a>:</h4>
<p>Yes. Compiling now. No more SVG!</p>



<a name="338045534"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/338045534" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#338045534">(Feb 25 2023 at 18:27)</a>:</h4>
<p>Cannot make the icons in the toolbar toggle. API does not allow with bitmaps. Does it matter? <a href="/user_uploads/33951/cq8T28w_GDmLbpPikqbzSUGW/icon_data.zip">icon_data.zip</a></p>



<a name="338045672"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/338045672" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#338045672">(Feb 25 2023 at 18:29)</a>:</h4>
<p>I will update my repo on github to allow a build in my cloudsmith alpha. You should then be able to see the changes made.</p>



<a name="338048269"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/338048269" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#338048269">(Feb 25 2023 at 18:53)</a>:</h4>
<p><a href="https://github.com/Rasbats/JavaScript_pi/tree/v2.0.2-wx3.2">https://github.com/Rasbats/JavaScript_pi/tree/v2.0.2-wx3.2</a></p>
<p>Changes made in icons.cpp/h and JavaScript_pi.cpp.</p>



<a name="338048657"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/338048657" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#338048657">(Feb 25 2023 at 18:57)</a>:</h4>
<p>Tarball now made on my cloudsmith:<br>
<a href="https://cloudsmith.io/~mike-rossiter/repos/javascript-alpha/packages/">https://cloudsmith.io/~mike-rossiter/repos/javascript-alpha/packages/</a></p>



<a name="338048784"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/338048784" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#338048784">(Feb 25 2023 at 18:58)</a>:</h4>
<p>While messing I moved to api-18!</p>



<a name="338048929"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/338048929" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#338048929">(Feb 25 2023 at 18:59)</a>:</h4>
<p>Dinner and wine are calling.</p>



<a name="338156279"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/338156279" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#338156279">(Feb 26 2023 at 14:18)</a>:</h4>
<p>Mike... can you clarify for me.  It seems</p>
<ol>
<li>svg no longer needed?  We can now use png icons for all platforms?  So you have removed the svg stuff.</li>
<li>You have, in  consequence,  removed the JAVASCRIPT_USE_SVG parameter</li>
<li>But there is now a ocpnUSE_SVG parameter?  Why, given the above?</li>
</ol>



<a name="338166422"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/338166422" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#338166422">(Feb 26 2023 at 15:24)</a>:</h4>
<p>Can I pull your changes back, reviewing them, or should I merge by hand?</p>



<a name="338180894"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/338180894" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#338180894">(Feb 26 2023 at 17:15)</a>:</h4>
<blockquote>
<p>But there is now a ocpnUSE_SVG </p>
</blockquote>
<p>Not sure how that got in there. Not needed. And Plugin.cmake needs the JAVASCRIPT_USE_SVG  stuff removing as well. </p>
<blockquote>
<p>We can now use png icons for all platforms? </p>
</blockquote>
<p>Yes.  wmm_pi does this.</p>
<blockquote>
<p>Can I pull your changes back, reviewing them, or should I merge by hand?</p>
</blockquote>
<p>Not sure if I made other mess. Probably better to merge by hand.</p>



<a name="339297419"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/339297419" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#339297419">(Mar 03 2023 at 09:58)</a>:</h4>
<p>My remote builds are failing for some platforms.  Should they be succeeding, or are they non-viable/obsolete?<br>
I have captured the log for each class</p>
<table>
<thead>
<tr>
<th>platform</th>
<th>errors</th>
</tr>
</thead>
<tbody>
<tr>
<td>flatpak</td>
<td>error: org.freedesktop.Sdk/x86_64/20.08 not installed + signature error</td>
</tr>
<tr>
<td>bookworm</td>
<td>signature error</td>
</tr>
<tr>
<td>android</td>
<td>loads of compile errors re wxWidgets</td>
</tr>
</tbody>
</table>



<a name="339299403"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/339299403" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#339299403">(Mar 03 2023 at 10:07)</a>:</h4>
<p>flatpak: the yaml file does not match the one for ShipDriver. Template problem?</p>
<p>bookwork: template sd3.2.3-beta1 should have fixed this ?????</p>



<a name="339299482"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/339299482" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#339299482">(Mar 03 2023 at 10:07)</a>:</h4>
<p>android not relevant for this plugin, I think.</p>



<a name="339319878"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/339319878" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#339319878">(Mar 03 2023 at 11:39)</a>:</h4>
<p><span class="user-mention silent" data-user-id="399559">Mike Rossiter</span> <a href="#narrow/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6/near/339299482">said</a>:</p>
<blockquote>
<p>android not relevant for this plugin, I think.</p>
</blockquote>
<p>Fine.  Any way of avoiding that build and hence getting the error messages?  I know I could edit the build files but I would need to remember each time the template is updated.</p>



<a name="339321276"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/339321276" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#339321276">(Mar 03 2023 at 11:45)</a>:</h4>
<p><span class="user-mention silent" data-user-id="399559">Mike Rossiter</span> <a href="#narrow/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6/near/339299403">said</a>:</p>
<blockquote>
<p>flatpak: the yaml file does not match the one for ShipDriver. Template problem?</p>
<p>bookwork: template sd3.2.3-beta1 should have fixed this ?????</p>
</blockquote>
<p>What action do you advise?  I am using  latest, I think</p>
<blockquote>
<p>% cat cmake/TemplateVersion<br>
 # Created by update-templates<br>
date: 2023-02-03 15:53 UTC<br>
commit: ff0ae9c<br>
tags: sd3.2.2<br>
sd3.2.2-beta<br>
sd3.2.2-beta1</p>
</blockquote>



<a name="339328267"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/339328267" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#339328267">(Mar 03 2023 at 12:15)</a>:</h4>
<p>Sorry - hold that last. Need to update to sd3.2.3</p>



<a name="339331105"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/339331105" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#339331105">(Mar 03 2023 at 12:29)</a>:</h4>
<p>Android: Only way I can see is to remove the android sections in <em>.circleci/config.yml</em> each time the template is used:</p>
<div class="codehilite"><pre><span></span><code>build-android-arm64:
    docker:
      - image: circleci/android:api-28-ndk
    environment:
      - OCPN_TARGET: android-aarch64
      - CMAKE_BUILD_PARALLEL_LEVEL: 2
    steps:
      - checkout
      - run: ci/circleci-build-android.sh
      - run: ci/maybe-push-upload.sh

  build-android-armhf:
    docker:
      - image: circleci/android:api-28-ndk
    environment:
      - OCPN_TARGET: android-armhf
      - CMAKE_BUILD_PARALLEL_LEVEL: 2
    steps:
      - checkout
      - run: ci/circleci-build-android.sh
      - run: ci/maybe-push-upload.sh
</code></pre></div>



<a name="339334957"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/339334957" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#339334957">(Mar 03 2023 at 12:48)</a>:</h4>
<p>Have updated to sd3.2.3-beta1<br>
Getting:</p>
<blockquote>
<p>CMake Error at CMakeLists.txt:44 (target_link_libraries):<br>
Target "JavaScript_pi" links to:<br>
ocpn::api<br>
but the target was not found. </p>
</blockquote>
<p>CMakeLists.txt around line 44 has:<br>
<code>if (${PKG_NAME} MATCHES wx32)
  target_link_libraries(${CMAKE_PROJECT_NAME} ocpn::api_wx32)
else ()
  target_link_libraries(${CMAKE_PROJECT_NAME} ocpn::api)
endif ()</code><br>
So, clearly, <code>PKG_NAME</code> not being set to <code>wx32</code>.<br>
Indeed it is not.  Only place it is set is in Plugin.cmake:<br>
<code>set(PKG_NAME JavaScript_pi)</code></p>
<p>I'm confused, and so is the script, I guess <span aria-label="face with spiral eyes" class="emoji emoji-1f635-200d-1f4ab" role="img" title="face with spiral eyes">:face_with_spiral_eyes:</span></p>



<a name="339336982"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/339336982" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#339336982">(Mar 03 2023 at 12:57)</a>:</h4>
<p>This should be in <em>opencpn-libs/api-18/CMakeLists.txt</em> at line 16:<br>
<code>add_library(ocpn::api ALIAS OCPN_API_WX32)</code></p>
<p>May need to update opencpn-libs. You are at the bleeding edge I think.</p>



<a name="339339674"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/339339674" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#339339674">(Mar 03 2023 at 13:08)</a>:</h4>
<p>Here's what is in that file for me:</p>
<div class="codehilite"><pre><span></span><code> #
 # Include API header and, on win32, link import libs. Set API_VERSION  and
 # API_OCPN_MIN_VERSION
 #
cmake_minimum_required(VERSION 3.1)

if (TARGET ocpn::api)
  return ()
endif ()

set(API_VERSION &quot;1.18&quot; PARENT_SCOPE)
set(API_OCPN_MIN_VERSION &quot;5.7.0&quot; PARENT_SCOPE)

add_library(OCPN_API_WX32 INTERFACE)
add_library(ocpn::api_wx32 ALIAS OCPN_API_WX32)
target_include_directories(
  OCPN_API_WX32
    INTERFACE &quot;${CMAKE_CURRENT_SOURCE_DIR}&quot;
)
if (WIN32 AND MSVC)
  target_link_libraries(
    OCPN_API_WX32
      INTERFACE &quot;${CMAKE_CURRENT_SOURCE_DIR}/msvc-wx32/opencpn.lib&quot;
  )
  # Assuming unicode build, required for mingw headers
  target_compile_definitions(OCPN_API_WX32 INTERFACE -DUNICODE)
endif ()
</code></pre></div>
<p>Do I still add as you say above?</p>



<a name="339355447"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/339355447" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#339355447">(Mar 03 2023 at 14:11)</a>:</h4>
<p>Problem is I don't think my edit will work when you push to the repo. You need to update <em>opencpn-libs</em>.<br>
In <em>opencpn-libs/README.md</em> is the instruction for updating <em>opencpn-libs</em>.<br>
From the root of JavaScript_pi do the <em>git submodule upate</em> bit.</p>



<a name="339355534"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/339355534" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#339355534">(Mar 03 2023 at 14:12)</a>:</h4>
<p>etc, etc.</p>



<a name="339358892"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/339358892" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#339358892">(Mar 03 2023 at 14:26)</a>:</h4>
<div class="codehilite"><pre><span></span><code>tony@Janov JavaScript_pi % git submodule update --remote --merge opencpn-libs
fatal: Needed a single revision
Unable to find current origin/master revision in submodule path &#39;opencpn-libs&#39;
</code></pre></div>



<a name="339359412"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/339359412" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#339359412">(Mar 03 2023 at 14:28)</a>:</h4>
<p>Hang  on - I had trouble with the .git stuff when merging earlier.  Will try reinstalling.</p>



<a name="339360118"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/339360118" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#339360118">(Mar 03 2023 at 14:32)</a>:</h4>
<p>It says it is already installed - so back to the error message.</p>



<a name="339360298"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/339360298" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#339360298">(Mar 03 2023 at 14:32)</a>:</h4>
<p>Or can I uninstall the sub-module and start fresh?</p>



<a name="339360466"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/339360466" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#339360466">(Mar 03 2023 at 14:33)</a>:</h4>
<p>Your branch v2.0.3-wx3.2 already has the correct line:<br>
<code>add_library(ocpn::api ALIAS OCPN_API_WX32</code><br>
in <em>opencpn-libs/api-18</em>.</p>
<p>Let me work with your fork and see what I get here.</p>



<a name="339361294"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/339361294" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#339361294">(Mar 03 2023 at 14:36)</a>:</h4>
<p>I have switched to my master branch now.  When I switched, it faulted trying to move the submodule .git stuff - said a folder was not empty.  So I had to delete it.  Suggest you work with my Master branch.</p>



<a name="339361528"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/339361528" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#339361528">(Mar 03 2023 at 14:37)</a>:</h4>
<p>Will do.</p>



<a name="339361972"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/339361972" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#339361972">(Mar 03 2023 at 14:38)</a>:</h4>
<p>Just pushed master to remote. 14:38</p>



<a name="339374117"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/339374117" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#339374117">(Mar 03 2023 at 15:22)</a>:</h4>
<p>Took the fork of your master branch. To avoid github desktop errors I went back to <code>git clone --recursive`` etc. The </code>--recursive``` is to bring in the sub-module <em>opencpn-libs</em>.<br>
Updated the template to <em>sd3.2.3-beta1</em>. <br>
build-macos taking forever as it has to make a cache of wxWidgets built in the same way as for OpenCPN. Took 30m the other day. Will be quicker next time as it does not have to rebuild the cache.<br>
All builds, apart from android are good.<br>
Builds arrive in my cloudsmith repo:<br>
<a href="https://cloudsmith.io/~mike-rossiter/repos/javascript-alpha/packages/">https://cloudsmith.io/~mike-rossiter/repos/javascript-alpha/packages/</a><br>
because I used <em>mike-rossiter</em>/ in <em>plugin.cmake</em> iso <em>opencpn</em>.</p>



<a name="339374382"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/339374382" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#339374382">(Mar 03 2023 at 15:23)</a>:</h4>
<p>Workflows for circleci are here:<br>
<a href="https://app.circleci.com/pipelines/github/Rasbats/JavaScript_pi/260/workflows/6017efbb-a5bc-48fe-b526-b8137dea3689">https://app.circleci.com/pipelines/github/Rasbats/JavaScript_pi/260/workflows/6017efbb-a5bc-48fe-b526-b8137dea3689</a></p>



<a name="339375544"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/339375544" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#339375544">(Mar 03 2023 at 15:27)</a>:</h4>
<p>Parking settings (Windows) from tools for my build:</p>
<div class="codehilite"><pre><span></span><code>Bespoke settings

#define CONSOLE_MIN_HEIGHT 39L
#define CONSOLE_STUB 63L
#define PARK_LEVEL 35L
#define PARK_FIRST_X 85L
#define PARK_SEP 2L
</code></pre></div>



<a name="339376256"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/339376256" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#339376256">(Mar 03 2023 at 15:30)</a>:</h4>
<p>Wonderful !!!   Please can you spell out where I do the <code>git clone --recursive</code> bit.  <em>etc..</em> assumes I know what you are doing !</p>



<a name="339378377"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/339378377" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#339378377">(Mar 03 2023 at 15:39)</a>:</h4>
<p>You have your master branch in the repo on github in the cloud.<br>
You want to make a clone of that repo on your Mac.<br>
cd to a folder which does not have JavaScript_pi already present.<br>
With git commands:<br>
<code>git clone --recursive https://github.com/antipole2/JavaScript_pi.git</code><br>
Github desktop should use --recursive but it gave me an error when I tried to make the clone.</p>



<a name="339381468"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/339381468" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#339381468">(Mar 03 2023 at 15:52)</a>:</h4>
<p>However, it fails for me.<br>
Note I pushed my Master at 14:38.  Might you have cloned just before that.  Might I have screwed it up just after that?</p>
<div class="codehilite"><pre><span></span><code>tony@Janov JavaScript_pi % git clone --recursive https://github.com/antipole2/JavaScript_pi.git
Cloning into &#39;JavaScript_pi&#39;...
remote: Enumerating objects: 6636, done.
remote: Counting objects: 100% (1688/1688), done.
remote: Compressing objects: 100% (566/566), done.
remote: Total 6636 (delta 1282), reused 1418 (delta 1106), pack-reused 4948
Receiving objects: 100% (6636/6636), 61.29 MiB | 2.73 MiB/s, done.
Resolving deltas: 100% (3318/3318), done.
Submodule &#39;opencpn-libs&#39; (https://github.com/leamas/opencpn-libs.git) registered for path &#39;opencpn-libs&#39;
Cloning into &#39;/Users/tony/JavaScript/JavaScript_pi/JavaScript_pi/opencpn-libs&#39;...
remote: Enumerating objects: 1606, done.
remote: Counting objects: 100% (73/73), done.
remote: Compressing objects: 100% (34/34), done.
remote: Total 1606 (delta 49), reused 55 (delta 39), pack-reused 1533
Receiving objects: 100% (1606/1606), 23.61 MiB | 3.28 MiB/s, done.
Resolving deltas: 100% (551/551), done.
fatal: remote error: upload-pack: not our ref c58db80d3844179532fd39f3c2b6dad09c8f5798
fatal: the remote end hung up unexpectedly
Fetched in submodule path &#39;opencpn-libs&#39;, but it did not contain c58db80d3844179532fd39f3c2b6dad09c8f5798. Direct fetching of that commit failed.
</code></pre></div>



<a name="339383062"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/339383062" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#339383062">(Mar 03 2023 at 15:58)</a>:</h4>
<p>Let me try the same again.</p>



<a name="339383522"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/339383522" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#339383522">(Mar 03 2023 at 15:59)</a>:</h4>
<p>Maybe I need to re-clone   opencpn-libs from Alec ?</p>



<a name="339384426"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/339384426" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#339384426">(Mar 03 2023 at 16:03)</a>:</h4>
<p>Yes ... that is the difference between us. Suggest updating the opencpn-libs sub-module again. Or run sd3.2.3-beta1 again. For me that is when opencpn-libs got updated.</p>



<a name="339389007"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/339389007" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#339389007">(Mar 03 2023 at 16:23)</a>:</h4>
<p>Parking settings - Ubuntu Focal - Small notebook monitor:</p>
<div class="codehilite"><pre><span></span><code>Bespoke settings

#define CONSOLE_MIN_HEIGHT 38L
#define CONSOLE_STUB 45L
#define PARK_LEVEL 27L
#define PARK_FIRST_X 100L
#define PARK_SEP 20L
</code></pre></div>



<a name="339392116"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/339392116" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#339392116">(Mar 03 2023 at 16:35)</a>:</h4>
<p>Is this last __LINUX__ ?</p>



<a name="339392398"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/339392398" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#339392398">(Mar 03 2023 at 16:36)</a>:</h4>
<p>Yes it is.</p>



<a name="339397624"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/339397624" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#339397624">(Mar 03 2023 at 16:58)</a>:</h4>
<p>Got there.  I am beginning to understand this stuff now.<br>
When I switched back to Master (Which I have not used for some good while) it seems to have discovered that the opencpn-lib sub-module has been restructured since I last used it.  It could not update because there was a folder/file conflict.  I tried to fix it but must have screwed it up and then pushed the screwed-up one to remote.</p>
<p>I re-updated sd3.2.3-beta1 then had to add that extra add-library alias line<br>
Now it has built OK.<br>
I have switched to my opencpn-libs repositary and pushed the update and can now push the JavaScript-pi to master.<br>
Phew!<br>
Sorry to be a drag on you.  I know you have lost of other stuff to attend to.</p>



<a name="339526321"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/339526321" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#339526321">(Mar 04 2023 at 10:35)</a>:</h4>
<p>Something is broken again... sorry to bug you yet more.<br>
I had to reinstall sd3.2.3-beta1, which went OK.  I think it now includes that extra add_library.  Maybe it should be beta2?<br>
I can build locally OK.<br>
Remote builds fail with   <code>add_subdirectory given source "opencpn-libs/api-18" which is not an existing directory.</code><br>
Looking at my opencpn-libs repositary on Github Desktop it says it is a Detached Head, which is correct for a submodule, I believe.  Bu I cannot push it.<br>
Looking on-line, it looks like my opencpn-libs is out of step with Alec's because we have both been adding the add_library fix.<br>
Maybe I need to re-clone it?<br>
Still not sure why I got the error, as the api-18 directory is in there.</p>
<p>BTW 1: when <code>circleci-build-maacos.sh</code> fails because of the above, it still completes with OK in the cicleci pipeline, so it continues and fails later.<br>
BTW 2:  Deleting the Android stuff from  config.yml not a good idea.  Stops all builds because of </p>
<div class="codehilite"><pre><span></span><code>Error calling workflow: &#39;build_all&#39;
Cannot find a definition for job named build-android-arm64
</code></pre></div>



<a name="339526967"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/339526967" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#339526967">(Mar 04 2023 at 10:39)</a>:</h4>
<p>Let me look at your repo. My mistake with android stuff. I had not tried that edit.</p>



<a name="339528537"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/339528537" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#339528537">(Mar 04 2023 at 10:48)</a>:</h4>
<p>Alec's opencpn-libs repo already includes:<br>
<code>add_library(ocpn::api ALIAS OCPN_API_WX32)</code><br>
Your opencpn-libs is out of line with Alec's. No external sub-module found.<br>
Here is the instruction for working with sub-modules:<br>
<a href="/user_uploads/33951/eruraPRoYQYIGGaC-0jxOaDr/README.md">README.md</a> <br>
May be worth removing the sub-module and then adding it again.  All git commands are done in the root folder of JavaScript.</p>



<a name="339542923"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/339542923" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#339542923">(Mar 04 2023 at 12:09)</a>:</h4>
<p>Back in business.<br>
Could not update to latest submodule status because it needed single revision.<br>
So removed submodule and tried to re-install.  This failed because there was still the empty opencpn-libs folder and in .git/modules<br>
Once I had cleared those out, could re-install.</p>
<p>Android builds fail as discussed.<br>
But so are the flatpack and bookworm ones</p>
<div class="codehilite"><pre><span></span><code>The following signatures couldn&#39;t be verified because the public key is not available: NO_PUBKEY 4EB27DB2A3B88B8B
</code></pre></div>
<p>I confirm I am using sd3.2.3-beta1</p>



<a name="339543620"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/339543620" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#339543620">(Mar 04 2023 at 12:13)</a>:</h4>
<blockquote>
<p>I confirm I am using sd3.2.3-beta1</p>
</blockquote>
<p>Silly question: after <code>bash update-templates sd3.2.3-beta1</code> are you doing a git push?</p>



<a name="339546693"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/339546693" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#339546693">(Mar 04 2023 at 12:31)</a>:</h4>
<p>Not so silly. I pushed again to be sure. Still flatpack and bookworm failing.<br>
Buster says <em>success</em> but actually has not done anything.</p>



<a name="339547851"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/339547851" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#339547851">(Mar 04 2023 at 12:38)</a>:</h4>
<p>Need to look at your repo master again.</p>



<a name="339550649"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/339550649" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#339550649">(Mar 04 2023 at 12:56)</a>:</h4>
<p>update-templates has not changed your <em>flatpak</em> folder or <em>.circleci/config.yml</em>.  This explains the failures. Strange.  Need to try an update-templates on my Mac machine.  Out of time at the moment.</p>



<a name="339590485"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/339590485" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#339590485">(Mar 04 2023 at 17:20)</a>:</h4>
<p>The remote MacOS build is taking about 30 minutes every time.  It looks like it is always recompiling wxWidgets.<br>
The log includes the error</p>
<div class="codehilite"><pre><span></span><code>CMake Error at cmake/MacosWxwidgets.cmake:86 (math):
  math does not recognize sub-command _nproc
Call Stack (most recent call first):
  CMakeLists.txt:84 (include)
</code></pre></div>
<p>Possibly this might lead to the recompilation of wxWidgets?<br>
<a href="https://app.circleci.com/pipelines/github/antipole2/JavaScript_pi/201/workflows/3243faf5-a98f-4c70-b04a-ebe3414399ed/jobs/2167">Sample pipeline here</a></p>



<a name="339600281"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/339600281" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#339600281">(Mar 04 2023 at 18:53)</a>:</h4>
<p>The flatpak yaml file is not touched by update-templates on the Mac. I will raise a bug report.<br>
<a href="https://stackoverflow.com/questions/4247068/sed-command-with-i-option-failing-on-mac-but-works-on-linux">https://stackoverflow.com/questions/4247068/sed-command-with-i-option-failing-on-mac-but-works-on-linux</a><br>
For now you could copy my .yaml file and also the <em>build-deps/control</em> file.</p>



<a name="339600424"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/339600424" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#339600424">(Mar 04 2023 at 18:54)</a>:</h4>
<p>From my JavaScript fork (master) of your repo.</p>



<a name="339669013"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/339669013" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#339669013">(Mar 05 2023 at 10:08)</a>:</h4>
<p><a href="https://github.com/Rasbats/shipdriver_pi/issues/505">https://github.com/Rasbats/shipdriver_pi/issues/505</a></p>



<a name="339715271"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/339715271" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alec Leamas <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#339715271">(Mar 05 2023 at 15:55)</a>:</h4>
<blockquote>
<p>android: Only way I can see is to remove the android sections in .circleci/config.yml each time the template is used:</p>
</blockquote>
<p>Look into  <em>build-conf.rc</em></p>
<p>in haste...</p>



<a name="339723205"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/339723205" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#339723205">(Mar 05 2023 at 17:05)</a>:</h4>
<p><span class="user-mention silent" data-user-id="399559">Mike Rossiter</span> <a href="#narrow/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6/near/339600281">said</a>:</p>
<blockquote>
<p>For now you could copy my .yaml file and also the <em>build-deps/control</em> file.</p>
</blockquote>
<ul>
<li>Did this and all building except Android (will try Alec's approach for that).</li>
<li>Buster builds say they have succeeded but actually do no meaningful work.</li>
<li>Copied your dependency file too but MacOS still compiling wxWidgets each time and taking almost 30 minutes.  Pipeline <a href="https://app.circleci.com/pipelines/github/antipole2/JavaScript_pi/211/workflows/f050ad26-6a83-4bb1-9f3b-5eac92fa5273/jobs/2284">here</a>.</li>
</ul>



<a name="339827656"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/339827656" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#339827656">(Mar 06 2023 at 10:19)</a>:</h4>
<p>You are now building branch v2.1.0 iso master. I think the next run of v2.1.0 will build much faster. I think the cache is related to the branch you build from.</p>



<a name="339837075"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/339837075" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#339837075">(Mar 06 2023 at 11:02)</a>:</h4>
<p>Buster builds are frozen. No new plugins are being built. Buster will use existing plugins only.<br>
<a href="https://github.com/OpenCPN/OpenCPN/discussions/2797">https://github.com/OpenCPN/OpenCPN/discussions/2797</a></p>



<a name="340100317"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/340100317" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#340100317">(Mar 07 2023 at 12:47)</a>:</h4>
<p>Managed to get my production builds built.  But have spotted no Windows build.  Not <a href="https://app.circleci.com/pipelines/github/antipole2/JavaScript_pi/211/workflows/f050ad26-6a83-4bb1-9f3b-5eac92fa5273">in here.</a></p>



<a name="340101864"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/340101864" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#340101864">(Mar 07 2023 at 12:54)</a>:</h4>
<p>I will fork v2.1.0 and see what happens here.</p>



<a name="340114768"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/340114768" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#340114768">(Mar 07 2023 at 13:53)</a>:</h4>
<p>The appveyor builds for Windows are here:<br>
<a href="https://ci.appveyor.com/project/antipole2/javascript-pi">https://ci.appveyor.com/project/antipole2/javascript-pi</a><br>
Problems with the new <em>GUIDarray</em> stuff (api-18). Have a feeling that <em>opencpn/libs/api-18</em> is missing something.<br>
TBC</p>



<a name="340130125"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/340130125" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alec Leamas <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#340130125">(Mar 07 2023 at 14:55)</a>:</h4>
<p>Yes, the lib file needs to be updated. Hard to keep up when things moves fast as now.</p>



<a name="340146133"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/340146133" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#340146133">(Mar 07 2023 at 15:55)</a>:</h4>
<p>From Dave's master branch 14 hours ago:<br>
<a href="/user_uploads/33951/My4c1uXvR7zTJ0QPzSXgPQZB/ocpn_plugin.h">ocpn_plugin.h</a> <br>
<a href="/user_uploads/33951/zBOy7xIkY7Zc06PbBGoLLJxN/opencpn.lib">opencpn.lib</a> <br>
JavaScript_pi builds fine with these on Windows.<br>
<span class="user-mention" data-user-id="399510">@Alec Leamas</span> : Shall I make a PR for <em>leams/opencpn-libs</em>?</p>



<a name="340146425"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/340146425" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alec Leamas <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#340146425">(Mar 07 2023 at 15:56)</a>:</h4>
<p>Yes, please do!</p>



<a name="340150754"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/340150754" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alec Leamas <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#340150754">(Mar 07 2023 at 16:12)</a>:</h4>
<p>Right. However, we have still not done anything w r t shipdriver, we need to update the version of opencpn-libs in there.<br>
In shipdriver master branch do:</p>
<div class="codehilite"><pre><span></span><code>    $ git submodule update --remote --merge opencpn-libs
    $ git add opencpn-libs
    $ git commit -m &quot;Updating opencpn-libs to latest version.&quot;
    $ git push ...
</code></pre></div>



<a name="340150898"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/340150898" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alec Leamas <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#340150898">(Mar 07 2023 at 16:13)</a>:</h4>
<p><span class="user-mention" data-user-id="554731">@Tony Voss</span>  You need to update your opencpn-libs, same exercise as above</p>



<a name="340155313"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/340155313" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#340155313">(Mar 07 2023 at 16:31)</a>:</h4>
<p>All done. JavaScript builds fine with CI for all OS. Only Windows tested. Imports fine on latest OpenCPN 5.7.1 local build.</p>



<a name="340156212"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/340156212" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#340156212">(Mar 07 2023 at 16:34)</a>:</h4>
<p>Dam.. Was on v3.2 in ShipDriver. Will revert and make the changes to master branch.</p>



<a name="340157103"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/340157103" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#340157103">(Mar 07 2023 at 16:38)</a>:</h4>
<p>Done.</p>



<a name="340160578"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/340160578" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alec Leamas <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#340160578">(Mar 07 2023 at 16:53)</a>:</h4>
<p>Short of time now, but will cherry-pick into 3.2 later</p>



<a name="340304735"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/340304735" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#340304735">(Mar 08 2023 at 09:19)</a>:</h4>
<p><span class="user-mention silent" data-user-id="399510">Alec Leamas</span> <a href="#narrow/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6/near/340150898">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="554731">Tony Voss</span>  You need to update your opencpn-libs, same exercise as above</p>
</blockquote>
<p>Tried on JavaScript master branch:</p>
<div class="codehilite"><pre><span></span><code>tony@Janov JavaScript_pi % git submodule update --remote --merge opencpn-libs
fatal: Needed a single revision
Unable to find current origin/master revision in submodule path &#39;opencpn-libs&#39;
</code></pre></div>
<p>No updates outstanding.  I do have branches of master branch.</p>



<a name="340384590"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/340384590" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alec Leamas <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#340384590">(Mar 08 2023 at 14:58)</a>:</h4>
<p>Well, you seem to have kind of a state in opencpn-libs... Command above works for other users. Could you please run the following and submit the log?</p>
<div class="codehilite"><pre><span></span><code>$ cd opencpn-libs
$ git status
$ git branch
$ git log --oneline -7
$ git remote
$ git remote show origin
</code></pre></div>



<a name="340390652"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/340390652" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#340390652">(Mar 08 2023 at 15:19)</a>:</h4>
<div class="codehilite"><pre><span></span><code>cd /Users/tony/JavaScript/JavaScript_pi/opencpn-libs
tony@Janov opencpn-libs % git status
HEAD detached at 38762f4
nothing to commit, working tree clean
tony@Janov opencpn-libs % git branch
* (HEAD detached at 38762f4)
  main
tony@Janov opencpn-libs % git log --oneline -7
38762f4 (HEAD, origin/devel) ocpn_plugin.h: clang-format
e2f30a4 api-18: Update ocpn_plugin.h to latest version
d778f76 api-18: Add  compatiblity ocpn::api target (#9)
1648fc0 Add new api-18 library
e7a08c4 api-17: Correct another typo.
aa2247c Correct (probable) typo.
9733384 api-17: Add opencpn.lib for wx32 builds
tony@Janov opencpn-libs % git remote
origin
upstream
tony@Janov opencpn-libs % git remote show origin
* remote origin
  Fetch URL: https://github.com/leamas/opencpn-libs.git
  Push  URL: https://github.com/leamas/opencpn-libs.git
  HEAD branch: main
  Remote branches:
    devel tracked
    main  tracked
    tmp   tracked
  Local branch configured for &#39;git pull&#39;:
    main merges with remote main
  Local ref configured for &#39;git push&#39;:
    main pushes to main (up to date)
tony@Janov opencpn-libs % cd ..
tony@Janov JavaScript_pi % git status
On branch master
Your branch is up to date with &#39;origin/master&#39;.
nothing to commit, working tree clean
tony@Janov JavaScript_pi % git submodule update --remote --merge opencpn-libs
fatal: Needed a single revision
Unable to find current origin/master revision in submodule path &#39;opencpn-libs&#39;
tony@Janov JavaScript_pi %
</code></pre></div>



<a name="340392281"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/340392281" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alec Leamas <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#340392281">(Mar 08 2023 at 15:25)</a>:</h4>
<p>All looks ok in opencpn-libs AFAICT. Bit it looks for the branch "master" instead of "main", that might be a problem, perhaps <strong>the</strong> problem. Let me check</p>



<a name="340394810"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/340394810" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alec Leamas <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#340394810">(Mar 08 2023 at 15:34)</a>:</h4>
<p>Perhaps, more or less a shot in the dark: Look into the file <em>.gitmodules</em>. Here is the definitions for opencpn-libs like <code>path = ...</code> and <code>url = ...</code></p>
<p>Add  a new line like <code>branch = main</code>  below the other ones. Then  run <code>git submodule sync</code> and re-try the update. </p>
<p>Reference: <a href="https://stackoverflow.com/questions/40987847">https://stackoverflow.com/questions/40987847</a></p>



<a name="340412815"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/340412815" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#340412815">(Mar 08 2023 at 16:43)</a>:</h4>
<p><span class="user-mention" data-user-id="399510">@Alec Leamas</span>  That seems to have worked - well done and thank you.  Remote builds gone through too.  Now Android do not fail - just do not do anything - like buster.    That's OK by me because I now, for the first time, get a 'Success' outcome.</p>



<a name="340437851"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/340437851" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#340437851">(Mar 08 2023 at 18:38)</a>:</h4>
<p>My remote builds still do not do Windows.<br>
Also MacOS recompiles loads including  wxWidgets even when run a second time from the same branch.  Takes ca 23 mins.<br>
<a href="https://app.circleci.com/pipelines/github/antipole2/JavaScript_pi/224/workflows/c5310e0f-4d77-46f6-80ae-75b542c58cbe">Work flow here</a>.</p>



<a name="340456063"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/340456063" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alec Leamas <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#340456063">(Mar 08 2023 at 20:14)</a>:</h4>
<p>Windows is build on appveyor (which you need to setup), not circleci. Hence nothing about windows in that log.</p>
<p>EDIT:  First thing to check is your cloudsmith repo: is there a windows build? If not, check the appveyor logs.</p>



<a name="340458096"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/340458096" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alec Leamas <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#340458096">(Mar 08 2023 at 20:26)</a>:</h4>
<p>Why your macos jobs rebuilds wxWidgets I just cannot understand. It does find the cache and installs it.  Have you made any changes to ci/circleci-build-macos.sh?</p>
<p>If you hav'nt you might have a  broken cache for whatever reason, you have been doing all sorts of things here. One way might be to invalidate the cache, look into <em>build-deps/macos-cache-stamp</em> and  use that to invalidate the cache. The first build after that will not find any cache to download, look into the step "Restoring cache" in the log. OTOH, you will see it upload the new cache in the "Saving cache" step.</p>
<p>Next build will find a cache, you will see that it is downloaded in the "Restore cache" step. At this point I don' see how it could start to build wxWidgets like today, it doesn't do that for anyone else. </p>
<p>Still, I don't see everything...</p>



<a name="340550630"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/340550630" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#340550630">(Mar 09 2023 at 09:21)</a>:</h4>
<p>The Windows build is failing in AppVeyor.  Not sure which errors are serious and which can be ignored as I am not familiar with this.  But outcome is a definite fail.<br>
<a href="https://ci.appveyor.com/project/antipole2/javascript-pi/builds/46446359">Log here.</a></p>



<a name="340553084"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/340553084" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#340553084">(Mar 09 2023 at 09:32)</a>:</h4>
<p>May not be connected but I would change <em>Plugin.cmake</em>:<br>
<code>set(PKG_PRERELEASE "alpha")</code><br>
to:<br>
<code>set(PKG_PRERELEASE "")</code></p>



<a name="340554821"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/340554821" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mike Rossiter <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#340554821">(Mar 09 2023 at 09:41)</a>:</h4>
<p>v2.1.0 branch does not contain the latest <em>opencpn-libs</em>. For this reason there are a lot of errors showing in the appveyor log. Related to api-18, which was updated recently.</p>
<div class="codehilite"><pre><span></span><code>$ git submodule update --remote --merge opencpn-libs
$ git add opencpn-libs
$ git commit -m &quot;Updating opencpn-libs to latest version.&quot;
$ git push
</code></pre></div>



<a name="340644922"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/340644922" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#340644922">(Mar 09 2023 at 15:54)</a>:</h4>
<p>Looks like the above is straightened out now.<br>
I needed to update opencpn-libs in my v2.1.0 branch as well as my v2.2.0 branch<br>
Reset Mac cache file and that looks OK now.<br>
Getting Windows build too. <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span></p>
<p>But had loads of problems with merging plugins metadata.<br>
Firstly, I was re-building v2.1.0 to get a Windows build and it seems the  xml file names are not unique if no version change - at least for debian.  So had merge conflicts.  Resorted to bumping version number to v2.1.1.<br>
Secondly, I need to leave the wx315 files in the catalogue for OCPN5.6 but the darwin xml contained target of darwin-wx315, which is no longer accepted during checks after the pull request.  It seems the options are now darwin &amp; darwin-32.  So I edited the target in the xml file to darwin and PRd again. It passed checks this time.  I am waiting for the PR to be accepted.</p>



<a name="341330840"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/341330840" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alec Leamas <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#341330840">(Mar 12 2023 at 20:05)</a>:</h4>
<p>You should not make that edit. Instead, leave it as-is and make a notd to Dave why the check fails. He is aware of the situation, and will merge anyway.  Changing the target to wx-32 passes the checks, but might crash in runtime since these old plugins actually are linked against wx 3.1.5</p>



<a name="341425460"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/341425460" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Tony Voss <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#341425460">(Mar 13 2023 at 10:47)</a>:</h4>
<p><span class="user-mention silent" data-user-id="399510">Alec Leamas</span> <a href="#narrow/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6/near/341330840">said</a>:</p>
<blockquote>
<p>You should not make that edit. Instead, leave it as-is and make a notd to Dave why the check fails. He is aware of the situation, and will merge anyway.  Changing the target to wx-32 passes the checks, but might crash in runtime since these old plugins actually are linked against wx 3.1.5</p>
</blockquote>
<p>Alec.. I only edited the name in the xml file after the builds and just before the PR .  So I believe the builds will be OK.  The edit just got it cleanly through the checks.</p>



<a name="341443682"></a>
<h4><a href="https://opencpn.zulipchat.com#narrow/stream/349785-JavaScript_pi/topic/Building%20for%20later%20than%20OCPN%20v5.6/near/341443682" class="zl"><img src="https://leamas.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alec Leamas <a href="https://leamas.github.io/zulip-archive/stream/349785-JavaScript_pi/topic/Building.20for.20later.20than.20OCPN.20v5.2E6.html#341443682">(Mar 13 2023 at 12:16)</a>:</h4>
<p>But the edit will trick runtime OpenCPN to think that the plugin is wx-32,  but it is not.  Upcoming version  5.8 will load it and most likely crash sooner or later. Older versions will not load it since they only load wx-315. </p>
<p>So, a bad edit. Just disregard the checks which basically are buggy: <a href="https://github.com/OpenCPN/plugins/issues/818">https://github.com/OpenCPN/plugins/issues/818</a>.</p>



<hr><p>Last updated: Jan 12 2025 at 06:14 UTC</p>
</html>