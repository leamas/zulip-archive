[
    {
        "content": "<p>Abandoned the branch v3.2. New tag sd3.2.0-beta1 for testing wx32 builds. Old tag deleted.<br>\nShipDriver is fine.<br>\nUKTides_pi  has a problem with bullseye-wx32 builds:<br>\n<a href=\"https://app.circleci.com/pipelines/github/Rasbats/UKTides_pi\">https://app.circleci.com/pipelines/github/Rasbats/UKTides_pi</a><br>\nSeems to be related to the use of a bounding box.<br>\nWindows msvc-wx32 builds are ok.</p>",
        "id": 311270611,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1669032956
    },
    {
        "content": "<p>I know that UKTides problem. It's about <a href=\"https://github.com/wxWidgets/wxWidgets/issues/22790\">https://github.com/wxWidgets/wxWidgets/issues/22790</a>.</p>\n<p>Basically this boils down to that  wxw 3.2.1 and gcc 12 does not work together. In the Flatpak build I applied a patch to wxWidgets to handle it :(.  We don't have that option on Debian, but we can use an older compiler like gcc-11 or gcc-10 to work around this. I'll look into it.</p>",
        "id": 311273689,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1669034276
    },
    {
        "content": "<blockquote>\n<p>Windows msvc-wx32 builds are ok.</p>\n</blockquote>\n<p>Did you do that?</p>",
        "id": 311273776,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1669034304
    },
    {
        "content": "<p>No need for a 3.2 branch until we have released 3.2, until then we work in master.</p>",
        "id": 311274410,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1669034542
    },
    {
        "content": "<p>Working in master now.</p>\n<blockquote>\n<p>Windows msvc-wx32 builds are ok.<br>\nDid you do that?</p>\n</blockquote>\n<p>ShipDriver and UKTides working fine for Windows. I am having issues with JavaScript. SVG icons do not appear. I used UKTides as a guide. Still working on this one.</p>",
        "id": 311277198,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1669035602
    },
    {
        "content": "<p>I have not made any wx32 builds for windows, for sure. Assuming you don't have either.</p>\n<p>As for UKTides, we will have to patch the wxWidgets headers until it is fixed upstream in 3.2.3 which is a long way  ahead (3.2.2 is still not released). No need to rebuild the packages, though. This is because we are using an deprecated API which of course hasn't been that much tested.</p>",
        "id": 311278412,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1669036042
    },
    {
        "content": "<p>Looking at the wx32 builds and realizes that this will become messy. We need to make two separate builds, one for msvc and another for msvc-wx32. For circleci, this is simple, basically just about  entries in _.circleci/config_ But appveyor only  have a single appveyor.yml. </p>\n<p>Thanks for listening, I think you helped me to sort this out. <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span></p>",
        "id": 311413176,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1669046245
    },
    {
        "content": "<p>Ah... now I see why have are talking about msvc-wx32 builds. You just changed the abi in PluginSetup.cmake </p>\n<p>One basic note here: Could you please try to write a little more descriptive commit messages? Here you just said <em>Update PluginSetup.cmake</em>. To be frank,  the message could have been empty, it would be no difference  (no problem to see which file which is updated).  If you had written something like <em>update target to msvc-wx32</em> it would have saved some time for me. </p>\n<p>And it's not as simple as that. We need to make two different plugins, one which is linked against 3.1.2 (that is msvc) and one which is linked against 3.2.1 (msvc-wx32). I'm on it, but the windows CLI environment is, well, let's say a little different ;)</p>",
        "id": 311452375,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1669058954
    },
    {
        "content": "<blockquote>\n<p>We need to make two different plugins</p>\n</blockquote>\n<p>I am using template sd3.1.4 for msvc builds and sd3.2.0-beta1 for msvc-w32 builds. msvc will soon be deprecated. Will there still be a need for msvc builds?</p>",
        "id": 311471624,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1669063458
    },
    {
        "content": "<blockquote>\n<p>Will there still be a need for msvc builds?</p>\n</blockquote>\n<p>Yes, we need to support both O56 and O58 on Bullseye/Focal. The trick is basically to do two builds in the same appveyor.yml. I have it more or less working, but have run out of steam trying to fight the soo inconsisten CLI environment. </p>\n<p>Should probably learn powershell, it seems to be better defined. But...</p>",
        "id": 311484090,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1669069117
    },
    {
        "content": "<blockquote>\n<p>MSVC: build both against wxWidgets 3.2 and 3.1 (#2797) #466 </p>\n</blockquote>\n<p>If people only knew what work you guys put into this! <br>\nAre we in a position to make a tag that I can test with <em>update-templates</em>?</p>",
        "id": 312256901,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1669409948
    },
    {
        "content": "<p>We can always make tags and test. However, there is still work to do. The MacOS builds needs an update, part of this is to create new binaries of OpnCPN which is on <span class=\"user-mention\" data-user-id=\"517002\">@Dave Register</span>'s table.</p>\n<p>Dave and I has also had a private discussion about the need to support Bionic; for us this means building plugins for Buster. The starting point was that he wanted to build,  while I did not want that. We are heading into some sort of compromise. We have already agreed  that builds for Buster should not go into the catalog except in rare cases.</p>",
        "id": 312259283,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1669411511
    },
    {
        "content": "<p>But, as I said, don't let this stop you from making tags and test them. Be prepared to problems w update-templates...</p>",
        "id": 312259480,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1669411667
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"399559\">@Mike Rossiter</span>   My brain found some bugs in appveyor.bat over the night. Stay tuned for an update.</p>",
        "id": 312307328,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1669451583
    },
    {
        "content": "<p>Thanks.<br>\nWith <em>opencpn-libs/api-16</em> and <em>opencpn-libs/api-17</em> we have a wx3.1.2 build of OpenCPN at present. For O5.8 how is the build going to distinguish between msw and msw-wx32 <em>opencpn.lib</em> in these directories? Naming?</p>",
        "id": 312370491,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1669480110
    },
    {
        "content": "<p>I don't really follow you here. The tarballs have the target in their name i. e., they have either <em>msvc</em> or <em>msvc-wx32</em> as part of the name. Is this what you are  looking for?</p>",
        "id": 312398536,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1669498547
    },
    {
        "content": "<p>ah... ok, I see: the two different libraries (the dll files) has the same name. This might be a problem in corner cases, and in any way confusing for devs. I'll look into it.</p>\n<p>Good catch!</p>",
        "id": 312398886,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1669498845
    },
    {
        "content": "<p>But, but ... it is the <em>opencpn.lib</em> we are using for the Windows build. For building legacy plugins  for O5.6 we can't use an <em>msw-wx32</em> version of <em>opencpn.lib</em>. Updates like <em>sd3.1.4</em> will fail.</p>",
        "id": 312438370,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1669537927
    },
    {
        "content": "<p>Right. Two different things. Need to look also into this, might take some time.</p>\n<p>Windows build environment is, well, interesting...</p>",
        "id": 312447138,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1669543726
    },
    {
        "content": "<p>It's not that bad, everything happens in  libs/api-16 and libs/api-17. We need to add a new,  wx32-based lib to these and link to depending on some condition.</p>\n<p><span class=\"user-mention\" data-user-id=\"399559\">@Mike Rossiter</span> First step would be to create a opencpn.lib linked against wx32. Something you could do?</p>",
        "id": 312453195,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1669547104
    },
    {
        "content": "<p>I have one ready. And the relevant <em>ocpn_plugin.h</em>.<br>\n<a href=\"/user_uploads/33951/hZHUl4pqgTpgIsgEzuMG3i7T/ocpn_plugin.h\">ocpn_plugin.h</a>  <br>\n<a href=\"/user_uploads/33951/Wla4uU9RxZ5fKdd12fO32J3X/opencpn.lib\">opencpn.lib</a></p>",
        "id": 312453599,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1669547314
    },
    {
        "content": "<p>The header should definitely be the same, this is just about how it it is compiled. </p>\n<p>Thanks for the lib! Busy doing other things, but should be able to come up with something today. Might perhaps be late.</p>",
        "id": 312455816,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1669548572
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"399559\">@Mike Rossiter</span>  OK, I have a PR pending also for the opencpn.lib stuff. The bulk of the changes are in opencpn-libs -- these are already pushed.</p>\n<p>However, it would save some time for  me if you first merged <a href=\"https://github.com/Rasbats/shipdriver_pi/pull/469\">https://github.com/Rasbats/shipdriver_pi/pull/469</a>, otherwise I don't really know what to rebase to. Waiting for input from you.</p>",
        "id": 312479515,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1669560521
    },
    {
        "content": "<blockquote>\n<p>However, it would save some time for me if you first merged <a href=\"https://github.com/Rasbats/shipdriver_pi/pull/469\">https://github.com/Rasbats/shipdriver_pi/pull/469</a></p>\n</blockquote>\n<p>Now merged.</p>",
        "id": 312512271,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1669578752
    },
    {
        "content": "<p>OK. will make new PR. Interesting development in <a href=\"https://github.com/OpenCPN/OpenCPN/discussions/2797\">https://github.com/OpenCPN/OpenCPN/discussions/2797</a>, though: after all, no need to make wx30 plugins, wx32 is enough. Need to simplify things...</p>",
        "id": 312514267,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1669580114
    },
    {
        "content": "<blockquote>\n<p>OK. will make new PR.</p>\n</blockquote>\n<p>done: <a href=\"https://github.com/Rasbats/shipdriver_pi/pull/470\">https://github.com/Rasbats/shipdriver_pi/pull/470</a></p>",
        "id": 312516520,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1669581674
    },
    {
        "content": "<p>I will wait for the simplification! The msvc-wx32 builds are not appearing on Cloudsmith at the moment, although they seem to be built correctly by appveyor.</p>",
        "id": 312604260,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1669634159
    },
    {
        "content": "<blockquote>\n<p>The msvc-wx32 builds are not appearing on Cloudsmith</p>\n</blockquote>\n<p>Can you send a link  to such a build?</p>",
        "id": 312626184,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1669641722
    },
    {
        "content": "<p>I. e, the build on appveyor?</p>",
        "id": 312626359,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1669641776
    },
    {
        "content": "<blockquote>\n<p>the build on appveyor?</p>\n</blockquote>\n<p><a href=\"https://ci.appveyor.com/project/Rasbats/shipdriver-pi/builds/45507351\">https://ci.appveyor.com/project/Rasbats/shipdriver-pi/builds/45507351</a></p>",
        "id": 312635295,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1669644360
    },
    {
        "content": "<p>Looks like the choco server(s) was down at the moment this build ran, see below. Can you make a try to just rebuild the same sources?</p>\n<div class=\"codehilite\"><pre><span></span><code>Requirement already satisfied: pip in c:\\python311\\lib\\site-packages (22.3.1)\nChocolatey v1.2.0\nInstalling the following packages:\nwget\nBy installing, you accept licenses for the packages.\nError retrieving packages from source &#39;https://community.chocolatey.org/api/v2/&#39;:\n Could not connect to the feed specified at &#39;https://community.chocolatey.org/api/v2/&#39;. Please verify that the package source (located in the Package Manager Settings) is valid and ensure your network connectivity.\nwget not installed. The package was not found with the source(s) listed.\n Source(s): &#39;https://community.chocolatey.org/api/v2/&#39;\n NOTE: When you specify explicit sources, it overrides default sources.\nIf the package version is a prerelease and you didn&#39;t specify `--pre`,\n</code></pre></div>",
        "id": 312649523,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1669648171
    },
    {
        "content": "<blockquote>\n<p>just rebuild the same sources</p>\n</blockquote>\n<p>Done. Produces an msvc-wx32 tarball. The import works but not the installation. The dll is <em>ShipDriver_pi-wx32.dll</em> and the data folder <em>ShipDriver_pi-wx32</em>. Was this intended?</p>",
        "id": 312656299,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1669650020
    },
    {
        "content": "<p>Yes, sort of... but now I understand that it will fail, since the folder name does not match <em>GetCommonName()</em>  in the API. Sorry, my bad. Back to the drawing board</p>",
        "id": 312667712,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1669653069
    },
    {
        "content": "<p>New PR: <a href=\"https://github.com/Rasbats/shipdriver_pi/pull/471\">https://github.com/Rasbats/shipdriver_pi/pull/471</a></p>\n<p>For now, let's focus on getting this working before we start simplifying.</p>",
        "id": 312737516,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1669676476
    },
    {
        "content": "<p>Using  OpenCPN alpha 5.7.1 fe9f867:<br>\n<a href=\"/user_uploads/33951/6DVcS1kXdIOW9S88PVnG7pSy/msvc-wx32.png\">Picture</a> <br>\nWith the build from the PR the dll is sent to <em>.jail</em>.<br>\nAppveyor build is here:<br>\n<a href=\"https://ci.appveyor.com/project/Rasbats/shipdriver-pi/builds/45519295\">https://ci.appveyor.com/project/Rasbats/shipdriver-pi/builds/45519295</a><br>\nTarballs are here:<br>\n<a href=\"https://cloudsmith.io/~opencpn/repos/shipdriver-alpha/packages/?page=1\">https://cloudsmith.io/~opencpn/repos/shipdriver-alpha/packages/?page=1</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/33951/6DVcS1kXdIOW9S88PVnG7pSy/msvc-wx32.png\" title=\"Picture\"><img src=\"/user_uploads/33951/6DVcS1kXdIOW9S88PVnG7pSy/msvc-wx32.png\"></a></div>",
        "id": 312806829,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1669716533
    },
    {
        "content": "<p>That the \"jail\" code is still there makes me mad, I have spent some time getting rid of it  and now it's there again. Sigh.</p>\n<p>Can you please post opencpn.log, running with <em>--loglevel debug</em>?</p>",
        "id": 312841140,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1669728167
    },
    {
        "content": "<p>By the way: If you open  <em>Options</em> | <em>Plugins</em> | <em>Settings</em> : what is the Active Setting displayed in the Compatibility panel?</p>",
        "id": 312841803,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1669728363
    },
    {
        "content": "<blockquote>\n<p>That the \"jail\" code is still there makes me mad</p>\n</blockquote>\n<p>That was the last installer on the Forum.  Maybe I need to grab/compile the latest master.</p>\n<blockquote>\n<p>Active Setting displayed in the Compatibility panel?</p>\n</blockquote>\n<p><em>CatalogExpert=1</em> has not been used. We have just the 'normal' installed settings.</p>\n<blockquote>\n<p>running with --loglevel debug?</p>\n</blockquote>\n<p>Back later.</p>",
        "id": 312847613,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1669730081
    },
    {
        "content": "<blockquote>\n<p>has not been used. We have just the 'normal' installed settings.</p>\n</blockquote>\n<p>Still, interested in what's \"normal\" for you...</p>",
        "id": 312854265,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1669731946
    },
    {
        "content": "<blockquote>\n<p>Still, interested in what's \"normal\" for you</p>\n</blockquote>\n<p>Basic parallel installation. No settings changed.</p>\n<p>opencpn.log with --loglevel debug :<br>\n<a href=\"/user_uploads/33951/Cxs9bsjcD1eniKvrwfp_CeW2/opencpn.shipdriver.import.log\">opencpn.shipdriver.import.log</a></p>",
        "id": 312898091,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1669743874
    },
    {
        "content": "<p>Hm... the log says:</p>\n<div class=\"codehilite\"><pre><span></span><code>ERROR dlmsw.cpp:167 Failed to load shared library &#39;C:\\Users\\Mike\\AppData\\Local\\opencpn\\plugins\\ShipDriver_pi.dll&#39;(error 126: The specified module could not be found.)\n</code></pre></div>\n<p>Bit it should be there, unless this pesky jailing stuff has already done it's evil work. I must debug this myself, will try to find some time later.</p>",
        "id": 312940584,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1669757039
    },
    {
        "content": "<p>hm... more thinking. If you (after loading the VS studio CLI tools) runs <em>dumpbin /dependents opencpn.exe</em>  where opencpn.exe is the file you use: what is the output? That is, is it really linked to wxWidgets 3.2?</p>",
        "id": 312941895,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1669757510
    },
    {
        "content": "<p>The error message above ( Error 126...) is typically about unresolved runtime deps. What dumpbin does is to show these runtime deps.</p>",
        "id": 312942113,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1669757593
    },
    {
        "content": "<p>No <em>buster</em> metadata files added to auto branch of fork of OpenCPN/plugins.<br>\nDoes <em>build-conf.rc</em> need an edit.</p>\n<p>This is the <em>maybe-push-upload.sh</em> script:<br>\n...<br>\ncase ${OCPN_TARGET,} in<br>\n<em>buster</em>)<br>\n      upload=\"$oldstable_upload\"<br>\n      git_push=\"$oldstable_git_push\"<br>\n      ;;</p>\n<p><em>android</em>)<br>\n      upload=\"$android_upload\"<br>\n      git_push=\"$android_git_push\"<br>\n      ;;</p>\n<p>*)  upload=\"true\"<br>\n      git_push=\"true\"<br>\n      ;;<br>\nesac<br>\n...</p>",
        "id": 316472514,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1671289802
    },
    {
        "content": "<p>It is on purpose, by default we should not build and in particular not upload buster builds. That is, we keep existing buster entries in the catalogue as is. The only exception is if there a serious buster bugfix, something I doubt will ever happen</p>",
        "id": 316479421,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1671292926
    },
    {
        "content": "<p>Thanks. Forgot about this discussion.<br>\nPR for shipdriver_pi with OpenCPN/plugins failed checks. Am I getting too far ahead??? Maybe the catalog for wx32 is not ready.<br>\nOr does ocpn-plugin.xsd need updating or something else.</p>",
        "id": 316480238,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1671293372
    },
    {
        "content": "<p>log here:<br>\n<a href=\"https://github.com/OpenCPN/plugins/actions/runs/3720544300/jobs/6310088725\">https://github.com/OpenCPN/plugins/actions/runs/3720544300/jobs/6310088725</a></p>",
        "id": 316480403,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1671293445
    },
    {
        "content": "<p>Good catch. Seems that the flatpak build used something like flatpak- wx32 , it should not. On phone. Can you check the target value used?</p>",
        "id": 316481514,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1671294026
    },
    {
        "content": "<p><em>set(plugin_target \"flatpak\")</em> in PluginSetup.cmake.</p>",
        "id": 316482148,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1671294399
    },
    {
        "content": "<p>I mean the actual result in the XML metadata</p>",
        "id": 316482428,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1671294553
    },
    {
        "content": "<p>Standby ... just looking.</p>",
        "id": 316482604,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1671294655
    },
    {
        "content": "<p>Hard to stand by. I'm part of today's dinner party host couple</p>",
        "id": 316483006,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1671294858
    },
    {
        "content": "<p>&lt;target&gt;flatpak-x86_64&lt;/target&gt;</p>",
        "id": 316483401,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1671295055
    },
    {
        "content": "<p>Your partner needs to tell you to switch off and enjoy the wine.</p>",
        "id": 316483525,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1671295109
    },
    {
        "content": "<p>Wrong - cannot find flatpack build in the ShipDriver/prod tarballs. They are present in the alpha tarballs. Investigating.</p>",
        "id": 316484237,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1671295438
    },
    {
        "content": "<p>The target is actually ok ..</p>",
        "id": 316484816,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1671295694
    },
    {
        "content": "<p>Should I be using the beta catalog at the moment. I find a tarball in ShipDriver/beta.</p>",
        "id": 316484891,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1671295735
    },
    {
        "content": "<p>No <em>ShipDriver-sd3.2.0-beta7-flatpak.wx32-22.08</em> tarball in ShipDriver/beta either.<br>\nTagged build pushes to ShipDriver/alpha:<br>\n<a href=\"https://app.circleci.com/pipelines/github/Rasbats/shipdriver_pi/847/workflows/0663c8b6-19fd-41fc-8607-2bb765e9dad7/jobs/7215\">https://app.circleci.com/pipelines/github/Rasbats/shipdriver_pi/847/workflows/0663c8b6-19fd-41fc-8607-2bb765e9dad7/jobs/7215</a></p>",
        "id": 316486994,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1671296750
    },
    {
        "content": "<p>In <em>shipdriver.yaml</em>:<br>\n...<br>\nruntime: org.opencpn.OpenCPN<br>\nruntime-version: beta   # FIXME(alec) Revert to stable when updated to 22.08<br>\nsdk: org.freedesktop.Sdk//22.08<br>\n...</p>",
        "id": 316488857,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1671297725
    },
    {
        "content": "<p>Not flatpak-wx32,  just flatpak.</p>",
        "id": 316516373,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1671315572
    },
    {
        "content": "<p><em>ShipDriver-sd3.2.0-beta7-flatpak.wx32-22.08</em> is the name of the tarball in ShipDriver/alpha.</p>",
        "id": 316556846,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1671353431
    },
    {
        "content": "<p><em>metadata.cmake</em> seems to be where the wx32 is added.</p>",
        "id": 316559946,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1671355605
    },
    {
        "content": "<p>Slight hangover here.</p>\n<p>Making a local flatpak build with the same options as the CI job  <code>make -DCMAKE_BUILD_TYPE=Release -DOCPN_WX_ABI=wx32 ..: make flatpak</code> I get a target which is  <code>flatpak-x86_64-wx32</code>. This rightfully  refuses to validate, it should be <code>flatpak-x86_64</code>.</p>\n<p>PR coming</p>",
        "id": 316561201,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1671356398
    },
    {
        "content": "<p><a href=\"https://github.com/Rasbats/shipdriver_pi/pull/483\">https://github.com/Rasbats/shipdriver_pi/pull/483</a></p>",
        "id": 316562362,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1671357278
    },
    {
        "content": "<p>These are the metadata xml files for a beta build:<br>\n<a href=\"https://github.com/Rasbats/plugins/tree/auto/metadata\">https://github.com/Rasbats/plugins/tree/auto/metadata</a><br>\nCorresponding tarballs found in ShipDriver/beta.</p>",
        "id": 316574703,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1671363954
    },
    {
        "content": "<p>Made a release build/tag sd3.2.0 for the master catalog. PR for this made for OpenCPN/plugins. Validation checks all passed.</p>",
        "id": 316581138,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1671366780
    },
    {
        "content": "<p>Great! I will announce the release, stand by..</p>\n<p>BTW: Thanks for your thorough testing!</p>",
        "id": 316581425,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1671366888
    },
    {
        "content": "<p>You missed to update  the release date  in ChangeLog, shit happens. I have updated master.</p>",
        "id": 316582442,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1671367330
    },
    {
        "content": "<p><a href=\"https://github.com/OpenCPN/OpenCPN/discussions/2886\">https://github.com/OpenCPN/OpenCPN/discussions/2886</a></p>",
        "id": 316583269,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1671367801
    },
    {
        "content": "<p>hm... we have a major problem with the sd3.2.0 tag: It exists i  two versions <em>sd3.2.0</em>  and <em>sd3.2.0(1)</em>. The one listed by update-templates is <em>sd3.2.0</em>  a. k.a  6ef81d9 from yesterday.<br>\n<span class=\"user-mention\" data-user-id=\"399559\">@Mike Rossiter</span>  Are you there?</p>",
        "id": 316584873,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1671368546
    },
    {
        "content": "<p>Assuming  not. I will try to handle this, stay tuned...</p>",
        "id": 316585577,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1671368911
    },
    {
        "content": "<blockquote>\n<p>It exists in two versions sd3.2.0 and sd3.2.0(1). </p>\n</blockquote>\n<p>Removed the old 3.2.0 tag today. The replacement should link to commit eb7b01.</p>",
        "id": 316588582,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1671370347
    },
    {
        "content": "<p>I have handled it. See <a href=\"https://github.com/OpenCPN/OpenCPN/discussions/2886\">https://github.com/OpenCPN/OpenCPN/discussions/2886</a></p>",
        "id": 316588620,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1671370370
    },
    {
        "content": "<p>Tag is 3.2.1 not sd3.2.1. Was that intended?</p>",
        "id": 316588822,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1671370460
    },
    {
        "content": "<p>Thanks. Had some problems after pushing all of my local tags, this was probably caused by this. I just removed that one.</p>\n<p>However, the sd3.2.1  has  been there since announced, and this is the only one \"seen\" by update-templates. It <strong>is</strong> a vary bad thing to remove pushed tags, but inb this case I think it made sense.</p>\n<p>Thanks again!</p>",
        "id": 316590358,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1671371179
    },
    {
        "content": "<p>Lesson learned: we should have a release checklist.</p>",
        "id": 316590763,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1671371350
    },
    {
        "content": "<p>Building plugin using sd3.2.2<br>\nIf in Plugin.cmake I have <br>\n<code>set(PKG_API_LIB api-17)  #  A directory in libs/ e. g., api-17 or api-16</code><br>\nthen <code>circleci-build-macos.sh</code> runs OK</p>\n<p>but if I have<br>\n<code>set(PKG_API_LIB api-18)  #  A directory in libs/ e. g., api-17 or api-16</code>.<br>\nthen <code>circleci-build-macos.sh</code> fails with</p>\n<div class=\"codehilite\"><pre><span></span><code>CMake Error at CMakeLists.txt:44 (target_link_libraries):\n  Target &quot;JavaScript_pi&quot; links to:\n\n    ocpn::api\n\n  but the target was not found.  Possible reasons include:\n\n    * There is a typo in the target name.\n    * A find_package call is missing for an IMPORTED target.\n    * An ALIAS target is missing.\n</code></pre></div>\n<p>Looks like the test at CMakeLists.txt line 41 <code>if (${PKG_NAME} MATCHES wx32)</code> is failing.</p>",
        "id": 325798559,
        "sender_full_name": "Tony Voss",
        "timestamp": 1675506109
    },
    {
        "content": "<p>In JavaScript_pi.cpp/.h you are still pointing to 117. Should be 118 for api-18.</p>",
        "id": 325804200,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1675508201
    },
    {
        "content": "<p>Thanks for pointing that out, Mike.  Does <code>circleci-build-macos.sh</code>  look at src files? I had not thought so.<br>\nHave fixed JavaScript_pi.cpp/.h to use <code>opencpn_plugin_118</code> but still the same issue.</p>",
        "id": 325815324,
        "sender_full_name": "Tony Voss",
        "timestamp": 1675512381
    },
    {
        "content": "<p>Let me play with a build here.</p>",
        "id": 325817720,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1675513319
    },
    {
        "content": "<p>The problem with API 18  and the missing ocpn::api is due to a missing line in <em>opencpn-libs/api-18/CMakeLists.txt</em>.</p>\n<div class=\"codehilite\"><pre><span></span><code>add_library(OCPN_API_WX32 INTERFACE)\nadd_library(ocpn::api_wx32 ALIAS OCPN_API_WX32)\nadd_library(ocpn::api ALIAS OCPN_API_WX32)```\n\nTry adding that last line. It works for me. Alec will need to update opencpn-libs/api-18 at some stage.\n</code></pre></div>",
        "id": 325833487,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1675519867
    },
    {
        "content": "<p>It is an ongoing issue:<br>\n<a href=\"https://github.com/leamas/opencpn-libs/issues/9#issuecomment-1416531971\">https://github.com/leamas/opencpn-libs/issues/9#issuecomment-1416531971</a></p>",
        "id": 325833726,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1675519960
    },
    {
        "content": "<p>Adding the third <code>add_library</code> worked - thank you</p>",
        "id": 325841763,
        "sender_full_name": "Tony Voss",
        "timestamp": 1675523473
    },
    {
        "content": "<p>Issues with sd3.2.2-beta1 as of 27th Feb 2023<br>\nThe following issues when building for MacOS</p>\n<p><strong>Local build</strong></p>\n<ol>\n<li>Changed files in src are not being recompiled - cannot make changes!</li>\n<li>After updating to sd3.2.3-beta1, the resulting <code>circleci-build-macos.sh</code> file compiles at least some ARM code, resulting in an incompatible plugin error.  To fix this I have to patch the  <code>circleci-build-macos.sh</code>  file by adding <code>  -DCMAKE_OSX_ARCHITECTURES=x86_64 \\</code></li>\n<li>After running <code>circleci-build-macos.sh</code> <em>make tarball</em> compiles lots more than it used to - like all of wxWidgets.</li>\n<li>The first <em>make tarball</em> fails with <code>Cannot locate wx-config tool</code>.  I have to run it a again, when it appears to work - but changed code is not compiled.</li>\n</ol>\n<p><strong>Remote build</strong></p>\n<ol>\n<li>Most platforms take about 3.5 minutes.</li>\n<li>MacOS takes always takes much much longer.  Just now almost 30 minutes.  It seems to be compiling everything including the kitchen sink, where it seems to be brewing  stuff.  Maybe I was just recompiling all this because of some update but MacOS always takes an inordinate amount of time.</li>\n</ol>",
        "id": 338425566,
        "sender_full_name": "Tony Voss",
        "timestamp": 1677524504
    },
    {
        "content": "<blockquote>\n<p>sd3.2.2-beta1 as of 27th Feb 2023</p>\n</blockquote>\n<p>Latest template for wx32 is <em>sd3.2.3-beta1</em></p>",
        "id": 338432256,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1677526373
    },
    {
        "content": "<p>Whoops - my mistake above.  I am using<br>\n<code> cat cmake/TemplateVersion\nCreated by update-templates\ndate: 2023-02-27 15:30 UTC\ncommit: 318eca5\ntags: sd3.2.1-beta1\nsd3.2.3-beta1</code></p>",
        "id": 338434703,
        "sender_full_name": "Tony Voss",
        "timestamp": 1677527070
    },
    {
        "content": "<p>Still have the above list of problems, except that Remote build no longer unreasonably long (Issue 2 above).  Must have been rebuilding brew stuff for everyone?<br>\nHave now sorted out issues with my branches and am definitely building from the branch I am editing.<br>\nTo have a clean start, I have re-updated to sd3.2.2-beta1.<br>\nIssues 1-4 remain and I cannot get source changes to compile and take effect (1).  I suspect an issue with the dependencies.<br>\nIssue 3: I think sd is no longer caching the wx build in /usr/local/lib.  The versions there are of old date.  So it recompiles the whole lot each time after a new build-osx folder  has been  recreated.<br>\nIssue 4: There are actually two errors. The earlier one is:</p>\n<blockquote>\n<p>CMake Error at cmake/MacosWxwidgets.cmake:86 (math):<br>\n  math does not recognize sub-command _nproc<br>\nCall Stack (most recent call first):<br>\n  CMakeLists.txt:84 (include)</p>\n</blockquote>",
        "id": 338559720,
        "sender_full_name": "Tony Voss",
        "timestamp": 1677583283
    },
    {
        "content": "<blockquote>\n<p>I have re-updated to sd3.2.2-beta1.</p>\n</blockquote>\n<p>Is it worth testing sd3.2.3-beta1? This may fix the caching problem.</p>",
        "id": 338562086,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1677584020
    },
    {
        "content": "<p>Apologies... my mistake again.  I <strong>did</strong> update to sd3.2.3-beta1</p>\n<blockquote>\n<p>bash update-templates sd3.2.3-beta1</p>\n</blockquote>",
        "id": 338564251,
        "sender_full_name": "Tony Voss",
        "timestamp": 1677584627
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"554731\">@Tony Voss</span> </p>\n<p>There seems to be a typo in <em>cmake/MacosWxwidgets.cmake</em>. Here, I read (line 76):</p>\n<div class=\"codehilite\"><pre><span></span><code>math(_nproc ${OPCN_NPROC} * 2)    # Assuming two threads/cpu\n</code></pre></div>\n<p>This should of course be OCPN_NPROC. Question is how this has passed through all the tests we have done. Do you have the same OPCN_NPROC? Does  changing it to OCPN_NPROC fix the problem?</p>",
        "id": 338637756,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1677602955
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"399510\">@Alec Leamas</span> <br>\nYes I have that typo, although it is at line 86 for me.<br>\nI fixed it and re-ran <code>circleci-build-macos.sh</code><br>\nNote that I have my x86 patch in it, without which I get arm64 code in the tarball, which Plugin Loader rejects.<br>\nI still get the same errors on first making the tarball.<br>\nHowever, the terminal output makes interesting reading.  I attach it.  I have added line numbers so we can refer to it.</p>\n<ol>\n<li>Line 9: it appears to think it is building for  <code>aarch64-apple-darwin22.2.0</code>.  Might aarch be another typo?   In any event it should be building for x86. </li>\n<li>Line 10: Yes I am running on  Apple arm64 hardware.</li>\n<li>\n<p>Line 16: Cross-compiling no.  Is that correct?  We are supposed to be compiling for x86 on an arm64  machine.<br>\n4: It is instructive to  search the file for <em>Warnings</em>. Line 1323 and elsewhere warn we are building for arm but linking to x86.  Does not sound good.</p>\n</li>\n<li>\n<p>Line 395: Configured wxWidgets 3.2.1 for `aarch64-apple-darwin22.2.0'</p>\n</li>\n<li>Lines 416-419 _nproc error - perhaps because of processor type confusion?</li>\n<li>It then compiles all of wxWidgets again and as usual</li>\n<li>Line 437 et seq:  <code>Cannot locate wx-config tool</code> Perhaps not surprising, given the confusion?</li>\n<li>Line  1452: I rerun <code>make tarball</code> which does build an x86 tarball which does load into OpenCPN (although it has failed to compile my changed sources - that may be a separate issue.)</li>\n</ol>\n<p><strong>My take</strong><br>\n<code>circleci-build-macos.sh</code> includes <code>  -DOCPN_TARGET_TUPLE=\"darwin-wx32;10;x86_64\" \\</code> and I have added <code> -DCMAKE_OSX_ARCHITECTURES=x86_64 \\</code><br>\nThis does not seem sufficient to convince it to build everything for x86 but my additional patch is sufficient to get a loadable tarball with the second run.<br>\nNB the wxWidgets build is not being cached in <code>/usr/local/lib</code> so is rebuilt after each run of <code>`circleci-build-macos.sh</code>.</p>\n<p><a href=\"/user_uploads/33951/gLCwf7LI25rSLhbPJlsQwwmm/Terminal-Saved-Output.txt\">Terminal-Saved-Output.txt</a></p>",
        "id": 338654016,
        "sender_full_name": "Tony Voss",
        "timestamp": 1677607189
    },
    {
        "content": "<ol>\n<li>aarch64 is certainly no typo. It means the same thing as arm64, and is overall probably more used (arm64 is a debianism)</li>\n<li>compiling for x86 on arm64 hardware is by definition indeed to cross-compile.</li>\n<li>Should not really be about architecture. OCPN_NPROC is set in cmake/PluginOptions.cmake, and basically runs <code>sysctl</code> on MacOS to find out number of processors. If this fails, there should be explicit warnings.</li>\n<li><code>Cannot locate wx-config tool </code> This might be related to processor confusion. Basically, first run rebuilds wxWidgets from source and installs the binaries in the directory <em>cache</em>.  In next step, it tries to find <em>wx-config-tool</em> in <em>cache/</em> but this then seem to fail. This probably means that the wxWidgets build failed for some reason.</li>\n</ol>\n<p>Overall, we have so far just not thought that much about your  use case  (building on m1 for x86_64). I'm not surprised there are problems <span aria-label=\"sad\" class=\"emoji emoji-2639\" role=\"img\" title=\"sad\">:sad:</span></p>",
        "id": 338678136,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1677613853
    },
    {
        "content": "<p>Looking into the log, here are two parts. The part  beginning with -- prefix is the overall shipdriver cmake configuration.  When the \"checking\" prefix arrives, we see the configuration of wxwidgets. In this there is</p>\n<div class=\"codehilite\"><pre><span></span><code> checking build system type... aarch64-apple-darwin22.2.0\n  checking host system type... aarch64-apple-darwin22.2.0\n</code></pre></div>\n<p>It seems like the wxwidgets build is for aarch64 i. e. the host architecture. For this to work, we must somehow convince wxWidgets to cross-compile to x86_64.  This is autotools stuff, see <a href=\"https://www.gnu.org/software/autoconf/manual/autoconf-2.69/html_node/Hosts-and-Cross_002dCompilation.html\">https://www.gnu.org/software/autoconf/manual/autoconf-2.69/html_node/Hosts-and-Cross_002dCompilation.html</a></p>",
        "id": 338680294,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1677614512
    },
    {
        "content": "<p>Thinking aloud, might have to leave. This is about patching MacosWxwidgets, this part:</p>\n<div class=\"codehilite\"><pre><span></span><code>execute_process(\n COMMAND ./configure\n      --with-cxx=11\n      --with-macosx-version-min=10.10\n      --enable-unicode\n      --with-osx-cocoa\n      --enable-aui\n      --disable-debug\n      --with-opengl\n      --without-subdirs\n      --prefix=${cache_dir}\n</code></pre></div>\n<p>Adding correct --host and <del>--target</del> --build. However, this is not the same on the x86_64 hosts which still are more common so it probably needs some trickery</p>",
        "id": 338681408,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1677614900
    },
    {
        "content": "<p>The correct options to add might be  <code>--host x86_64-apple-darwin</code> <code>--build arm64-apple-darwin</code> <br>\nSee also <a href=\"https://groups.google.com/a/webmproject.org/g/webp-discuss/c/YmnyJdO0d1U/m/K63UWr1fAwAJ\">https://groups.google.com/a/webmproject.org/g/webp-discuss/c/YmnyJdO0d1U/m/K63UWr1fAwAJ</a></p>",
        "id": 338683031,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1677615409
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"554731\">@Tony Voss</span>  My suggestion, after hijacking this as my personal log. is that you add <code>--host x86_64-apple-darwin</code>and <code>--build arm64-apple-darwin</code> to the options above and see if you can make it build a x86_64 version of wxWidgets. Check the results in the directory <em>cache/</em>. That should be a first step</p>",
        "id": 338683780,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1677615641
    },
    {
        "content": "<p>Have fired up an Intel x86 Mac to separate x86 and arm64 issues.<br>\nOn Intel Mac, I still see the error  </p>\n<blockquote>\n<p>CMake Error at cmake/MacosWxwidgets.cmake:86 (math):<br>\nmath does not recognize sub-command _nproc<br>\nCall Stack (most recent call first):<br>\nCMakeLists.txt:84 (include)</p>\n</blockquote>\n<p>but not the later one.<br>\nMy plugin builds OK on this platform.</p>\n<p>Will try  Alec's patches later when I have time.</p>\n<p>BTW, not sure why we need wxWidgets libraries anyway when just building plugins  (unless incorporating wx functions not included in OpenCPN).  So maybe the error is not causing me any problem?  We just need the wx header files.  Or have I got this completely wrong?</p>",
        "id": 338789237,
        "sender_full_name": "Tony Voss",
        "timestamp": 1677664937
    },
    {
        "content": "<blockquote>\n<p>BTW, not sure why we need wxWidgets libraries anyway when just building plugins </p>\n</blockquote>\n<p>wxW is a build dependency. That is, when we create a dynamic library like a plugin is must have all  linker references resolved at build time. Later, when deployed in runtime, opencpn resolves these dependencies but we still need to resolve them at build time. For the same reason we bundle some other libraries which are available from OpenCPN at runtime.</p>\n<p>This is pretty standard stuff, more or less the same on all platforms including windows and linux although the details differ.</p>",
        "id": 338797999,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1677667284
    },
    {
        "content": "<blockquote>\n<p>math does not recognize sub-command _nproc</p>\n</blockquote>\n<p>This comes from this line:</p>\n<div class=\"codehilite\"><pre><span></span><code>math(_nproc ${OCPN_NPROC} * 2)    # Assuming two threads/cpu\n</code></pre></div>\n<p>It basically means that OCPN_NPROC is not set as it should, the command expands to <code>math(_nproc * 2)</code> which is gibberish.</p>\n<p>Assuming the typo is fixed (OPCN-&gt;OCPN) this then is about PluginOptions.cmake, but I don't see how this  could fail without any error messages (such messages should come early, PluginOptions is the first file included by CMakeLists).</p>\n<p>So:</p>\n<p>- Have you fixed the OPCN_NPROC typo?<br>\n  - If so, and the problem persists: what happens if you define CMAKE_BUILD_PARALLEL_LEVEL on the command line i. e., adds something like <code>-DCMAKE_BUILD_PARALLEL_LEVEL=2</code> to the cmake invocation?</p>",
        "id": 338800498,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1677667882
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"399559\">@Mike Rossiter</span> <a href=\"https://github.com/Rasbats/shipdriver_pi/pull/506\">https://github.com/Rasbats/shipdriver_pi/pull/506</a></p>",
        "id": 340060495,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1678182316
    },
    {
        "content": "<p>sd3.2.4-beta1 failed to build for ShipDriver <em>bullseye-armhf</em> and <em>bookworm-armhf</em>:<br>\n<a href=\"https://app.circleci.com/pipelines/github/Rasbats/shipdriver_pi/914/workflows/93f316de-85bb-4001-bdc8-566199a8394e\">https://app.circleci.com/pipelines/github/Rasbats/shipdriver_pi/914/workflows/93f316de-85bb-4001-bdc8-566199a8394e</a><br>\nbullseye built with a re-run but bookworm failed to build after 2 re-runs.<br>\nOnly change made was to update the changelog.</p>",
        "id": 354338125,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1682768423
    },
    {
        "content": "<p>issue being raised.</p>",
        "id": 354338308,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1682768447
    },
    {
        "content": "<p>@*<em>Mike Rossiter</em></p>\n<p>Together, we have messed up the v3.2 branch.  Especially, I'm concerned that we have updated opencpn-libs without fixing any named bug besides, perhaps, <a href=\"https://github.com/leamas/opencpn-libs/issues/15\">https://github.com/leamas/opencpn-libs/issues/15</a>.</p>\n<p>OTOH, besides  nmea0183 i. e. that bug  the update is only about adding new libraries and this should not break any eggs.</p>\n<p>Thoughts?</p>",
        "id": 354848499,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1682939767
    },
    {
        "content": "<blockquote>\n<p>add_subdirectory(\"opencpn-libs/nmea0183\")</p>\n</blockquote>\n<p>Needed to use this to update <em>survey_pi</em>. Previously I had a problem with APBPrecision as well. The update to opencpn-libs, using sd3.2.4-beta1 worked fine.</p>",
        "id": 354853378,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1682941277
    },
    {
        "content": "<p>ok, let's keep this then</p>",
        "id": 354861803,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1682943817
    },
    {
        "content": "<blockquote>\n<p>I do not see any reason to have all three, now that the code has sufficiently matured. One will do</p>\n</blockquote>\n<p>Agreed</p>\n<blockquote>\n<p>Which one seems right to you, </p>\n</blockquote>\n<p>We should use <code>__ANDROID__</code>. The reason is that this defined by the compiler, and constants defined by the compiler should IMHO always be preferred when available and applicable. </p>\n<p>One reason is that we don't need to define it ourselves. A simple definition is no problem, but it carries risks that it is not available in all contexts for example when used to conditionalize  <code>#ifdef</code> in the top of files, early before including other files.</p>\n<p>Another reason is that using a compiler defined constant makes the code easier to grasp for new devs, these constants are known, documented, used  elsewhere and easily looked using google et al.</p>\n<p>IMHO, above actually applies to other things.  <code>__linux__</code> is underused,  <code>#ifdef _MSC_VER</code> is a better choice than  <code>#ifdef WIN32</code>, etc.</p>\n<p>BTW: Both ANDROID and __ANDROID__ seems to be available, and there is some confusion about them, the root being the role of the NDK  and the compilers (gcc/clang). Eventually, __ANDROID__ is supported by both clang  and gcc, and to be frank I trust the compilers'  stability  more than NDK's.</p>",
        "id": 355077302,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1683017531
    },
    {
        "content": "<blockquote>\n<p>#ifdef _MSC_VER is a better choice than #ifdef WIN32, </p>\n</blockquote>\n<p>_MSV_VER is actually about the compiler, not the OS. But I guess this distinction is not that well handled, windows is mostly treated as just \"windows\", I guess.</p>",
        "id": 355080672,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1683018353
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"399559\">@Mike Rossiter</span> </p>\n<p>Ooops, i posted a reply to Dave in this stream. Sorry for the mess, but now I understand why I could not find that reply...</p>\n<p>Anyway, we need to make a new beta tag sd3.2.4.beta2 I guess. The current tag beta1 is out of sync with the actual contents in the v3.2 branch. </p>\n<p>Besides that are we happy? What is needed to release?</p>",
        "id": 355421759,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1683117121
    },
    {
        "content": "<blockquote>\n<p>Besides that are we happy? What is needed to release?</p>\n</blockquote>\n<p>win_deps.bat? And the changelog to correct. PR <a href=\"https://github.com/opencpn/OpenCPN/issues/516\">#516</a>?</p>",
        "id": 355678978,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1683183535
    },
    {
        "content": "<p>Perhaps it's better to release what we have, I might not be able to cope with this for some time (own boat + main opencpn)</p>",
        "id": 355765492,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1683204978
    },
    {
        "content": "<blockquote>\n<p>Perhaps it's better to release what we have</p>\n</blockquote>\n<p>Agree. Getting ready for a long cruise here. I will amend the Changelog and make the beta2.</p>",
        "id": 355767582,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1683205452
    },
    {
        "content": "<p>Back from the cruise. Lots to do around the house! <br>\nHave updated the Windows build of sd 3.2 to use wxWidgets 3.2.2.1 with updated <em>win_deps.bat</em>. Tested the alpha and it imports and works.</p>",
        "id": 371371573,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1688192232
    },
    {
        "content": "<p><a href=\"https://cloudsmith.io/~alec-leamas/repos/opencpn-plugins-unstable/packages/\">https://cloudsmith.io/~alec-leamas/repos/opencpn-plugins-unstable/packages/</a> </p>\n<p>Jammy build here works ok. But the builds from the latest commit to ShipDriver v3.2 branch do not. <br>\n<a href=\"https://github.com/Rasbats/shipdriver_pi/commit/1b02b301ed6307d5b524c2a857f997cd1a33d0f6\">https://github.com/Rasbats/shipdriver_pi/commit/1b02b301ed6307d5b524c2a857f997cd1a33d0f6</a></p>\n<p>Unable to go further.</p>",
        "id": 383569051,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1691662905
    },
    {
        "content": "<p>This is odd. When I build the same commit  1b02b30 I get the builds at <a href=\"https://cloudsmith.io/~alec-leamas/repos/opencpn-plugins-unstable/packages/\">https://cloudsmith.io/~alec-leamas/repos/opencpn-plugins-unstable/packages/</a> (same location, the builds with timestamp \"now\")</p>\n<p>Looking into the debian-wx32-x86_64 build, the one targeting Jammy PPA opencpn. This has the metadata target <em>debian-wx32-x86_64</em> which should be OK. Furthermore, it is linked to wxWidgets 3.2 which also is sound. </p>\n<p>When you say it does not work, what exactly is happening when you try to import it (I assume this  is the way you test)?</p>",
        "id": 383674637,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1691682186
    },
    {
        "content": "<blockquote>\n<p>(I assume this is the way you test)?</p>\n</blockquote>\n<p>Correct.  Both the build in your Cloudsmith repos and my v3.2 Cloudsmith (#1b02b30)repos fail. Both are found incompatible.<br>\nDid wonder if there was a typo  in <em>config.yml:</em><br>\nLine 31 in the commit.<br>\n minus    - OCPN_TARGET: bullseye<br>\n plus        - TARGET_TUPLE: debian-x86_64;10;x86_64</p>",
        "id": 383702055,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1691687415
    },
    {
        "content": "<p>The tarball name contains wx32 twice. Was this intended?</p>",
        "id": 383703864,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1691687775
    },
    {
        "content": "<blockquote>\n<p>The tarball name contains wx32 twice. Was this intended?</p>\n</blockquote>\n<p>No, but this is not the central part here. The question is why it deem it as incompatible, and the tarball name is irrelevant in that respect.</p>\n<p>I need opencpn.log using --loglevel debug when you try to import one of these. Something you can attach?</p>",
        "id": 383718310,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1691690850
    },
    {
        "content": "<p><a href=\"/user_uploads/33951/tH61RMwHNWKx7gf1ZXuhhQ9W/opencpn.log\">opencpn.log</a></p>",
        "id": 383720959,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1691691528
    },
    {
        "content": "<p>I see it:. Log: <code>Plugin: init: abi: debian-wx32-x86_64-x86_64, abi_version: 11, major ver: 11</code></p>\n<p>Target: <code> &lt;target&gt;debian-wx32-x86_64-x86_64&lt;/target&gt;</code></p>",
        "id": 383723356,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1691692094
    },
    {
        "content": "<p>I have made new v3.2 branch. This is rebased, I removed \"your\" stuff which belongs to master. <code>git pull</code>will not work. One way to obtain it is  </p>\n<div class=\"codehilite\"><pre><span></span><code>    $ git checkout master\n    $ git fetch -f origin v3.2:v3.2\n    $ git checkout v3.2\n</code></pre></div>\n<p>Builds are available at <a href=\"https://cloudsmith.io/~alec-leamas/repos/opencpn-plugins-unstable/packages/\">https://cloudsmith.io/~alec-leamas/repos/opencpn-plugins-unstable/packages/</a>.  I actually tried to check the target also for previous build, but I obviously  failed. I checked also this time, it does look OK to me.</p>",
        "id": 383743555,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1691697372
    },
    {
        "content": "<p>Tested the builds from your cloudsmith and mine. Both are good when imported in Jammy. I will tag 3.2.5-beta1.</p>\n<blockquote>\n<p>I have made new v3.2 branch.</p>\n</blockquote>\n<p>Thanks again for sorting me out. To align the master branch with v3.2 scripts will using update-templates cause a problem?</p>",
        "id": 383840749,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1691736013
    },
    {
        "content": "<p>there is no need to align master w 3.2. update-templates should work just fine, the trick is the it is self-updating. We'll need to check things for beta2, though.</p>\n<p>Thanks for tagging!</p>",
        "id": 383858941,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1691740939
    },
    {
        "content": "<blockquote>\n<p>there is no need to align master w 3.2.</p>\n</blockquote>\n<p>I was wanting to use master for the next ShipDriver beta for the catalog with the latest scripts. Is a new branch for this a better way to go?</p>",
        "id": 383861122,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1691741366
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"399510\">@Alec Leamas</span>  Getting master scripts in line with v3.2? Or is there stuff there that needs keeping?</p>",
        "id": 384207995,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1691833946
    },
    {
        "content": "<p>Let's not  think that much about 3.2. It's basically a point-fix. We just  move on, leaving 3.2 behind.</p>",
        "id": 384208785,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1691834148
    },
    {
        "content": "<p>Everything there is cherry picked from master besides the targets., this was messy due to the state of the branch. We just need to make sure targets are ok as well  in master.</p>",
        "id": 384209169,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1691834232
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"399559\">@Mike Rossiter</span>  Just FYI: the current ocpn_plugin.h in opencpn-libs/api-18 is broken and needs to be updated before we release 3.3.0</p>",
        "id": 385051853,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1692090555
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"399559\">@Mike Rossiter</span>  I have created a 3.3.0 milestone in github and  assigned some new issues to it. You perhaps might want to do the same with issues you are working on, it creates a better view of when we can consider 3.3.0 completed.</p>",
        "id": 385429782,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1692180552
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"399510\">@Alec Leamas</span> Have added issues that I should resolve for v3.3.0  to be regarded as complete.</p>",
        "id": 387609505,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1693205292
    }
]