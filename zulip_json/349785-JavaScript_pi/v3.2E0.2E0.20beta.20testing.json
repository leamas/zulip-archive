[
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"399559\">@Mike Rossiter</span>  JavaScript v3.0 beta is ready for testing on Windows and Linux please.<br>\nDownload the latest build from the <a href=\"https://app.circleci.com/pipelines/github/antipole2/JavaScript_pi/409/workflows/8f5b8a0e-9f1a-46a6-88c0-c58bfda43ce9\">beta repository here</a>.<br>\nTo run the test suite you will need the  latest <a href=\"https://github.com/antipole2/JavaScript_pi/tree/468ec51ffdea5af000908824669b3c06d705c6cb/Tests_scripts\">Test_scripts fold from here</a> or you can clone/fork the  <a href=\"https://github.com/antipole2/JavaScript_pi/tree/v3.0.0-beta\">v3.0.0-beta branch </a> from the repository.  There are several additions to the test suite.</p>\n<p>thanks</p>",
        "id": 425479185,
        "sender_full_name": "Tony Voss",
        "timestamp": 1709889905
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"554731\">@Tony Voss</span>  On the case.</p>",
        "id": 425767214,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710071481
    },
    {
        "content": "<p>Using Windows and installing, the intro screen appears but is blank and OpenCPN does not respond. The <em>.dll</em> and data folders are found in the correct place in the plugins folder. Same with OpenCPN 5.9.x. I will clone and build with Windows at this end and see what is happening.</p>",
        "id": 425768423,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710072576
    },
    {
        "content": "<p>Please remind me how to use Trace.</p>",
        "id": 425771428,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710075506
    },
    {
        "content": "<p>The trace statement is something like<br>\nTRACE(nn, textString)<br>\nwhere nn is a trace level.</p>\n<p>In trace.h you have</p>\n<div class=\"codehilite\"><pre><span></span><code>#define TRACE_YES   false // if true, include TRACE code. Should be false in release\n#define TRACE_MAX   33  // TRACE level range   (Level 0 always traced)\n#define TRACE_MIN   33\n</code></pre></div>\n<p>Set TRACE_YES to true and the TRACE_MAX and TRACE_MIN to the range of tracing levels you want to trace.  So that should include the nn you chose above.<br>\nVarious numbers are used, so you could happen to get other tracing.  I have used up to 110.</p>",
        "id": 425771994,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710075965
    },
    {
        "content": "<p>Disabled JS in opencpn.ini. This is the blank screen when trying to enable.<br>\n<a href=\"/user_uploads/33951/ZGYR5InlB1FknOxunZsamSvM/1.jpg\">1.jpg</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/33951/ZGYR5InlB1FknOxunZsamSvM/1.jpg\" title=\"1.jpg\"><img src=\"/user_uploads/33951/ZGYR5InlB1FknOxunZsamSvM/1.jpg\"></a></div>",
        "id": 425777237,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710080430
    },
    {
        "content": "<p>The plot thickens. Installed the existing version from the catalog. Runs. Then replaced the .dll with the one from v3.0.0-beta. Runs with the v3.0.0-beta welcome console.<br>\nThe problem seems to be setting up the defaults if JS has not previously been installed.</p>",
        "id": 425778225,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710081159
    },
    {
        "content": "<p>OK - please let me exercise the various setting up situations.  I have made changes in this area.  It will be more than a few minutes before I get around to it - Sunday lunch etc.  <span aria-label=\"yum\" class=\"emoji emoji-1f60b\" role=\"img\" title=\"yum\">:yum:</span></p>",
        "id": 425778750,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710081631
    },
    {
        "content": "<p>Sorry screwed up this message.  Said things do not seem very robust if the section of .ini file not as expected.  And if OCPN thinks plug-in is installed but there is no section in the .ini file, it is not happy.<br>\nWill get back to you.  First I have to get my system working again after messing it up.<br>\nTomorrow is a rare dry day and I need to work on the sliding back door.</p>",
        "id": 425795891,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710096749
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"399559\">@Mike Rossiter</span>  Wondered what state your .ini file is as far a JS plugin is concerned.<br>\nHave tried  various things to test robustness.<br>\nIt seems that with an empty [Plugins/JavaScript_pi]  or missing section,  OCPN hangs in plugin loader before calling init().  I think it should be more robust and deal with it gracefully.</p>\n<p>Anyhow, in latest beta pushed to GitHub c6473d9 but not built  remotely, I have tracing set for levels 1-5 and extra trace statement in  init and load config.  I also have extra wxLogMessage statements for various error conditions and even without errors if TRACE_YES is true.</p>\n<p>Can you give it another go, please?</p>",
        "id": 425870637,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710150115
    },
    {
        "content": "<p>I think the issue starts with <code>LoadConfig()</code>. On it tomorrow.</p>",
        "id": 425970516,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710176679
    },
    {
        "content": "<p>This added to opencpn.ini:</p>\n<div class=\"codehilite\"><pre><span></span><code>[PlugIns/JavaScript_pi.dll]\nbEnabled=1\n</code></pre></div>\n<p><code>LatestImportDir=D:\\\\Documents\\\\Github\\\\JavaScript_pi\\\\build</code></p>\n<p><a href=\"/user_uploads/33951/VUKGd2gFiigXnhaA5qkFM7nv/2.jpg\">2.jpg</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/33951/VUKGd2gFiigXnhaA5qkFM7nv/2.jpg\" title=\"2.jpg\"><img src=\"/user_uploads/33951/VUKGd2gFiigXnhaA5qkFM7nv/2.jpg\"></a></div><p>Then the freeze.</p>",
        "id": 426101353,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710241763
    },
    {
        "content": "<p>Restart OpenCPN and a freeze again, with similar screen.</p>",
        "id": 426101685,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710241896
    },
    {
        "content": "<p>Anything in the log from JavaSCript_pi?<br>\nPlease let me see your  [PlugIns/JavaScript_pi] section from the  .ini file</p>",
        "id": 426103938,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710242800
    },
    {
        "content": "<p>Nothing in the log apart from compatibility testing.</p>\n<blockquote>\n<p>[PlugIns/JavaScript_pi] section from the .ini file</p>\n</blockquote>\n<p>Nothing in the .ini file other than already shown.</p>\n<p>My feeling is that none of the defaults are loaded with LoadConfig() .<br>\nSuch as:</p>\n<div class=\"codehilite\"><pre><span></span><code>consolePosition.x =  pConf-&gt;Read ( name + _T ( &quot;:ConsolePosX&quot; ), 20L );\nconsolePosition.y =  pConf-&gt;Read ( name + _T ( &quot;:ConsolePosY&quot; ), 20L );\nconsoleSize.x =  pConf-&gt;Read ( name + _T ( &quot;:ConsoleSizeX&quot; ), 10L );\nconsoleSize.y =  pConf-&gt;Read ( name + _T ( &quot;:ConsoleSizeY&quot; ), 5L );\n</code></pre></div>",
        "id": 426106004,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710243607
    },
    {
        "content": "<p>Have you tried starting with a .conf file without any JavaScript_pi sections to try and reproduce the problem with the Mac?</p>",
        "id": 426106714,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710243883
    },
    {
        "content": "<p>In my .ini file there are two separate JavaScript sections</p>\n<div class=\"codehilite\"><pre><span></span><code>[PlugIns/libjavascript_pi.dylib]\nbEnabled=1\n</code></pre></div>\n<p>Which is managed by OCPN, including the enabled status<br>\nand then there is another section</p>\n<div class=\"codehilite\"><pre><span></span><code>[PlugIns/JavaScript_pi]\n</code></pre></div>\n<p>which is where all my stuff is stored.</p>\n<p>Other plugins have these two sections too e.g.</p>\n<div class=\"codehilite\"><pre><span></span><code>[PlugIns/libdashboard_pi.dylib]\nbEnabled=0\n[PlugIns/Dashboard]\nVersion=2\n...\n</code></pre></div>\n<p>Starting without any [PlugIns/JavaScript_pi] or an empty section hangs OCPN in PluginLoader. (It should cope - I expect to report that).</p>",
        "id": 426107413,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710244164
    },
    {
        "content": "<blockquote>\n<p>[PlugIns/JavaScript_pi]<br>\nwhich is where all my stuff is stored.</p>\n</blockquote>\n<p>That section is not created here.</p>",
        "id": 426107713,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710244292
    },
    {
        "content": "<p>I wonder how anything has worked in the past.<br>\nYou must have had one in the past.  Could it have been deleted since?<br>\nI will look at coping with no existing section.</p>",
        "id": 426108071,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710244432
    },
    {
        "content": "<p>If I load the old (2.2) version from the catalog the sections are created perfectly. Then loading the new (3.0) version works.</p>",
        "id": 426108382,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710244537
    },
    {
        "content": "<p>With 2.2 had it remembered your previous consoles or did you just get the default one named <code>JavaScript</code> ?</p>",
        "id": 426108801,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710244682
    },
    {
        "content": "<p>You might also see <code>\"Welcome to the JavaScript plugin\\n\\nRun your first script by clicking on the run button above.\\n\\nSee the Help panel right for documentation\"</code></p>",
        "id": 426109015,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710244745
    },
    {
        "content": "<p>I need to compare 2.2 and 3.0 in this respect.</p>",
        "id": 426109469,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710244911
    },
    {
        "content": "<p><a href=\"/user_uploads/33951/QNX5251ASmt1UB9Hn2up5xBu/3.jpg\">3.jpg</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/33951/QNX5251ASmt1UB9Hn2up5xBu/3.jpg\" title=\"3.jpg\"><img src=\"/user_uploads/33951/QNX5251ASmt1UB9Hn2up5xBu/3.jpg\"></a></div>",
        "id": 426111493,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710245623
    },
    {
        "content": "<p>That's because v2.2 sorted things out and then 3.0 saw it was updating from 2.2.<br>\nI really need to find why 3.0 failed without first starting 2.2.</p>\n<p>Meanwhile, please checkout 3.0 as intended</p>\n<blockquote>\n<p>To run the test suite you will need the latest Test_scripts fold from here or you can clone/fork the v3.0.0-beta branch from the repository. There are several additions to the test suite.</p>\n</blockquote>",
        "id": 426112020,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710245838
    },
    {
        "content": "<p>Replaced LoadConfig() v3 with v2.2. The v3 plugin then imported ok, with nothing JS in the .ini file to start with.</p>\n<p>Now testing with v3.</p>",
        "id": 426112539,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710246013
    },
    {
        "content": "<p>I think I have it.  In v3 if it does not find the section, it looks where they used to be stored but,  if not found there, fails to switch back to the present-day location.</p>",
        "id": 426113418,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710246330
    },
    {
        "content": "<p>Not having much luck with the test scripts.  Example:<br>\n<em>JavaScript_pi\\Tests_scripts\\74_dialogue_test.js</em></p>\n<div class=\"codehilite\"><pre><span></span><code>L4  wrapUpWorks with error stack:Duktape context dump:\nctx: top=1, stack=[{}]\n\nL4  Call stack: SyntaxError: source decode failed (line 8)\n    at [anon] (eval:8) internal\n    at [anon] (duk_lexer.c:314) internal\nL5  JavaScript-&gt;message() SyntaxError: source decode failed (line 8)\nL4  JavaScript-&gt;clearDialog()  (None)\nL4  JavaScript-&gt;clearAlert()  (None)\nL0  ------------------ Console JavaScript wrapped up\n</code></pre></div>\n<p>Found that the degree symbol had been introduced in the test script. Now looking at other scripts to see if we have the same problem.</p>",
        "id": 426158784,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710258943
    },
    {
        "content": "<p>Once the degree symbol had been deleted the script ran successfully.</p>",
        "id": 426158940,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710258979
    },
    {
        "content": "<p>The Position object now has a method to parse a position like 52º 23.67'N 3º 14'W<br>\nGreat applications with it.   Have just planned summer cruise by copying positions out of the sailing guide and pasting the waypoints into the chart <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span><br>\ncleanString now converts superscript 0 to degree.<br>\nSo looks like Windows cannot cope with that?</p>",
        "id": 426160898,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710259464
    },
    {
        "content": "<p>Does <code>writeTextFile</code> also use cleanString? 42 fails at the moment.</p>",
        "id": 426161877,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710259750
    },
    {
        "content": "<p>Testscript. 42_writeTextFile.js<br>\nLine 3 fplease change the third parameter from 0 to 1 so it reads<br>\n<code>writeTextFile(data, \"testWriteData\",1);</code></p>",
        "id": 426165652,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710260674
    },
    {
        "content": "<p>You can test characater cleaning in the tools.</p>\n<p>You can now also do it in JavaScript with<br>\n<code>cleanedString = cleanString(dirtyString);</code></p>",
        "id": 426166067,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710260780
    },
    {
        "content": "<blockquote>\n<p>Testscript. 42_writeTextFile.js<br>\nLine 3 fplease change the third parameter from 0 to 1 so it reads<br>\nwriteTextFile(data, \"testWriteData\",1);</p>\n</blockquote>\n<p>No change.</p>",
        "id": 426167122,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710261076
    },
    {
        "content": "<p>I am puzzled.  There is no test 42.  Yes the file exists  but it is not invoked directly by main.</p>",
        "id": 426168430,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710261437
    },
    {
        "content": "<p>main.js failed for me so I went to individual scripts.<br>\nmain.js failed at line 225:<br>\n<code>else printGreen(\"No errors\\n\");</code></p>",
        "id": 426169475,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710261739
    },
    {
        "content": "<p>Very strange.  Try a one line script<br>\n<code>printGreen(\"No errors\\n\");</code></p>",
        "id": 426170045,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710261919
    },
    {
        "content": "<p>result: undefined</p>",
        "id": 426170252,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710261970
    },
    {
        "content": "<p>But it did print \"No errors\"in green  first?</p>",
        "id": 426170417,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710262021
    },
    {
        "content": "<p>Sorry, yes it did.</p>\n<p>Just wondering if we need to have your work in LoadConfig() to make sure nothing is missing from the variables read from the config file.</p>",
        "id": 426170830,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710262139
    },
    {
        "content": "<p>It might help if you knew what has been going on.<br>\nLook here for the release notice: <a href=\"https://github.com/antipole2/JavaScript_pi/blob/v3.0.0-beta/Releast%20notice.md\">https://github.com/antipole2/JavaScript_pi/blob/v3.0.0-beta/Releast%20notice.md</a><br>\nand you can download the new user guide from here <a href=\"https://github.com/antipole2/JavaScript_pi/blob/v3.0.0-beta/documentation/JavaScript_plugin_user_guide.pdf\">documentation/JavaScript_plugin_user_guide.pdf</a></p>",
        "id": 426172147,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710262526
    },
    {
        "content": "<p>I am very close to finding the problem with loadConfig - narrowed it down to one line.<br>\nSo I'll fix fix that first.  But you might like to look at the release notice as it will indicate where work has been done.</p>\n<p>I don't think that issue could lead to what you are seeing. <br>\nWhen you say </p>\n<blockquote>\n<p>main.js failed at line 225:<br>\nelse printGreen(\"No errors\\n\");</p>\n</blockquote>\n<p>what do you mean? What was the error message?<br>\nI am cooking this evening - Ynskje's day off and out.  So I will need to attend to that.  Also tomorrow I am using an almost dry day (!) to have an outside sliding door off to replace the seals and interlock which have arrived from the USA.</p>",
        "id": 426173568,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710262922
    },
    {
        "content": "<p>Off to the kitchen now.</p>",
        "id": 426173784,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710262986
    },
    {
        "content": "<p>SyntaxError: source decode failed (line 225)</p>\n<p>I cleaned the topsides on Kamish yesterday. Rained here today.</p>",
        "id": 426174606,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710263250
    },
    {
        "content": "<p>? seems to be replaced by degree symbol when the script is loaded. Seen in comment in <em>02 PosWayRoutes.js</em> line 33.</p>",
        "id": 426198076,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710271675
    },
    {
        "content": "<p>Postponed door work until better weather.</p>",
        "id": 426278992,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710317118
    },
    {
        "content": "<p>Have reworked and fixed loadConfig.  Pushed to repo.</p>\n<p>In the config file, bool is represented by 0 or 1.  I had<br>\n<code> bool configFound = pConf-&gt;Read ( _T( \"ShowJavaScriptIcon\" ), &amp;m_bJavaScriptShowIcon, 1 );\n</code><br>\nIf not found, it used the default, which in this case sets a bool to 1 and not true or false.  Compiler does not (cannot) spot that.  Changed to <br>\n<code> bool configFound = pConf-&gt;Read ( _T( \"ShowJavaScriptIcon\" ), &amp;m_bJavaScriptShowIcon, true );\n</code><br>\nand all is happy again.<br>\nI have removed the complicated stuff rescuing pre v0.3  and deleting stuff in the old location for the config.  Much cleaner now.</p>",
        "id": 426280566,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710317728
    },
    {
        "content": "<blockquote>\n<p>main.js failed at line 225:<br>\nelse printGreen(\"No errors\\n\");</p>\n</blockquote>\n<p>Cannot understand this problem.  Fine here.<br>\nNeed to find issue.  Possibly some weird invisible character in source?<br>\nSuggest you copy the line and paste into the field in the diagnostis tab of tools and 'clean' it.  It will dump character codes .</p>",
        "id": 426281312,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710318009
    },
    {
        "content": "<p>? seems to be replaced by degree symbol when the script is loaded. Seen in comment in 02 PosWayRoutes.js line 33.<br>\nplease copy that lineand paste into the field in the diagnostis tab of tools and 'clean' it. It will dump character codes .  Can then see what Windows build is doing with it.</p>",
        "id": 426281686,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710318147
    },
    {
        "content": "<p>We may be fouling Windows inability to cope with degree symbol?  In version3 we now have the ability to parse a position.  Please try this simple script:</p>\n<div class=\"codehilite\" data-code-language=\"JavaScript\"><pre><span></span><code><span class=\"nx\">Position</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nx\">require</span><span class=\"p\">(</span><span class=\"s2\">\"Position\"</span><span class=\"p\">);</span>\n\n<span class=\"nx\">pos</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"ow\">new</span><span class=\"w\"> </span><span class=\"nx\">Position</span><span class=\"p\">(</span><span class=\"mf\">55</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"mf\">2</span><span class=\"p\">);</span>\n<span class=\"nx\">print</span><span class=\"p\">(</span><span class=\"nx\">pos</span><span class=\"p\">.</span><span class=\"nx\">formatted</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s2\">\"\\n\"</span><span class=\"p\">);</span>\n\n<span class=\"nx\">pos2</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"ow\">new</span><span class=\"w\"> </span><span class=\"nx\">Position</span><span class=\"p\">(</span><span class=\"s2\">\"52° 12.345'N 1° 1.234'W\"</span><span class=\"p\">);</span>\n<span class=\"nx\">print</span><span class=\"p\">(</span><span class=\"nx\">pos2</span><span class=\"p\">.</span><span class=\"nx\">formatted</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s2\">\"\\n\"</span><span class=\"p\">);</span>\n</code></pre></div>\n<p>When I run it, I get</p>\n<blockquote>\n<p>55° 00.000'N 002° 0.000'W<br>\n52° 12.345'N 001° 1.234'W</p>\n</blockquote>\n<p>If there are issues, please put the \"52° 12.345'N 1° 1.234'W\" string through the clean and dump process.</p>",
        "id": 426283087,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710318711
    },
    {
        "content": "<blockquote>\n<p>42 fails at the moment.</p>\n</blockquote>\n<p>It is no longer being used in the tests.</p>",
        "id": 426283952,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710319054
    },
    {
        "content": "<p>Cleaned out everything JavaScript_pi. Updated my fork. Built a tarball. Installed fine. Only issue was that the Help window did not appear.</p>",
        "id": 426284480,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710319261
    },
    {
        "content": "<p>Help window only presented when you have updated version.  Otherwise you need to access via the ? or in the tools.<br>\nDoes the test suite run OK now?</p>",
        "id": 426284814,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710319395
    },
    {
        "content": "<p>Should have said Help Panel. This normally appears on a first install, with links to documentation etc. Having trouble with cut and paste on my PC. Will need to re-start the machine. Then breakfast!</p>",
        "id": 426285180,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710319536
    },
    {
        "content": "<blockquote>\n<p>This normally appears on a first install,</p>\n</blockquote>\n<p>Only if the version number has increased.  Not if you reinstall the same version.</p>\n<p>BTW, links are to released version documentation and not v3.</p>",
        "id": 426285430,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710319621
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>Position = require(&quot;Position&quot;);\n\npos = new Position(55, -2);\nprint(pos.formatted, &quot;\\n&quot;);\n\npos2 = new Position(&quot;52° 12.345&#39;N 1° 1.234&#39;W&quot;);\nprint(pos2.formatted, &quot;\\n&quot;);\n</code></pre></div>\n<blockquote>\n<p>SyntaxError: source decode failed (line 3)</p>\n</blockquote>\n<p>Try cleaning with: <code>pos = new Position(55, -2);</code></p>\n<div class=\"codehilite\"><pre><span></span><code>[00]p [01]o [02]s [03]  [04]= [05]  [06]n [07]e [08]w [09]\n[10]P [11]o [12]s [13]i [14]t [15]i [16]o [17]n [18]( [19]5\n[20]5 [21], [22]  [23]- [24]2 [25]) [26];\n\nRaw\npos = new Position(55, -2);\n[00]70 [01]6F [02]73 [03]20 [04]3D [05]20 [06]6E [07]65 [08]77 [09]20\n[10]50 [11]6F [12]73 [13]69 [14]74 [15]69 [16]6F [17]6E [18]28 [19]35\n[20]35 [21]2C [22]20 [23]2D [24]32 [25]29 [26]3B\n\nCleaned\npos = new Position(55, -2);\n[00]70 [01]6F [02]73 [03]20 [04]3D [05]20 [06]6E [07]65 [08]77 [09]20\n[10]50 [11]6F [12]73 [13]69 [14]74 [15]69 [16]6F [17]6E [18]28 [19]35\n[20]35 [21]2C [22]20 [23]2D [24]32 [25]29 [26]3B\n</code></pre></div>\n<p>I think the problem lies somewhere in <em>Position.</em></p>",
        "id": 426299803,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710324465
    },
    {
        "content": "<p>Ran this.</p>\n<div class=\"codehilite\"><pre><span></span><code>pos = new Position(55, -2);\nprint(&quot;this&quot; + \\n&quot;);\n</code></pre></div>\n<p><em>ReferenceError: identifier 'Position' undefined</em></p>",
        "id": 426303963,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710325785
    },
    {
        "content": "<p>Yes - you have forgotten the Require to load it.<br>\nHere is a script with the Position constructer included in-line.<br>\nUnzip and load and run.  You should see which line it is failing on.<br>\n<a href=\"/user_uploads/33951/jPLnlrGp1h2ooUTtlzSNtoOC/positionComplete.js.zip\">positionComplete.js.zip</a></p>",
        "id": 426306440,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710326496
    },
    {
        "content": "<p>My bad. Now with positionComplete:<br>\n<em>SyntaxError: source decode failed (line 152)</em></p>",
        "id": 426309452,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710327279
    },
    {
        "content": "<p>Line 152 invokes the  function starting at line 23 to build the formatted position.  This uses <code>String.fromCharCode(176)</code> to get a degree character, which is perhaps where Windows is failing - although I thought it worked previously.<br>\nTry replacing  with xB0.  So line 27<br>\n<code>            (\"00\" + parseInt(latAbs)).slice(-2) + String.fromCharCode(176) + \" \" +</code><br>\nbecomes<br>\n<code>            (\"00\" + parseInt(latAbs)).slice(-2) + \"\\xB0\" + \" \" +</code><br>\nand similar change on line 30</p>",
        "id": 426311400,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710327973
    },
    {
        "content": "<p>Yes ... it did work before. Same error with your changes.</p>",
        "id": 426311961,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710328202
    },
    {
        "content": "<p>Try replacing both with something not taxing, like<br>\n<code>       (\"00\" + parseInt(latAbs)).slice(-2) + \"*\" + \" \" +</code></p>",
        "id": 426312905,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710328575
    },
    {
        "content": "<p>Same error.</p>",
        "id": 426313384,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710328763
    },
    {
        "content": "<p>How about line 10:<br>\n<code>pos = parsePosition(arguments[0]);</code><br>\nThis is a new addition.</p>",
        "id": 426313633,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710328853
    },
    {
        "content": "<p>Yes.  Maybe the constructor is failing because the parsePosition function has several \\xB0 in it.<br>\nIt has to cope with the seven or eight different ways people type a position  25.8', 25'8, 25'.8 etc.</p>\n<p>Please try just this in a different console</p>\n<p><code>print(\"Degree symbol is \\xB0\\n\");</code></p>",
        "id": 426315615,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710329563
    },
    {
        "content": "<p>*Degree symbol is °<br>\nresult: undefined*</p>",
        "id": 426315802,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710329637
    },
    {
        "content": "<p>Line 82 change to <code>trace = true;</code></p>",
        "id": 426316897,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710329997
    },
    {
        "content": "<p>Having trouble with boolean?:</p>\n<div class=\"codehilite\"><pre><span></span><code>latitude = -54;\nlat = latitude&lt;0)?&quot;S&quot;:&quot;N&quot;;\nprint(lat, &quot;\\n&quot;);\n</code></pre></div>\n<p>Could you correct this for me to test?</p>",
        "id": 426317046,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710330037
    },
    {
        "content": "<blockquote>\n<p>Line 82 change to trace = true;</p>\n</blockquote>\n<p>Same error.</p>",
        "id": 426317334,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710330137
    },
    {
        "content": "<p>Missing opening ( around boolean expression, should be</p>\n<div class=\"codehilite\"><pre><span></span><code>latitude = -54;\nlat = (latitude&lt;0)?&quot;S&quot;:&quot;N&quot;;\nprint(lat, &quot;\\n&quot;);\n</code></pre></div>",
        "id": 426317389,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710330157
    },
    {
        "content": "<p>*S<br>\nresult: undefined*</p>",
        "id": 426317665,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710330249
    },
    {
        "content": "<p>That's correct for what you programmed - assuming you included the * in your reply to me</p>",
        "id": 426317920,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710330355
    },
    {
        "content": "<p>The * might be where you are trying to type back prime fr code?</p>",
        "id": 426318082,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710330406
    },
    {
        "content": "<p>I was trying to italicize the text.</p>",
        "id": 426318205,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710330452
    },
    {
        "content": "<p>Leaving trace = true, after that line 82 insert<br>\n<code>return({latitude:60, longitude:-2});</code><br>\nYou should see that position returned from the parsing function.<br>\nIf that works, try moving the position further down the parsing function to see how far it gets without failing.</p>",
        "id": 426319858,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710331068
    },
    {
        "content": "<p>Return fails. Only this:<br>\n<em>SyntaxError: source decode failed (line 153)</em></p>",
        "id": 426320482,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710331278
    },
    {
        "content": "<p>I am using nested functions.  Not strictly allowed but seen no problems on MacOS.<br>\nPlease try this script in a scratch console</p>\n<div class=\"codehilite\" data-code-language=\"JavaScript\"><pre><span></span><code><span class=\"nx\">print</span><span class=\"p\">(</span><span class=\"nx\">outer</span><span class=\"p\">(),</span><span class=\"w\"> </span><span class=\"s2\">\"\\n\"</span><span class=\"p\">);</span>\n\n<span class=\"kd\">function</span><span class=\"w\"> </span><span class=\"nx\">outer</span><span class=\"p\">(){</span>\n<span class=\"w\">    </span><span class=\"kd\">function</span><span class=\"w\"> </span><span class=\"nx\">inner</span><span class=\"p\">(){</span>\n<span class=\"w\">        </span><span class=\"k\">return</span><span class=\"p\">(</span><span class=\"s2\">\"Hello\"</span><span class=\"p\">);</span>\n<span class=\"w\">        </span><span class=\"p\">}</span>\n<span class=\"w\">    </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"nx\">inner</span><span class=\"p\">();</span>\n<span class=\"w\">    </span><span class=\"p\">}</span>\n</code></pre></div>",
        "id": 426323499,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710332328
    },
    {
        "content": "<p>Hello<br>\nresult: undefined</p>",
        "id": 426323908,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710332481
    },
    {
        "content": "<p>So it is not nested functions...</p>",
        "id": 426325016,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710332848
    },
    {
        "content": "<p>My head hurts as well ;)</p>",
        "id": 426325303,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710332929
    },
    {
        "content": "<p>OK, lets narrow it down. by commenting out code<br>\nLines 80-84 become</p>\n<div class=\"codehilite\" data-code-language=\"JavaScript\"><pre><span></span><code><span class=\"w\">      </span><span class=\"kd\">function</span><span class=\"w\"> </span><span class=\"nx\">parsePosition</span><span class=\"p\">(</span><span class=\"nx\">text</span><span class=\"p\">){</span>\n<span class=\"w\">        </span><span class=\"c1\">// parse lat &amp; long into position object</span>\n<span class=\"k\">return</span><span class=\"p\">({</span><span class=\"nx\">latitude</span><span class=\"o\">:</span><span class=\"mf\">61</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nx\">longitude</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"mf\">2</span><span class=\"p\">});</span>\n<span class=\"err\">/*</span>\n<span class=\"w\">        </span><span class=\"nx\">trace</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"kc\">true</span><span class=\"p\">;</span>\n</code></pre></div>\n<p>and insert end of comment like this</p>\n<div class=\"codehilite\" data-code-language=\"JavaScript\"><pre><span></span><code><span class=\"w\">        </span><span class=\"kd\">function</span><span class=\"w\"> </span><span class=\"nx\">bail</span><span class=\"p\">(</span><span class=\"nx\">message</span><span class=\"p\">){</span>\n<span class=\"w\">            </span><span class=\"k\">throw</span><span class=\"p\">(</span><span class=\"nx\">title</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"s2\">\" \"</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"nx\">phase</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"s2\">\" \"</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"nx\">message</span><span class=\"p\">);</span>\n<span class=\"w\">            </span><span class=\"p\">};</span>\n<span class=\"o\">*</span><span class=\"err\">/</span>\n<span class=\"w\">        </span><span class=\"p\">}</span>\n</code></pre></div>\n<p>Hopefully you get output</p>\n<blockquote>\n<p>55° 00.000'N 002° 0.000'W<br>\n61° 00.000'N 002° 0.000'W<br>\nresult: undefined</p>\n</blockquote>",
        "id": 426326584,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710333384
    },
    {
        "content": "<p>Sorry: <br>\nSyntaxError: source decode failed (line 156)</p>",
        "id": 426330451,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710334115
    },
    {
        "content": "<p>Fresh copy of the test script which compiles OK for me.  Please adopt so we know we are working with the same thing.<br>\n<a href=\"/user_uploads/33951/5fLfNpQV9xl6RnoflofCe1rm/positionComplete.js.zip\">positionComplete.js.zip</a></p>",
        "id": 426331479,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710334288
    },
    {
        "content": "<p>SyntaxError: source decode failed (line 28)</p>",
        "id": 426332234,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710334402
    },
    {
        "content": "<p>OK looks like it is throwing up over \"\\xB0\".  Let's restore it using fromCharCode lines 26-33 should now be</p>\n<div class=\"codehilite\" data-code-language=\"JavaScript\"><pre><span></span><code><span class=\"w\">        </span><span class=\"k\">return</span><span class=\"w\"> </span><span class=\"p\">(</span>\n<span class=\"w\">            </span><span class=\"p\">(</span><span class=\"s2\">\"00\"</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"nb\">parseInt</span><span class=\"p\">(</span><span class=\"nx\">latAbs</span><span class=\"p\">)).</span><span class=\"nx\">slice</span><span class=\"p\">(</span><span class=\"o\">-</span><span class=\"mf\">2</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"nb\">String</span><span class=\"p\">.</span><span class=\"nx\">fromCharCode</span><span class=\"p\">(</span><span class=\"mf\">176</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"o\">+</span>\n<span class=\"w\">            </span><span class=\"p\">(</span><span class=\"s2\">\"00\"</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"nx\">latAbs</span><span class=\"w\"> </span><span class=\"o\">%</span><span class=\"w\"> </span><span class=\"mf\">1</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"mf\">60</span><span class=\"p\">).</span><span class=\"nx\">toFixed</span><span class=\"p\">(</span><span class=\"mf\">3</span><span class=\"p\">)).</span><span class=\"nx\">slice</span><span class=\"p\">(</span><span class=\"o\">-</span><span class=\"mf\">6</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"s2\">\"'\"</span><span class=\"w\"> </span><span class=\"o\">+</span>\n<span class=\"w\">            </span><span class=\"p\">((</span><span class=\"k\">this</span><span class=\"p\">.</span><span class=\"nx\">latitude</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"w\"> </span><span class=\"mf\">0</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"o\">?</span><span class=\"w\"> </span><span class=\"s2\">\"S \"</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"s2\">\"N \"</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"o\">+</span>\n<span class=\"w\">            </span><span class=\"p\">(</span><span class=\"s2\">\"00\"</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"nb\">parseInt</span><span class=\"p\">(</span><span class=\"nx\">lonAbs</span><span class=\"p\">)).</span><span class=\"nx\">slice</span><span class=\"p\">(</span><span class=\"o\">-</span><span class=\"mf\">3</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"nb\">String</span><span class=\"p\">.</span><span class=\"nx\">fromCharCode</span><span class=\"p\">(</span><span class=\"mf\">176</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"o\">+</span>\n<span class=\"w\">            </span><span class=\"p\">(</span><span class=\"nx\">lonAbs</span><span class=\"w\"> </span><span class=\"o\">%</span><span class=\"w\"> </span><span class=\"mf\">1</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"mf\">60</span><span class=\"p\">).</span><span class=\"nx\">toFixed</span><span class=\"p\">(</span><span class=\"mf\">3</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"s2\">\"'\"</span><span class=\"w\"> </span><span class=\"o\">+</span>\n<span class=\"w\">            </span><span class=\"p\">((</span><span class=\"k\">this</span><span class=\"p\">.</span><span class=\"nx\">longitude</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"w\"> </span><span class=\"mf\">0</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"o\">?</span><span class=\"w\"> </span><span class=\"s2\">\"W\"</span><span class=\"w\"> </span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"s2\">\"E\"</span><span class=\"p\">)</span>\n<span class=\"w\">            </span><span class=\"p\">)}</span>\n</code></pre></div>",
        "id": 426333729,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710334656
    },
    {
        "content": "<p>Still:<br>\nSyntaxError: source decode failed (line 28)</p>",
        "id": 426334273,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710334791
    },
    {
        "content": "<p>Hold on: your ? has come out as a decimal character when I copied your code across.</p>",
        "id": 426334572,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710334866
    },
    {
        "content": "<p>Maybe use the Load button to load  the file rather than copying and pasting.</p>",
        "id": 426335010,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710335006
    },
    {
        "content": "<p>Yes. Did that but lines 43 and 44 had the same problem, replacing ? by the decimal character..</p>",
        "id": 426335629,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710335198
    },
    {
        "content": "<p>Off to lunch.</p>",
        "id": 426335676,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710335213
    },
    {
        "content": "<p>Saved this as a .js file.</p>\n<div class=\"codehilite\"><pre><span></span><code>latitude = -55;\nprint((latitude &lt; 0) ? &quot;S &quot; : &quot;N &quot;);\n</code></pre></div>\n<p>When this is loaded:</p>\n<div class=\"codehilite\"><pre><span></span><code>latitude = -55;\nprint((latitude &lt; 0) ° &quot;S &quot; : &quot;N &quot;);\n</code></pre></div>",
        "id": 426348612,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710338991
    },
    {
        "content": "<p>In Diagnostics when I enter ?</p>\n<div class=\"codehilite\"><pre><span></span><code>[00]?\n\nRaw\n?\n[00]3F\n\nCleaned\n&amp;#xb0\n[00]26 [01]23 [02]78 [03]62 [04]30\n</code></pre></div>",
        "id": 426349646,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710339304
    },
    {
        "content": "<p>So the ? character is not being left untouched when a file is loaded.</p>",
        "id": 426349806,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710339361
    },
    {
        "content": "<p>New in v3 is cleaning superscript 0 to  real degree<br>\nThis is done in functions.cpp line 62 on.  I addd line 92<br>\n<code>    given.Replace(superScript0, degree, true);</code><br>\nand I commented out this next because I cannot remember why it is there,<br>\n<code>//     given.Replace(degree, degreeText, true);</code><br>\nMaybe Windows needed t?  But no mention of x3F anywhere.<br>\nThoughts?</p>",
        "id": 426358439,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710341662
    },
    {
        "content": "<p>You can test in JavaScript with</p>\n<div class=\"codehilite\" data-code-language=\"JavaScript\"><pre><span></span><code><span class=\"nx\">print</span><span class=\"p\">(</span><span class=\"nx\">cleanString</span><span class=\"p\">(</span><span class=\"s2\">\"?\"</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"s2\">\"\\n\"</span><span class=\"p\">);</span>\n</code></pre></div>",
        "id": 426360597,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710342172
    },
    {
        "content": "<blockquote>\n<p>But no mention of x3F anywhere.</p>\n</blockquote>\n<blockquote>\n<p>//     given.Replace(degree, degreeText, true);</p>\n</blockquote>\n<p>Reverted but this made no difference.</p>",
        "id": 426360635,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710342182
    },
    {
        "content": "<p>Going out for exercise after lunch - diabetes avoidance!</p>",
        "id": 426360889,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710342248
    },
    {
        "content": "<p>&amp;#xb0<br>\nresult: undefined</p>",
        "id": 426360921,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710342256
    },
    {
        "content": "<p>That's the extra one you reinstated.  But why is ? being seen as a degree?<br>\nPlease try this script:</p>\n<div class=\"codehilite\" data-code-language=\"JavaScript\"><pre><span></span><code><span class=\"nx\">test</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"?\"</span><span class=\"p\">;</span>\n<span class=\"nx\">print</span><span class=\"p\">(</span><span class=\"nx\">test</span><span class=\"p\">,</span><span class=\"s2\">\"\\t\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nx\">test</span><span class=\"p\">.</span><span class=\"nx\">charCodeAt</span><span class=\"p\">(</span><span class=\"mf\">0</span><span class=\"p\">).</span><span class=\"nx\">toString</span><span class=\"p\">(</span><span class=\"mf\">16</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"s2\">\"\\n\"</span><span class=\"p\">);</span>\n<span class=\"nx\">after</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nx\">cleanString</span><span class=\"p\">(</span><span class=\"nx\">test</span><span class=\"p\">);</span>\n<span class=\"nx\">print</span><span class=\"p\">(</span><span class=\"nx\">after</span><span class=\"p\">,</span><span class=\"s2\">\"\\t\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nx\">after</span><span class=\"p\">.</span><span class=\"nx\">charCodeAt</span><span class=\"p\">(</span><span class=\"mf\">0</span><span class=\"p\">).</span><span class=\"nx\">toString</span><span class=\"p\">(</span><span class=\"mf\">16</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"s2\">\"\\n\"</span><span class=\"p\">);</span>\n</code></pre></div>\n<p>I get</p>\n<blockquote>\n<p>?   3f<br>\n?   3f<br>\nresult: undefined</p>\n</blockquote>",
        "id": 426373386,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710345534
    },
    {
        "content": "<p>?   3f<br>\n°   NaN<br>\nresult: undefined</p>",
        "id": 426374357,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710345771
    },
    {
        "content": "<p>So we know that ? is being compiled correctly to 0x3f.<br>\nBut it is being converted to º and your restored extra is  converting it to a string that is Not A Number.<br>\nOnly change I made is to add in functions.cpp line 93<br>\n<code> given.Replace(superScript0, degree, true);</code><br>\nwhere superScript0 is<br>\n<code> const wxString superScript0 {\"\\u2070\"};   // superscript 0 pretending to be degrees</code></p>\n<p>Could this somehow be matching 0x3f ? Sounds impossible but only think I can think of.<br>\nCan you comment out this conversion to check?</p>",
        "id": 426384626,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710348644
    },
    {
        "content": "<p>Well done. That allowed the import of my simple test file without changing the ? character. I will play with the other file you sent.</p>",
        "id": 426388932,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710349815
    },
    {
        "content": "<p>SyntaxError: source decode failed (line 153)<br>\nWith both <em>positionComplete.js</em> commented out section and raw.</p>",
        "id": 426389580,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710349999
    },
    {
        "content": "<p>But the ? is retained on loading.</p>",
        "id": 426389665,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710350026
    },
    {
        "content": "<p>I am not quite clear what you are sying.  I think that <code>positionComplete.js</code> fails at line 153, which is blank for me but probably my 154<br>\n<code>pos = new Position(55, -2);</code><br>\nI think the constructor is throwing the error.  Please</p>\n<ol>\n<li>comment out the second pos2  test at lines 157</li>\n<li>comment out line 10 <code>pos = parsePosition(arguments[0]);</code></li>\n<li>comment out lines 74-76</li>\n<li>Adjust the existing commented out section to exclude the whole of the <code>function parsePosition</code>.  You will need to move the closing */ down one line<br>\nDoes that run and just do the pos.formatted thing?</li>\n</ol>",
        "id": 426392601,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710350934
    },
    {
        "content": "<blockquote>\n<p>Does that run and just do the pos.formatted thing?</p>\n</blockquote>\n<p><em>SyntaxError: source decode failed (line 155)</em></p>",
        "id": 426394397,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710351530
    },
    {
        "content": "<p>Which line of these is 155?</p>\n<div class=\"codehilite\"><pre><span></span><code>pos = new Position(55, -2);\nprint(pos.formatted, &quot;\\n&quot;);\n</code></pre></div>",
        "id": 426395097,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710351751
    },
    {
        "content": "<p><em>print(pos.formatted, \"\\n\");</em></p>",
        "id": 426395279,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710351815
    },
    {
        "content": "<p>Have you still got <code>\"\\xB0 \"</code> in lines 27 &amp; 30?</p>",
        "id": 426395576,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710351906
    },
    {
        "content": "<blockquote>\n<p>Have you still got \"\\xB0 \" in lines 27 &amp; 30?</p>\n</blockquote>\n<p>Yes.</p>",
        "id": 426395781,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710351972
    },
    {
        "content": "<p>Please replace both instances of <code>\"\\xB0\"</code> with <code>String.fromCharCode(176)</code></p>",
        "id": 426396302,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710352110
    },
    {
        "content": "<p>Just tried that. Same result.</p>",
        "id": 426396370,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710352136
    },
    {
        "content": "<p>Just in case I am messing things up could you send me an update of the test file <em>positionComplete.js.</em></p>",
        "id": 426396824,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710352287
    },
    {
        "content": "<p>I am away. BBL.</p>",
        "id": 426396995,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710352347
    },
    {
        "content": "<p><a href=\"/user_uploads/33951/nRuMjC4r1gJHyqvX39RT9O2T/positionComplete.js.zip\">positionComplete.js.zip</a></p>",
        "id": 426397062,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710352370
    },
    {
        "content": "<p>Thanks. The same result:<br>\n<em>SyntaxError: source decode failed (line 155)</em></p>",
        "id": 426397425,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710352498
    },
    {
        "content": "<p>Attached is a different test with the v2.0.4 Position built in.<br>\nDoes this work?  I get</p>\n<blockquote>\n<p>55° 00.000'N 002° 0.000'W<br>\nresult: undefined</p>\n</blockquote>\n<p><a href=\"/user_uploads/33951/wdcCAO_bcB4LCIRe7VdxSk2v/oldPositionComplete.js.zip\">oldPositionComplete.js.zip</a></p>",
        "id": 426399227,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710353115
    },
    {
        "content": "<blockquote>\n<p>55° 00.000'N 002° 0.000'W<br>\nresult: undefined</p>\n</blockquote>",
        "id": 426412794,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710358285
    },
    {
        "content": "<p>After line 64 in this latest file, add<br>\n<code>   return this;</code><br>\nand test again.</p>",
        "id": 426413938,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710358742
    },
    {
        "content": "<p>Supper - back tomorrow</p>",
        "id": 426415256,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710359245
    },
    {
        "content": "<p>I would expect the JavaScript engine to give the line number of the issue up to 2 nesting levels but it is not doing so in this case.  Perhaps this is because the issue is in a construction rather than a function call.<br>\nI see no alternative but to add back in the new bits of Position a bit at a time until you see the problem.  You could do that, or I can but I will have to send you a file at each stage.</p>",
        "id": 426494191,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710406441
    },
    {
        "content": "<p>Please can you send me a test file for each stage. Happy to test as they come.</p>",
        "id": 426501770,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710409007
    },
    {
        "content": "<p>(1) Was adding  <code>return this</code> as above OK?</p>",
        "id": 426502415,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710409208
    },
    {
        "content": "<p>Yes ... that was ok.</p>",
        "id": 426503264,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710409494
    },
    {
        "content": "<p>55° 00.000'N 002° 0.000'W<br>\nresult: undefined</p>",
        "id": 426503890,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710409696
    },
    {
        "content": "<p><a href=\"/user_uploads/33951/oEz9xmFYh52xPxwYKJ6vQUgM/Test2.js.zip\">Test2.js.zip</a></p>\n<p>Expect</p>\n<blockquote>\n<p>55° 00.000'N 002° 0.000'W<br>\n61° 00.000'N 002° 0.000'W<br>\nresult: undefined</p>\n</blockquote>",
        "id": 426508180,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710411170
    },
    {
        "content": "<p>SyntaxError: source decode failed (line 80)<br>\nWhen I remove lines 81 and 82 the result is ok.</p>",
        "id": 426508623,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710411324
    },
    {
        "content": "<p><a href=\"/user_uploads/33951/0f9JVUsdFWitsrGp4MGDi-Cr/Test3.js.zip\">Test3.js.zip</a></p>",
        "id": 426509934,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710411755
    },
    {
        "content": "<p>SyntaxError: source decode failed (line 82)</p>",
        "id": 426510319,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710411874
    },
    {
        "content": "<p><a href=\"/user_uploads/33951/kp_f4ePJNA8KqjKtJNgjssIk/Test4.js.zip\">Test4.js.zip</a></p>",
        "id": 426512257,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710412532
    },
    {
        "content": "<p>SyntaxError: source decode failed (line 82)</p>",
        "id": 426512475,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710412604
    },
    {
        "content": "<p>Added tracing stuff - very close.<br>\n<a href=\"/user_uploads/33951/BxVrJDPVlCgrw7rS4_1BxQTd/Test5.js.zip\">Test5.js.zip</a></p>",
        "id": 426516581,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710414030
    },
    {
        "content": "<p>SyntaxError: source decode failed (line 87)<br>\nLine 87 has stopped the other print commands.</p>",
        "id": 426517153,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710414236
    },
    {
        "content": "<p>If I remove the degree symbols in Line 87 things work.</p>",
        "id": 426517396,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710414342
    },
    {
        "content": "<p>And output includes the degree symbols.</p>",
        "id": 426517502,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710414374
    },
    {
        "content": "<p>So might this all be about degree symbols rather than an issue in the Position?<br>\nPlease try this one-liner<br>\n<code>print(\"52° 12.345'N 1° 1.234'W\",\"\\n\");</code></p>",
        "id": 426517988,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710414563
    },
    {
        "content": "<p>SyntaxError: source decode failed (line 0)</p>",
        "id": 426518180,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710414623
    },
    {
        "content": "<p>and if you paste <code>52º</code> into the cleanString test in Tools ?</p>",
        "id": 426518369,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710414718
    },
    {
        "content": "<p>[00]5 [01]2 [02]º </p>\n<p>Raw<br>\n52º<br>\n[00]35 [01]32 [02]BA </p>\n<p>Cleaned<br>\n52°<br>\n[00]35 [01]32 [02]B0 </p>\n<p>The degree symbols are different.  Do I revert the commenting out of the superscore character line?</p>",
        "id": 426518647,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710414843
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>// given.Replace(superScript0, degree, true);\n</code></pre></div>",
        "id": 426519199,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710415069
    },
    {
        "content": "<p>Your pasted degree was actually 0xBA - the masculine ordinal.  This is a common mis-representation of degree.  maybe you got that by copying from Zulip.<br>\nAnyhow, cleanString correctly changed that to 0xB0 - the degree symbol.<br>\nYes you can uncomment that superscript conversion but it is not being used here.<br>\nIt looks like the problem is again that the Windows JS engine cannot cope with degree 0xB0.</p>",
        "id": 426520013,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710415383
    },
    {
        "content": "<p>Let's see whether it can process if  not compiled.<br>\nPlease change line  87 to<br>\n<code>pos2 = new Position(fromClipboard());</code><br>\nand before running the script, copy this position to the clipboard, from where it will read it.<br>\n52° 12.345'N 1° 1.234'W</p>",
        "id": 426520843,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710415708
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>arguments.length:2\n55° 00.000&#39;N 002° 0.000&#39;W\narguments.length:1\nHave arguments.length == 1\nType:string\nIn parse section\nDone parse section\n61° 00.000&#39;N 002° 0.000&#39;W\nresult: undefined\n</code></pre></div>",
        "id": 426521351,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710415893
    },
    {
        "content": "<p>Yes!   Conclusion: cannot compile degree symbol but a script can process it.<br>\nStandby for testing further with the new Position .</p>",
        "id": 426521654,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710416013
    },
    {
        "content": "<p>Please run Test6 with the position on your clipboard.<br>\n<a href=\"/user_uploads/33951/6ZsltwaBa4XE1z3v06p2utTd/Test6.js.zip\">Test6.js.zip</a></p>",
        "id": 426522284,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710416231
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>55° 00.000&#39;N 002° 0.000&#39;W\nparsePosition line 86 Error: internal error\ncalled from Position line 10\ncalled from line 154\n</code></pre></div>",
        "id": 426522620,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710416341
    },
    {
        "content": "<p>So earlier problem was that it was failing to compile with degree symbol.<br>\nAt least now we are getting the trace back.<br>\nIt is failing when matching a regular expression if the text to be matched as a degree in it.<br>\nWill send you another test in a few moments,</p>",
        "id": 426523817,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710416741
    },
    {
        "content": "<p>Please run this script with the position on the clipboard:</p>\n<div class=\"codehilite\" data-code-language=\"JavaScript\"><pre><span></span><code><span class=\"nx\">text</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nx\">fromClipboard</span><span class=\"p\">();</span>\n<span class=\"nx\">print</span><span class=\"p\">(</span><span class=\"s2\">\"Clipboard has: \"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nx\">text</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s2\">\"\\n\"</span><span class=\"p\">);</span>\n<span class=\"nx\">print</span><span class=\"p\">(</span><span class=\"s2\">\"\\xB0\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s2\">\"\\n\"</span><span class=\"p\">);</span>\n<span class=\"k\">while</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"nx\">text</span><span class=\"p\">.</span><span class=\"nx\">indexOf</span><span class=\"p\">(</span><span class=\"s2\">\"\\xB0\"</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"o\">&gt;=</span><span class=\"w\"> </span><span class=\"mf\">0</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"nx\">text</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nx\">text</span><span class=\"p\">.</span><span class=\"nx\">replace</span><span class=\"p\">(</span><span class=\"s2\">\"\\xB0\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s1\">'*'</span><span class=\"p\">);</span>\n<span class=\"nx\">print</span><span class=\"p\">(</span><span class=\"s2\">\"Processed: \"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nx\">text</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s2\">\"\\n\"</span><span class=\"p\">);</span>\n</code></pre></div>",
        "id": 426525797,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710417487
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>Clipboard has: 52° 12.345&#39;N 1° 1.234&#39;W\n°\nProcessed: 52° 12.345&#39;N 1° 1.234&#39;W\nresult: undefined\n</code></pre></div>",
        "id": 426526108,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710417610
    },
    {
        "content": "<p>That is disappointing.  The \"\\xB0\" has compiled OK as it is printed correctly in line 3.<br>\nBut it is failing to match in the search and replace bit.<br>\nWill have another go.</p>",
        "id": 426526581,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710417794
    },
    {
        "content": "<p>147 messages were moved here from <a class=\"stream-topic\" data-stream-id=\"349785\" href=\"/#narrow/stream/349785-JavaScript_pi/topic/v3.2E0.20beta.20testing\">#JavaScript_pi &gt; v3.0 beta testing</a> by <span class=\"user-mention silent\" data-user-id=\"399559\">Mike Rossiter</span>.</p>",
        "id": 426527023,
        "sender_full_name": "Notification Bot",
        "timestamp": 1710417964
    },
    {
        "content": "<p>This topic was moved here from <a class=\"stream-topic\" data-stream-id=\"349785\" href=\"/#narrow/stream/349785-JavaScript_pi/topic/.28no.20topic.29\">#JavaScript_pi &gt; (no topic)</a> by <span class=\"user-mention silent\" data-user-id=\"399559\">Mike Rossiter</span>.</p>",
        "id": 426527176,
        "sender_full_name": "Notification Bot",
        "timestamp": 1710418027
    },
    {
        "content": "<p>Trying to get all the beta testing stuff together.</p>",
        "id": 426527592,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710418177
    },
    {
        "content": "<p>Please run this with position on clipboard</p>\n<div class=\"codehilite\" data-code-language=\"JavaScript\"><pre><span></span><code><span class=\"kd\">var</span><span class=\"w\"> </span><span class=\"nx\">text</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nx\">fromClipboard</span><span class=\"p\">();</span>\n<span class=\"nx\">print</span><span class=\"p\">(</span><span class=\"s2\">\"Clipboard has: \"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nx\">text</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s2\">\"\\n\"</span><span class=\"p\">);</span>\n<span class=\"nx\">print</span><span class=\"p\">(</span><span class=\"s2\">\"\\xB0\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s2\">\"\\n\"</span><span class=\"p\">);</span>\n<span class=\"nx\">splut</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nx\">text</span><span class=\"p\">.</span><span class=\"nx\">split</span><span class=\"p\">(</span><span class=\"s2\">\"\\xB0\"</span><span class=\"p\">);</span>\n<span class=\"nx\">print</span><span class=\"p\">(</span><span class=\"nx\">splut</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s2\">\"\\n\"</span><span class=\"p\">);</span>\n<span class=\"nx\">text</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nx\">splut</span><span class=\"p\">.</span><span class=\"nx\">join</span><span class=\"p\">(</span><span class=\"s2\">\"*\"</span><span class=\"p\">);</span>\n<span class=\"nx\">print</span><span class=\"p\">(</span><span class=\"s2\">\"\\nProcessed: \"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nx\">text</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s2\">\"\\n\"</span><span class=\"p\">);</span>\n</code></pre></div>",
        "id": 426529911,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710419099
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>Clipboard has: 52° 12.345&#39;N 1° 1.234&#39;W\n°\n[&quot;52° 12.345&#39;N 1° 1.234&#39;W&quot;]\n\nProcessed: 52° 12.345&#39;N 1° 1.234&#39;W\nresult: undefined\n</code></pre></div>",
        "id": 426530286,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710419246
    },
    {
        "content": "<p>Blast - it is even failing  on Windows to spilt the string  at a degree character.  It seems unable to match it in any of the ways I have tried.<br>\nThinking...</p>",
        "id": 426531232,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710419597
    },
    {
        "content": "<p>Please run this test with a position on the clipboard:</p>\n<div class=\"codehilite\" data-code-language=\"JavaScript\"><pre><span></span><code><span class=\"kd\">var</span><span class=\"w\"> </span><span class=\"nx\">text</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nx\">fromClipboard</span><span class=\"p\">();</span>\n<span class=\"nx\">print</span><span class=\"p\">(</span><span class=\"s2\">\"Clipboard has: \"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nx\">text</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s2\">\"\\n\"</span><span class=\"p\">);</span>\n<span class=\"k\">for</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"nx\">i</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mf\">0</span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"nx\">i</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"w\"> </span><span class=\"nx\">text</span><span class=\"p\">.</span><span class=\"nx\">length</span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"nx\">i</span><span class=\"o\">++</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"nx\">print</span><span class=\"p\">(</span><span class=\"nx\">text</span><span class=\"p\">.</span><span class=\"nx\">charCodeAt</span><span class=\"p\">(</span><span class=\"nx\">i</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"s2\">\" \"</span><span class=\"p\">);</span>\n</code></pre></div>",
        "id": 426535213,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710420988
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>Clipboard has: 52° 12.345&#39;N 1° 1.234&#39;W\n53 50 32 49 50 46 51 52 53 39 78 32 49 32 49 46 50 51 52 39 87 result: undefined\n</code></pre></div>",
        "id": 426535837,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710421195
    },
    {
        "content": "<p>BBL</p>",
        "id": 426537912,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710421860
    },
    {
        "content": "<p>Working on a workaround for inability to handle º<br>\nAnother test, please<br>\n<a href=\"/user_uploads/33951/sVCAo6E-CstAAIudC-okdkCY/Test7.js.zip\">Test7.js.zip</a></p>",
        "id": 426548113,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710424913
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>Clipboard has: 52° 12.345&#39;N 1° 1.234&#39;W\n53 50 32 49 50 46 51 52 53 39 78 32 49 32 49 46 50 51 52 39 87\nA: 52° 12.345&#39;N 1° 1.234&#39;W\n\n\n[&quot;52° 12.345&#39;N 1° 1.234&#39;W&quot;]\n\nB: 52° 12.345&#39;N 1° 1.234&#39;W\nresult: undefined\n</code></pre></div>",
        "id": 426548711,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710425080
    },
    {
        "content": "<p>That didn't work.  Please try this test:<br>\n<a href=\"/user_uploads/33951/WCeOg9L4jZ33uL5AhUpO0-S-/Test8.js.zip\">Test8.js.zip</a></p>",
        "id": 426557257,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710427403
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>Clipboard has: 52° 12.345&#39;N 1° 1.234&#39;W\n53 50 32 49 50 46 51 52 53 39 78 32 49 32 49 46 50 51 52 39 87\nA: 52° 12.345&#39;N 1° 1.234&#39;W\n\n\n[&quot;52° 12.345&#39;N 1° 1.234&#39;W&quot;]\n53 50 32 49 50 46 51 52 53 39 78 32 49 32 49 46 50 51 52 39 87\nresult: undefined\n</code></pre></div>",
        "id": 426557867,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710427573
    },
    {
        "content": "<p>This one with position on clipboard, please.</p>\n<div class=\"codehilite\" data-code-language=\"JavaScript\"><pre><span></span><code><span class=\"nx\">text</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nx\">cleanString</span><span class=\"p\">(</span><span class=\"nx\">fromClipboard</span><span class=\"p\">());</span>\n<span class=\"nx\">print</span><span class=\"p\">(</span><span class=\"nx\">text</span><span class=\"p\">.</span><span class=\"nx\">split</span><span class=\"p\">(</span><span class=\"s2\">\"\\xB0\"</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"s2\">\"\\n\"</span><span class=\"p\">);</span>\n</code></pre></div>",
        "id": 426559058,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710427906
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>[&quot;52° 12.345&#39;N 1° 1.234&#39;W&quot;]\nresult: undefined\n</code></pre></div>",
        "id": 426559835,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710428110
    },
    {
        "content": "<p>Despite all these tries, I have found no way of identifying º in a JS script not even with <code>String.fromCharCode(176)</code> etc.  It seems on Windows it is incapable of handling characters greater than x7F, even when using character codes.</p>\n<p>The only solution I can think of is to clean it to something in the 7-bit code.  Could be * but potential confudion with a real *.<br>\nI am toying with /x07 'Bell'.  It works on MacOS and prints as a bell symbol. I can pattern match it tool.  Please run the following to test if it can be matched on Windows.<br>\nThoughts?</p>\n<div class=\"codehilite\" data-code-language=\"JavaScript\"><pre><span></span><code><span class=\"nx\">text</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"This is a bell ding\\x07dong\"</span><span class=\"p\">;</span>\n<span class=\"nx\">print</span><span class=\"p\">(</span><span class=\"nx\">text</span><span class=\"p\">.</span><span class=\"nx\">split</span><span class=\"p\">(</span><span class=\"s2\">\"\\x07\"</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"s2\">\"\\n\"</span><span class=\"p\">);</span>\n</code></pre></div>",
        "id": 426563601,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710429114
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>[&quot;This is a bell ding&quot;,&quot;dong&quot;]\nresult: undefined\n</code></pre></div>",
        "id": 426564113,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710429257
    },
    {
        "content": "<p>Is it possible to use 'deg' in some way instead of the degree symbol? And then for output change deg to the symbol.</p>",
        "id": 426572262,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710431430
    },
    {
        "content": "<p>Perhaps not. The symbol is not recognised by Windows.</p>",
        "id": 426572429,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710431481
    },
    {
        "content": "<p>The result of your last test <strong>was good</strong>.  The text was split at x07.<br>\nWe can for Windowsonly transform to x07 in way in and back on way out.  So you will stil be able to us º in scripts and print it etc.</p>",
        "id": 426573307,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710431739
    },
    {
        "content": "<p>Can probably even use ° in the Position parser too!</p>",
        "id": 426574977,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710432127
    },
    {
        "content": "<p>Whoops!  Have discovered a rather serious oversight.<br>\nScripts were being filtered on Load rather than on Run.<br>\nSo script edited or pasted into the script pane were not being filtered.<br>\nNot sure whether your woes with degree could have been down to this.</p>\n<p>New build just now has gone into my <a href=\"https://cloudsmith.io/~opencpn/repos/javascript-alpha/packages/\">alpha build repo here</a>.</p>\n<p>Please test with this<br>\n<a href=\"/user_uploads/33951/qEFdav0nWLM5RtYjydr0_e82/Test9.js.zip\">Test9.js.zip</a><br>\n updated and expanded Position/test.</p>\n<p>My output:</p>\n<blockquote>\n<p>55° 00.000'N 002° 0.000'W<br>\n55° 12.342'N 002° 1.021'W<br>\nA   54° 00.000'N 013° 12.340'W<br>\nB   55° 12.000'N 013° 23.450'W<br>\nC   56° 30.217'N 013° 44.950'W<br>\nresult: undefined</p>\n</blockquote>",
        "id": 426710921,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710497314
    },
    {
        "content": "<p><code>SyntaxError: source decode failed (line 27)</code><br>\nMasculine ordinal appears in the loaded script: \"º \" (not this symbol).<br>\nIt does not like this (\"'\") either. Lines 28 and 31.</p>",
        "id": 426713524,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710498328
    },
    {
        "content": "<p>Minutes symbol seems to be replaced by \"\\\" in line 163.</p>",
        "id": 426714147,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710498541
    },
    {
        "content": "<blockquote>\n<p>Minutes symbol seems to be replaced by \"\\\" in line 163.</p>\n</blockquote>\n<p>No that is correct.  The \\ is an escape for  the \" - degrees minutes and seconds</p>\n<blockquote>\n<p>Masculine ordinal appears in the loaded script: \"º \" (not this symbol).</p>\n</blockquote>\n<p>Quite likely.  It is cleaned into degree at run time now.  It may appear as any of the others like masculine ordinal.</p>\n<p>I have gone back to using real º in the Position script but if that fails, try replacing º with \\xB0 in lines 27, 30 &amp; 105 and on line 125 with \\xB0</p>",
        "id": 426717246,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710499681
    },
    {
        "content": "<p><code>SyntaxError: source decode failed (line 28)</code><br>\nThe \"'\" symbol?</p>",
        "id": 426720783,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710500942
    },
    {
        "content": "<p>Trying to replace with \\x27.</p>",
        "id": 426721450,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710501180
    },
    {
        "content": "<p>All primes of any flavour are being cleaned to \\x27.</p>\n<p>I can have<br>\n<code>print(\"'prime'\\n\");</code> which prints 'prime'.<br>\nI can also write<br>\n<code>print('prime2\\n');</code> so I can use ' instead of \" - useful if I want to have \" inside.</p>\n<p>I wonder whether in Windows it only sees it as a quote mark.  Try<br>\n<code>print(\"\\'prime3\\'\\n\");</code> which works for me.</p>",
        "id": 426722738,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710501682
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>&#39;prime3&#39;\nresult: undefined\n</code></pre></div>",
        "id": 426723023,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710501805
    },
    {
        "content": "<p>So escaping \\' works. <br>\nHow about <code>print('prime2\\n');</code>?</p>",
        "id": 426723228,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710501887
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>prime2\nresult: undefined\n</code></pre></div>",
        "id": 426723551,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710502005
    },
    {
        "content": "<p>And this one <code>print(\"'prime'\\n\");</code> ?</p>",
        "id": 426723691,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710502070
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>&#39;prime&#39;\nresult: undefined\n</code></pre></div>",
        "id": 426723831,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710502133
    },
    {
        "content": "<p>So why is line 28 failing?<br>\nYou could try escaping it \\'<br>\nAlso line  31 at least.</p>",
        "id": 426724212,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710502302
    },
    {
        "content": "<p>SyntaxError: source decode failed (line 28)</p>",
        "id": 426725214,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710502709
    },
    {
        "content": "<p>and \\x27 ?</p>",
        "id": 426725401,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710502794
    },
    {
        "content": "<p>SyntaxError: source decode failed (line 28)</p>",
        "id": 426725615,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710502864
    },
    {
        "content": "<p>Please run <code>print(123.5 % 1, \"\\n\");</code></p>",
        "id": 426725835,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710502949
    },
    {
        "content": "<p><code>print(123.5 % 1 * 60, \"\\n\");</code></p>",
        "id": 426725949,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710503003
    },
    {
        "content": "<p>0.5<br>\nresult: undefined</p>\n<p>30<br>\nresult: undefined</p>",
        "id": 426726133,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710503079
    },
    {
        "content": "<p>Line 28 should look like this:<br>\n<code>(\"00\" + (latAbs % 1 * 60).toFixed(3)).slice(-6) + \"'\" +</code></p>\n<p>Please find out which bit is the problem.  Yo could try replacing ' with, say, x<br>\nor insert returns (not within a string) so it is spread across more lines. <br>\nThen the error message will point you closer.</p>",
        "id": 426726736,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710503306
    },
    {
        "content": "<p>Back to the problem of the ternary operator ?. When I remove this in lines 29-31 I trace down to line 90, another ternary. I will try some if/else stuff.</p>",
        "id": 426729133,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710504178
    },
    {
        "content": "<p>Hang on - earlier you said you had issues with ?<br>\nTry <code>print(\"Question ?\\n\");</code></p>",
        "id": 426729446,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710504307
    },
    {
        "content": "<p>SyntaxError: source decode failed (line 0)</p>",
        "id": 426729682,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710504389
    },
    {
        "content": "<p>What is ? giving you in the Tools string cleaning inspector?<br>\nExpect x3F</p>",
        "id": 426729807,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710504438
    },
    {
        "content": "<p>[00]? </p>\n<div class=\"codehilite\"><pre><span></span><code>Raw\n?\n[00]3F\n\nCleaned\n°\n[00]B0\n</code></pre></div>",
        "id": 426729952,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710504485
    },
    {
        "content": "<p>Ah!  stand by...</p>",
        "id": 426730009,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710504511
    },
    {
        "content": "<p>Isnt this about javascript using utf-16 a k a unicode internally?. The degrees codepoint is certainly not 0xB0, it is 0x00B0. And when trying to match single bytes things breaks. Or?</p>\n<p>Sample node session:</p>\n<div class=\"codehilite\"><pre><span></span><code>&gt; console.log(&quot;degrees °&quot;)\ndegrees °\nundefined\n&gt; chars = [...&quot;degrees °&quot;]\n[\n  &#39;d&#39;, &#39;e&#39;, &#39;g&#39;,\n  &#39;r&#39;, &#39;e&#39;, &#39;e&#39;,\n  &#39;s&#39;, &#39; &#39;, &#39;°&#39;\n]\n&gt; console.log(chars)\n[\n  &#39;d&#39;, &#39;e&#39;, &#39;g&#39;,\n  &#39;r&#39;, &#39;e&#39;, &#39;e&#39;,\n  &#39;s&#39;, &#39; &#39;, &#39;°&#39;\n]\nundefined\n</code></pre></div>\n<p>Just tell me if I should shut up...</p>",
        "id": 426730908,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1710504798
    },
    {
        "content": "<p>x3F is not anywhere in the string cleaning  functions.cpp line 62 on.<br>\nIt was working before - only thing new is cleaning superscript 0 to degree.<br>\nLet's try commenting that out.  Will you do or do you want me to do and rebuild?</p>",
        "id": 426731133,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710504876
    },
    {
        "content": "<p>Sounds unlikely but is ? being sen as supescript 0 and turned into degree?</p>",
        "id": 426731279,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710504923
    },
    {
        "content": "<p>I think the engine is 8 bit ASCII</p>",
        "id": 426731593,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710505024
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 426731599,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710505027
    },
    {
        "content": "<p>I don't have your latest alpha code but I will recompile yesterdays with superscript commented out.</p>",
        "id": 426731876,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710505129
    },
    {
        "content": "<p>Yesterdays does not clean the script window careful.<br>\nThe plugin is here <code>https://github.com/antipole2/JavaScript_pi/tree/v3.0.0-beta</code></p>",
        "id": 426732586,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710505367
    },
    {
        "content": "<p>It is only the builds that went into my alpha repo accidentally</p>",
        "id": 426732694,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710505419
    },
    {
        "content": "<p>Did a manual clean of the degree symbol and with Test9 it went as far as line 155 before failing. StandBy for a new build.</p>",
        "id": 426732869,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710505482
    },
    {
        "content": "<p>Restored cleaning sub-prime in your latest code.</p>\n<div class=\"codehilite\"><pre><span></span><code>(&quot;00&quot; + parseInt(latAbs)).slice(-2) + &quot;&amp;#xb0 &quot; +\n            (&quot;00&quot; + (latAbs % 1 * 60).toFixed(3)).slice(-6) + &quot;&#39;&quot; +\n            ((this.latitude &lt; 0) ° &quot;S &quot; : &quot;N &quot;) +\n</code></pre></div>\n<p>The ? has been replaced by the degree symbol. Back where we started!!!</p>",
        "id": 426734688,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710506169
    },
    {
        "content": "<p>Manually change degree to ?</p>\n<div class=\"codehilite\"><pre><span></span><code>55&amp;#xb0 00.000&#39;N 002&amp;#xb0 0.000&#39;W\n55&amp;#xb0 12.342&#39;N 002&amp;#xb0 1.021&#39;W\nparsePosition lat not a number\n</code></pre></div>",
        "id": 426735488,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710506490
    },
    {
        "content": "<p>What do you have in the script?  Degree is being escaped but &amp;# is from where?<br>\nTry simple print one-liners to make sure you can do say<br>\n<code>print(\"º?\\n\");</code></p>",
        "id": 426736533,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710506851
    },
    {
        "content": "<p>Lines 27 &amp; 30 - the escape should be \\xB0 not \\B0 if that is hat you have?</p>",
        "id": 426737391,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710507175
    },
    {
        "content": "<p>As a script it loaded as:<br>\nprint(\"&amp;#xb0°\\n\");<br>\nSyntaxError: source decode failed (line 0)<br>\nWhen copied into window:<br>\nrint(\"º?\\n\");<br>\nSyntaxError: source decode failed (line 0)</p>\n<p>In functions.cpp you have:<br>\n<code>const wxString degreeText   {\"&amp;#xb0\"};</code><br>\nWill try changing that to \"\\xBO\"</p>",
        "id": 426738479,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710507545
    },
    {
        "content": "<p>BBL</p>",
        "id": 426739530,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710507883
    },
    {
        "content": "<p>I have removed clean on load as it is clened on run.  But had better restore clean on load for windows sake.<br>\nIn JavaScriptgui_impl.cpp uncomment line  133</p>",
        "id": 426739565,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710507897
    },
    {
        "content": "<p>Compiled the wrong branch of JS. Starting again.</p>",
        "id": 426748775,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710510948
    },
    {
        "content": "<p>Lunch</p>",
        "id": 426748889,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710510978
    },
    {
        "content": "<p>With 133 commented out I tested the ? symbol.</p>\n<div class=\"codehilite\"><pre><span></span><code>00]?\n\nRaw\n?\n[00]3F\n\nCleaned\n°\n[00]B0\n</code></pre></div>\n<p>With 133 uncommented \"°\" appears instead of \"?\".</p>",
        "id": 426754673,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710512907
    },
    {
        "content": "<p>Not clear to me,  I think you said it made a differenec but I see none in your bit above?<br>\nNB I now clean in the console method in JavaScriotgui_impl.h line 559 so it gets cleaned even if you past in or edit.  So the one at line 133 should be redundant - otherwise cleaning twice.<br>\nMust pop out for an hour.</p>",
        "id": 426757084,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710513618
    },
    {
        "content": "<p>Back now.  Where are we at?</p>",
        "id": 426767488,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710516525
    },
    {
        "content": "<p>cut and paste is giving me problems. Restarting the pc.</p>",
        "id": 426767925,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710516635
    },
    {
        "content": "<p>This is what I have when loading Test9:        </p>\n<div class=\"codehilite\"><pre><span></span><code>(&quot;00&quot; + parseInt(latAbs)).slice(-2) + &quot;º &quot; +\n            (&quot;00&quot; + (latAbs % 1 * 60).toFixed(3)).slice(-6) + &quot;&#39;&quot; +\n            ((this.latitude &lt; 0) ? &quot;S &quot; : &quot;N &quot;) +\n</code></pre></div>\n<p>When I test the ? character all is well but we have the  masculine ordinal:<br>\n<a href=\"/user_uploads/33951/s-wf9JziSCtbS-wj3IDDkMCi/4.jpg\">4.jpg</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/33951/s-wf9JziSCtbS-wj3IDDkMCi/4.jpg\" title=\"4.jpg\"><img src=\"/user_uploads/33951/s-wf9JziSCtbS-wj3IDDkMCi/4.jpg\"></a></div>",
        "id": 426769388,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710517051
    },
    {
        "content": "<p>When you view it in the script pane, you may see the masculine ordinal but it is cleaned before it gets into the JavaScript engine.<br>\nYou can confirm that by running the simple script</p>\n<div class=\"codehilite\" data-code-language=\"JavaScript\"><pre><span></span><code><span class=\"nx\">text</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"'°º⁰ primes ‘’‛’′´`º\"</span><span class=\"p\">;</span>\n<span class=\"k\">for</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"nx\">i</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mf\">0</span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"nx\">i</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"w\"> </span><span class=\"nx\">text</span><span class=\"p\">.</span><span class=\"nx\">length</span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"nx\">i</span><span class=\"o\">++</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"nx\">print</span><span class=\"p\">(</span><span class=\"nx\">text</span><span class=\"p\">.</span><span class=\"nx\">charAt</span><span class=\"p\">(</span><span class=\"nx\">i</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"s2\">\"\\t\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nx\">text</span><span class=\"p\">.</span><span class=\"nx\">charCodeAt</span><span class=\"p\">(</span><span class=\"nx\">i</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"s2\">\"\\n\"</span><span class=\"p\">);</span>\n</code></pre></div>\n<p>When I run that I get</p>\n<blockquote>\n<p>'   39<br>\n°   176<br>\n°   176<br>\n°   176<br>\n    32<br>\np   112<br>\nr   114<br>\ni   105<br>\nm   109<br>\ne   101<br>\ns   115<br>\n    32<br>\n'   39<br>\n'   39<br>\n'   39<br>\n'   39<br>\n'   39<br>\n'   39<br>\n'   39<br>\n°   176</p>\n</blockquote>",
        "id": 426770438,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710517340
    },
    {
        "content": "<p>My result:<br>\nresult: undefined</p>",
        "id": 426770699,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710517427
    },
    {
        "content": "<p>Warning in my compiler:<br>\n<code>'\\u2070' cannot be represented in the current code page (1252)</code></p>",
        "id": 426772590,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710517988
    },
    {
        "content": "<p>Line 111 in functions.cpp is perhaps the culprit.</p>",
        "id": 426775148,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710518707
    },
    {
        "content": "<p>__WXMSW__ is being used to determine the OS. It should be __WINDOWS__.</p>",
        "id": 426777731,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710519514
    },
    {
        "content": "<p>__WXMSW__ is for GUI stuff, I think.</p>",
        "id": 426778339,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710519719
    },
    {
        "content": "<blockquote>\n<p>'\\u2070' cannot be represented in the current code page (1252)<br>\nThis relates to superscript 0 and is only a warning.  However, its possible there is one ib the tests.  I have seen it used in the wild for the degree symbol.  Have to think about how to handle that.  Might it end up getting confused with '?' ?</p>\n</blockquote>\n<p>Regarding Line 111 in functions.cpp, I had forgottem about that and have been getting strings from the duk stack without going via that.  It only affects Windows and if the script when run has generated \"\\u00C2\\u00b0\", which we must have seen sometime in the past.  It does not impact what goes into the engine - only what it delivers out.</p>\n<p>Snag is, I get strings off the stack in many places and not always from the top - sometimes further down.  I can, maybe should, generalise it but it will take some hours.</p>\n<p>Shall I change __WXMSW__  to _WINDOWS__ throughout?</p>",
        "id": 426778964,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710519912
    },
    {
        "content": "<blockquote>\n<p>Shall I change __WXMSW__ to _WINDOWS__ throughout?</p>\n</blockquote>\n<p>No, it only applies to lines 85 - 124.</p>",
        "id": 426779517,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710520079
    },
    {
        "content": "<p>When I load Test9 now, from file, the ordinal has been replaced by degree. But when I reopen OpenCPN and it loads from config the ordinal is back.</p>",
        "id": 426780103,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710520261
    },
    {
        "content": "<p>And the script fails at line 27. Testing the degree symbol:</p>\n<div class=\"codehilite\"><pre><span></span><code>[00]°\n\nRaw\n°\n[00]B0\n\nCleaned\n°\n[00]B0\n</code></pre></div>",
        "id": 426780400,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710520361
    },
    {
        "content": "<p>Probably because you reactivated line 133.  So if you Load it, it gets a preliminary clean.  But when it gets loaded from file on start-up, it does not.  Either way, it gets cleaned just before compilation now..</p>",
        "id": 426780837,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710520477
    },
    {
        "content": "<p>In line 27, do you have º or \\xb0 ?</p>",
        "id": 426781206,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710520583
    },
    {
        "content": "<p>The degree symbol, not \\xb0.</p>",
        "id": 426781308,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710520627
    },
    {
        "content": "<p>Try \\xb0 please</p>",
        "id": 426781420,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710520669
    },
    {
        "content": "<p>I haveone of each in lines 27 &amp; 30 just to keep an eye on them :-)</p>",
        "id": 426781759,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710520767
    },
    {
        "content": "<p>Changing all the degrees to \\xb0 it gets as far as line 155 in Test9.</p>",
        "id": 426782052,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710520863
    },
    {
        "content": "<p>BBL. A cup of tea calls.</p>",
        "id": 426782084,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710520875
    },
    {
        "content": "<p>That's when it first executes lines 27 &amp; 30.  What is the error?</p>",
        "id": 426782396,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710520968
    },
    {
        "content": "<p>SyntaxError: source decode failed (line 155)</p>",
        "id": 426789475,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710523204
    },
    {
        "content": "<p>I have been typing degree as masculine ordinal, so that is what has been in the files I sent you.  But it should not matter as it now gets cleaned to degree \\xb0 just before compiling.<br>\nSo I don't understand why switching in \\xb0 makes any difference for you.  If you copy the masculine ordinal (or whatever) out of the script window and paste it into the cleaner in tools, does it get converted to degree \\xb0 ?<br>\nIt is vital that the symbol is converted before compilation.  If you are using the update from me this morning, that should be happening.</p>\n<p>I have discovered that if a script is reloaded on start up and automatically run, it was not getting cleaned.  I have fixed that here but I doubt that was your situation.</p>",
        "id": 426789515,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710523211
    },
    {
        "content": "<blockquote>\n<p>does it get converted to degree \\xb0 ?</p>\n</blockquote>\n<p>Yes it does.</p>\n<div class=\"codehilite\"><pre><span></span><code>[00]º\n\nRaw\nº\n[00]BA\n\nCleaned\n°\n[00]B0\n</code></pre></div>",
        "id": 426789996,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710523371
    },
    {
        "content": "<p>Are you sure you have a call to <code>JScleanString</code> in <code>void doRunCommand(Brief brief){</code> - file JavaScriptgui_impl.h ?</p>",
        "id": 426790247,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710523444
    },
    {
        "content": "<blockquote>\n<p>Are you sure you have a call to JScleanString</p>\n</blockquote>\n<p>Yes, confirmed.</p>",
        "id": 426790720,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710523605
    },
    {
        "content": "<p>I will renew my source code from your repo and rebuild.</p>",
        "id": 426790826,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710523636
    },
    {
        "content": "<p>Please try this script</p>\n<div class=\"codehilite\" data-code-language=\"JavaScript\"><pre><span></span><code><span class=\"nx\">text</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"º\"</span><span class=\"p\">;</span>\n<span class=\"nx\">print</span><span class=\"p\">(</span><span class=\"nx\">text</span><span class=\"p\">.</span><span class=\"nx\">charCodeAt</span><span class=\"p\">(</span><span class=\"mf\">0</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"s2\">\"\\n\"</span><span class=\"p\">);</span>\n</code></pre></div>\n<p>where the 'degree' is actually the masculine ordinal.  To check that it is getting converted as it appears in your script pane.  It does here.</p>",
        "id": 426792397,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710524204
    },
    {
        "content": "<p>SyntaxError: source decode failed (line 0)</p>",
        "id": 426792736,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710524325
    },
    {
        "content": "<p>Would a string.replace in Functions.cpp be any good?</p>",
        "id": 426793094,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710524432
    },
    {
        "content": "<p>That is what we have at line 92 - yes?<br>\nThat test works here OK.</p>",
        "id": 426793369,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710524535
    },
    {
        "content": "<p>Replacing A_stringDeg but not ordinal.</p>",
        "id": 426793511,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710524604
    },
    {
        "content": "<p>and the tools utility calls the same function.</p>",
        "id": 426793524,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710524612
    },
    {
        "content": "<p>^^</p>",
        "id": 426793664,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710524660
    },
    {
        "content": "<p>That cleaning is only done when preparing output to print.  It is not used at all in script input.</p>",
        "id": 426794016,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710524810
    },
    {
        "content": "<p>It is beginning to look like the JavaScript engine cannot handle the degree symbol in source on Windows but can on Mac.</p>",
        "id": 426794299,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710524918
    },
    {
        "content": "<p>Do you agree?</p>",
        "id": 426794601,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710525049
    },
    {
        "content": "<p>Found this:<br>\n<em>grrr... and never mind the fact that my Windows PC decided to use character sets that map degree symbol to \\u00f8 instead of \\u00b0!</em></p>",
        "id": 426794833,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710525126
    },
    {
        "content": "<p><a href=\"https://stackoverflow.com/questions/4901133/json-and-escaping-characters\">https://stackoverflow.com/questions/4901133/json-and-escaping-characters</a></p>",
        "id": 426794977,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710525191
    },
    {
        "content": "<p>Got the degree symbol from the Windows character map. Tested in cleaning:</p>\n<div class=\"codehilite\"><pre><span></span><code>Raw\n°\n[00]B0\n\nCleaned\n&amp;#xb0\n[00]26 [01]23 [02]78 [03]62 [04]30\n</code></pre></div>",
        "id": 426795805,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710525532
    },
    {
        "content": "<p>Where does this leave us?<br>\nPerhaps we have to go back to my other plan B - using \\x07 (bell) internally.<br>\nA quick test is straight forward.<br>\nIn functions.cpp, uncomment line 74 to turn the degre into BELL.<br>\nIn the test script, replace all degrees or \\xb0 with \\x07<br>\nIt should then run but the prited output will lack any degree symbol.  That I can quckily fix.<br>\nBut I woke up in the night realising there are twenty other places that would need fixing.</p>",
        "id": 426796462,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710525772
    },
    {
        "content": "<p>Are - we don't want &amp;#xb0  May be an extra change on the end to \\xB0 ?</p>",
        "id": 426796768,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710525905
    },
    {
        "content": "<p>Sorry ...  BB tomorrow.</p>",
        "id": 426796795,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710525917
    },
    {
        "content": "<p>One of my sons arrives from Leeds this evening with my grandson for a rare visit. I will be rather taken up with this over the weekend. Possibly back Sunday more likely Monday.</p>",
        "id": 426802413,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710528144
    },
    {
        "content": "<blockquote>\n<p>Cleaned<br>\n&amp;#xb0</p>\n</blockquote>\n<p>Are you sure JScleanString line 95 is commented out?<br>\n<code>//     given.Replace(degree, degreeText, true);</code><br>\nIf not, that would explain the tools cleaning.<br>\n(I don't recall why it was created but I commented it out in V3 because I didn't know why it was there.)<br>\nBut it is present in plugin v2.  So does it have to be in?   Very puzzled.</p>\n<p>Can you have a play?  Afraid I cannot do anything here as it is not an issue on Mac.</p>",
        "id": 426805742,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710529650
    },
    {
        "content": "<p><a href=\"/user_uploads/33951/cRgiuE9BRTooEsY0TXMq9ZaO/positionComplete.js\">positionComplete.js</a></p>\n<p>On Run ... Replace the ordinals with circumflex ^ . Replace degree symbol with circumflex.</p>\n<p>Removed the ordinal from <code>dmsPattern</code>.</p>\n<p>In output change the circumflex back to the degree symbol.</p>\n<p>I think the superscore0 replacement was causing the ? to change character.</p>\n<p><a href=\"https:///github.com/Rasbats/JavaScript_pi/tree/v3.0.0-beta\">https://github.com/Rasbats/JavaScript_pi/tree/v3.0.0-beta</a></p>",
        "id": 426886704,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710591478
    },
    {
        "content": "<p>I have pushed some commits to my fork of JS. Some tests failed and I have tried to fix some of these. The commits reference these.</p>",
        "id": 427169299,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710695342
    },
    {
        "content": "<p>I am back on this.  So, we seem to be agreed that we have to use a substitute character for degree inside the plugin.  I have defined a macro DEGREE for this in version.h and presently have it set to \\u0007 (bell) but it can be changed in a single point.<br>\nI am keeping the degree in the scripts as it gets cleaned to DEGREE and should be able to keep it in the tests too as it gets cleaned to DEGREE. <br>\nIn Position I am keeping the degree/ordinal but excaping it as a precaution in case DEGREE is set to something like circumflex.<br>\nI will shortly push a version for you to try, please.<br>\nI will look at your mods but I think many unnecessary, so suggest you hold off a mo.</p>",
        "id": 427173098,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710696330
    },
    {
        "content": "<p>The test scripts include a number of deliberate errors to test error handling - as in the comments.<br>\nYour edits are fixing them <span aria-label=\"face with hand over mouth\" class=\"emoji emoji-1f92d\" role=\"img\" title=\"face with hand over mouth\">:face_with_hand_over_mouth:</span></p>",
        "id": 427174946,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710696839
    },
    {
        "content": "<p>Problem was that they caused OpenCPN to crash!</p>",
        "id": 427175164,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710696889
    },
    {
        "content": "<p>Not here and you have run them previously.  This is an important finding...</p>",
        "id": 427175427,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710696978
    },
    {
        "content": "<p>Please run this test (documented in the Technical Guide)<br>\n<code>JS_throw_test(1,2);</code><br>\nIf the two arguments are unequal, it returns their sum, which will become the result.</p>\n<p>Then, if the two arguments are made equal, it will thrown an error within the plugin C++ code and it should show as an error in the script.  It should not crash OCPN and does not here.</p>",
        "id": 427177092,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710697431
    },
    {
        "content": "<p>Works as expected. Let's sort the degree symbole first. Tests again later.</p>",
        "id": 427179215,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710698005
    },
    {
        "content": "<p>Just pushed beta-k and it is building for the beta repository too, so you can install from there.<br>\nHere is the test file.<br>\n<a href=\"/user_uploads/33951/BMNeHmKrvAoMRQilVv09iz-G/Test10.js.zip\">Test10.js.zip</a><br>\nIf we go this way, there are several places I am going to have to fix up, like reading from or to file  and messageBox and, worst of all,  onDialogue but I will hold off until we have confirmed the approach.</p>",
        "id": 427180048,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710698235
    },
    {
        "content": "<p>Supper calls <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span></p>",
        "id": 427180164,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710698275
    },
    {
        "content": "<p>Test10 works.<br>\nBut my copy/paste has failed again.</p>",
        "id": 427197538,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710703112
    },
    {
        "content": "<p>So let's go with this approach.<br>\nWhat failed with copy/paste? I need to fix those APIs for DEGREE substitution</p>",
        "id": 427199003,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710703522
    },
    {
        "content": "<p>Please do a test in the  tools dump string  with the following data.<br>\n<code>?º⁰</code><br>\nwhere the third character is a superscript 0.  I cannot type that but had to use the character viewer to put it in.  It should dump before cleaning as x2070 thus</p>\n<blockquote>\n<p>00]? [01]º [0002]⁰ </p>\n<p>Raw<br>\n?º⁰<br>\n[00]3F [01]BA [02]2070 </p>\n<p>Cleaned<br>\n?\u0007\u0007<br>\n[00]3F [01]07 [02]07</p>\n</blockquote>",
        "id": 427202934,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710704547
    },
    {
        "content": "<p>Test10</p>\n<div class=\"codehilite\"><pre><span></span><code>55° 00.000&#39;N 002° 0.000&#39;W\n55° 12.342&#39;N 002° 1.021&#39;W\nA   54° 00.000&#39;N 013° 12.340&#39;W\nB   55° 12.000&#39;N 013° 23.450&#39;W\nC   56° 30.217&#39;N 013° 44.950&#39;W\nresult: undefined\n</code></pre></div>\n<p>?º⁰</p>\n<div class=\"codehilite\"><pre><span></span><code>[00]? [01]º [0002]⁰\n\nRaw\n?º⁰\n[00]3F [01]BA [02]2070\n\nCleaned\n?\u0007⁰\n[00]3F [01]07 [02]2070\n</code></pre></div>",
        "id": 427376475,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710748612
    },
    {
        "content": "<p>copy/paste is a Windows 10 problem and a restart fixes it at the moment.<br>\nBoating today.</p>",
        "id": 427377616,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710748858
    },
    {
        "content": "<p>version.h now contains</p>\n<div class=\"codehilite\"><pre><span></span><code>#define DEGREE        {&quot;\\u00B0&quot;}    // real degree character\n#ifdef __WINDOWS__\n#define PSEUDODEGREE  {&quot;\\u0007&quot;}    // substitute character for degree - bell\n#else\n#define PSEUDODEGREE  DEGREE    // keep it as real degree\n#endif\n</code></pre></div>\n<p>I have now fixed up the twelve areas where I have to go PSEUDODEGREE &lt;-&gt;DEGREE on way in or. out - error messages, messageBox, to and from clipboard, file input and output etc. etc.  Worst was the onDialogue feature. where the dialogue specification and its interpretation has to be fixed up.  Bloody Windows <span aria-label=\"rage\" class=\"emoji emoji-1f621\" role=\"img\" title=\"rage\">:rage:</span> <br>\nStill not completely hidden as I explain in this addition to the User Guide</p>\n<blockquote>\n<p><strong>Note for Windows users about the degree symbol</strong><br>\nOn Windows, the JavaScript engine cannot handle the degree symbol ° (code \\u00B0).<br>\nTo work around this, the plugin changes all incoming occurrences of ° (including in scripts), to an alternative code (\\u0007 - bell) and all out-going occurrences of this alternative back to °.  This is mostly invisible to the user.<br>\nHowever, if you print the actual character code, you will see the substitute. <br>\nThis will also be the case if you examine the JSON representation of the symbol or match it by character code.</p>\n</blockquote>\n<p>The string dump you sent me shows that superscript 0 is seen as \\x2070 in C++ so it is now cleaned to DEGREE.  Not sure why it was still giving trouble before.  Now it goes directly to DEGREE.  Please test again.</p>\n<p>Latest beta-l build inmy beta repo has the updated Position object, so you can test with, say,</p>\n<div class=\"codehilite\" data-code-language=\"JavaScript\"><pre><span></span><code><span class=\"nx\">Position</span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nx\">require</span><span class=\"p\">(</span><span class=\"s2\">\"Position\"</span><span class=\"p\">);</span>\n<span class=\"nx\">print</span><span class=\"p\">(</span><span class=\"ow\">new</span><span class=\"w\"> </span><span class=\"nx\">Position</span><span class=\"p\">(</span><span class=\"s2\">\"28.5ºN 3º 12'34E\"</span><span class=\"p\">).</span><span class=\"nx\">formatted</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s2\">\"\\n\"</span><span class=\"p\">);</span>\n</code></pre></div>\n<p>If this all viable, please try the test suite again.  It runs OK for me.</p>",
        "id": 427515712,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710776645
    },
    {
        "content": "<p>Correction to the above...<br>\nSuperscript 0 is cleaned to PSEUDODEGREE</p>",
        "id": 427538862,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710782912
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>28\u0007 30.000&#39;N 003\u0007 12.340&#39;E\nresult: undefined\n</code></pre></div>\n<p>The BEL is left in the output window.</p>",
        "id": 427566747,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710792768
    },
    {
        "content": "<p>Test <em>12_runtime_error_main.js</em> causes OpenCPN to crash.</p>",
        "id": 427567272,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710792992
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>The BEL is left in the output window.\n</code></pre></div>\n<p>Screenshot please.</p>\n<blockquote>\n<p>Test 12_runtime_error_main.js causes OpenCPN to crash.</p>\n</blockquote>\n<p>Does it crash if you run that script directly, rather than invoking from the main test program?</p>",
        "id": 427568813,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710793571
    },
    {
        "content": "<p>If it crashes when run directly, please confirm whether</p>\n<div class=\"codehilite\" data-code-language=\"JavaScript\"><pre><span></span><code><span class=\"nx\">JS_throw_test</span><span class=\"p\">(</span><span class=\"mf\">2</span><span class=\"p\">,</span><span class=\"mf\">2</span><span class=\"p\">);</span>\n</code></pre></div>\n<p>throws an error within the plugin correctly, while</p>\n<div class=\"codehilite\" data-code-language=\"JavaScript\"><pre><span></span><code><span class=\"nx\">onSeconds</span><span class=\"p\">(</span><span class=\"mf\">1</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nx\">doit</span><span class=\"p\">);</span>\n<span class=\"kd\">function</span><span class=\"w\"> </span><span class=\"nx\">doit</span><span class=\"p\">(){</span>\n<span class=\"w\">    </span><span class=\"nx\">print</span><span class=\"p\">(</span><span class=\"s2\">\"Hello\"</span><span class=\"p\">);</span>\n<span class=\"w\">    </span><span class=\"p\">}</span>\n</code></pre></div>\n<p>crashes OCPN.</p>",
        "id": 427570056,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710794018
    },
    {
        "content": "<p><a href=\"/user_uploads/33951/KwSKhZII_ex5hFfauDA96v38/5.jpg\">5.jpg</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/33951/KwSKhZII_ex5hFfauDA96v38/5.jpg\" title=\"5.jpg\"><img src=\"/user_uploads/33951/KwSKhZII_ex5hFfauDA96v38/5.jpg\"></a></div><p>Test 12 crashes when run directly as well as when invoked from main.</p>\n<p><code>JS_throw_test(2,2);</code> works correctly.</p>\n<div class=\"codehilite\"><pre><span></span><code>onSeconds(1, doit);\nfunction doit(){\n    print(&quot;Hello&quot;);\n    }\n</code></pre></div>\n<p>crashes directly.</p>",
        "id": 427570845,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710794332
    },
    {
        "content": "<p>Back tomorrow</p>",
        "id": 427572897,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710795237
    },
    {
        "content": "<p>Please run this script:</p>\n<div class=\"codehilite\" data-code-language=\"JavaScript\"><pre><span></span><code><span class=\"nx\">Position</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nx\">require</span><span class=\"p\">(</span><span class=\"s2\">\"Position\"</span><span class=\"p\">);</span>\n<span class=\"nx\">text</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"ow\">new</span><span class=\"w\"> </span><span class=\"nx\">Position</span><span class=\"p\">(</span><span class=\"s2\">\"28.5ºN 3º 12'34E\"</span><span class=\"p\">).</span><span class=\"nx\">formatted</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s2\">\"\\n\"</span><span class=\"p\">;</span>\n<span class=\"nx\">messageBox</span><span class=\"p\">(</span><span class=\"nx\">text</span><span class=\"p\">);</span>\n<span class=\"nx\">alert</span><span class=\"p\">(</span><span class=\"nx\">text</span><span class=\"p\">);</span>\n<span class=\"nx\">toClipboard</span><span class=\"p\">(</span><span class=\"nx\">text</span><span class=\"p\">);</span>\n</code></pre></div>\n<p>and advise whether the degree symbol is correct in the dialogue, alert and on the clipboard.</p>",
        "id": 427628423,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710830154
    },
    {
        "content": "<p>Re the crash, the timer function has been completely re-implemented in v3.m. That error is now thrown within a console method.  On reflection, that is rather chancing it but it works here on MacOS.  I need to restructure to avoid.</p>",
        "id": 427628695,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710830313
    },
    {
        "content": "<p><a href=\"/user_uploads/33951/5OUuoi3-FeDF96VsP1-p_xsi/6.jpg\">6.jpg</a><br>\n<a href=\"/user_uploads/33951/ubGj4tHYq7jwugEIGvoOUmMg/7.jpg\">7.jpg</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/33951/5OUuoi3-FeDF96VsP1-p_xsi/6.jpg\" title=\"6.jpg\"><img src=\"/user_uploads/33951/5OUuoi3-FeDF96VsP1-p_xsi/6.jpg\"></a></div><div class=\"message_inline_image\"><a href=\"/user_uploads/33951/ubGj4tHYq7jwugEIGvoOUmMg/7.jpg\" title=\"7.jpg\"><img src=\"/user_uploads/33951/ubGj4tHYq7jwugEIGvoOUmMg/7.jpg\"></a></div><p>And the clipboard:<br>\n<code>28\u0007 30.000'N 003\u0007 12.340'E</code> <br>\nThe bell symbol appears. Has the output been cleaned?</p>",
        "id": 427654419,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710841904
    },
    {
        "content": "<p>New timer mechanism now moved out of console mothod.  Long battle with getting timers to reliably go away on script termination  <span aria-label=\"face with spiral eyes\" class=\"emoji emoji-1f635-200d-1f4ab\" role=\"img\" title=\"face with spiral eyes\">:face_with_spiral_eyes:</span> </p>\n<p>Beta m now in my repository.</p>\n<p>Please check it throws an error safely with</p>\n<div class=\"codehilite\" data-code-language=\"JavaScript\"><pre><span></span><code><span class=\"nx\">onSeconds</span><span class=\"p\">(</span><span class=\"mf\">2</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nx\">func</span><span class=\"p\">);</span>\n<span class=\"kd\">function</span><span class=\"w\"> </span><span class=\"nx\">func</span><span class=\"p\">(){</span>\n<span class=\"w\">    </span><span class=\"nx\">print</span><span class=\"p\">(</span><span class=\"s2\">\"Should not get here\\n\"</span><span class=\"p\">);</span>\n<span class=\"w\">    </span><span class=\"p\">}</span>\n</code></pre></div>\n<p>Also please run the timer tests.</p>\n<p><code>OCPNonNMEA0183()</code> &amp; <code>OCPNonNMEA2000()</code> will have the same problem as onSeconds had.  I will rework them once you have confirmed the new onSeconds tests are OK.</p>",
        "id": 427781630,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710870847
    },
    {
        "content": "<p><strong>The degree problem</strong><br>\nA mystery.  Yes I am uncleaning.  I did a test forcing it to use \\x0007 here on MacOS and all output was correct.<br>\nPlease try this script to see what code is being produced at the end.  I am showing the formatted text in an alert as it is simpler.</p>\n<div class=\"codehilite\" data-code-language=\"JavaScript\"><pre><span></span><code><span class=\"nx\">Position</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nx\">require</span><span class=\"p\">(</span><span class=\"s2\">\"Position\"</span><span class=\"p\">);</span>\n<span class=\"nx\">pos</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"ow\">new</span><span class=\"w\"> </span><span class=\"nx\">Position</span><span class=\"p\">(</span><span class=\"mf\">55</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"mf\">2</span><span class=\"p\">);</span>\n<span class=\"nx\">text</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nx\">pos</span><span class=\"p\">.</span><span class=\"nx\">formatted</span><span class=\"p\">;</span>\n<span class=\"nx\">print</span><span class=\"p\">(</span><span class=\"nx\">text</span><span class=\"p\">.</span><span class=\"nx\">charCodeAt</span><span class=\"p\">(</span><span class=\"mf\">2</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"s2\">\"\\n\"</span><span class=\"p\">);</span>\n<span class=\"nx\">alert</span><span class=\"p\">(</span><span class=\"nx\">pos</span><span class=\"p\">.</span><span class=\"nx\">formatted</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s2\">\"\\n\"</span><span class=\"p\">);</span>\n</code></pre></div>\n<p>When I run this with the fiddle to make it use \\x0007, it prints <strong>7</strong></p>",
        "id": 427782610,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710871199
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>onSeconds(2, func);\nfunction func(){\n    print(&quot;Should not get here\\n&quot;);\n    }\n</code></pre></div>\n<p>Causes a crash.</p>\n<div class=\"codehilite\"><pre><span></span><code>Position = require(&quot;Position&quot;);\npos = new Position(55, -2);\ntext = pos.formatted;\nprint(text.charCodeAt(2), &quot;\\n&quot;);\nalert(pos.formatted, &quot;\\n&quot;);\n</code></pre></div>\n<p>Prints 7 in output. The alert has a square character.<br>\n<a href=\"/user_uploads/33951/q7UZGzTnD1A-rjVSPSjKXZ2k/8.jpg\">8.jpg</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/33951/q7UZGzTnD1A-rjVSPSjKXZ2k/8.jpg\" title=\"8.jpg\"><img src=\"/user_uploads/33951/q7UZGzTnD1A-rjVSPSjKXZ2k/8.jpg\"></a></div>",
        "id": 427783988,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710871674
    },
    {
        "content": "<p>I have to use a rare dry day to tackle the sliding back door - which is exposed to the sea.</p>\n<p>I am sorry to give you work but I see no alternative but to ask you to dig in a bit as I cannot reproduce here.</p>\n<p><strong>Degree character problem</strong></p>\n<p>Is Windows failing because of an issue with the bell charcater?<br>\nIn version.h line 35, try setting PSEUDODEGREE to something printable such as {\"\\u005E\"} (^)</p>\n<p><strong>Crash when throwing error </strong></p>\n<p>JS_throw_test does not use the <code>throw_error </code>method.</p>\n<p>I suspect if you run this single line script, you will get the crash<br>\n<code>messageBox(\"One\", 2, 3, 4);</code><br>\nTurn on tracing level 4.  In trace.h set TRACE_YES to <code>true</code><br>\nand both TRACE_MAX and TRACE_MIN to 4.<br>\nTrouble is, you lose the trace when it crashes and even if you direct the trace to the log file, it does not get into there when it crashes so soon after - I think.<br>\nSo we have to experiment.</p>\n<p>In JavaScriptgui_imp.h you have line 771 as<br>\n<code>void wrapUp(Completions reason) {    // clean down and maybe destroy ctx</code><br>\nInsert <code>return;</code> immediately after that so it does nothing.</p>\n<p>If it does not crash, move the return to the beginning of <code>wrapUpWorks</code> just below the above.</p>\n<p>NB Both these will leave the duktape stack unreleased, so you will have a big memory leak.  So avoid running too many times without restarting OCPN.</p>\n<p>I will try and check back at intervals.</p>",
        "id": 427868234,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710920147
    },
    {
        "content": "<blockquote>\n<p>Is Windows failing because of an issue with the bell charcater?</p>\n</blockquote>\n<p>No, I added this to <code>JScleanOutput</code>:<br>\n<code>given.Replace(PSEUDODEGREE, DEGREE, true);</code> <br>\nand the alert was correct.</p>\n<p><a href=\"/user_uploads/33951/bNq3Ej3g8XhsCRhd21BqXF8G/9.jpg\">9.jpg</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/33951/bNq3Ej3g8XhsCRhd21BqXF8G/9.jpg\" title=\"9.jpg\"><img src=\"/user_uploads/33951/bNq3Ej3g8XhsCRhd21BqXF8G/9.jpg\"></a></div>",
        "id": 427890725,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710929113
    },
    {
        "content": "<p><em>JSExtensions.cpp</em> Line 527. Compile error mpTimersVector undeclared. I am going to comment out this TRACE at the moment.</p>",
        "id": 427905552,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710933838
    },
    {
        "content": "<p>Probably needs pConsole-&gt;mpTimersVector since I moved it out of the method.</p>",
        "id": 427905966,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710933998
    },
    {
        "content": "<blockquote>\n<p>Probably needs pConsole-&gt;mpTimersVector since I moved it out of the method.</p>\n</blockquote>\n<p>That fixes it.</p>",
        "id": 427906476,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710934187
    },
    {
        "content": "<p>Placing return; did not work.<br>\nIn ThrowError() commenting out:</p>\n<div class=\"codehilite\"><pre><span></span><code>if (!duk_is_error(ctx, -1)){\n            // we do not have an error object on the stack\n            duk_push_error_object(ctx, DUK_ERR_ERROR, _(&quot;Console &quot;) + mConsoleName + _(&quot; - &quot;) + message);  // convert message to error object\n            }\n</code></pre></div>\n<p>Stopped the crash. Not sure where to go from here.</p>",
        "id": 427907799,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710934693
    },
    {
        "content": "<blockquote>\n<p>No, I added this to JScleanOutput:<br>\ngiven.Replace(PSEUDODEGREE, DEGREE, true);<br>\nand the alert was correct.</p>\n</blockquote>\n<p>Already had that in my latest push to GitHub</p>\n<div class=\"codehilite\" data-code-language=\"JavaScript\"><pre><span></span><code><span class=\"nx\">wxString</span><span class=\"w\"> </span><span class=\"nx\">js_formOutput</span><span class=\"p\">(</span><span class=\"nx\">duk_context</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"nx\">ctx</span><span class=\"p\">){</span>\n<span class=\"w\">    </span><span class=\"nx\">duk_idx_t</span><span class=\"w\"> </span><span class=\"nx\">nargs</span><span class=\"p\">;</span><span class=\"w\">  </span><span class=\"c1\">// number of args in call</span>\n<span class=\"w\">    </span><span class=\"nx\">wxString</span><span class=\"w\"> </span><span class=\"nx\">output</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nx\">wxEmptyString</span><span class=\"p\">;</span>\n\n<span class=\"w\">    </span><span class=\"nx\">nargs</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nx\">duk_get_top</span><span class=\"p\">(</span><span class=\"nx\">ctx</span><span class=\"p\">);</span>\n<span class=\"c1\">//   MAYBE_DUK_DUMP</span>\n<span class=\"w\">    </span><span class=\"k\">for</span><span class=\"p\">(</span><span class=\"kr\">int</span><span class=\"w\"> </span><span class=\"nx\">i</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mf\">0</span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"nx\">i</span><span class=\"o\">&lt;</span><span class=\"nx\">nargs</span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"nx\">i</span><span class=\"o\">++</span><span class=\"p\">){</span>\n<span class=\"w\">        </span><span class=\"k\">switch</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"nx\">duk_int_t</span><span class=\"w\"> </span><span class=\"nx\">type</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nx\">duk_get_type</span><span class=\"p\">(</span><span class=\"nx\">ctx</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nx\">i</span><span class=\"p\">)){</span>\n<span class=\"w\">            </span><span class=\"k\">case</span><span class=\"w\"> </span><span class=\"nx\">DUK_TYPE_STRING</span><span class=\"o\">:</span>\n<span class=\"w\">            </span><span class=\"k\">case</span><span class=\"w\"> </span><span class=\"nx\">DUK_TYPE_NUMBER</span><span class=\"o\">:</span>\n<span class=\"w\">                </span><span class=\"nx\">output</span><span class=\"w\"> </span><span class=\"o\">+=</span><span class=\"w\"> </span><span class=\"nx\">duk_to_string</span><span class=\"p\">(</span><span class=\"nx\">ctx</span><span class=\"p\">,</span><span class=\"nx\">i</span><span class=\"p\">);</span><span class=\"w\">  </span><span class=\"c1\">// mangles º character on Windows!</span>\n<span class=\"w\">                </span><span class=\"k\">break</span><span class=\"p\">;</span>\n<span class=\"w\">            </span><span class=\"k\">case</span><span class=\"w\"> </span><span class=\"nx\">DUK_TYPE_BOOLEAN</span><span class=\"o\">:</span>\n<span class=\"w\">                </span><span class=\"nx\">output</span><span class=\"w\"> </span><span class=\"o\">+=</span><span class=\"w\"> </span><span class=\"p\">((</span><span class=\"nx\">duk_to_boolean</span><span class=\"p\">(</span><span class=\"nx\">ctx</span><span class=\"p\">,</span><span class=\"nx\">i</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"o\">==</span><span class=\"w\"> </span><span class=\"mf\">1</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"o\">?</span><span class=\"w\"> </span><span class=\"s2\">\"true\"</span><span class=\"o\">:</span><span class=\"s2\">\"false\"</span><span class=\"p\">);</span>\n<span class=\"w\">                </span><span class=\"k\">break</span><span class=\"p\">;</span>\n<span class=\"w\">            </span><span class=\"k\">case</span><span class=\"w\"> </span><span class=\"nx\">DUK_TYPE_OBJECT</span><span class=\"o\">:</span>\n<span class=\"w\">                </span><span class=\"nx\">duk_json_encode</span><span class=\"p\">(</span><span class=\"nx\">ctx</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nx\">i</span><span class=\"p\">);</span>\n<span class=\"w\">                </span><span class=\"nx\">output</span><span class=\"w\"> </span><span class=\"o\">+=</span><span class=\"w\"> </span><span class=\"nx\">duk_to_string</span><span class=\"p\">(</span><span class=\"nx\">ctx</span><span class=\"p\">,</span><span class=\"nx\">i</span><span class=\"p\">);</span>\n<span class=\"w\">                </span><span class=\"k\">break</span><span class=\"p\">;</span>\n<span class=\"w\">            </span><span class=\"k\">case</span><span class=\"w\"> </span><span class=\"nx\">DUK_TYPE_NULL</span><span class=\"o\">:</span>\n<span class=\"w\">                </span><span class=\"k\">break</span><span class=\"p\">;</span>\n<span class=\"w\">            </span><span class=\"k\">case</span><span class=\"w\"> </span><span class=\"nx\">DUK_TYPE_UNDEFINED</span><span class=\"o\">:</span>\n<span class=\"w\">                </span><span class=\"nx\">findConsoleByCtx</span><span class=\"p\">(</span><span class=\"nx\">ctx</span><span class=\"p\">)</span><span class=\"o\">-&gt;</span><span class=\"nx\">throw_error</span><span class=\"p\">(</span><span class=\"nx\">ctx</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s2\">\"output - arg \"</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"nx\">to_string</span><span class=\"p\">(</span><span class=\"nx\">i</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"s2\">\" is undefined\"</span><span class=\"p\">);</span>\n<span class=\"w\">            </span><span class=\"k\">default</span><span class=\"o\">:</span>\n<span class=\"w\">                </span><span class=\"nx\">findConsoleByCtx</span><span class=\"p\">(</span><span class=\"nx\">ctx</span><span class=\"p\">)</span><span class=\"o\">-&gt;</span><span class=\"nx\">throw_error</span><span class=\"p\">(</span><span class=\"nx\">ctx</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s2\">\"output - arg \"</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"nx\">to_string</span><span class=\"p\">(</span><span class=\"nx\">i</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"s2\">\" of unexpected type \"</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"nx\">to_string</span><span class=\"p\">(</span><span class=\"nx\">type</span><span class=\"p\">));</span>\n<span class=\"w\">            </span><span class=\"p\">}</span>\n<span class=\"w\">        </span><span class=\"p\">}</span>\n<span class=\"w\">    </span><span class=\"nx\">output</span><span class=\"p\">.</span><span class=\"nx\">Replace</span><span class=\"p\">(</span><span class=\"nx\">PSEUDODEGREE</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nx\">DEGREE</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"kc\">true</span><span class=\"p\">);</span><span class=\"w\"> </span><span class=\"c1\">// internally, we are using DEGREE to represent degree - convert any back</span>\n<span class=\"err\">#</span><span class=\"nx\">ifdef</span><span class=\"w\"> </span><span class=\"nx\">__WXMSW__</span>\n<span class=\"w\">    </span><span class=\"nx\">wxString</span><span class=\"w\"> </span><span class=\"nx\">JScleanOutput</span><span class=\"p\">(</span><span class=\"nx\">wxString</span><span class=\"w\"> </span><span class=\"nx\">given</span><span class=\"p\">);</span>\n<span class=\"w\">    </span><span class=\"nx\">output</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nx\">JScleanOutput</span><span class=\"p\">(</span><span class=\"nx\">output</span><span class=\"p\">);</span><span class=\"w\"> </span><span class=\"c1\">// clean for Windows only</span>\n<span class=\"err\">#</span><span class=\"nx\">endif</span>\n<span class=\"w\">    </span><span class=\"k\">return</span><span class=\"p\">(</span><span class=\"nx\">output</span><span class=\"p\">);</span>\n</code></pre></div>\n<p>Note I have it outside the Windows bit. so it is executed on all platforms.  This so that any platform can change the PSEUDODEGREE character.  I alsonow  have this all over the place and not only when stuff is going throughg js_formOutput.<br>\nI cannot rceall why we have the JScleanOutput for Windows.  It may not be necessary now we have other things sorted.  Can we get rid of it?</p>",
        "id": 427922529,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710939791
    },
    {
        "content": "<blockquote>\n<p>I cannot rceall why we have the JScleanOutput for Windows. It may not be necessary now we have other things sorted. Can we get rid of it?</p>\n</blockquote>\n<p>Without this I have a rogue symbol in the alert box. In the console output it is not needed.</p>\n<p>Boat things early this afternoon.</p>",
        "id": 427923665,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710940139
    },
    {
        "content": "<blockquote>\n<p>In ThrowError() commenting out:<br>\nif (!duk_is_error(ctx, -1)){<br>\n            // we do not have an error object on the stack<br>\n            duk_push_error_object(ctx, DUK_ERR_ERROR, _(\"Console \") + mConsoleName + _(\" - \") + message);  // convert message to error object<br>\n            }</p>\n</blockquote>\n<p>Please insert just before the commented out <code>if (!duk_is_error(ctx, -1)){</code> insert</p>\n<div class=\"codehilite\"><pre><span></span><code>TRACE(4, pConsole-&gt;dukDump( ));\n</code></pre></div>\n<p>as per the technical guide p14 <em>Obtaining dumps from with code</em><br>\nThen get the error to throw and let me have that bit of the trace.  I should be able to see what is on the Duktape stack.</p>",
        "id": 427924237,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710940319
    },
    {
        "content": "<p>With the <code>if(!duk_is_err()</code>bit commented out, what error message if any is shown in the output pane?</p>",
        "id": 427928968,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710941738
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>L4  setConsoleMinClientSize text JavaScript, size X:52 Y: 15\nL4  Constructed console JavaScript size x 1066 y 949  minSize x 134 y 39\nL0  ------------------ Console JavaScript about to run\nL4  JavaScript-&gt;throw_error() messageBox called with invalid number of args\nL4  Duktape context dump:\nctx: top=4, stack=[&quot;One&quot;,2,3,4]\n\nL4  JavaScript-&gt;afterwards() with dukOutcome 1 and status now (no status)\nL4  JavaScript-&gt;run() completed with outcome 0\nL4  JavaScript-&gt;wrapUpWorks() with status 0 and now HAD_ERROR\nDuktape context dump:\nctx: top=1, stack=[4]\n\nL4  No brief\n\nL4  wrapUpWorks with error stack:Duktape context dump:\nctx: top=1, stack=[4]\n\nL4  JavaScript-&gt;clearDialog()  (None)\nL4  JavaScript-&gt;clearAlert()  (None)\nL0  ------------------ Console JavaScript wrapped up\n</code></pre></div>\n<blockquote>\n<p>With the if(!duk_is_err()bit commented out, what error message if any is shown in the output pane?</p>\n</blockquote>\n<p>Just \"4\".</p>",
        "id": 427958724,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710949308
    },
    {
        "content": "<p>Question:  when that section is not commented out, if there is, say, a compile error, does it show the appropriate error message or crash OCPN?  I think it likely shows error OK as you have been reporting the problems with degree in a script.<br>\nPlease let me have the trace/dump for a compile error.</p>",
        "id": 427963567,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710950614
    },
    {
        "content": "<p>A crash obviously.<br>\nWindows debug:<br>\n<code>Unhandled exception at 0x77236D13 (ntdll.dll) in opencpn.exe: 0xC0000374: A heap has been corrupted (parameters: 0x77273960).</code></p>\n<p>In trace window only this (frozen):</p>\n<div class=\"codehilite\"><pre><span></span><code>L4  setConsoleMinClientSize text JavaScript, size X:52 Y: 15\nL4  Constructed console JavaScript size x 1066 y 949  minSize x 134 y 39\nL0  ------------------ Console JavaScript about to run\nL4  JavaScript-&gt;throw_error() messageBox called with invalid number of args\nL4  Duktape context dump:\nctx: top=4, stack=[&quot;One&quot;,2,3,4]\n</code></pre></div>",
        "id": 427965692,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710951142
    },
    {
        "content": "<p>Please cause a compiler error - invalid JavaScript.  Say just run<br>\na = b;<br>\n(b is undefined and compile will throw an error)</p>",
        "id": 427966363,
        "sender_full_name": "Tony Voss",
        "timestamp": 1710951316
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>Tracing levels 4 - 4\nReferenceError: identifier &#39;b&#39; undefined\n</code></pre></div>",
        "id": 427966925,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710951468
    },
    {
        "content": "<p>Sorry ... should have included this. No crash.</p>\n<div class=\"codehilite\"><pre><span></span><code>L4  setConsoleMinClientSize text JavaScript, size X:52 Y: 15\nL4  Constructed console JavaScript size x 1066 y 949  minSize x 134 y 39\nL0  ------------------ Console JavaScript about to run\nL4  JavaScript-&gt;afterwards() with dukOutcome 1 and status now (no status)\nL4  JavaScript-&gt;run() completed with outcome 0\nL4  JavaScript-&gt;wrapUpWorks() with status 0 and now HAD_ERROR\nDuktape context dump:\nctx: top=1, stack=[{}]\n\nL4  No brief\n\nL4  wrapUpWorks with error stack:Duktape context dump:\nctx: top=1, stack=[{}]\n\nL4  Call stack: ReferenceError: identifier &#39;b&#39; undefined\n    at [anon] (duk_js_var.c:1239) internal\n    at eval (eval:1) preventsyield\nL4  JavaScript-&gt;clearDialog()  (None)\nL4  JavaScript-&gt;clearAlert()  (None)\nL0  ------------------ Console JavaScript wrapped up\n</code></pre></div>",
        "id": 427985110,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1710956836
    },
    {
        "content": "<p>With a compiler generated error (and no crash) the stack only has the error object on it.<br>\nWith my calls, the stack still has the remains of the API  arguments on it.<br>\nSo, let's clear those off before putting our error object onto it.</p>\n<p>Here is the revised throw_error</p>\n<div class=\"codehilite\" data-code-language=\"JavaScript\"><pre><span></span><code><span class=\"w\">    </span><span class=\"ow\">void</span><span class=\"w\"> </span><span class=\"nx\">throw_error</span><span class=\"p\">(</span><span class=\"nx\">duk_context</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"nx\">ctx</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nx\">wxString</span><span class=\"w\"> </span><span class=\"nx\">message</span><span class=\"p\">){</span>\n<span class=\"w\">        </span><span class=\"c1\">// throw an error from within c++ code called from running script</span>\n<span class=\"w\">        </span><span class=\"c1\">// either there is an error object on the stack or a message</span>\n<span class=\"w\">        </span><span class=\"c1\">// ! do not call otherwise</span>\n<span class=\"w\">        </span><span class=\"nx\">message</span><span class=\"p\">.</span><span class=\"nx\">Replace</span><span class=\"p\">(</span><span class=\"nx\">PSEUDODEGREE</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nx\">DEGREE</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"kc\">true</span><span class=\"p\">);</span><span class=\"w\">    </span><span class=\"c1\">// internally, we are using DEGREE to represent degree - convert any back</span>\n<span class=\"w\">        </span><span class=\"nx\">TRACE</span><span class=\"p\">(</span><span class=\"mf\">4</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nx\">mConsoleName</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"s2\">\"-&gt;throw_error() \"</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"nx\">message</span><span class=\"p\">);</span>\n<span class=\"w\">        </span><span class=\"nx\">m_result</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nx\">wxEmptyString</span><span class=\"p\">;</span><span class=\"w\">    </span><span class=\"c1\">// supress result</span>\n<span class=\"w\">        </span><span class=\"nx\">m_explicitResult</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"kc\">true</span><span class=\"p\">;</span><span class=\"w\">    </span><span class=\"c1\">// supress result</span>\n<span class=\"w\">        </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"o\">!</span><span class=\"nx\">duk_is_error</span><span class=\"p\">(</span><span class=\"nx\">ctx</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"mf\">1</span><span class=\"p\">)){</span>\n<span class=\"w\">            </span><span class=\"c1\">// we do not have an error object on the stack</span>\n<span class=\"w\">            </span><span class=\"kr\">int</span><span class=\"w\"> </span><span class=\"nx\">n</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nx\">duk_get_top</span><span class=\"p\">(</span><span class=\"nx\">ctx</span><span class=\"p\">);</span><span class=\"w\">  </span><span class=\"c1\">// number of items on stack</span>\n<span class=\"w\">            </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"nx\">n</span><span class=\"w\"> </span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"mf\">0</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"nx\">duk_pop_n</span><span class=\"p\">(</span><span class=\"nx\">ctx</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nx\">n</span><span class=\"p\">);</span><span class=\"w\">   </span><span class=\"c1\">// clear stack</span>\n<span class=\"w\">            </span><span class=\"nx\">duk_push_error_object</span><span class=\"p\">(</span><span class=\"nx\">ctx</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nx\">DUK_ERR_ERROR</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nx\">_</span><span class=\"p\">(</span><span class=\"s2\">\"Console \"</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"nx\">mConsoleName</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"nx\">_</span><span class=\"p\">(</span><span class=\"s2\">\" - \"</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"nx\">message</span><span class=\"p\">);</span><span class=\"w\">  </span><span class=\"c1\">// convert message to error object</span>\n<span class=\"w\">            </span><span class=\"p\">}</span>\n<span class=\"w\">        </span><span class=\"nx\">m_hadError</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"kc\">true</span><span class=\"p\">;</span>\n<span class=\"w\">        </span><span class=\"nx\">mRunningMain</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"kc\">false</span><span class=\"p\">;</span>\n<span class=\"w\">        </span><span class=\"nx\">duk_throw</span><span class=\"p\">(</span><span class=\"nx\">ctx</span><span class=\"p\">);</span><span class=\"w\">   </span><span class=\"c1\">// we don't come back from this</span>\n<span class=\"w\">        </span><span class=\"p\">}</span>\n</code></pre></div>",
        "id": 428068042,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711005083
    },
    {
        "content": "<p>About to crash but I used Visual Studio debug. This was the result in the TRACE:</p>\n<div class=\"codehilite\"><pre><span></span><code>L4  setConsoleMinClientSize text JavaScript, size X:52 Y: 15\nL4  Constructed console JavaScript size x 1066 y 949  minSize x 134 y 39\nL0  ------------------ Console JavaScript about to run\nL4  JavaScript-&gt;throw_error() messageBox called with invalid number of args\nL4  JavaScript-&gt;afterwards() with dukOutcome 1 and status now (no status)\nL4  JavaScript-&gt;run() completed with outcome 0\nL4  JavaScript-&gt;wrapUpWorks() with status 0 and now HAD_ERROR\nDuktape context dump:\nctx: top=1, stack=[{}]\n\nL4  No brief\n\nL4  wrapUpWorks with error stack:Duktape context dump:\nctx: top=1, stack=[{}]\n\nL4  Call stack: Error: Console JavaScript - messageBox called with invalid number of args\n    at [anon] (D:\\Documents\\Github\\JavaScript_pi\\src\\JavaScriptgui_impl.h:1102) internal\n    at [anon] () native strict preventsyield\n    at eval (eval:1) preventsyield\nL4  wholeLine:    at eval (eval:1\nL4  JavaScript-&gt;clearDialog()  (None)\nL4  JavaScript-&gt;clearAlert()  (None)\nL0  ------------------ Console JavaScript wrapped up\n</code></pre></div>",
        "id": 428069908,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711006201
    },
    {
        "content": "<p><a href=\"/user_uploads/33951/QcSX9ADClOJEOvhSSnRsoCWn/10.jpg\">10.jpg</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/33951/QcSX9ADClOJEOvhSSnRsoCWn/10.jpg\" title=\"10.jpg\"><img src=\"/user_uploads/33951/QcSX9ADClOJEOvhSSnRsoCWn/10.jpg\"></a></div>",
        "id": 428070117,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711006315
    },
    {
        "content": "<p><a href=\"/user_uploads/33951/uuviDibatOBoTiBT3ufQ-Pu1/11.jpg\">11.jpg</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/33951/uuviDibatOBoTiBT3ufQ-Pu1/11.jpg\" title=\"11.jpg\"><img src=\"/user_uploads/33951/uuviDibatOBoTiBT3ufQ-Pu1/11.jpg\"></a></div>",
        "id": 428070671,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711006639
    },
    {
        "content": "<p>If ctx is empty does <code>duk_throw(ctx)</code> work?</p>",
        "id": 428071247,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711006934
    },
    {
        "content": "<p>Boating today.</p>",
        "id": 428071391,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711007024
    },
    {
        "content": "<blockquote>\n<p>If ctx is empty does duk_throw(ctx) work?<br>\nNo - but the throw is before ctx is destroyed - or should be - but hang on - edit coming...</p>\n</blockquote>",
        "id": 428071405,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711007034
    },
    {
        "content": "<p>Please replace  wrapup (from line 771 in JavaScriptgui_imp.h) with this:</p>\n<div class=\"codehilite\" data-code-language=\"JavaScript\"><pre><span></span><code><span class=\"w\">    </span><span class=\"ow\">void</span><span class=\"w\"> </span><span class=\"nx\">wrapUp</span><span class=\"p\">(</span><span class=\"nx\">Completions</span><span class=\"w\"> </span><span class=\"nx\">reason</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\">    </span><span class=\"c1\">// clean down and maybe destroy ctx</span>\n<span class=\"w\">        </span><span class=\"nx\">wrapUpWorks</span><span class=\"p\">(</span><span class=\"nx\">reason</span><span class=\"p\">);</span>\n<span class=\"w\">        </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"o\">!</span><span class=\"nx\">isBusy</span><span class=\"p\">()){</span>\n<span class=\"w\">            </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"nx\">mpCtx</span><span class=\"w\"> </span><span class=\"o\">!=</span><span class=\"w\"> </span><span class=\"nx\">nullptr</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"p\">{</span><span class=\"w\"> </span><span class=\"c1\">// for safety - nasty consequences if no context</span>\n<span class=\"w\">                </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"nx\">reason</span><span class=\"w\"> </span><span class=\"o\">==</span><span class=\"w\"> </span><span class=\"nx\">DONE</span><span class=\"p\">){</span><span class=\"w\">    </span><span class=\"c1\">// save the enduring variable</span>\n<span class=\"w\">                    </span><span class=\"nx\">TRACE</span><span class=\"p\">(</span><span class=\"mf\">4</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nx\">mConsoleName</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"s2\">\"-&gt;wrapUp() will save _remember\"</span><span class=\"p\">);</span>\n<span class=\"w\">                    </span><span class=\"nx\">duk_push_global_object</span><span class=\"p\">(</span><span class=\"nx\">mpCtx</span><span class=\"p\">);</span>\n<span class=\"w\">                    </span><span class=\"kr\">int</span><span class=\"w\"> </span><span class=\"nx\">OK</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nx\">duk_get_prop_literal</span><span class=\"p\">(</span><span class=\"nx\">mpCtx</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"mf\">1</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s2\">\"_remember\"</span><span class=\"p\">);</span>\n<span class=\"w\">                    </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"nx\">OK</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"nx\">m_remembered</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nx\">duk_json_encode</span><span class=\"p\">(</span><span class=\"nx\">mpCtx</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"mf\">1</span><span class=\"p\">);</span>\n<span class=\"w\">                    </span><span class=\"k\">else</span><span class=\"w\"> </span><span class=\"nx\">m_remembered</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"{}\"</span><span class=\"p\">;</span><span class=\"w\">   </span><span class=\"c1\">// play safe - if no -remember set as undefined</span>\n<span class=\"w\">                    </span><span class=\"nx\">duk_pop</span><span class=\"p\">(</span><span class=\"nx\">mpCtx</span><span class=\"p\">);</span>\n<span class=\"w\">                    </span><span class=\"p\">}</span>\n<span class=\"w\">                </span><span class=\"nx\">TRACE</span><span class=\"p\">(</span><span class=\"mf\">4</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nx\">mConsoleName</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"s2\">\"-&gt;wrapUp() destroying ctx\"</span><span class=\"p\">);</span>\n<span class=\"w\">                </span><span class=\"nx\">duk_destroy_heap</span><span class=\"p\">(</span><span class=\"nx\">mpCtx</span><span class=\"p\">);</span>\n<span class=\"w\">                </span><span class=\"nx\">mpCtx</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nx\">nullptr</span><span class=\"p\">;</span>\n<span class=\"w\">                </span><span class=\"p\">}</span>\n<span class=\"w\">            </span><span class=\"nx\">TRACE</span><span class=\"p\">(</span><span class=\"mf\">0</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s2\">\"------------------ Console \"</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"nx\">mConsoleName</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"s2\">\" wrapped up\"</span><span class=\"p\">);</span>\n<span class=\"w\">            </span><span class=\"p\">}</span>\n<span class=\"w\">        </span><span class=\"p\">}</span>\n</code></pre></div>",
        "id": 428076071,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711009081
    },
    {
        "content": "<p>Sorry ... same error at <code>duk_throw(ctx)</code>.  Back tonight.</p>",
        "id": 428081975,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711011555
    },
    {
        "content": "<p>p.s. my line numbers differ a little because of auto formatting.</p>",
        "id": 428082053,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711011587
    },
    {
        "content": "<p>Mike - hope you had a good day at the boat.<br>\nPlease work with beta n just pushed to GitHub at 18:28 but not built remotely.</p>\n<p>JS_throw_test extended such that<br>\nJS_throw_test(1, 1)<br>\n throws error by pushing error object to stack and throwing</p>",
        "id": 428192890,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711045871
    },
    {
        "content": "<p>Above sent too soon and I cannot edit it any more - please ignore that.</p>\n<p>Mike - hope you had a good day at the boat.<br>\nPlease work with beta n just pushed to GitHub at 18:28 but not built remotely.  It has TRACE level 4.</p>\n<p>JS_throw_test extended such that<br>\n<code>JS_throw_test(1, 1) // both arguments equal</code><br>\n throws error by pushing error object to stack and throwing.  Works correctly?<br>\n<code>JS_throw_test(0,0 ) // both arguments zero</code><br>\ninvokes throw_error method.  Crashes Windows?<br>\nThe trace from the two looks identical apart from the extra trace statement within throw_ error apart from the following:<br>\nThe error objects pushed to the stack are slightly different DUK_ERR_TYPE_ERROR and DUK_ERR_ERROR.  These types are <a href=\"https://duktape.org/api#defines.5\">explained here</a>.  The one that works has DUK_ERR_TYPE_ERROR whereas the one that fails is DUK_ERR_ERROR.  I have not harmonised them because DUK_ERR_ERROR seems more appropriate but is the one used in the failing version.<br>\nAnother difference was setting <code>m_hadError = true;</code> but that did not do anything and I have now commented it out.  Also  <code>mRunningMain = false;</code> but that is only relevant when there are call-backs, which is not the case in these tests.</p>\n<p>Other straws to grasp at:</p>\n<ol>\n<li>Does running the crashing script in a virgin console that has never run anything before behave differently?</li>\n<li>Might be worth checking whether the crash occurs with the plugin v2.  We could have overlooked it.</li>\n</ol>\n<p>Sorry to land you with all this work but I am unable to pursue myself.</p>",
        "id": 428195843,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711046993
    },
    {
        "content": "<p><code>JS_throw_test(1, 1)</code></p>\n<div class=\"codehilite\"><pre><span></span><code>L4  setConsoleMinClientSize text JavaScript, size X:52 Y: 15\nL4  Constructed console JavaScript size x 1066 y 949  minSize x 134 y 39\nL0  ------------------ Console JavaScript about to run\nL4  JavaScript-&gt;afterwards() with dukOutcome 1 and status now (no status)\nL4  JavaScript-&gt;run() completed with outcome 0\nL4  JavaScript-&gt;wrapUpWorks() with status 0 and now HAD_ERROR\nDuktape context dump:\nctx: top=1, stack=[{}]\n\nL4  No brief\n\nL4  wrapUpWorks with error stack:Duktape context dump:\nctx: top=1, stack=[{}]\n\nL4  Call stack: TypeError: the arguments match - duk_throw\n    at [anon] (D:\\Documents\\Github\\JavaScript_pi\\src\\JSExtensions.cpp:1011) internal\n    at [anon] () native strict preventsyield\n    at eval (eval:1) preventsyield\nL4  wholeLine:    at eval (eval:1\nL4  JavaScript-&gt;clearDialog()  (None)\nL4  JavaScript-&gt;clearAlert()  (None)\nL4  JavaScript-&gt;wrapUp() destroying ctx\nL0  ------------------ Console JavaScript wrapped up\n</code></pre></div>\n<p><code>line 1 TypeError: the arguments match - duk_throw</code></p>",
        "id": 428200080,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711048681
    },
    {
        "content": "<p>JS_throw_test(0, 0)<br>\nCrash</p>\n<div class=\"codehilite\"><pre><span></span><code>L4  setConsoleMinClientSize text JavaScript, size X:52 Y: 15\nL4  Constructed console JavaScript size x 1066 y 949  minSize x 134 y 39\nL0  ------------------ Console JavaScript about to run\nL4  JavaScript-&gt;throw_error() the arguments are both zero - throw_error\nL4  JavaScript-&gt;throw_error() pushing error object to stack\nL4  JavaScript-&gt;afterwards() with dukOutcome 1 and status now (no status)\nL4  JavaScript-&gt;run() completed with outcome 0\nL4  JavaScript-&gt;wrapUpWorks() with status 0 and now HAD_ERROR\nDuktape context dump:\nctx: top=1, stack=[{}]\n\nL4  No brief\n\nL4  wrapUpWorks with error stack:Duktape context dump:\nctx: top=1, stack=[{}]\n\nL4  Call stack: Error: Console JavaScript - the arguments are both zero - throw_error\n    at [anon] (D:\\Documents\\Github\\JavaScript_pi\\src\\JavaScriptgui_impl.h:989) internal\n    at [anon] () native strict preventsyield\n    at eval (eval:1) preventsyield\nL4  wholeLine:    at eval (eval:1\nL4  JavaScript-&gt;clearDialog()  (None)\nL4  JavaScript-&gt;clearAlert()  (None)\nL4  JavaScript-&gt;wrapUp() destroying ctx\nL0  ------------------ Console JavaScript wrapped up\n</code></pre></div>\n<p>Debug shows error at <code>duk_throw(ctx)</code><br>\nAfter debug this in output:<br>\n<code>line 1 Error: Console JavaScript - the arguments are both zero - throw_error</code></p>",
        "id": 428201430,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711049183
    },
    {
        "content": "<p>In both cases, the stack dump shows just one thing - the  error object on the stack as expected.<br>\n<code>ctx: top=1, stack=[{}]</code><br>\nI am perplexed.  Only reason <code>duk_throw(ctx)</code> might fail is if invalid ctx.  Biut trce does not reveal any difference and, if a programming error, it would show here on MacOS.</p>\n<p>Please check with v2 . You will need to use, say, <code>messageBox(1,2,3,4);</code></p>",
        "id": 428203606,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711049904
    },
    {
        "content": "<p>Try changing error type in throw_error (line 989) to DUK_ERR_TYPE_ERROR</p>",
        "id": 428290687,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711099692
    },
    {
        "content": "<blockquote>\n<p>Please check with v2 . You will need to use, say, messageBox(1,2,3,4);</p>\n</blockquote>\n<p>Crash :(</p>",
        "id": 428295817,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711101448
    },
    {
        "content": "<p>Now trying changing error type.</p>",
        "id": 428295882,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711101473
    },
    {
        "content": "<p>With JS_throw_test(1, 1)<br>\n<code>line 1 TypeError: the arguments match - duk_throw</code><br>\nWith JS_throw_test(0, 0)<br>\n<code>line 1 TypeError: Console JavaScript - the arguments are both zero - throw_error</code></p>\n<p>With JS_throw_test(0, 0) the debug always finds the line <code>duk_throw(ctx);</code></p>",
        "id": 428312654,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711107987
    },
    {
        "content": "<p>Are you saying it crashes OCPN with DUK_ERR_TYPE_ERROR ?</p>",
        "id": 428312960,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711108112
    },
    {
        "content": "<p>Maybe it cannot cope with duk_throw(ctx) from within a method?  <span aria-label=\"thinking\" class=\"emoji emoji-1f914\" role=\"img\" title=\"thinking\">:thinking:</span></p>",
        "id": 428313842,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711108510
    },
    {
        "content": "<blockquote>\n<p>Are you saying it crashes OCPN with DUK_ERR_TYPE_ERROR ?</p>\n</blockquote>\n<p>Yes it does.</p>\n<p>Is <code>duk_throw(ctx)</code> needed? This works:</p>\n<div class=\"codehilite\"><pre><span></span><code>wxStyledTextCtrl* output_window = m_Output;\noutput_window-&gt;AppendText(message);\n</code></pre></div>",
        "id": 428314889,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711108914
    },
    {
        "content": "<p><code>duk_throw</code>  throws the value on top of the stack.<br>\nIf no values?</p>",
        "id": 428317331,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711109848
    },
    {
        "content": "<p>Ah... but the throw is needed to stop the script and unwind the call stack.  It could be in a function called from a JavaScript function called from a function etc.</p>\n<p>The throw_error method checks if there is already an error object on the top of the stack, such as when there is a compiler error (line 984).  If not it pushes one with our custom message.  The traces I have seen show the object (only) on the stack.The trace should be showing that it has.  Is it showing in the trace from line 999?</p>",
        "id": 428318326,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711110185
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>L4  setConsoleMinClientSize text JavaScript, size X:52 Y: 15\nL4  Constructed console JavaScript size x 816 y 949  minSize x 134 y 39\nL0  ------------------ Console JavaScript about to run\nL4  JavaScript-&gt;throw_error() the arguments are both zero - throw_error\nL4  JavaScript-&gt;throw_error() pushing error object to stack\n\nAfter debug:\n\nL4  JavaScript-&gt;afterwards() with dukOutcome 1 and status now (no status)\nL4  JavaScript-&gt;run() completed with outcome 0\nL4  JavaScript-&gt;wrapUpWorks() with status 0 and now HAD_ERROR\nDuktape context dump:\nctx: top=1, stack=[{}]\n\nL4  No brief\n\nL4  wrapUpWorks with error stack:Duktape context dump:\nctx: top=1, stack=[{}]\n\nL4  Call stack: TypeError: Console JavaScript - the arguments are both zero - throw_error\n    at [anon] (D:\\Documents\\Github\\JavaScript_pi\\src\\JavaScriptgui_impl.h:1107) internal\n    at [anon] () native strict preventsyield\n    at eval (eval:1) preventsyield\nL4  wholeLine:    at eval (eval:1\nL4  JavaScript-&gt;clearDialog()  (None)\nL4  JavaScript-&gt;clearAlert()  (None)\nL4  JavaScript-&gt;wrapUp() destroying ctx\nL0  ------------------ Console JavaScript wrapped up\n</code></pre></div>",
        "id": 428319558,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711110620
    },
    {
        "content": "<p>Yes the trace shows it is pushing the error object.<br>\nPlease try the following</p>\n<ol>\n<li>in throw error, comment out the throw at line 993</li>\n<li>paste a copy of the throw into jstest after the call to throw_error.  File JSextensions.cpp after line 1016.</li>\n<li>Test with JS_throw_test(0,0);</li>\n</ol>\n<p>With this, the only difference between JS_throw_test(1,1) which is OK and JS_throw_test(0,0) which crashes is how the error object it pushed on (and the error code it uses).</p>",
        "id": 428320863,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711111061
    },
    {
        "content": "<p>No crash.</p>\n<div class=\"codehilite\"><pre><span></span><code>L4  setConsoleMinClientSize text JavaScript, size X:52 Y: 15\nL4  Constructed console JavaScript size x 816 y 949  minSize x 134 y 39\nL0  ------------------ Console JavaScript about to run\nL4  JavaScript-&gt;throw_error() the arguments are both zero - throw_error\nL4  JavaScript-&gt;throw_error() pushing error object to stack\nL4  JavaScript-&gt;afterwards() with dukOutcome 1 and status now (no status)\nL4  JavaScript-&gt;run() completed with outcome 0\nL4  JavaScript-&gt;wrapUpWorks() with status 0 and now HAD_ERROR\nDuktape context dump:\nctx: top=1, stack=[{}]\n\nL4  No brief\n\nL4  wrapUpWorks with error stack:Duktape context dump:\nctx: top=1, stack=[{}]\n\nL4  Call stack: TypeError: Console JavaScript - the arguments are both zero - throw_error\n    at [anon] (D:\\Documents\\Github\\JavaScript_pi\\src\\JavaScriptgui_impl.h:1107) internal\n    at [anon] () native strict preventsyield\n    at eval (eval:1) preventsyield\nL4  wholeLine:    at eval (eval:1\nL4  JavaScript-&gt;clearDialog()  (None)\nL4  JavaScript-&gt;clearAlert()  (None)\nL4  JavaScript-&gt;wrapUp() destroying ctx\nL0  ------------------ Console JavaScript wrapped up\n</code></pre></div>\n<p>In output:<br>\n<code>line 1 TypeError: Console JavaScript - the arguments are both zero - throw_error</code></p>",
        "id": 428321916,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711111429
    },
    {
        "content": "<p>Hooray!  At last <span aria-label=\"smile\" class=\"emoji emoji-1f642\" role=\"img\" title=\"smile\">:smile:</span> <br>\nConclusion:  Windows cannot cope with throw within a method and probably a function when there is  a C++ call to be unwound.  Do you agree?</p>",
        "id": 428322284,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711111543
    },
    {
        "content": "<p>Agreed. Are there unintended consequences?</p>",
        "id": 428322502,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711111614
    },
    {
        "content": "<p>I need to rework all throws within the plugin.  Tedious but not difficult.  Will push an update version and advise.</p>",
        "id": 428322710,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711111694
    },
    {
        "content": "<p>Needed to change 95 instances like<br>\n<code>if (&lt;some condition) throw_error(ctx, \"the error message\");</code><br>\nto</p>\n<div class=\"codehilite\" data-code-language=\"JavaScript\"><pre><span></span><code><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"nx\">some</span><span class=\"w\"> </span><span class=\"nx\">condition</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"p\">{</span>\n<span class=\"w\">      </span><span class=\"nx\">prep_for_throw</span><span class=\"p\">(</span><span class=\"nx\">pConsole</span><span class=\"o\">-&gt;</span><span class=\"nx\">mpCtx</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s2\">\"the error message\"</span><span class=\"p\">);</span>\n<span class=\"w\">      </span><span class=\"k\">throw</span><span class=\"p\">(</span><span class=\"nx\">pConsole</span><span class=\"o\">-&gt;</span><span class=\"nx\">mpCtx</span><span class=\"p\">);</span>\n<span class=\"w\">  </span><span class=\"p\">}</span>\n</code></pre></div>\n<p>Build beta-m pushed to GitHub and build in my beta repo.</p>\n<p>I fear there could still be a problem with file name working.<br>\nPlease run the one-liner<br>\n<code>readTextFile(\"??\");</code><br>\nwhich will open a dialogue to choose the file to read.  If you cancel the dialogue, it throws an error from within a function - not a method.</p>\n<p>If all is well, please run the diagnostic suite.</p>",
        "id": 428362714,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711123443
    },
    {
        "content": "<p>Looking good. Only problem so far with Position/Waypoint/Route:</p>\n<div class=\"codehilite\"><pre><span></span><code>Reading back waypoint\n\nReading back updated waypoint\nConstructing fullwaypoint failed: Mark Test mark is at 51° 00.000&#39;N 011° 0.000&#39;E Mark Test mark is at 51\u0007 00.000&#39;N 011\u0007 0.000&#39;E\n\nWaypoint tests completed with error(s)\n\n*** Route tests ***\nReadback of route matched\nRetrieved route updated:\nRoute: Changed route name from: New from string to: New to string\n0 {&quot;position&quot;:{&quot;latitude&quot;:60,&quot;longitude&quot;:-1},&quot;GUID&quot;:&quot;43fcffff-7070-4c84-b850-dea3073f0000&quot;,&quot;markName&quot;:&quot;TestWP0&quot;,&quot;description&quot;:&quot;Description of WP0&quot;,&quot;creationDateTime&quot;:1711124287,&quot;isVisible&quot;:true,&quot;iconName&quot;:&quot;circle&quot;,&quot;hyperlinkList&quot;:[]}\n1 {&quot;position&quot;:{&quot;latitude&quot;:59.1,&quot;longitude&quot;:-0.10000000000000009},&quot;GUID&quot;:&quot;70ceffff-db8f-41a4-895d-04e45621ffff&quot;,&quot;markName&quot;:&quot;TestWP1&quot;,&quot;description&quot;:&quot;Description of WP1&quot;,&quot;creationDateTime&quot;:1711124287,&quot;isVisible&quot;:true,&quot;iconName&quot;:&quot;circle&quot;,&quot;hyperlinkList&quot;:[]}\n2 {&quot;position&quot;:{&quot;latitude&quot;:50,&quot;longitude&quot;:3},&quot;GUID&quot;:&quot;&quot;,&quot;markName&quot;:&quot;ReplacedMark&quot;,&quot;description&quot;:&quot;Replaced Description&quot;,&quot;creationDateTime&quot;:&quot;&quot;,&quot;isVisible&quot;:true,&quot;iconName&quot;:&quot;anchor&quot;,&quot;hyperlinkList&quot;:[]}\n3 {&quot;position&quot;:{&quot;latitude&quot;:60.3,&quot;longitude&quot;:-1.3},&quot;GUID&quot;:&quot;5c42ffff-2224-44b5-b1d0-8fd15b87ffff&quot;,&quot;markName&quot;:&quot;TestWP3&quot;,&quot;description&quot;:&quot;Description of WP3&quot;,&quot;creationDateTime&quot;:1711124287,&quot;isVisible&quot;:true,&quot;iconName&quot;:&quot;circle&quot;,&quot;hyperlinkList&quot;:[]}\n\nRoute tests completed OK\n\n*** Track tests ***\nTrack tests OK\nresult: Tests ran to completion\n</code></pre></div>",
        "id": 428365872,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711124394
    },
    {
        "content": "<p>Read text file:</p>\n<div class=\"codehilite\"><pre><span></span><code>This is line one\nThis is line two\nThis is line three\nThis is line four\nThis is line five\nThis is line six\nThis is line seven\nThis is line eight\nresult: Read local text file failed\n</code></pre></div>",
        "id": 428366241,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711124504
    },
    {
        "content": "<p>Only those 2. N2k not available.</p>",
        "id": 428368484,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711125126
    },
    {
        "content": "<p>Problem with waypoint is that test script had a fromCharCode() to generate a degree, which is now handled by our good work.  SO I have replaced that with a degree character, which should get handled correctly.  Here is an update for test file <code>02_PosWayRouteTests.js</code><br>\n<a href=\"/user_uploads/33951/d1Jl63GBWn08WpG987-k5qdA/02_PosWayRouteTests.js.zip\">02_PosWayRouteTests.js.zip</a></p>",
        "id": 428371443,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711126027
    },
    {
        "content": "<p>Read text file issue could  be because Windows file is slightly different.  Please run this and let me have the output</p>\n<div class=\"codehilite\" data-code-language=\"JavaScript\"><pre><span></span><code><span class=\"nx\">text</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nx\">readTextFile</span><span class=\"p\">(</span><span class=\"s2\">\"textFile.txt\"</span><span class=\"p\">);</span>\n<span class=\"nx\">print</span><span class=\"p\">(</span><span class=\"s2\">\"File length is \"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nx\">text</span><span class=\"p\">.</span><span class=\"nx\">length</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s2\">\" and file is\\n'\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nx\">text</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s2\">\"'\\n\"</span><span class=\"p\">);</span>\n</code></pre></div>",
        "id": 428371791,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711126129
    },
    {
        "content": "<blockquote>\n<p>N2k not available.</p>\n</blockquote>\n<p>Which was the test that gave you this and what was the output please?<br>\n(I can't find it right now.)</p>",
        "id": 428373972,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711126826
    },
    {
        "content": "<p>Bell symbol appears :</p>\n<div class=\"codehilite\"><pre><span></span><code>Present time: 1711128833\nJavaScript plugin v3.0 Patch 0 Beta m\n\n*** Position tests ***\nLatest fix was at 2024-03-22 17:33:53.371+00:00\nPosition 59\u0007 42.996&#39;N 072\u0007 21.852&#39;W\nPresent navigational information not available\nPosition tests completed OK\n\n*** Waypoint tests ***\n43 existing waypoints\nNo active waypoint\n\nReading back waypoint\n\nReading back updated waypoint\nWaypoint tests completed OK\n\n*** Route tests ***\nReadback of route matched\nRetrieved route updated:\nRoute: Changed route name from: New from string to: New to string\n0 {&quot;position&quot;:{&quot;latitude&quot;:60,&quot;longitude&quot;:-1},&quot;GUID&quot;:&quot;5f21ffff-e639-476e-b008-a125391b0000&quot;,&quot;markName&quot;:&quot;TestWP0&quot;,&quot;description&quot;:&quot;Description of WP0&quot;,&quot;creationDateTime&quot;:1711128833,&quot;isVisible&quot;:true,&quot;iconName&quot;:&quot;circle&quot;,&quot;hyperlinkList&quot;:[]}\n1 {&quot;position&quot;:{&quot;latitude&quot;:59.1,&quot;longitude&quot;:-0.10000000000000009},&quot;GUID&quot;:&quot;3afd0000-9c35-41c6-8224-bb015f63ffff&quot;,&quot;markName&quot;:&quot;TestWP1&quot;,&quot;description&quot;:&quot;Description of WP1&quot;,&quot;creationDateTime&quot;:1711128833,&quot;isVisible&quot;:true,&quot;iconName&quot;:&quot;circle&quot;,&quot;hyperlinkList&quot;:[]}\n2 {&quot;position&quot;:{&quot;latitude&quot;:50,&quot;longitude&quot;:3},&quot;GUID&quot;:&quot;&quot;,&quot;markName&quot;:&quot;ReplacedMark&quot;,&quot;description&quot;:&quot;Replaced Description&quot;,&quot;creationDateTime&quot;:&quot;&quot;,&quot;isVisible&quot;:true,&quot;iconName&quot;:&quot;anchor&quot;,&quot;hyperlinkList&quot;:[]}\n3 {&quot;position&quot;:{&quot;latitude&quot;:60.3,&quot;longitude&quot;:-1.3},&quot;GUID&quot;:&quot;2b250000-941f-4e3c-a31e-2fdc38270000&quot;,&quot;markName&quot;:&quot;TestWP3&quot;,&quot;description&quot;:&quot;Description of WP3&quot;,&quot;creationDateTime&quot;:1711128833,&quot;isVisible&quot;:true,&quot;iconName&quot;:&quot;circle&quot;,&quot;hyperlinkList&quot;:[]}\n\nRoute tests completed OK\n\n*** Track tests ***\nTrack tests OK\nresult: Tests ran to completion\n</code></pre></div>\n<div class=\"codehilite\"><pre><span></span><code>L0  ------------------ Console PluginTests about to run\nL4  PluginTests-&gt;prep_for_throw() OCPNGetSingleWaypoint called with non-existant GUID abc\nL4  PluginTests-&gt;prep_for_throw() pushing error object to stack\nL4  PluginTests-&gt;prep_for_throw() OCPNdeleteRoute called with non-existant GUID aaa\nL4  PluginTests-&gt;prep_for_throw() pushing error object to stack\nL4  PluginTests-&gt;prep_for_throw() OCPNgetRoute called with non-existant GUID 4871ffff-5c2a-47ec-a4d2-88e74aa7ffff\nL4  PluginTests-&gt;prep_for_throw() pushing error object to stack\nL4  PluginTests-&gt;prep_for_throw() OCPNdeleteTrack called with non-existant GUID aaa\nL4  PluginTests-&gt;prep_for_throw() pushing error object to stack\nL4  PluginTests-&gt;prep_for_throw() OCPNdeleteTrack called with non-existant GUID [object Object]\nL4  PluginTests-&gt;prep_for_throw() pushing error object to stack\nL4  PluginTests-&gt;afterwards() with dukOutcome 0 and status now (no status)\nL4  PluginTests-&gt;run() completed with outcome 2\nL4  PluginTests-&gt;wrapUpWorks() with status 2 and now DONE\nDuktape context dump:\nctx: top=0, stack=[]\n\nL4  No brief\n\nL4  PluginTests-&gt;clearDialog()  (None)\nL4  PluginTests-&gt;clearAlert()  (None)\nL4  PluginTests-&gt;wrapUp() will save _remember\nL4  PluginTests-&gt;wrapUp() destroying ctx\nL0  ------------------ Console PluginTests wrapped up\n</code></pre></div>",
        "id": 428380004,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711129006
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>File length is 150 and file is\n&#39;This is line one\nThis is line two\nThis is line three\nThis is line four\nThis is line five\nThis is line six\nThis is line seven\nThis is line eight&#39;\nresult: undefined\n</code></pre></div>",
        "id": 428380353,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711129120
    },
    {
        "content": "<p>N2k inn 110_n2k_encode_decode.js<br>\n<code>line 78 TypeError: [object Error] not callable</code></p>\n<div class=\"codehilite\"><pre><span></span><code>L0  ------------------ Console PluginTests about to run\nL4  PluginTests-&gt;prep_for_throw() SyntaxError: parse error (line 1, end of input)\nL4  PluginTests-&gt;prep_for_throw() pushing error object to stack\nL4  PluginTests-&gt;afterwards() with dukOutcome 1 and status now (no status)\nL4  PluginTests-&gt;run() completed with outcome 0\nL4  PluginTests-&gt;wrapUpWorks() with status 0 and now HAD_ERROR\nDuktape context dump:\nctx: top=1, stack=[{}]\n\nL4  No brief\n\nL4  wrapUpWorks with error stack:Duktape context dump:\nctx: top=1, stack=[{}]\n\nL4  Call stack: TypeError: [object Error] not callable\n    at [anon] (duk_js_call.c:1349) internal\n    at NMEA2000 (C:\\Users\\rasba\\AppData\\Local\\opencpn\\plugins\\JavaScript_pi\\data\\scripts\\NMEA2000.js:29) construct\n    at eval (eval:78) preventsyield\nL4  wholeLine:    at eval (eval:78\nL4  PluginTests-&gt;clearDialog()  (None)\nL4  PluginTests-&gt;clearAlert()  (None)\nL4  PluginTests-&gt;wrapUp() destroying ctx\nL0  ------------------ Console PluginTests wrapped up\n</code></pre></div>",
        "id": 428380825,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711129290
    },
    {
        "content": "<p>Had to reinstall OpenCPN 02_PosWayRouteTests.js is OK. No bel.</p>",
        "id": 428384153,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711130530
    },
    {
        "content": "<p><strong>Problem with readTextFile</strong><br>\nThe test just compares the file text with a JavaScript string.  Bu the character count from the read file is 150 whereas for me it is 143.  Looks like Windows has both a CR &amp; LF as new line, whereas MacOS &amp; Unix/linux has just \\n.<br>\nPlease run this and let me have the output</p>\n<div class=\"codehilite\" data-code-language=\"JavaScript\"><pre><span></span><code><span class=\"nx\">text</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nx\">readTextFile</span><span class=\"p\">(</span><span class=\"s2\">\"textFile.txt\"</span><span class=\"p\">);</span>\n<span class=\"k\">for</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"nx\">i</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"mf\">0</span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"nx\">i</span><span class=\"w\"> </span><span class=\"o\">&lt;</span><span class=\"w\"> </span><span class=\"nx\">text</span><span class=\"p\">.</span><span class=\"nx\">length</span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"nx\">i</span><span class=\"o\">++</span><span class=\"p\">)</span><span class=\"nx\">print</span><span class=\"p\">(</span><span class=\"nx\">text</span><span class=\"p\">.</span><span class=\"nx\">charAt</span><span class=\"p\">(</span><span class=\"nx\">i</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"s2\">\"\\t\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nx\">text</span><span class=\"p\">.</span><span class=\"nx\">charCodeAt</span><span class=\"p\">(</span><span class=\"nx\">i</span><span class=\"p\">).</span><span class=\"nx\">toString</span><span class=\"p\">(</span><span class=\"mf\">16</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"s2\">\"\\n\"</span><span class=\"p\">);</span>\n</code></pre></div>",
        "id": 428384807,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711130752
    },
    {
        "content": "<p>Re problems with constructor not callable, I REALLY REALLY hope that this is not the case.  Please run the following and report:</p>\n<div class=\"codehilite\" data-code-language=\"JavaScript\"><pre><span></span><code><span class=\"nx\">Position</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nx\">require</span><span class=\"p\">(</span><span class=\"s2\">\"Position\"</span><span class=\"p\">);</span>\n<span class=\"nx\">posA</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"ow\">new</span><span class=\"w\"> </span><span class=\"nx\">Position</span><span class=\"p\">;</span>\n<span class=\"nx\">posB</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"ow\">new</span><span class=\"w\"> </span><span class=\"nx\">Position</span><span class=\"p\">(</span><span class=\"mf\">60</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"mf\">1</span><span class=\"p\">);</span>\n<span class=\"nx\">print</span><span class=\"p\">(</span><span class=\"nx\">posB</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s2\">\"\\n\"</span><span class=\"p\">);</span>\n</code></pre></div>",
        "id": 428385474,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711131007
    },
    {
        "content": "<p>Supper calls</p>",
        "id": 428385491,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711131018
    },
    {
        "content": "<p>The file:</p>\n<div class=\"codehilite\"><pre><span></span><code>Tracing levels 4 - 4\nT   54\nh   68\ni   69\ns   73\n    20\ni   69\ns   73\n    20\nl   6c\ni   69\nn   6e\ne   65\n    20\no   6f\nn   6e\ne   65\n\n    d\n\n    a\nT   54\nh   68\ni   69\ns   73\n    20\ni   69\ns   73\n    20\nl   6c\ni   69\nn   6e\ne   65\n    20\nt   74\nw   77\no   6f\n\n    d\n\n    a\nT   54\nh   68\ni   69\ns   73\n    20\ni   69\ns   73\n    20\nl   6c\ni   69\nn   6e\ne   65\n    20\nt   74\nh   68\nr   72\ne   65\ne   65\n\n    d\n\n    a\nT   54\nh   68\ni   69\ns   73\n    20\ni   69\ns   73\n    20\nl   6c\ni   69\nn   6e\ne   65\n    20\nf   66\no   6f\nu   75\nr   72\n\n    d\n\n    a\nT   54\nh   68\ni   69\ns   73\n    20\ni   69\ns   73\n    20\nl   6c\ni   69\nn   6e\ne   65\n    20\nf   66\ni   69\nv   76\ne   65\n\n    d\n\n    a\nT   54\nh   68\ni   69\ns   73\n    20\ni   69\ns   73\n    20\nl   6c\ni   69\nn   6e\ne   65\n    20\ns   73\ni   69\nx   78\n\n    d\n\n    a\nT   54\nh   68\ni   69\ns   73\n    20\ni   69\ns   73\n    20\nl   6c\ni   69\nn   6e\ne   65\n    20\ns   73\ne   65\nv   76\ne   65\nn   6e\n\n    d\n\n    a\nT   54\nh   68\ni   69\ns   73\n    20\ni   69\ns   73\n    20\nl   6c\ni   69\nn   6e\ne   65\n    20\ne   65\ni   69\ng   67\nh   68\nt   74\nresult: undefined\n</code></pre></div>\n<div class=\"codehilite\"><pre><span></span><code>L4  setConsoleMinClientSize text JavaScript, size X:52 Y: 15\nL4  Constructed console JavaScript size x 738 y 881  minSize x 134 y 39\nL0  ------------------ Console JavaScript about to run\nL4  JavaScript-&gt;afterwards() with dukOutcome 0 and status now (no status)\nL4  JavaScript-&gt;run() completed with outcome 2\nL4  JavaScript-&gt;wrapUpWorks() with status 2 and now DONE\nDuktape context dump:\nctx: top=0, stack=[]\n\nL4  No brief\n\nL4  JavaScript-&gt;clearDialog()  (None)\nL4  JavaScript-&gt;clearAlert()  (None)\nL4  JavaScript-&gt;wrapUp() will save _remember\nL4  JavaScript-&gt;wrapUp() destroying ctx\nL0  ------------------ Console JavaScript wrapped up\n</code></pre></div>",
        "id": 429063386,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711183921
    },
    {
        "content": "<p>The position:</p>\n<div class=\"codehilite\"><pre><span></span><code>{&quot;latitude&quot;:60,&quot;longitude&quot;:1}\nresult: undefined\n</code></pre></div>\n<div class=\"codehilite\"><pre><span></span><code>L0  ------------------ Console JavaScript about to run\nL4  JavaScript-&gt;afterwards() with dukOutcome 0 and status now (no status)\nL4  JavaScript-&gt;run() completed with outcome 2\nL4  JavaScript-&gt;wrapUpWorks() with status 2 and now DONE\nDuktape context dump:\nctx: top=0, stack=[]\n\nL4  No brief\n\nL4  JavaScript-&gt;clearDialog()  (None)\nL4  JavaScript-&gt;clearAlert()  (None)\nL4  JavaScript-&gt;wrapUp() will save _remember\nL4  JavaScript-&gt;wrapUp() destroying ctx\nL0  ------------------ Console JavaScript wrapped up\n</code></pre></div>",
        "id": 429063497,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711184039
    },
    {
        "content": "<p>Thanks.  Re text file, I need to drop Window's CR on all text file read ops.  Update to follow.</p>",
        "id": 429063668,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711184211
    },
    {
        "content": "<p>Re problem with NK, please run following and report (Do not need trace).</p>\n<div class=\"codehilite\" data-code-language=\"JavaScript\"><pre><span></span><code><span class=\"nx\">descriptor</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nx\">require</span><span class=\"p\">(</span><span class=\"s2\">\"pgnDescriptors\"</span><span class=\"p\">)(</span><span class=\"mf\">126992</span><span class=\"p\">);</span>\n<span class=\"nx\">print</span><span class=\"p\">(</span><span class=\"nx\">descriptor</span><span class=\"p\">.</span><span class=\"nx\">Id</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s2\">\"\\n\"</span><span class=\"p\">);</span>\n</code></pre></div>\n<p>PS Will be on conference call for an ahour or so on non-marine matters from 10:00</p>",
        "id": 429065024,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711185619
    },
    {
        "content": "<p>If the above fails to print <code>systemTime</code>, please try this alternative:</p>\n<div class=\"codehilite\" data-code-language=\"JavaScript\"><pre><span></span><code><span class=\"nx\">descriptor</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"nx\">require</span><span class=\"p\">(</span><span class=\"s2\">\"pgnDescriptors\"</span><span class=\"p\">))(</span><span class=\"mf\">126992</span><span class=\"p\">);</span>\n<span class=\"nx\">print</span><span class=\"p\">(</span><span class=\"nx\">descriptor</span><span class=\"p\">.</span><span class=\"nx\">Id</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s2\">\"\\n\"</span><span class=\"p\">);</span>\n</code></pre></div>",
        "id": 429066288,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711186902
    },
    {
        "content": "<p>Neither message works for me:<br>\n<code>TypeError: [object Error] not callable</code></p>",
        "id": 429069369,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711189899
    },
    {
        "content": "<p>Please try this:</p>\n<div class=\"codehilite\" data-code-language=\"JavaScript\"><pre><span></span><code><span class=\"nx\">Descriptor</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nx\">require</span><span class=\"p\">(</span><span class=\"s2\">\"pgnDescriptors\"</span><span class=\"p\">);</span>\n<span class=\"nx\">st</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"ow\">new</span><span class=\"w\"> </span><span class=\"nx\">Descriptor</span><span class=\"p\">(</span><span class=\"mf\">126992</span><span class=\"p\">);</span>\n<span class=\"nx\">print</span><span class=\"p\">(</span><span class=\"nx\">st</span><span class=\"p\">.</span><span class=\"nx\">Id</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s2\">\"\\n\"</span><span class=\"p\">);</span>\n</code></pre></div>",
        "id": 429073314,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711193683
    },
    {
        "content": "<p>and this one:</p>\n<div class=\"codehilite\" data-code-language=\"JavaScript\"><pre><span></span><code><span class=\"nx\">st</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"ow\">new</span><span class=\"w\"> </span><span class=\"nx\">require</span><span class=\"p\">(</span><span class=\"s2\">\"pgnDescriptors\"</span><span class=\"p\">)(</span><span class=\"mf\">126992</span><span class=\"p\">);</span>\n<span class=\"nx\">print</span><span class=\"p\">(</span><span class=\"nx\">st</span><span class=\"p\">.</span><span class=\"nx\">Id</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s2\">\"\\n\"</span><span class=\"p\">);</span>\n</code></pre></div>",
        "id": 429075129,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711195441
    },
    {
        "content": "<p><a href=\"https://github.com/opencpn/OpenCPN/issues/1\">#1</a> TypeError: [object Error] not constructable<br>\n<a href=\"https://github.com/opencpn/OpenCPN/issues/2\">#2</a> TypeError: [object Error] not callable</p>",
        "id": 429075362,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711195643
    },
    {
        "content": "<p>Now this, please:</p>\n<div class=\"codehilite\" data-code-language=\"JavaScript\"><pre><span></span><code><span class=\"nx\">pgnDescriptors</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nx\">require</span><span class=\"p\">(</span><span class=\"s2\">\"pgnDescriptors\"</span><span class=\"p\">);</span>\n<span class=\"nx\">print</span><span class=\"p\">(</span><span class=\"s2\">\"A\\t\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"ow\">typeof</span><span class=\"w\"> </span><span class=\"nx\">pgnDescriptors</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s2\">\"\\n\"</span><span class=\"p\">);</span>\n<span class=\"nx\">stDescriptor</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nx\">pgnDescriptors</span><span class=\"p\">(</span><span class=\"mf\">126992</span><span class=\"p\">);</span>\n<span class=\"nx\">print</span><span class=\"p\">(</span><span class=\"s2\">\"B\\t\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"ow\">typeof</span><span class=\"w\"> </span><span class=\"nx\">stDescriptor</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s2\">\"\\n\"</span><span class=\"p\">);</span>\n<span class=\"nx\">print</span><span class=\"p\">(</span><span class=\"s2\">\"C\\t\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nx\">stDescriptor</span><span class=\"p\">.</span><span class=\"nx\">Id</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s2\">\"\\n\"</span><span class=\"p\">);</span>\n</code></pre></div>",
        "id": 429077314,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711197398
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>A   object\nTypeError: [object Error] not callable\n</code></pre></div>",
        "id": 429077457,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711197512
    },
    {
        "content": "<p>Oh... on MacOS,  I get<br>\n`A      function<br>\nNeed to think about this.</p>",
        "id": 429077726,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711197701
    },
    {
        "content": "<p>Now this, please:</p>\n<div class=\"codehilite\" data-code-language=\"JavaScript\"><pre><span></span><code><span class=\"nx\">Position</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nx\">require</span><span class=\"p\">(</span><span class=\"s2\">\"Position\"</span><span class=\"p\">);</span>\n<span class=\"nx\">print</span><span class=\"p\">(</span><span class=\"s2\">\"X\\t\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"ow\">typeof</span><span class=\"w\"> </span><span class=\"nx\">Position</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s2\">\"\\n\"</span><span class=\"p\">);</span>\n</code></pre></div>",
        "id": 429079711,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711199463
    },
    {
        "content": "<p>To address the text compare issue on Windows, I am now cleaning \\r\\n to \\n.<br>\nHopefully this will fix the read text file issues.</p>\n<p>I cannot understand why on Windows <code>require(\"pgnDescriptors\")</code>is compiling to an object, but onMacOS to a function, which is correct.  Grasping at staws here, but the only difference I can presently see between this and other files that compile to a function is that pgnDescriptors has a comment block in front of the start of the function.  Possibly Duktape is seeing it does not start with <code>function</code> and discounting it as a function.  So I have moved the comment block inside the function body.</p>\n<p>beta-p pushed to GitHub and build to beta repo 23 Mar 15:12</p>\n<p>Please run  tests affected by CR LF</p>\n<ol>\n<li>Read text file</li>\n<li>Read remote text file</li>\n<li>Files object</li>\n</ol>\n<p>Also please run</p>\n<div class=\"codehilite\" data-code-language=\"JavaScript\"><pre><span></span><code><span class=\"nx\">Position</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nx\">require</span><span class=\"p\">(</span><span class=\"s2\">\"Position\"</span><span class=\"p\">);</span>\n<span class=\"nx\">print</span><span class=\"p\">(</span><span class=\"s2\">\"X\\t\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"ow\">typeof</span><span class=\"w\"> </span><span class=\"nx\">Position</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s2\">\"\\n\"</span><span class=\"p\">);</span>\n\n<span class=\"nx\">pgnDescriptors</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nx\">require</span><span class=\"p\">(</span><span class=\"s2\">\"pgnDescriptors\"</span><span class=\"p\">);</span>\n<span class=\"nx\">print</span><span class=\"p\">(</span><span class=\"s2\">\"A\\t\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"ow\">typeof</span><span class=\"w\"> </span><span class=\"nx\">pgnDescriptors</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s2\">\"\\n\"</span><span class=\"p\">);</span>\n<span class=\"nx\">stDescriptor</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nx\">pgnDescriptors</span><span class=\"p\">(</span><span class=\"mf\">126992</span><span class=\"p\">);</span>\n<span class=\"nx\">print</span><span class=\"p\">(</span><span class=\"s2\">\"B\\t\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"ow\">typeof</span><span class=\"w\"> </span><span class=\"nx\">stDescriptor</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s2\">\"\\n\"</span><span class=\"p\">);</span>\n<span class=\"nx\">print</span><span class=\"p\">(</span><span class=\"s2\">\"C\\t\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nx\">stDescriptor</span><span class=\"p\">.</span><span class=\"nx\">Id</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s2\">\"\\n\"</span><span class=\"p\">);</span>\n</code></pre></div>",
        "id": 429089493,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711207368
    },
    {
        "content": "<p>(deleted)</p>",
        "id": 429089618,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711207471
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>X   function\nresult: undefined\n</code></pre></div>\n<p>And the second:</p>\n<p><code>line 1 Error: Console JavaScript - SyntaxError: parse error (line 1, end of input)</code></p>",
        "id": 429090230,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711208036
    },
    {
        "content": "<p>Read text file</p>\n<div class=\"codehilite\"><pre><span></span><code>This is line one\nThis is line two\nThis is line three\nThis is line four\nThis is line five\nThis is line six\nThis is line seven\nThis is line eight\nresult: Read local text file matched\n</code></pre></div>\n<p>Read remote text file<br>\n<code>result: Read remote text file matched</code></p>\n<p>Files object</p>\n<div class=\"codehilite\"><pre><span></span><code>{&quot;id&quot;:10877,&quot;fileString&quot;:&quot;D:\\\\Documents\\\\Github\\\\JavaScript_pi\\\\Tests_scripts\\\\00_main.js&quot;}\ngetAllText and getTextLine testSeek to start gives: 0\nSeek to midway gives: 5123\nEof at midway gives: false\nTell gives: 5123\nSeek to end gives: 11204\nEof at end gives: true\nWrite test\nAppend test\nUpdate test\nByte test\nresult: Files OK\n</code></pre></div>",
        "id": 429090667,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711208349
    },
    {
        "content": "<p>All good on files.<br>\nSo the one liner<br>\n<code>pgnDescriptors = require(\"pgnDescriptors\");</code><br>\ngets a parse error end of input ?</p>",
        "id": 429090796,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711208477
    },
    {
        "content": "<p>Double check:<br>\n<code>line 1 Error: Console PluginTests - SyntaxError: parse error (line 1, end of input)</code></p>",
        "id": 429091227,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711208797
    },
    {
        "content": "<p>Cannot see anything wrong with js.<br>\nPlease run the above test with TRACE level max &amp; min set to 45.</p>",
        "id": 429091477,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711208993
    },
    {
        "content": "<p>JSExtensions.js. after line 473<br>\n<code> pConsole-&gt;prep_for_throw(ctx, \"require - \" + fileNameGiven + \" not in built-in scripts\");</code><br>\nadd missing line<br>\n<code>               duk_throw(ctx);</code><br>\nMissed when I did all those edits yesterday.<br>\nWould only explain problem if  file not being found.</p>",
        "id": 429092253,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711209518
    },
    {
        "content": "<p>Without edit:</p>\n<div class=\"codehilite\"><pre><span></span><code>L0  ------------------ Console PluginTests about to run\nL0  ------------------ Console PluginTests wrapped up\nL0  ------------------ Console PluginTests about to run\nL45 Require - fileGivenName: pgnDescriptors\nL45 Require - looking for built-in script\nL45 Require - looking to load built-in script: C:\\Users\\rasba\\AppData\\Local\\opencpn\\plugins\\JavaScript_pi\\data\\scripts\\pgnDescriptors.js\nL45 Require - found built-in script\nL45 Require - resolved to: C:\\Users\\rasba\\AppData\\Local\\opencpn\\plugins\\JavaScript_pi\\data\\scripts\\pgnDescriptors.js\nL0  ------------------ Console PluginTests wrapped up\n</code></pre></div>",
        "id": 429092543,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711209723
    },
    {
        "content": "<p>With edit:<br>\n<code>line 1 TypeError: invalid args</code></p>\n<div class=\"codehilite\"><pre><span></span><code>L0  ------------------ Console PluginTests about to run\nL45 Require - fileGivenName: pgnDescriptors\nL45 Require - looking for built-in script\nL45 Require - looking to load built-in script: C:\\Users\\rasba\\AppData\\Local\\opencpn\\plugins\\JavaScript_pi\\data\\scripts\\pgnDescriptors.js\nL0  ------------------ Console PluginTests wrapped up\n</code></pre></div>",
        "id": 429092849,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711209985
    },
    {
        "content": "<p>So if the condition at line 472 is true, without the edit it was falling through and trying to read non file - hence 'end of file message'<br>\nBut file string looks OK?  So why would the condition be true.<br>\nNow with edit, why are we not seeing the error from line 473?<br>\nLooks like it is not throwing and trying to compile and failing.</p>\n<p>Tea break!</p>",
        "id": 429093709,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711210691
    },
    {
        "content": "<p>Not checking for read error when reading the file.<br>\nAfter now line 490<br>\n<code>    outcome = getTextFile(resolved, &amp;script);</code><br>\ninsert</p>\n<div class=\"codehilite\" data-code-language=\"JavaScript\"><pre><span></span><code><span class=\"w\">    </span><span class=\"k\">if</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"nx\">outcome</span><span class=\"w\"> </span><span class=\"o\">!=</span><span class=\"w\"> </span><span class=\"nx\">wxEmptyString</span><span class=\"p\">){</span>\n<span class=\"w\">        </span><span class=\"nx\">pConsole</span><span class=\"o\">-&gt;</span><span class=\"nx\">prep_for_throw</span><span class=\"p\">(</span><span class=\"nx\">ctx</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s2\">\"require readTextFile error: \"</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"nx\">outcome</span><span class=\"p\">);</span>\n<span class=\"w\">        </span><span class=\"nx\">duk_throw</span><span class=\"p\">(</span><span class=\"nx\">ctx</span><span class=\"p\">);</span>\n<span class=\"w\">        </span><span class=\"p\">}</span>\n</code></pre></div>\n<p>With this added, please try<br>\n<code>pgnDescriptors = require(\"pgnDescriptors\");</code> again.</p>\n<p>Another thought... this file is large.  Possibly getting a buffer overrun so if the above does not reveal the problem, I have other tacks to try.</p>",
        "id": 429096364,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711212848
    },
    {
        "content": "<p>Another thing to try...</p>\n<p>In a spare console, load the descriptors function into the script pane using the Load button.  Browse to the file which is at <code>C:\\Users\\rasba\\AppData\\Local\\opencpn\\plugins\\JavaScript_pi\\data\\scripts\\pgnDescriptors.js</code></p>\n<p>Run this.  It should compile and with just Result: undefined as output.</p>\n<p>Keep this extra console around for further testing.</p>",
        "id": 429168318,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711266766
    },
    {
        "content": "<blockquote>\n<p>With this added, please try</p>\n</blockquote>\n<p><code>line 1 TypeError: invalid args</code></p>\n<blockquote>\n<p>With this added, please try</p>\n</blockquote>\n<p><code>line 75 TypeError: invalid args</code></p>\n<p><a href=\"/user_uploads/33951/-53CvygOVWwIs0sN7jdzM9Yb/12.jpg\">12.jpg</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/33951/-53CvygOVWwIs0sN7jdzM9Yb/12.jpg\" title=\"12.jpg\"><img src=\"/user_uploads/33951/-53CvygOVWwIs0sN7jdzM9Yb/12.jpg\"></a></div><p>Is this the right way round?</p>\n<p>Boating again today.</p>",
        "id": 429170613,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711268409
    },
    {
        "content": "<p><a href=\"https://meet.jit.si/570087640978805#config.startWithVideoMuted=true\">Join voice call.</a></p>",
        "id": 429170855,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711268604
    },
    {
        "content": "<p>Can we spek before you go off?  TRy joining call.</p>",
        "id": 429171225,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711268775
    },
    {
        "content": "<p>Sorry ... missed this. Is 1000 tomorrow any good.</p>",
        "id": 429247965,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711314347
    },
    {
        "content": "<p>Fine. 10:00am.</p>",
        "id": 429248087,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711314438
    },
    {
        "content": "<p>line 1 Error: Console PluginTests - require readTextFile error: readTextFile D:\\Documents\\Github\\JavaScript_pi\\Tests_scripts\\DocumentsMy OpenCPN bugsJavaScript_pipgnDescriptors.js not found</p>",
        "id": 429348495,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711363091
    },
    {
        "content": "<p>D:\\Documents\\Github\\JavaScript_pi\\Tests_scripts\\DocumentspgnDescriptors.js not found</p>",
        "id": 429349178,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711363276
    },
    {
        "content": "<p>result: function getDescriptor() { [ecmascript code] }</p>",
        "id": 429350594,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711363661
    },
    {
        "content": "<p>L45 Require - fileGivenName: ??<br>\nL45 Require - hunting for script<br>\nL45 Require - resolved to: C:\\Users\\rasba\\AppData\\Local\\opencpn\\plugins\\JavaScript_pi\\data\\scripts\\pgnDescriptors.js<br>\nL0  ------------------ Console PluginTests wrapped up</p>",
        "id": 429352667,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711364187
    },
    {
        "content": "<p>L101    resolveFileName mode 0 toPrompt 0 prompt <br>\nL101    resolveFileName fullPath:C:\\Documents\\Github\\JavaScript_pi\\Tests_scripts\\Users<br>\nasbaAppDataLocalopencpnpluginsJavaScript_pidatascriptspgnDescriptors.js<br>\nL0  ------------------ Console PluginTests wrapped up</p>",
        "id": 429354986,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711364782
    },
    {
        "content": "<p>To simplify testing of the resolveFileName code, you can use just this simple js to invoke it:</p>\n<div class=\"codehilite\" data-code-language=\"JavaScript\"><pre><span></span><code><span class=\"nx\">getFileString</span><span class=\"p\">(</span><span class=\"s2\">\"??\"</span><span class=\"p\">);</span>\n</code></pre></div>\n<p>Or put whattever you want in the \"  \"</p>",
        "id": 429370234,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711368103
    },
    {
        "content": "<p>Just pushed beta-q to GitHub and beta repo.<br>\n(1) Trace window now belongs to plugin and gets deleted on plugin deinit<br>\n(2) readTextFile now preallocates a buffer for the data.  Hopefully, it will cope with the large file.<br>\nPlease try with this test script:</p>\n<div class=\"codehilite\" data-code-language=\"JavaScript\"><pre><span></span><code><span class=\"nx\">desc</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nx\">require</span><span class=\"p\">(</span><span class=\"s2\">\"pgnDescriptors\"</span><span class=\"p\">);</span>\n<span class=\"nx\">desc</span><span class=\"p\">(</span><span class=\"mf\">126992</span><span class=\"p\">).</span><span class=\"nx\">Id</span><span class=\"p\">;</span>\n</code></pre></div>\n<p>Expected output:</p>\n<blockquote>\n<p>result: systemTime</p>\n</blockquote>\n<p>This should work without first needing to resolve the missing \\\\ you are looking  into as it loads from the built-in scripts.  SO you can just load from my beta repo.<br>\nIf there is still a problem, you can turn on TRACE at level 64 to see how big it  things the file is.</p>",
        "id": 429401980,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711373166
    },
    {
        "content": "<p><a href=\"/user_uploads/33951/dwFl_wBLNDlFGKjQKxEMwsKA/13.jpg\">13.jpg</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/33951/dwFl_wBLNDlFGKjQKxEMwsKA/13.jpg\" title=\"13.jpg\"><img src=\"/user_uploads/33951/dwFl_wBLNDlFGKjQKxEMwsKA/13.jpg\"></a></div>",
        "id": 429430335,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711378825
    },
    {
        "content": "<p>My pre-allocation of buffer space is working OK.  I have run that test line 4,400 times in a loop OK so the space is getting relased OK.<br>\nThe trace shows the file is tge right size (allowing for Windws adding CR before each LF.</p>\n<p>Please load  and run this all-in-one test:<br>\n<a href=\"/user_uploads/33951/LY1N8-UuYFMqN23fAaOTCKes/getDescriptor_test.js.zip\">getDescriptor_test.js.zip</a></p>",
        "id": 429441116,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711380965
    },
    {
        "content": "<p>result: undefined</p>",
        "id": 429441658,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711381083
    },
    {
        "content": "<p>Did it print <code>systemTime</code> before the result?</p>",
        "id": 429442084,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711381155
    },
    {
        "content": "<p>No <code>systemTime</code> printed.</p>",
        "id": 429443324,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711381400
    },
    {
        "content": "<p><a href=\"#narrow/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing/near/429442084\">A message</a> was moved here from <a class=\"stream-topic\" data-stream-id=\"349785\" href=\"/#narrow/stream/349785-JavaScript_pi/topic/.28no.20topic.29\">#JavaScript_pi &gt; (no topic)</a> by <span class=\"user-mention silent\" data-user-id=\"554731\">Tony Voss</span>.</p>",
        "id": 429443340,
        "sender_full_name": "Notification Bot",
        "timestamp": 1711381402
    },
    {
        "content": "<p>2 messages were moved here from <a class=\"stream-topic\" data-stream-id=\"349785\" href=\"/#narrow/stream/349785-JavaScript_pi/topic/.28no.20topic.29\">#JavaScript_pi &gt; (no topic)</a> by <span class=\"user-mention silent\" data-user-id=\"554731\">Tony Voss</span>.</p>",
        "id": 429443566,
        "sender_full_name": "Notification Bot",
        "timestamp": 1711381446
    },
    {
        "content": "<p>And the script starts ?</p>\n<div class=\"codehilite\" data-code-language=\"JavaScript\"><pre><span></span><code><span class=\"nx\">print</span><span class=\"p\">(</span><span class=\"nx\">getDescriptor</span><span class=\"p\">(</span><span class=\"mf\">126992</span><span class=\"p\">).</span><span class=\"nx\">Id</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s2\">\"\\n\"</span><span class=\"p\">);</span>\n\n\n<span class=\"w\"> </span><span class=\"kd\">function</span><span class=\"w\"> </span><span class=\"nx\">getDescriptor</span><span class=\"p\">(</span><span class=\"nx\">pgn</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nx\">optionsArg</span><span class=\"p\">){</span>\n<span class=\"w\">    </span><span class=\"err\">/*</span>\n</code></pre></div>\n<p>Please replace the first line with</p>\n<div class=\"codehilite\" data-code-language=\"JavaScript\"><pre><span></span><code><span class=\"nx\">print</span><span class=\"p\">(</span><span class=\"s2\">\"Before call\\n\"</span><span class=\"p\">);</span>\n<span class=\"nx\">print</span><span class=\"p\">(</span><span class=\"nx\">getDescriptor</span><span class=\"p\">(</span><span class=\"mf\">126992</span><span class=\"p\">).</span><span class=\"nx\">Id</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s2\">\"\\n\"</span><span class=\"p\">);</span>\n<span class=\"nx\">print</span><span class=\"p\">(</span><span class=\"s2\">\"After call\\n\"</span><span class=\"p\">);</span>\n</code></pre></div>\n<p>and run again</p>",
        "id": 429444942,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711381645
    },
    {
        "content": "<p><a href=\"/user_uploads/33951/rnqc4NCSCrPiBiB-5usMM9aY/14.jpg\">14.jpg</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/33951/rnqc4NCSCrPiBiB-5usMM9aY/14.jpg\" title=\"14.jpg\"><img src=\"/user_uploads/33951/rnqc4NCSCrPiBiB-5usMM9aY/14.jpg\"></a></div>",
        "id": 429448457,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711382265
    },
    {
        "content": "<p>Very weird - not even printing the before statement!<br>\nTry commenting out line 2 so it does not call the function.</p>",
        "id": 429450070,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711382530
    },
    {
        "content": "<p>result: undefined</p>",
        "id": 429450728,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711382664
    },
    {
        "content": "<p>So the presence of the getDescriptor function means the print statements do not run and yet the script runs m enough to terminate with <code>result undefined</code> ?</p>",
        "id": 429451746,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711382878
    },
    {
        "content": "<p>Yes. With just the lines:</p>\n<div class=\"codehilite\"><pre><span></span><code>print(&quot;Before call\\n&quot;);\nprint(getDescriptor(126992).Id, &quot;\\n&quot;);\nprint(&quot;After call\\n&quot;);\n</code></pre></div>\n<p>The result is the correct print.</p>",
        "id": 429452531,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711383014
    },
    {
        "content": "<p>Let's speak.</p>",
        "id": 429453162,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711383144
    },
    {
        "content": "<p>OK.</p>",
        "id": 429453233,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711383162
    },
    {
        "content": "<p><a href=\"https://meet.jit.si/541554131652509#config.startWithVideoMuted=true\">Join voice call.</a></p>",
        "id": 429453292,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711383174
    },
    {
        "content": "<p><code>print(\"Middle '\", getDescriptor(126992).Id, \"'\\n\");</code></p>",
        "id": 429457349,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711384030
    },
    {
        "content": "<p>Pushed beta-r.<br>\nCleans umlauts on Windows only but I tested it on Mac</p>\n<blockquote>\n<p>[00]ü [01]  [02]ö <br>\nRaw<br>\nü ö<br>\n[00]FC [01]20 [02]F6 <br>\nCleaned<br>\nue oe<br>\n[00]75 [01]65 [02]20 [03]6F [04]65</p>\n</blockquote>\n<p>Reming.ote builds just complet</p>",
        "id": 429477406,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711389088
    },
    {
        "content": "<p>ReferenceError: identifier 'getDescriptor' undefined</p>",
        "id": 429480288,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711389948
    },
    {
        "content": "<p>Supper calls.<br>\nAre you testing with the all-in-one script with the print before, middle and after?</p>",
        "id": 429480730,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711390115
    },
    {
        "content": "<p>Was with one line. With all three:</p>\n<div class=\"codehilite\"><pre><span></span><code>Before call\nReferenceError: identifier &#39;getDescriptor&#39; undefined\n</code></pre></div>",
        "id": 429481027,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711390222
    },
    {
        "content": "<p>Where is getDescriptor?</p>",
        "id": 429481154,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711390265
    },
    {
        "content": "<p>Better speak tomorrow.   I will be available first thing.  Let me know when you available.</p>",
        "id": 429487192,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711392605
    },
    {
        "content": "<p>Is 1000 ok?</p>",
        "id": 429489421,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711393415
    },
    {
        "content": "<p>Sorry ... did not have the getDescriptor function in the console!!!</p>",
        "id": 429490918,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711393968
    },
    {
        "content": "<p>Just pushed latest beta-s and built. Let me know when you have tried it with the getDescriptor included and ready to talk.</p>",
        "id": 429620187,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711447454
    },
    {
        "content": "<p>Ok.</p>",
        "id": 429620279,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711447486
    },
    {
        "content": "<p><a href=\"https://meet.jit.si/810787084015076#config.startWithVideoMuted=true\">Join voice call.</a></p>",
        "id": 429620358,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711447509
    },
    {
        "content": "<p>Whoops - compile error in that - stand by</p>",
        "id": 429621186,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711447765
    },
    {
        "content": "<p>Fixed in Beta t - also building remotely now</p>",
        "id": 429621863,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711447989
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"JavaScript\"><pre><span></span><code><span class=\"nx\">getDescriptor</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nx\">require</span><span class=\"p\">(</span><span class=\"s2\">\"pgnDescriptors\"</span><span class=\"p\">);</span>\n\n<span class=\"nx\">print</span><span class=\"p\">(</span><span class=\"s2\">\"Before call\\n\"</span><span class=\"p\">);</span>\n<span class=\"nx\">print</span><span class=\"p\">(</span><span class=\"nx\">getDescriptor</span><span class=\"p\">(</span><span class=\"mf\">126992</span><span class=\"p\">).</span><span class=\"nx\">Id</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s2\">\"\\n\"</span><span class=\"p\">);</span>\n<span class=\"nx\">print</span><span class=\"p\">(</span><span class=\"s2\">\"After call\\n\"</span><span class=\"p\">);</span>\n</code></pre></div>",
        "id": 429623145,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711448448
    },
    {
        "content": "<div class=\"codehilite\" data-code-language=\"JavaScript\"><pre><span></span><code><span class=\"w\">            </span><span class=\"s2\">\"RangeMin\"</span><span class=\"o\">:</span><span class=\"mf\">0</span><span class=\"p\">,</span>\n<span class=\"w\">            </span><span class=\"s2\">\"RangeMax\"</span><span class=\"o\">:</span><span class=\"mf\">16777213</span><span class=\"p\">}</span>\n\n<span class=\"w\">        </span><span class=\"p\">]</span>\n<span class=\"w\">    </span><span class=\"p\">};</span>\n</code></pre></div>",
        "id": 429628371,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711450168
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>948             &quot;Description&quot;:&quot;&#39;δ~i~&#39; in table 20-VI in ICD-GPS-200&quot;,\n775             &quot;Description&quot;:&quot;&#39;̇Ω&#39; in table 20-VI in ICD-GPS-200&quot;,\n8486                &quot;Description&quot;:&quot;&#39;̇Ω&#39; in table 20-VI in ICD-GPS-200&quot;,\n8730                &quot;Description&quot;:&quot;&#39;√ a&#39; in table 20-VI in ICD-GPS-200&quot;,\n8486                &quot;Description&quot;:&quot;&#39;Ω~0~&#39; in table 20-VI in ICD-GPS-200&quot;,\n969             &quot;Description&quot;:&quot;&#39;ω&#39; in table 20-VI in ICD-GPS-200&quot;,\n</code></pre></div>",
        "id": 429638948,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711454323
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>    &quot;PGN&quot;:129541,\n    &quot;Id&quot;:&quot;gpsAlmanacData&quot;,\n    &quot;Description&quot;:&quot;GPS Almanac Data&quot;,\n</code></pre></div>",
        "id": 429639752,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711454606
    },
    {
        "content": "<p>I am removing the found characters and testing.</p>",
        "id": 429639871,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711454645
    },
    {
        "content": "<p>Why not omit that PGN for now</p>",
        "id": 429639921,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711454666
    },
    {
        "content": "<p>Ok.</p>",
        "id": 429639960,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711454686
    },
    {
        "content": "<p>That works. Great stuff.</p>",
        "id": 429640583,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711454897
    },
    {
        "content": "<p>Now can you please remove that PGN from the copy in data and then try this:</p>\n<div class=\"codehilite\" data-code-language=\"JavaScript\"><pre><span></span><code><span class=\"nx\">getDescriptor</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nx\">require</span><span class=\"p\">(</span><span class=\"s2\">\"pgnDescriptors\"</span><span class=\"p\">);</span>\n\n<span class=\"nx\">print</span><span class=\"p\">(</span><span class=\"s2\">\"Before call\\n\"</span><span class=\"p\">);</span>\n<span class=\"nx\">print</span><span class=\"p\">(</span><span class=\"nx\">getDescriptor</span><span class=\"p\">(</span><span class=\"mf\">126992</span><span class=\"p\">).</span><span class=\"nx\">Id</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s2\">\"\\n\"</span><span class=\"p\">);</span>\n<span class=\"nx\">print</span><span class=\"p\">(</span><span class=\"s2\">\"After call\\n\"</span><span class=\"p\">);</span>\n</code></pre></div>",
        "id": 429640766,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711454981
    },
    {
        "content": "<p>Brilliant:</p>\n<div class=\"codehilite\"><pre><span></span><code>Before call\nsystemTime\nAfter call\nresult: undefined\n</code></pre></div>",
        "id": 429641238,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711455143
    },
    {
        "content": "<p>Please now run the N2k decode/encode test</p>",
        "id": 429641504,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711455245
    },
    {
        "content": "<p>110_n2k_encode_decode.js</p>",
        "id": 429641573,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711455278
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>{\n    &quot;PGN&quot;: 126992,\n    &quot;id&quot;: &quot;systemTime&quot;,\n    &quot;description&quot;: &quot;System Time&quot;,\n    &quot;timestamp&quot;: &quot;undefined&quot;,\n    &quot;priority&quot;: &quot;undefined&quot;,\n    &quot;desination&quot;: &quot;undefined&quot;,\n    &quot;origin&quot;: &quot;undefined&quot;,\n    &quot;sid&quot;: &quot;undefined&quot;,\n    &quot;source&quot;: &quot;undefined&quot;,\n    &quot;date&quot;: &quot;undefined&quot;,\n    &quot;time&quot;: &quot;undefined&quot;\n}\n\n\nTesting pgn 126992\nTest 0 decode passed\n\nTesting pgn 129540\nTest 1 decode passed\n\nTesting pgn 129029\nTest 2 decode passed\n\nTesting pgn 129285\nTest 3 decode passed\n\nTesting pgn 126996\nTest 4 decode passed\n\nTotal time in main decode tests 503ms\n\nTesting decode method with pgn 129540\nDecode method passed\n\nAll decode tests passed\n\nEncoding pgn 126992\nTest 0 encode OK\n\nEncoding pgn 129540\nTest 1 encode OK\n\nEncoding pgn 129029\nTest 2 encode OK\n\nEncoding pgn 129285\nTest 3 encode OK\n\nEncoding pgn 126996\nTest 4 encode OK\n\nTotal time in encode tests 497ms\nAll encode tests passed\nresult: All tests passed\n</code></pre></div>",
        "id": 429641714,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711455334
    },
    {
        "content": "<p><a href=\"https://meet.jit.si/125688810952382#config.startWithVideoMuted=true\">Join voice call.</a></p>",
        "id": 429641820,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711455366
    },
    {
        "content": "<p>Testing on Linux:<br>\n<a href=\"https://github.com/opencpn/OpenCPN/issues/1\">#1</a> Removed Test Script 43 from 00_main.js. Not found. <br>\n<a href=\"https://github.com/opencpn/OpenCPN/issues/2\">#2</a> Parking consoles not working. <br>\n<code>FindConsoleByCtx failed to match console</code><br>\nPress OK and OpenCPN crashes<br>\nRun from 44_parking.js and 00_main. js same result.</p>\n<p>Parking button and  also scripts move consoles to top of screen but do not minimize them.</p>",
        "id": 429672865,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711464755
    },
    {
        "content": "<p>Have put 129541 as an optional add on - <a href=\"https://github.com/antipole2/JavaScripts-shared/blob/main/descriptor129541/descriptor129541.adoc\">see here</a>.</p>\n<p>Will look at Linux issues now.</p>",
        "id": 429675565,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711465438
    },
    {
        "content": "<blockquote>\n<p><a href=\"https://github.com/opencpn/OpenCPN/issues/1\">#1</a> Removed Test Script 43 from 00_main.js. Not found.<br>\nFile name had case mismatch.  Fixed for next try.</p>\n</blockquote>\n<p><a href=\"https://github.com/opencpn/OpenCPN/issues/2\">#2</a><br>\nThis is programming error and having failed to find the console, there is no sane way out.<br>\nPlease clarify how you got there.  Did you press a parking button or run the parking test script?</p>",
        "id": 429680948,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711466832
    },
    {
        "content": "<p>With some consoles parked but not minimised, please do a dump from the diagnostics tab of the tool and let me have it.</p>",
        "id": 429681262,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711466913
    },
    {
        "content": "<p><a href=\"https://github.com/opencpn/OpenCPN/issues/3\">#3</a> n2k encode/decode</p>\n<div class=\"codehilite\"><pre><span></span><code>Testing pgn 129540\nscript timed out\n</code></pre></div>\n<p>Removed this from n2k script</p>\n<div class=\"codehilite\"><pre><span></span><code>Testing pcn 129029\nScript timed out\n</code></pre></div>\n<p>Now removing descriptors to try and trace the issue. Maybe I need the script you used this morning.</p>",
        "id": 429681735,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711467036
    },
    {
        "content": "<p>Is your Linux machine old and slow?  Might it really be timing out?<br>\nDo you get some output?  How far does it get before the time-out?</p>",
        "id": 429683929,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711467606
    },
    {
        "content": "<blockquote>\n<p>Is your Linux machine old and slow? </p>\n</blockquote>\n<p>Yes.<br>\nSome output from Test 1</p>",
        "id": 429684698,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711467802
    },
    {
        "content": "<p>Line 127 of the test script is<br>\n<code>timeAlloc(1000);   // more time may be needed</code><br>\nbecause I reckoned it might be running out of time by then.<br>\nTry giving it more time with, say,<br>\n<code>timeAlloc(3000);   // more time may be needed</code><br>\nplaced near the beginning</p>",
        "id": 429684745,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711467819
    },
    {
        "content": "<blockquote>\n<p>This is programming error and having failed to find the console, there is no sane way out.<br>\nPlease clarify how you got there. Did you press a parking button or run the parking test script?</p>\n</blockquote>\n<p>Both tried.</p>",
        "id": 429685094,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711467910
    },
    {
        "content": "<p>JavaScript plugin version 3.0<br>\nJavaScript patch 0<br>\nJavaScript tools window DPI scaling factor 1.000000<br>\nwxWidgets version 3.2.2.0 or 3202<br>\nOCPN API version 1.18<br>\nDuktape version 20700<br>\nNot using svg<br>\npJavaScript_pi-&gt;m_pconfig                   0x009c726000<br>\npJavaScript_pi-&gt;m_parent_window         0x009cef35b0<br>\npJavaScript_pi-&gt;m_floatOnTop                false<br>\npJavaScript_pi-&gt;mRememberToggleStatus   false<br>\nfavouriteFiles:<br>\nrecentFiles:<br>\n    /home/mike/Documents/JavaScript_pi/Tests_scripts/110_n2k_encode_decode.js<br>\n    /home/mike/Documents/JavaScript_pi/Tests_scripts/00_main.js<br>\n    /home/mike/Documents/JavaScript_pi/Tests_scripts/54_stop_explicit_callback.js<br>\nN2K pgn registrations: none<br>\npJavaScript_pi-&gt;mpFirstConsole  0x009e61a240</p>\n<p>----------Console PluginTests----------<br>\nConsole name:       PluginTests<br>\nthis:                   0x009e61a240<br>\nmpNextConsole:      nullptr<br>\nmStatus:                (no status)<br>\nmRunningMain:       false<br>\nm_time_to_allocate: 1000ms<br>\nm_timeout_check_counter:    0<br>\nmWaitingCached:     true<br>\nmWaiting:           false<br>\nmpMessageDialog:    nullptr<br>\nisBusy():               false<br>\nisWaiting():            false<br>\nauto_run:           false<br>\nposition:               screen x:274 y:347  DIP x:274 y:347<br>\nSize():             x:738 y:600 DIP x:738 y:600 MinSize() x:142 y:37<br>\nm_parked:           true<br>\nisParked():         false<br>\nparked Location     74  27  size 142    37<br>\nnotParked location  235 90  size 738    600<br>\nMessages callback table<br>\n    OCPN_CORE_SIGNALK<br>\n    OCPN_OPENGL_CONFIG<br>\n    OpenCPN Config<br>\n    WMM_VARIATION_BOAT<br>\nm_timerActionBusy:  false<br>\nTimers callback table<br>\n    (empty)<br>\nMenus callback table<br>\n    (empty)<br>\nm_dialog:           None<br>\nm_alert:                None<br>\nm_NMEAmessageFunction:      <br>\nm_streamMessageCntlsVector  &lt;empty&gt;<br>\nm_activeLegFunction:        <br>\nm_exitFunction: <br>\nm_closeButtonFunction:  <br>\nm_explicitResult:       false<br>\nm_result:               <br>\nmscriptToBeRun: false<br>\nNo brief<br>\nmConsoleRepliesAwaited  0<br>\nm_remembered    <br>\nwxFile ids - none<br>\nNo Duktape context</p>\n<hr>\n<p>pJavaScript_pi-&gt;mpBin       nullptr</p>\n<p>End of dump</p>",
        "id": 429685178,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711467938
    },
    {
        "content": "<p>I'll look at the dump now.</p>\n<p>The tests take 334ms on my MacBook M2.  I can well imagine your old machine needs longer.  Suggest you refrain from messing with the descriptors.  They are loading OK or you would not ave got as far as you have.</p>",
        "id": 429685642,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711468076
    },
    {
        "content": "<p>But the PGN where it stops is 129540, the one before 129541 which caused the Windows problem.</p>",
        "id": 429685973,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711468156
    },
    {
        "content": "<p>129540 is big compared with th others.  The script runs all the decoding tests with only the default time of 1000ms for all three.  It does not allocate more time between each test (as written at present).  Feels like it is just running out of time.</p>",
        "id": 429686793,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711468367
    },
    {
        "content": "<p>Tried 5000 at line 127 but still times out.</p>",
        "id": 429687119,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711468472
    },
    {
        "content": "<p>That is after all the decoding tests have completed.<br>\nPut it near the beginning, say before the loop at line 83</p>\n<p>PS I can tell you how to turn on tracing within the decoding if w have to go there.</p>",
        "id": 429687826,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711468666
    },
    {
        "content": "<p>Or give it 2000 ms per test by placing inside the loop at the start</p>",
        "id": 429688093,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711468735
    },
    {
        "content": "<p>Same and same again with these edits.</p>",
        "id": 429688430,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711468819
    },
    {
        "content": "<p>Test script line 88, near end set <code>trace:true</code></p>",
        "id": 429689387,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711469049
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>Testing pgn 126992\nNMEA2000 called with arg type number\narg is number 126992\nparse for pgn 126992\nTest 0 decode passed\n\nTesting pgn 129540\nNMEA2000 called with arg type number\narg is number 129540\nScript timed out\n</code></pre></div>",
        "id": 429690801,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711469447
    },
    {
        "content": "<p>My line 83<br>\n<code>for (t = 0; t &lt; tests.length; t++){</code><br>\nchange to <code>t = 1</code> to omit first test.<br>\nThen on my line 88 change to trace:3<br>\nThis will cause it to print the descriptor as it has constructed it.</p>",
        "id": 429692534,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711469985
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>{\n    &quot;PGN&quot;: 126992,\n    &quot;id&quot;: &quot;systemTime&quot;,\n    &quot;description&quot;: &quot;System Time&quot;,\n    &quot;timestamp&quot;: &quot;undefined&quot;,\n    &quot;priority&quot;: &quot;undefined&quot;,\n    &quot;desination&quot;: &quot;undefined&quot;,\n    &quot;origin&quot;: &quot;undefined&quot;,\n    &quot;sid&quot;: &quot;undefined&quot;,\n    &quot;source&quot;: &quot;undefined&quot;,\n    &quot;date&quot;: &quot;undefined&quot;,\n    &quot;time&quot;: &quot;undefined&quot;\n}\n\n\nTesting pgn 129540\nNMEA2000 called with arg type number\narg is number 129540\n\n{\n    &quot;PGN&quot;: 129540,\n    &quot;Id&quot;: &quot;gnssSatsInView&quot;,\n    &quot;Description&quot;: &quot;GNSS Sats in View&quot;,\n    &quot;Type&quot;: &quot;Fast&quot;,\n    &quot;Complete&quot;: true,\n    &quot;Length&quot;: 3,\n    &quot;RepeatingFieldSet1Size&quot;: 7,\n    &quot;RepeatingFieldSet1StartField&quot;: 5,\n    &quot;RepeatingFieldSet1CountField&quot;: 4,\n    &quot;Fields&quot;: [\n        0,\n        {\n            &quot;Order&quot;: 1,\n            &quot;Id&quot;: &quot;sid&quot;,\n            &quot;Name&quot;: &quot;SID&quot;,\n            &quot;BitLength&quot;: 8,\n            &quot;BitOffset&quot;: 0,\n            &quot;BitStart&quot;: 0,\n            &quot;Type&quot;: &quot;Integer&quot;,\n            &quot;Resolution&quot;: 1,\n            &quot;Signed&quot;: false,\n            &quot;RangeMin&quot;: 0,\n            &quot;RangeMax&quot;: 253\n        },\n        {\n            &quot;Order&quot;: 2,\n            &quot;Id&quot;: &quot;rangeResidualMode&quot;,\n            &quot;Name&quot;: &quot;Range Residual Mode&quot;,\n            &quot;BitLength&quot;: 2,\n            &quot;BitOffset&quot;: 8,\n            &quot;BitStart&quot;: 0,\n            &quot;Type&quot;: &quot;Lookup table&quot;,\n            &quot;Resolution&quot;: 1,\n            &quot;Signed&quot;: false,\n            &quot;RangeMin&quot;: 0,\n            &quot;RangeMax&quot;: 2,\n            &quot;EnumValues&quot;: [\n                {\n                    &quot;name&quot;: &quot;Range residuals were used to calculate data&quot;,\n                    &quot;value&quot;: 0\n                },\n                {\n                    &quot;name&quot;: &quot;Range residuals were calculated after the position&quot;,\n                    &quot;value&quot;: 1\n                }\n            ]\n        },\n        {\n            &quot;Order&quot;: 3,\n            &quot;Id&quot;: &quot;reserved&quot;,\n            &quot;Name&quot;: &quot;Reserved&quot;,\n            &quot;BitLength&quot;: 6,\n            &quot;BitOffset&quot;: 10,\n            &quot;BitStart&quot;: 2,\n            &quot;Resolution&quot;: 1,\n            &quot;Signed&quot;: false\n        },\n        {\n            &quot;Order&quot;: 4,\n            &quot;Id&quot;: &quot;satsInView&quot;,\n            &quot;Name&quot;: &quot;Sats in View&quot;,\n            &quot;BitLength&quot;: 8,\n            &quot;BitOffset&quot;: 16,\n            &quot;BitStart&quot;: 0,\n            &quot;Type&quot;: &quot;Integer&quot;,\n            &quot;Resolution&quot;: 1,\n            &quot;Signed&quot;: false,\n            &quot;RangeMin&quot;: 0,\n            &quot;RangeMax&quot;: 253\n        },\n        {\n            &quot;Order&quot;: 5,\n            &quot;Id&quot;: &quot;prn&quot;,\n            &quot;Name&quot;: &quot;PRN&quot;,\n            &quot;BitLength&quot;: 8,\n            &quot;BitOffset&quot;: 24,\n            &quot;BitStart&quot;: 0,\n            &quot;Type&quot;: &quot;Integer&quot;,\n            &quot;Resolution&quot;: 1,\n            &quot;Signed&quot;: false,\n            &quot;RangeMin&quot;: 0,\n            &quot;RangeMax&quot;: 253\n        },\n        {\n            &quot;Order&quot;: 6,\n            &quot;Id&quot;: &quot;elevation&quot;,\n            &quot;Name&quot;: &quot;Elevation&quot;,\n            &quot;BitLength&quot;: 16,\n            &quot;BitOffset&quot;: 32,\n            &quot;BitStart&quot;: 0,\n            &quot;Units&quot;: &quot;rad&quot;,\n            &quot;Type&quot;: &quot;Number&quot;,\n            &quot;Resolution&quot;: 0.0001,\n            &quot;Signed&quot;: true,\n            &quot;RangeMin&quot;: -3.2767,\n            &quot;RangeMax&quot;: 3.2765\n        },\n        {\n            &quot;Order&quot;: 7,\n            &quot;Id&quot;: &quot;azimuth&quot;,\n            &quot;Name&quot;: &quot;Azimuth&quot;,\n            &quot;BitLength&quot;: 16,\n            &quot;BitOffset&quot;: 48,\n            &quot;BitStart&quot;: 0,\n            &quot;Units&quot;: &quot;rad&quot;,\n            &quot;Type&quot;: &quot;Number&quot;,\n            &quot;Resolution&quot;: 0.0001,\n            &quot;Signed&quot;: false,\n            &quot;RangeMin&quot;: 0,\n            &quot;RangeMax&quot;: 6.5533\n        },\n        {\n            &quot;Order&quot;: 8,\n            &quot;Id&quot;: &quot;snr&quot;,\n            &quot;Name&quot;: &quot;SNR&quot;,\n            &quot;BitLength&quot;: 16,\n            &quot;BitOffset&quot;: 64,\n            &quot;BitStart&quot;: 0,\n            &quot;Units&quot;: &quot;dB&quot;,\n            &quot;Type&quot;: &quot;Number&quot;,\n            &quot;Resolution&quot;: 0.01,\n            &quot;Signed&quot;: false,\n            &quot;RangeMin&quot;: 0,\n            &quot;RangeMax&quot;: 655.33\n        },\n        {\n            &quot;Order&quot;: 9,\n            &quot;Id&quot;: &quot;rangeResiduals&quot;,\n            &quot;Name&quot;: &quot;Range residuals&quot;,\n            &quot;BitLength&quot;: 32,\n            &quot;BitOffset&quot;: 80,\n            &quot;BitStart&quot;: 0,\n            &quot;Type&quot;: &quot;Integer&quot;,\n            &quot;Resolution&quot;: 1,\n            &quot;Signed&quot;: true,\n            &quot;RangeMin&quot;: -2147483647,\n            &quot;RangeMax&quot;: 2147483645\n        },\n        {\n            &quot;Order&quot;: 10,\n            &quot;Id&quot;: &quot;status&quot;,\n            &quot;Name&quot;: &quot;Status&quot;,\n            &quot;BitLength&quot;: 4,\n            &quot;BitOffset&quot;: 112,\n            &quot;BitStart&quot;: 0,\n            &quot;Type&quot;: &quot;Lookup table&quot;,\n            &quot;Resolution&quot;: 1,\n            &quot;Signed&quot;: false,\n            &quot;RangeMin&quot;: 0,\n            &quot;RangeMax&quot;: 13,\n            &quot;EnumValues&quot;: [\n                {\n                    &quot;name&quot;: &quot;Not tracked&quot;,\n                    &quot;value&quot;: 0\n                },\n                {\n                    &quot;name&quot;: &quot;Tracked&quot;,\n                    &quot;value&quot;: 1\n                },\n                {\n                    &quot;name&quot;: &quot;Used&quot;,\n                    &quot;value&quot;: 2\n                },\n                {\n                    &quot;name&quot;: &quot;Not tracked+Diff&quot;,\n                    &quot;value&quot;: 3\n                },\n                {\n                    &quot;name&quot;: &quot;Tracked+Diff&quot;,\n                    &quot;value&quot;: 4\n                },\n                {\n                    &quot;name&quot;: &quot;Used+Diff&quot;,\n                    &quot;value&quot;: 5\n                }\n            ]\n        },\n        {\n            &quot;Order&quot;: 11,\n            &quot;Id&quot;: &quot;reserved11&quot;,\n            &quot;Name&quot;: &quot;Reserved&quot;,\n            &quot;BitLength&quot;: 4,\n            &quot;BitOffset&quot;: 116,\n            &quot;BitStart&quot;: 4,\n            &quot;Resolution&quot;: 1,\n            &quot;Signed&quot;: false\n        }\n    ]\n}\n\nRepeating fields - repeat1Size:7    repeat1StartField:5 repeat1CountField:4 repeatName:satsInView\nparse for pgn 129540\nTest 1 decode passed\n\nTesting pgn 129029\nNMEA2000 called with arg type number\narg is number 129029\nScript timed out\n</code></pre></div>",
        "id": 429692998,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711470126
    },
    {
        "content": "<p>Better to talk<br>\n<a href=\"https://meet.jit.si/316026523466844#config.startWithVideoMuted=true\">Join voice call.</a></p>",
        "id": 429693667,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711470344
    },
    {
        "content": "<p>I need. to start cooking for this evening, but will keep an eye on Zulip from the kitchen.<br>\nI am perplexed.  When the tests start with t = 0, it completed the 0'th test and times out on 1.<br>\nWhen you start with t -= 1, it completes test 1 (which it timed out on previously), and times out on the next.<br>\nSo it always completes the first and times out on the second, whether you start on 0 or 1.<br>\nThat seems like a lack of time issue.  I thought you had added <code>timeAlloc(3000); </code> just inside the loop so it gets a fresh 3 seconds at the start of each test?  Is that still there?</p>",
        "id": 429701917,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711472948
    },
    {
        "content": "<p>Increased time in the loop to 9000 and all tests run.<br>\nTime taken 2802 ms</p>",
        "id": 429707804,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711474920
    },
    {
        "content": "<p>Time in encode 3543 ms</p>",
        "id": 429707984,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711474988
    },
    {
        "content": "<p>Now for parking.<br>\nStill not sure when you hit that message.<br>\nWith two console, neither running, please park one if you can.  I understand it will move up but not minimise.<br>\nThen take a dump and let me have that.</p>",
        "id": 429709525,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711475530
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>JavaScript plugin version 3.0\nJavaScript patch 0\nJavaScript tools window DPI scaling factor 1.000000\nwxWidgets version 3.2.2.0 or 3202\nOCPN API version 1.18\nDuktape version 20700\nNot using svg\npJavaScript_pi-&gt;m_pconfig                   0x00897ad730\npJavaScript_pi-&gt;m_parent_window         0x008a01c570\npJavaScript_pi-&gt;m_floatOnTop                false\npJavaScript_pi-&gt;mRememberToggleStatus   false\nfavouriteFiles:\nrecentFiles:\n    /home/mike/Documents/JavaScript_pi/Tests_scripts/110_n2k_encode_decode.js\n    /home/mike/Documents/JavaScript_pi/Tests_scripts/74_dialogue_test.js\n    /home/mike/Documents/JavaScript_pi/Tests_scripts/00_main.js\n    /home/mike/Documents/JavaScript_pi/Tests_scripts/54_stop_explicit_callback.js\nN2K pgn registrations: none\npJavaScript_pi-&gt;mpFirstConsole  0x008b74e1d0\n\n----------Console PluginTests----------\nConsole name:       PluginTests\nthis:                   0x008b74e1d0\nmpNextConsole:      0x008de878c0\nmStatus:                (no status)\nmRunningMain:       false\nm_time_to_allocate: 1000ms\nm_timeout_check_counter:    -454893342\nmWaitingCached:     true\nmWaiting:           false\nmpMessageDialog:    nullptr\nisBusy():               false\nisWaiting():            false\nauto_run:           false\nposition:               screen x:487 y:101  DIP x:487 y:101\nSize():             x:738 y:600 DIP x:738 y:600 MinSize() x:142 y:37\nm_parked:           false\nisParked():         false\nparked Location     74  27  size 142    37\nnotParked location  398 100 size 738    600\nMessages callback table\n    OCPN_CORE_SIGNALK\n    OCPN_OPENGL_CONFIG\n    OpenCPN Config\n    WMM_VARIATION_BOAT\nm_timerActionBusy:  false\nTimers callback table\n    (empty)\nMenus callback table\n    (empty)\nm_dialog:           None\nm_alert:                None\nm_NMEAmessageFunction:\nm_streamMessageCntlsVector  &lt;empty&gt;\nm_activeLegFunction:\nm_exitFunction:\nm_closeButtonFunction:\nm_explicitResult:       false\nm_result:\nmscriptToBeRun: false\nNo brief\nmConsoleRepliesAwaited  0\nm_remembered\nwxFile ids - none\nNo Duktape context\n\n----------Console test----------\nConsole name:       test\nthis:                   0x008de878c0\nmpNextConsole:      nullptr\nmStatus:                (no status)\nmRunningMain:       false\nm_time_to_allocate: 1000ms\nm_timeout_check_counter:    -1\nmWaitingCached:     true\nmWaiting:           false\nmpMessageDialog:    nullptr\nisBusy():               false\nisWaiting():            false\nauto_run:           false\nposition:               screen x:221 y:27   DIP x:221 y:27\nSize():             x:738 y:600 DIP x:738 y:600 MinSize() x:93 y:37\nm_parked:           true\nisParked():         true\nparked Location     221 27  size 93 37\nnotParked location  313 119 size 738    600\nMessages callback table\n    WMM_VARIATION_BOAT\nm_timerActionBusy:  false\nTimers callback table\n    (empty)\nMenus callback table\n    (empty)\nm_dialog:           None\nm_alert:                None\nm_NMEAmessageFunction:\nm_streamMessageCntlsVector  &lt;empty&gt;\nm_activeLegFunction:\nm_exitFunction:\nm_closeButtonFunction:\nm_explicitResult:       false\nm_result:\nmscriptToBeRun: false\nNo brief\nmConsoleRepliesAwaited  0\nm_remembered\nwxFile ids - none\nNo Duktape context\n\n----------------------------------------------------\n\npJavaScript_pi-&gt;mpBin       nullptr\n\nEnd of dump\n</code></pre></div>",
        "id": 429710234,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711475757
    },
    {
        "content": "<p>Re issue <a href=\"https://github.com/opencpn/OpenCPN/issues/1\">#1</a>, in <code>Tests_scripts/00_main.js</code> line 67, the file name should be <code>\"43_files.js\"</code> (lower case).</p>",
        "id": 429712433,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711476555
    },
    {
        "content": "<p>Must attend to meal now - back tomorrow.</p>",
        "id": 429712628,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711476634
    },
    {
        "content": "<p>Files Object now working from 00_main.js and the script itself.</p>",
        "id": 429818544,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711532568
    },
    {
        "content": "<p>Good.  I have found issues with parking.  Am working on it, so please hold off further testing.</p>",
        "id": 429818847,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711532654
    },
    {
        "content": "<p>Bit of a red herring on parking.  Anyhow, sorted now.<br>\nJust pushed beta-u to GitHub and build into beta repo.<br>\nRe Linux, please check if still have parking problem.</p>\n<ol>\n<li>With a console unparked, take a dump via the tools</li>\n<li>Park it using the park button.</li>\n<li>Does it minimise correctly?  If not, please take another dump.</li>\n</ol>\n<p>The pgn descriptors now lack the one causing the problem.<br>\nThe main test script has the fix for the mixed case file name.</p>\n<p>thanks</p>",
        "id": 429852330,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711543978
    },
    {
        "content": "<p>And if problem screen shot of wrong sized parked console</p>",
        "id": 429855106,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711544885
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>JavaScript plugin version 3.0\nJavaScript patch 0\nJavaScript tools window DPI scaling factor 1.000000\nwxWidgets version 3.2.2.0 or 3202\nOCPN API version 1.18\nDuktape version 20700\nNot using svg\npJavaScript_pi-&gt;m_pconfig                   0x00e85f3000\npJavaScript_pi-&gt;m_parent_window         0x00e8caa000\npJavaScript_pi-&gt;m_floatOnTop                false\npJavaScript_pi-&gt;mRememberToggleStatus   false\nfavouriteFiles:\nrecentFiles:\n    /home/mike/Documents/JavaScript_pi/Tests_scripts/00_main.js\n    /home/mike/Documents/JavaScript_pi/Tests_scripts/43_files.js\n    /home/mike/Documents/JavaScript_pi/Tests_scripts/110_n2k_encode_decode.js\n    /home/mike/Documents/JavaScript_pi/Tests_scripts/74_dialogue_test.js\n    /home/mike/Documents/JavaScript_pi/Tests_scripts/54_stop_explicit_callback.js\nN2K pgn registrations: none\npJavaScript_pi-&gt;mpFirstConsole  0x00eae980a0\n\n----------Console PluginTests----------\nConsole name:       PluginTests\nthis:                   0x00eae980a0\nmpNextConsole:      nullptr\nmStatus:                DONE\nmRunningMain:       false\nm_time_to_allocate: 1000ms\nm_timeout_check_counter:    1\nmWaitingCached:     true\nmWaiting:           false\nmpMessageDialog:    nullptr\nisBusy():               false\nisWaiting():            false\nauto_run:           false\nposition:               screen x:414 y:121  DIP x:414 y:121\nSize():             x:738 y:600 DIP x:738 y:600 MinSize() x:142 y:37\nm_parked:           true\nisParked():         false\nparked Location     74  27  size 142    37\nnotParked location  231 77  size 738    600\nMessages callback table\n    OCPN_CORE_SIGNALK\n    OCPN_OPENGL_CONFIG\n    OpenCPN Config\n    WMM_VARIATION_BOAT\nm_timerActionBusy:  false\nTimers callback table\n    (empty)\nMenus callback table\n    (empty)\nm_dialog:           None\nm_alert:                None\nm_NMEAmessageFunction:\nm_streamMessageCntlsVector  &lt;empty&gt;\nm_activeLegFunction:\nm_exitFunction:\nm_closeButtonFunction:\nm_explicitResult:       false\nm_result:               undefined\nmscriptToBeRun: false\nNo brief\nmConsoleRepliesAwaited  0\nm_remembered\nwxFile ids - none\nNo Duktape context\n\n----------------------------------------------------\n\npJavaScript_pi-&gt;mpBin       nullptr\n\nEnd of dump\n</code></pre></div>\n<p><a href=\"/user_uploads/33951/_9l3EwTnujyiTiFzYBZe75ZF/Screenshot-from-2024-03-27-14-18-00.png\">Screenshot-from-2024-03-27-14-18-00.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/33951/_9l3EwTnujyiTiFzYBZe75ZF/Screenshot-from-2024-03-27-14-18-00.png\" title=\"Screenshot-from-2024-03-27-14-18-00.png\"><img src=\"/user_uploads/33951/_9l3EwTnujyiTiFzYBZe75ZF/Screenshot-from-2024-03-27-14-18-00.png\"></a></div>",
        "id": 429870121,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711549152
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>JavaScript plugin version 3.0\nJavaScript patch 0\nJavaScript tools window DPI scaling factor 1.000000\nwxWidgets version 3.2.2.0 or 3202\nOCPN API version 1.18\nDuktape version 20700\nNot using svg\npJavaScript_pi-&gt;m_pconfig                   0x00e85f3000\npJavaScript_pi-&gt;m_parent_window         0x00e8caa000\npJavaScript_pi-&gt;m_floatOnTop                false\npJavaScript_pi-&gt;mRememberToggleStatus   false\nfavouriteFiles:\nrecentFiles:\n    /home/mike/Documents/JavaScript_pi/Tests_scripts/00_main.js\n    /home/mike/Documents/JavaScript_pi/Tests_scripts/43_files.js\n    /home/mike/Documents/JavaScript_pi/Tests_scripts/110_n2k_encode_decode.js\n    /home/mike/Documents/JavaScript_pi/Tests_scripts/74_dialogue_test.js\n    /home/mike/Documents/JavaScript_pi/Tests_scripts/54_stop_explicit_callback.js\nN2K pgn registrations: none\npJavaScript_pi-&gt;mpFirstConsole  0x00eae980a0\n\n----------Console PluginTests----------\nConsole name:       PluginTests\nthis:                   0x00eae980a0\nmpNextConsole:      nullptr\nmStatus:                DONE\nmRunningMain:       false\nm_time_to_allocate: 1000ms\nm_timeout_check_counter:    1\nmWaitingCached:     true\nmWaiting:           false\nmpMessageDialog:    nullptr\nisBusy():               false\nisWaiting():            false\nauto_run:           false\nposition:               screen x:74 y:27    DIP x:74 y:27\nSize():             x:738 y:600 DIP x:738 y:600 MinSize() x:142 y:37\nm_parked:           true\nisParked():         true\nparked Location     74  27  size 142    37\nnotParked location  414 121 size 738    600\nMessages callback table\n    OCPN_CORE_SIGNALK\n    OCPN_OPENGL_CONFIG\n    OpenCPN Config\n    WMM_VARIATION_BOAT\nm_timerActionBusy:  false\nTimers callback table\n    (empty)\nMenus callback table\n    (empty)\nm_dialog:           None\nm_alert:                None\nm_NMEAmessageFunction:\nm_streamMessageCntlsVector  &lt;empty&gt;\nm_activeLegFunction:\nm_exitFunction:\nm_closeButtonFunction:\nm_explicitResult:       false\nm_result:               undefined\nmscriptToBeRun: false\nNo brief\nmConsoleRepliesAwaited  0\nm_remembered\nwxFile ids - none\nNo Duktape context\n\n----------------------------------------------------\n\npJavaScript_pi-&gt;mpBin       nullptr\n\nEnd of dump\n</code></pre></div>",
        "id": 429870579,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711549279
    },
    {
        "content": "<p>On Linux, you have a parked console which has not shrunk.  Please</p>\n<ol>\n<li>Unpark it by clicking on the Close button.  It should spring back to where it was before it was parked.  (If it deletes it was not parked).</li>\n<li>Repark it usung the button.</li>\n<li>Is it still too big or does it shrink this time?</li>\n</ol>\n<p>By the way, the parking button should be the letter P on a blue background.  On teh screenshot you sent it was solid red. Is that so?  And why?</p>",
        "id": 429880555,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711551584
    },
    {
        "content": "<p>Unpark - springs back<br>\nRepark - still too big.<br>\nWindows - blue button, no \"P\".<br>\nLinux - red button, no \"P\". I don't know the reason. <br>\nBTW on my Linux display the tools captions are not shown.  Tried changing screen properties but this did not help. My graphics card is rubbish. This may be the reason.</p>",
        "id": 429883515,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711552321
    },
    {
        "content": "<p>Looks like Linux has something difficult about setting window size. <br>\nHave tracing to investigate.  I could give you the extra statements. Are you building on Linux? <br>\nOtherwise I can remote build for you.</p>",
        "id": 429884455,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711552576
    },
    {
        "content": "<p>Sorry ... not building on Linux here.</p>",
        "id": 429884928,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711552702
    },
    {
        "content": "<p>OK will build for you.</p>",
        "id": 429884995,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711552721
    },
    {
        "content": "<p>Just built into my <strong>alpha repo</strong> <a href=\"https://cloudsmith.io/~opencpn/repos/javascript-alpha/packages/\">https://cloudsmith.io/~opencpn/repos/javascript-alpha/packages/</a> version with extra tracing.<br>\nPlease park a console and let me have the trace.</p>",
        "id": 429888187,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711553567
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>L25 PluginTests OnPark start\nL25 PluginTests-&gt;isParked() already false\nL25 PluginTests-&gt;getLocation()returning position    521 119 size 738    600\nL25 PluginTests-&gt;park() parking called with minSize X:142  Y:37\nL25 PluginTests-&gt;park() readback of client size X:142  Y:0\nL25 PluginTests-&gt;park() readback of size X:142  Y:37\nL25 PluginTests-&gt;park() reparking\nL25 PluginTests-&gt;setLocation() setting position 74  27  size 142    37\nL25 PluginTests-&gt;park() finished reparking\nL25 PluginTests OnPark finished\n</code></pre></div>",
        "id": 429889064,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711553813
    },
    {
        "content": "<p>It appears that SetSize( ) just does not do anything.  It its the size OK in that I can read it back with GetSize but the displayed size does not change.  You could try moving the console window in case it lacks a redraw?<br>\nI have just pushed another alpha build that that sets the window height bigger than the minimum I was using - in case it cannot cope with that.  If it is resized, it will be smaller but   twice the normal parked height.</p>",
        "id": 429899087,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711556426
    },
    {
        "content": "<p>That works. Good. Now to run the parking test.</p>",
        "id": 429900990,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711556988
    },
    {
        "content": "<p>You mean it made the window smaller but twice height as normal?  <br>\nHold off the parking tests - not finished yet.</p>",
        "id": 429901311,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711557067
    },
    {
        "content": "<p>Parked consoles about 1.5 times minimum. Consoles D and E overlap 70%.</p>",
        "id": 429910096,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711559752
    },
    {
        "content": "<p>Just pushed/building another at 17:20, with Y set to 1 rather than 0 in Linux only.  Could give much smaller oversize.<br>\nConsole test script too complicated until basics sorted.<br>\nPlease test and park two consoles and let me have screen shot and trace.<br>\nThanks</p>",
        "id": 429911319,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711560189
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>L25 second OnPark start\nL25 second-&gt;isParked() already false\nL25 second-&gt;getLocation()returning position 309 91  size 738    600\nL25 second-&gt;park() parking called with minSize X:114  Y:37\nL25 second-&gt;park() readback of client size X:114  Y:1\nL25 second-&gt;park() readback of size X:114  Y:38\nL25 second-&gt;park() parking first time\nL25 PluginTests-&gt;isParked() already false\nL25 second-&gt;setLocation() setting position  221 27  size 114    38\nL25 second-&gt;park() parking at X:221  Y:27 frame\nL25 second OnPark finished\nL25 PluginTests OnPark start\nL25 PluginTests-&gt;isParked() already false\nL25 PluginTests-&gt;getLocation()returning position    340 92  size 828    616\nL25 PluginTests-&gt;park() parking called with minSize X:142  Y:37\nL25 PluginTests-&gt;park() readback of client size X:142  Y:1\nL25 PluginTests-&gt;park() readback of size X:142  Y:38\nL25 PluginTests-&gt;park() reparking\nL25 PluginTests-&gt;setLocation() setting position 74  27  size 142    38\nL25 PluginTests-&gt;park() readback of parked size X:142  Y:38\nL25 PluginTests-&gt;park() finished re-parking\nL25 PluginTests OnPark finished\n</code></pre></div>",
        "id": 429912020,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711560431
    },
    {
        "content": "<p><a href=\"/user_uploads/33951/jeFyVf71qcuOz0j5kmcRPdxL/Screenshot-from-2024-03-27-17-28-23.png\">Screenshot-from-2024-03-27-17-28-23.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/33951/jeFyVf71qcuOz0j5kmcRPdxL/Screenshot-from-2024-03-27-17-28-23.png\" title=\"Screenshot-from-2024-03-27-17-28-23.png\"><img src=\"/user_uploads/33951/jeFyVf71qcuOz0j5kmcRPdxL/Screenshot-from-2024-03-27-17-28-23.png\"></a></div>",
        "id": 429912385,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711560551
    },
    {
        "content": "<p>Yes!!  OK please run test script and screenshot if not right.</p>",
        "id": 429912661,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711560630
    },
    {
        "content": "<p>Just that overlap with consoles D and E at the start. After re-sizing at step 2 of the script the overlap disappears.</p>",
        "id": 429913463,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711560901
    },
    {
        "content": "<p>screenshot please</p>",
        "id": 429913539,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711560937
    },
    {
        "content": "<p><a href=\"/user_uploads/33951/BfmE5zh26pPxQeO4R5WePIgL/Screenshot-from-2024-03-27-17-39-39.png\">Screenshot-from-2024-03-27-17-39-39.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/33951/BfmE5zh26pPxQeO4R5WePIgL/Screenshot-from-2024-03-27-17-39-39.png\" title=\"Screenshot-from-2024-03-27-17-39-39.png\"><img src=\"/user_uploads/33951/BfmE5zh26pPxQeO4R5WePIgL/Screenshot-from-2024-03-27-17-39-39.png\"></a></div><p><a href=\"/user_uploads/33951/1rCNh-Aw6Z9sGBsoDLKSDna3/Screenshot-from-2024-03-27-17-40-28.png\">Screenshot-from-2024-03-27-17-40-28.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/33951/1rCNh-Aw6Z9sGBsoDLKSDna3/Screenshot-from-2024-03-27-17-40-28.png\" title=\"Screenshot-from-2024-03-27-17-40-28.png\"><img src=\"/user_uploads/33951/1rCNh-Aw6Z9sGBsoDLKSDna3/Screenshot-from-2024-03-27-17-40-28.png\"></a></div><p><a href=\"/user_uploads/33951/JmI6szI3I-C3OqMyXVVp-fuc/Screenshot-from-2024-03-27-17-41-19.png\">Screenshot-from-2024-03-27-17-41-19.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/33951/JmI6szI3I-C3OqMyXVVp-fuc/Screenshot-from-2024-03-27-17-41-19.png\" title=\"Screenshot-from-2024-03-27-17-41-19.png\"><img src=\"/user_uploads/33951/JmI6szI3I-C3OqMyXVVp-fuc/Screenshot-from-2024-03-27-17-41-19.png\"></a></div>",
        "id": 429914878,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711561430
    },
    {
        "content": "<p>Parked console can be re-sized. Also returns to correct size when closed.</p>",
        "id": 429916258,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711561917
    },
    {
        "content": "<p>So its only the first step that is wrong.</p>",
        "id": 429916545,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711562013
    },
    {
        "content": "<p>At step one when Console E is overlapping Console D, please take a dump.</p>",
        "id": 429917496,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711562307
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"554731\">Tony Voss</span> <a href=\"#narrow/stream/349785-JavaScript_pi/topic/v3.2E0.2E0.20beta.20testing/near/429917496\">said</a>:</p>\n<blockquote>\n<p>At step one when Console E is overlapping Console D, please take a dump.</p>\n</blockquote>\n<p>Then after the dump, while the consoles still overlap, use the Tools to change a console name - eg, ConsoleA -&gt; ConsoleX.  My hunch the overlapping will be corrected?</p>",
        "id": 429946572,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711572542
    },
    {
        "content": "<p>This morning we have all the consoles piled up on top of one another.</p>\n<div class=\"codehilite\"><pre><span></span><code>L0  ------------------ Console PluginTests about to run\nL25 PluginTests-&gt;isParked() already false\nL25 ConsoleA-&gt;isParked() already false\nL25 ConsoleA-&gt;getLocation()returning position   339 76  size 738    600\nL25 ConsoleA-&gt;park() parking called with minSize X:130  Y:37\nL25 ConsoleA-&gt;park() readback of client size X:130  Y:1\nL25 ConsoleA-&gt;park() readback of size X:130  Y:38\nL25 ConsoleA-&gt;park() parking first time\nL25 PluginTests-&gt;isParked() already false\nL25 ConsoleA-&gt;setLocation() setting position    745 27  size 130    38\nL25 ConsoleA-&gt;park() parking at X:745  Y:27 frame\nL25 1-&gt;isParked() already false\nL25 1-&gt;getLocation()returning position  333 74  size 738    600\nL25 1-&gt;park() parking called with minSize X:74  Y:37\nL25 1-&gt;park() readback of client size X:74  Y:1\nL25 1-&gt;park() readback of size X:74  Y:38\nL25 1-&gt;park() parking first time\nL25 PluginTests-&gt;isParked() already false\nL25 ConsoleA-&gt;isParked() found is parked\nL25 1-&gt;setLocation() setting position   880 27  size 74 38\nL25 1-&gt;park() parking at X:880  Y:27 frame\nL25 ConsoleC__Long-&gt;isParked() already false\nL25 ConsoleC__Long-&gt;getLocation()returning position 339 83  size 738    600\nL25 ConsoleC__Long-&gt;park() parking called with minSize X:175  Y:37\nL25 ConsoleC__Long-&gt;park() readback of client size X:175  Y:1\nL25 ConsoleC__Long-&gt;park() readback of size X:175  Y:38\nL25 ConsoleC__Long-&gt;park() parking first time\nL25 PluginTests-&gt;isParked() already false\nL25 ConsoleA-&gt;isParked() found is parked\nL25 1-&gt;isParked() found is parked\nL25 ConsoleC__Long-&gt;setLocation() setting position  959 27  size 175    38\nL25 ConsoleC__Long-&gt;park() parking at X:959  Y:27 frame\nL25 ConsoleD-&gt;isParked() already false\nL25 ConsoleD-&gt;getLocation()returning position   337 86  size 738    600\nL25 ConsoleD-&gt;park() parking called with minSize X:130  Y:37\nL25 ConsoleD-&gt;park() readback of client size X:130  Y:1\nL25 ConsoleD-&gt;park() readback of size X:130  Y:38\nL25 ConsoleD-&gt;park() parking first time\nL25 PluginTests-&gt;isParked() already false\nL25 ConsoleA-&gt;isParked() found is parked\nL25 1-&gt;isParked() found is parked\nL25 ConsoleC__Long-&gt;isParked() found is parked\nL25 ConsoleD-&gt;setLocation() setting position    1139    27  size 130    38\nL25 ConsoleD-&gt;park() parking at X:1139  Y:27 frame\nL25 ConsoleE-&gt;isParked() already false\nL25 ConsoleE-&gt;getLocation()returning position   361 102 size 738    600\nL25 ConsoleE-&gt;park() parking called with minSize X:128  Y:37\nL25 ConsoleE-&gt;park() readback of client size X:128  Y:1\nL25 ConsoleE-&gt;park() readback of size X:128  Y:38\nL25 ConsoleE-&gt;park() parking first time\nL25 PluginTests-&gt;isParked() already false\nL25 ConsoleA-&gt;isParked() found is parked\nL25 1-&gt;isParked() found is parked\nL25 ConsoleC__Long-&gt;isParked() found is parked\nL25 ConsoleD-&gt;isParked() found is parked\nL25 ConsoleE-&gt;setLocation() setting position    1274    27  size 128    38\nL25 ConsoleE-&gt;park() parking at X:1274  Y:27 frame\nL25 PluginTests-&gt;isParked() already false\nL25 PluginTests-&gt;isParked() already false\nL25 1-&gt;setLocation() setting position   745 27  size 74 38\nL25 ConsoleC__Long-&gt;setLocation() setting position  824 27  size 175    38\nL25 ConsoleD-&gt;setLocation() setting position    1004    27  size 130    38\nL25 ConsoleE-&gt;setLocation() setting position    1139    27  size 128    38\nL25 ConsoleC__Long-&gt;setLocation() setting position  745 27  size 175    38\nL25 ConsoleD-&gt;setLocation() setting position    925 27  size 130    38\nL25 ConsoleE-&gt;setLocation() setting position    1060    27  size 128    38\nL25 ConsoleD-&gt;setLocation() setting position    745 27  size 130    38\nL25 ConsoleE-&gt;setLocation() setting position    880 27  size 128    38\nL25 ConsoleE-&gt;setLocation() setting position    745 27  size 128    38\nL25 PluginTests-&gt;isParked() already false\nL0  ------------------ Console PluginTests wrapped up\n</code></pre></div>\n<p><a href=\"/user_uploads/33951/X_bWxLy7krOQW3sq9HGH7AwK/Screenshot-from-2024-03-28-10-39-09.png\">Screenshot-from-2024-03-28-10-39-09.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/33951/X_bWxLy7krOQW3sq9HGH7AwK/Screenshot-from-2024-03-28-10-39-09.png\" title=\"Screenshot-from-2024-03-28-10-39-09.png\"><img src=\"/user_uploads/33951/X_bWxLy7krOQW3sq9HGH7AwK/Screenshot-from-2024-03-28-10-39-09.png\"></a></div><p>Trying a restart of the pc to see if things change.</p>",
        "id": 430038939,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711622562
    },
    {
        "content": "<p>No difference ... the positions of the consoles have been saved in the wrong place.</p>",
        "id": 430039817,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711622903
    },
    {
        "content": "<p>It could be the start position for placement of the consoles is incorrect.</p>",
        "id": 430040467,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711623169
    },
    {
        "content": "<p>Out today at a couple of appointments.  Will try and check in here. <br>\nPlease capture relevant section of .ini file where they were saved. <br>\nIn Parking section of tools you can display the current parking parameters. <br>\nIf you delete one of them (unpark and then close button again) do the rest sort themselves out or stay piled on top of each other?<br>\nFresh beta-v this morning in beta repo with tracing off.</p>",
        "id": 430048668,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711626249
    },
    {
        "content": "<p>Cleared the .conf file of parking information and the test is back to normal. OpenCPN had crashed at one point. Not known where. This may have caused my problem with the incorrect placing.</p>",
        "id": 430053380,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711627599
    },
    {
        "content": "<p>If parking settings are wrong after restore at reload, you can reset to platform defaults in parking pane.</p>",
        "id": 430054055,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711627821
    },
    {
        "content": "<p>Leaving the consoles from the test in position this is how the conf looked.</p>\n<div class=\"codehilite\"><pre><span></span><code>ParkingBespoke=1\nParkingStub=63\nParkingLevel=27\nParkingFirstX=74\nParkingSep=5\nPluginTests\\:Parked=0\nPluginTests\\:ConsolePosX=336\nPluginTests\\:ConsolePosY=163\nPluginTests\\:ConsoleSizeX=738\nPluginTests\\:ConsoleSizeY=600\nPluginTests\\:DialogPosX=20\nPluginTests\\:DialogPosY=20\nPluginTests\\:AlertPosX=20\nPluginTests\\:AlertPosY=20\nPluginTests\\:AutoRun=0\nPluginTests\\:LoadFile=/home/mike/Documents/JavaScript_pi/Tests_scripts/44_parking.js\nPluginTests\\:_remember=\nPluginTests\\:UnparkedLocationSet=0\nPluginTests\\:UnparkedLocationPosX=0\nPluginTests\\:UnparkedLocationPosY=0\nPluginTests\\:UnparkedLocationSizeX=0\nPluginTests\\:UnparkedLocationSizeY=0\nPluginTests\\:ParkedLocationSet=0\nPluginTests\\:ParkedLocationPosX=0\nPluginTests\\:ParkedLocationPosY=0\nPluginTests\\:ParkedLocationSizeX=0\nPluginTests\\:ParkedLocationSizeY=0\n</code></pre></div>",
        "id": 430054138,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711627858
    },
    {
        "content": "<p>I had already changed parking settings from the default to a custom setting.</p>",
        "id": 430054231,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711627905
    },
    {
        "content": "<p>Is 'normal' with the overlapped consoles?  And does editing a console name or deleting one straightn them out?</p>",
        "id": 430057553,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711629129
    },
    {
        "content": "<p><a href=\"/user_uploads/33951/HYoK3GI12UDevOo15kqeXGIV/Screenshot-from-2024-03-28-12-36-14.png\">Screenshot-from-2024-03-28-12-36-14.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/33951/HYoK3GI12UDevOo15kqeXGIV/Screenshot-from-2024-03-28-12-36-14.png\" title=\"Screenshot-from-2024-03-28-12-36-14.png\"><img src=\"/user_uploads/33951/HYoK3GI12UDevOo15kqeXGIV/Screenshot-from-2024-03-28-12-36-14.png\"></a></div>",
        "id": 430058344,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711629410
    },
    {
        "content": "<p>No overlapped consoles now.</p>",
        "id": 430058359,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711629415
    },
    {
        "content": "<p>So what remains to be sorted before release of v3?  I take it Windows is still OK?</p>",
        "id": 430058683,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711629550
    },
    {
        "content": "<blockquote>\n<p>I take it Windows is still OK?</p>\n</blockquote>\n<p>I will test beta-v with Windows.</p>",
        "id": 430059263,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711629770
    },
    {
        "content": "<p><a href=\"/user_uploads/33951/LE4qRetEH8XW4glrVQLgORZD/15.jpg\">15.jpg</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/33951/LE4qRetEH8XW4glrVQLgORZD/15.jpg\" title=\"15.jpg\"><img src=\"/user_uploads/33951/LE4qRetEH8XW4glrVQLgORZD/15.jpg\"></a></div>",
        "id": 430061217,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711630491
    },
    {
        "content": "<p>Don't understand.  It is trying to read a file that  exists.  File string is correct.  Is the file still there?<br>\nIf stuck, you could in JSextensions.cpp change line 947 from<br>\n<code>pConsole-&gt;prep_for_throw(ctx, \"_wxFile unable to open file \" + filePath);</code><br>\nto<br>\n<code>pConsole-&gt;prep_for_throw(ctx, wxString::Format(\"_wxFile unable to open file %s error %d\", filePath, control.pFile-&gt;GetLastError()));\n</code><br>\nThis should add the error code to the error message.  This line compiles but I have not tested it - am on the go.<br>\nCode is platform dependent and you would need to interpret it.</p>\n<p>This all worked before,  and I have not changed anything there I think.  The test works fine for me on MacOS.  Hope you can find what is up.</p>",
        "id": 430067756,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711632685
    },
    {
        "content": "<p>Have tested that change.  It does give the error number.  If I run with non existant file I get<br>\nerror 2.</p>",
        "id": 430068405,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711632888
    },
    {
        "content": "<p>Sorry ... directory for the test scripts was wrong. All ok.</p>",
        "id": 430073438,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711634405
    },
    {
        "content": "<p>So we are all go for release?</p>",
        "id": 430076093,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711635062
    },
    {
        "content": "<p>Position/Waypoint/Route test:<br>\nPosition 33\u0007 21.480'N 079\u0007 16.920'W<br>\nThe bell symbol appears.<br>\nIs this important?</p>",
        "id": 430079533,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711635983
    },
    {
        "content": "<p>Nothing else I can see that stops release.</p>",
        "id": 430079897,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711636080
    },
    {
        "content": "<p>Oh ... poistionParseTests.js  -  reference to a Position,js file on your computer. Needs changing.</p>",
        "id": 430080716,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711636292
    },
    {
        "content": "<p>Please change to require (“Position”); and retry.</p>",
        "id": 430081591,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711636501
    },
    {
        "content": "<p>Thanks ... used <code>Position = require(\"Position\");</code><br>\nLots of BELs</p>\n<div class=\"codehilite\"><pre><span></span><code>0   {&quot;latitude&quot;:20.506666666666668,&quot;longitude&quot;:-5.508333333333333}  20\u0007 30.400&#39;N 005\u0007 30.500&#39;W\n1   {&quot;latitude&quot;:-2.05,&quot;longitude&quot;:5.508333333333334}    02\u0007 03.000&#39;S 005\u0007 30.500&#39;E\n2   {&quot;latitude&quot;:20.506666666666668,&quot;longitude&quot;:-5.508333333333334}  20\u0007 30.400&#39;N 005\u0007 30.500&#39;W\n3   {&quot;latitude&quot;:20.5,&quot;longitude&quot;:-5}    20\u0007 30.000&#39;N 005\u0007 0.000&#39;W\n0 error(s)\nthrowTest 0 threw parsePosition  not lat long pair\nthrowTest 1 threw parsePosition lat out of range\nthrowTest 2 threw parsePosition lon not a number\nthrowTest 3 threw parsePosition lat out of range\n0 missed throw error(s)\nresult: Success\n</code></pre></div>",
        "id": 430082219,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711636666
    },
    {
        "content": "<p>Must go to dentist</p>",
        "id": 430082359,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711636693
    },
    {
        "content": "<p>In version.h we have</p>\n<div class=\"codehilite\" data-code-language=\"C++\"><pre><span></span><code><span class=\"cp\">#define DEGREE        {\"\\u00B0\"}    </span><span class=\"c1\">// real degree character</span>\n<span class=\"cp\">#ifdef __WINDOWS__</span>\n<span class=\"cp\">#define PSEUDODEGREE  {\"\\u0007\"}    </span><span class=\"c1\">// substitute character for degree - bell</span>\n<span class=\"cp\">#else</span>\n<span class=\"cp\">#define PSEUDODEGREE  DEGREE    </span><span class=\"c1\">// keep it as real degree</span>\n<span class=\"cp\">#endif</span>\n</code></pre></div>\n<p>which is how you get º turned into BELL.<br>\nThen in JSextensions.cpp line 107, the output is filtered by<br>\n<code>   output.Replace(PSEUDODEGREE, DEGREE, true); // internally, we are using PSEUDODEGREE to represent degree - convert any back</code></p>\n<p>So mystified why you are seeing BELL.</p>\n<p>This simple script will test:</p>\n<div class=\"codehilite\" data-code-language=\"JavaScript\"><pre><span></span><code><span class=\"nx\">print</span><span class=\"p\">(</span><span class=\"s2\">\"Bell prints as \"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nb\">String</span><span class=\"p\">.</span><span class=\"nx\">fromCharCode</span><span class=\"p\">(</span><span class=\"mh\">0x07</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"s2\">\"\\n\"</span><span class=\"p\">);</span>\n</code></pre></div>\n<p>You should see it print º<br>\nThis assumes  <code>#ifdef __WINDOWS__</code> is working.</p>",
        "id": 430118244,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711644662
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>Bell prints as \u0007\nresult: undefined\n</code></pre></div>\n<p>What a pain.</p>",
        "id": 430127797,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711646810
    },
    {
        "content": "<p>Do you get the degree with<br>\n<code>print(\"Bell prints as \", String.fromCharCode(0xB0), \"\\n\");</code></p>",
        "id": 430129479,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711647263
    },
    {
        "content": "<p>Yes ...<br>\nNeed to restart my pc to show output.</p>",
        "id": 430130978,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711647704
    },
    {
        "content": "<p>Bell prints as °<br>\nresult: undefined</p>",
        "id": 430131394,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711647845
    },
    {
        "content": "<p>In JSextensions.cpp change lines 107 to be</p>\n<div class=\"codehilite\" data-code-language=\"C++\"><pre><span></span><code><span class=\"w\">    </span><span class=\"n\">TRACE</span><span class=\"p\">(</span><span class=\"mi\">123</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s\">\"Before: \"</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"n\">output</span><span class=\"p\">);</span>\n<span class=\"w\">    </span><span class=\"n\">output</span><span class=\"p\">.</span><span class=\"n\">Replace</span><span class=\"p\">(</span><span class=\"n\">PSEUDODEGREE</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">DEGREE</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nb\">true</span><span class=\"p\">);</span><span class=\"w\"> </span><span class=\"c1\">// internally, we are using DEGREE to represent degree - convert any back</span>\n<span class=\"w\">    </span><span class=\"n\">TRACE</span><span class=\"p\">(</span><span class=\"mi\">123</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s\">\"After: \"</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"n\">output</span><span class=\"p\">);</span>\n</code></pre></div>\n<p>and turn on tracing for 123</p>",
        "id": 430132478,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711648162
    },
    {
        "content": "<p>Then run</p>\n<div class=\"codehilite\" data-code-language=\"JavaScript\"><pre><span></span><code><span class=\"nx\">print</span><span class=\"p\">(</span><span class=\"s2\">\"Degree prints as º\\n\"</span><span class=\"p\">);</span>\n</code></pre></div>",
        "id": 430132942,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711648313
    },
    {
        "content": "<p>BBL</p>",
        "id": 430133102,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711648360
    },
    {
        "content": "<p>Then get a Mac <span aria-label=\"speechless\" class=\"emoji emoji-1f636\" role=\"img\" title=\"speechless\">:speechless:</span></p>",
        "id": 430133159,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711648382
    },
    {
        "content": "<div class=\"codehilite\"><pre><span></span><code>Tracing levels 123 - 123\nDegree prints as \u0007\nresult: undefined\n</code></pre></div>\n<div class=\"codehilite\"><pre><span></span><code>L0  ------------------ Console JavaScript about to run\nL123    Before: Degree prints as \u0007\n\nL123    After: Degree prints as \u0007\n\nL0  ------------------ Console JavaScript wrapped up\n</code></pre></div>",
        "id": 430134988,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711648938
    },
    {
        "content": "<p>News and shower.</p>",
        "id": 430135119,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711648979
    },
    {
        "content": "<p>Please try removing the curly braces around the definitions, so in versions.h it becomes</p>\n<div class=\"codehilite\" data-code-language=\"C++\"><pre><span></span><code><span class=\"cp\">#define DEGREE        \"\\u00B0\"  </span><span class=\"c1\">// real degree character</span>\n<span class=\"cp\">#ifdef __WINDOWS__</span>\n<span class=\"cp\">#define PSEUDODEGREE    \"\\u0007\"    </span><span class=\"c1\">// substitute character for degree - bell</span>\n<span class=\"cp\">#else</span>\n<span class=\"cp\">#define PSEUDODEGREE  DEGREE    </span><span class=\"c1\">// keep it as real degree</span>\n</code></pre></div>",
        "id": 430141265,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711650883
    },
    {
        "content": "<p>Explanation: we are defining a one-character string - not a character</p>",
        "id": 430141567,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711650974
    },
    {
        "content": "<p>I seem to have compiled version t no v. It will have to wait until tomorrow to recompile.</p>",
        "id": 430147731,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711653511
    },
    {
        "content": "<p>Will compile for you - stand by</p>",
        "id": 430147925,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711653605
    },
    {
        "content": "<p>beta-w building now into my beta repo - give it a moment</p>",
        "id": 430148614,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711653944
    },
    {
        "content": "<p>Assuming the above looks all OK, please run this final check on Windows....</p>\n<p>Copy this script into a console</p>\n<div class=\"codehilite\" data-code-language=\"JavaScript\"><pre><span></span><code><span class=\"nx\">Position</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nx\">require</span><span class=\"p\">(</span><span class=\"s2\">\"Position\"</span><span class=\"p\">);</span>\n<span class=\"nx\">print</span><span class=\"p\">(</span><span class=\"ow\">new</span><span class=\"w\"> </span><span class=\"nx\">Position</span><span class=\"p\">(</span><span class=\"nx\">fromClipboard</span><span class=\"p\">()).</span><span class=\"nx\">formatted</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s2\">\"\\n\"</span><span class=\"p\">);</span>\n</code></pre></div>\n<p>Then copy this next line to your clipboard<br>\n<code>50.333333ºN 3º 20'W</code><br>\nRun the script and the result  should be<br>\n<code>50° 20.000'N 003° 20.000'W</code></p>",
        "id": 430215472,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711697805
    },
    {
        "content": "<p>50\u0007 20.000'N 003\u0007 20.000'W<br>\nresult: undefined<br>\nThe BEL is still with us. BEL is a non-printing character on Windows. On the Mac?</p>",
        "id": 430221504,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711701359
    },
    {
        "content": "<p>Tried replacing PSEUDODEGREE  bel with ^. Did not work.</p>",
        "id": 430223878,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711702541
    },
    {
        "content": "<p>When it was working, I think I recall, we were using things like<br>\n<code>const wxString o_umlaut    {\"\\u00F6\"};</code><br>\nMaybe try that.  You or me to edit?</p>",
        "id": 430225948,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711703606
    },
    {
        "content": "<p>Added this to JScleanOuput:<br>\n<code>given.Replace(PSEUDODEGREE, \"\\u00B0\", true);</code><br>\nAnd the degree symbol prints correctly</p>",
        "id": 430232951,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711707072
    },
    {
        "content": "<p>positionParseTests still needs correcting for users etc.<br>\nWith that corrected the test runs with all the correct degree symbols in place.</p>",
        "id": 430233598,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711707442
    },
    {
        "content": "<p>Now we have the new way of defining DEGREE and PSUDODEGREE, what you have<br>\n<code>given.Replace(PSEUDODEGREE, \"\\u00B0\", true);</code><br>\nmust be the same as <br>\n<code>given.Replace(PSEUDODEGREE, DEGREE, true);</code></p>\n<p>I have put this into JScleanString , made the other Window bits of what was already there Windows only and now use JScleanString for all outputs, so it is done in one place.</p>\n<p>I have tested using something else for PSEUDODEGREE and inspected it using that code and output is OK on MacOS.</p>\n<p>Please try beta-x pushed and built in my beta repo.<br>\nPlease inspect output from 38_positionParseTests.js to check degree symbols correct and also the clipboard test from my message at 07:36 today.<br>\n<span aria-label=\"hand with index finger and thumb crossed\" class=\"emoji emoji-1faf0\" role=\"img\" title=\"hand with index finger and thumb crossed\">:hand_with_index_finger_and_thumb_crossed:</span>  <span aria-label=\"hand with index finger and thumb crossed\" class=\"emoji emoji-1faf0\" role=\"img\" title=\"hand with index finger and thumb crossed\">:hand_with_index_finger_and_thumb_crossed:</span>  <span aria-label=\"hand with index finger and thumb crossed\" class=\"emoji emoji-1faf0\" role=\"img\" title=\"hand with index finger and thumb crossed\">:hand_with_index_finger_and_thumb_crossed:</span></p>",
        "id": 430244394,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711712934
    },
    {
        "content": "<p>beta-x is good for both parseTests and clipboard. Looks good for release.</p>",
        "id": 430250268,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711716021
    },
    {
        "content": "<p>Phew!  At last!  Great to hatch this at Easter  <span aria-label=\"hatching\" class=\"emoji emoji-1f423\" role=\"img\" title=\"hatching\">:hatching:</span> <span aria-label=\"hatching\" class=\"emoji emoji-1f423\" role=\"img\" title=\"hatching\">:hatching:</span>  <span aria-label=\"hatching\" class=\"emoji emoji-1f423\" role=\"img\" title=\"hatching\">:hatching:</span></p>",
        "id": 430250699,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711716247
    },
    {
        "content": "<p>The release build on circleci is not running for MacOS because of CONCURRENCY LIMIT.<br>\nI guess this is because I have reached some limit for my free plan?  It says I have used 1,392 credits. But also says <code>Open source credits 33,403 credits of 400,000 used</code><br>\nWhen can I proceed? It looks like I get 30,000 per month.  Do I have to wait to the end of April?</p>",
        "id": 430271147,
        "sender_full_name": "Tony Voss",
        "timestamp": 1711725367
    },
    {
        "content": "<p>Beginning of April should be Ok. Still Easter ;)</p>",
        "id": 430271437,
        "sender_full_name": "Mike Rossiter",
        "timestamp": 1711725499
    },
    {
        "content": "<p>Hi,</p>\n<p>Any idea what this is: ? \"Mystified\"</p>\n<div class=\"codehilite\"><pre><span></span><code>ld: warning: ignoring file &#39;/usr/local/Cellar/openssl@3/3.2.1/lib/libssl.3.dylib&#39;: found architecture &#39;x86_64&#39;, required architecture &#39;arm64&#39;\nld: warning: ignoring file &#39;/usr/local/Cellar/openssl@3/3.2.1/lib/libcrypto.3.dylib&#39;: found architecture &#39;x86_64&#39;, required architecture &#39;arm64&#39;\nld: Undefined symbols:\n  _ASN1_INTEGER_set, referenced from:\n      generate_x509(evp_pkey_st*, std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt;&gt;) in certificates.cpp.o\n  _ASN1_OCTET_STRING_free, referenced from:\n      cs_cert_set_subject_alt_name(x509_st*, std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt;&gt;) in certificates.cpp.o\n      cs_cert_set_subject_alt_name(x509_st*, std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt;&gt;) in certificates.cpp.o\n  _ASN1_OCTET_STRING_new, referenced from:\n      cs_cert_set_subject_alt_name(x509_st*, std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt;&gt;) in certificates.cpp.o\n      cs_cert_set_subject_alt_name(x509_st*, std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt;&gt;) in certificates.cpp.o\n  _ASN1_OCTET_STRING_set, referenced from:\n      cs_cert_set_subject_alt_name(x509_st*, std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt;&gt;) in certificates.cpp.o\n  _BIO_free, referenced from:\n      ix::SocketOpenSSL::openSSLAddCARootsFromString(std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt;&gt;) in libixwebsocket.a[arm64][3`\n</code></pre></div>\n<p>Complete log:  <a href=\"https://app.circleci.com/pipelines/github/leamas/OpenCPN/4964/workflows/1a253a18-e09a-4f58-9213-2fcc226157a0/jobs/10604\">https://app.circleci.com/pipelines/github/leamas/OpenCPN/4964/workflows/1a253a18-e09a-4f58-9213-2fcc226157a0/jobs/10604</a></p>",
        "id": 433450231,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1713248852
    }
]