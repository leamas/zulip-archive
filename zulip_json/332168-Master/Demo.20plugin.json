[
    {
        "content": "<p>Public thread on demo plugin</p>",
        "id": 564884540,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1766311116
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"725680\">TwoCan</span> <a href=\"#narrow/dm/399510,725680,881165-group/near/564861093\">said</a>:</p>\n<blockquote>\n<p>For a demo plugin, perhaps deconstruct Race Start into specific examples of plugin API's ( and corresponding  separate branches)?</p>\n<p>Would just need to add examples of Chart related API's.</p>\n<p>Then additional branches to demonstrate shipdriver or test plugin templates.</p>\n<p>Publication into the catalog is another Pandora's box?</p>\n</blockquote>",
        "id": 564884579,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1766311164
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"725680\">TwoCan</span> <a href=\"#narrow/dm/399510,725680,881165-group/near/564862927\">said</a>:</p>\n<blockquote>\n<p>Happy to help and deconstruct my plugin. But after the new year.  Little interest in writing a new plugin or adding stuff I've already written, into the built in \"demo\" plugin even if there are plans to convert ithe demo plugin into a third party plugin.</p>\n<p>However I do need to question why the need to do this? Aside from you &amp; Sebastien how many new developers have expressed an interest in developing or maintaining plugins?</p>\n<p>Many of us contributed to writing the user manual but disappointingly few seemed to read it.</p>\n</blockquote>",
        "id": 564884668,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1766311275
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"881165\">Quinton Hoole</span> <a href=\"#narrow/dm/399510,725680,881165-group/near/564863525\">said</a>:</p>\n<blockquote>\n<p>Understood. Good questions. Dave and Alec seem to think it would be a good idea to demonstrate what kinds of things a plugin can do via the plugin api, and how to do them. And to make it easy for someone wanting to develop a plugin to get productive. </p>\n<p>My personal motivations go beyond that. Roughly speaking… </p>\n<ol>\n<li>I have a few plugins I’d like to develop. But first gaining familiarity with the plugin API, plugin build and test process etc will make it easier to design and build those plugins appropriately. </li>\n<li>I also would like to tidy up the plugin api. There seems to be a lot of old cruft in there that makes plugin development and maintenance more difficult than necessary. To do that properly I need to understand the whole api as it stands today, warts and all, and with hands-on experience using all of it. </li>\n<li>I’ve seen quite a few cases where changes to the API are made without proper testing against real plugins that use the api, leading to downstream breakages in plugins. So I’d like there to be a “test plugin” that can automatically exercise the whole API, to help pick up regressions in the API, and perhaps even in OpenCPN itself. I could potentially eventually use the plugin API to “drive” OpenCPN core, to perform system tests. It’s not really designed for that, but it might be a good start. </li>\n</ol>\n<p>Hope that makes sense.</p>\n</blockquote>",
        "id": 564884740,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1766311362
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"399510\">Alec Leamas</span> <a href=\"#narrow/dm/399510,725680,881165-group/near/564882274\">said</a>:</p>\n<blockquote>\n<blockquote>\n<p>However I do need to question why the need to do this? Aside from you &amp; Sebastien how many new developers have expressed an interest in developing or maintaining plugins?</p>\n</blockquote>\n<p>This is IMHO the big question.</p>\n<p>We actually have a <strong>lot</strong> of users and an open code base. Normally, this should attract some devs now and then.  Obviously, this fails for us.</p>\n<p>When I try to take a step back and look at this project with the eyes of a prospective plugin dev I see a mess of documentation, testplugin and shipdriver, cloudsmith, circleci and what not. I think it would scare me away. </p>\n<p>Compare this to a usual instructions for many projects out there like  <code>git clone,;cd whatever; ./configure; make; sudo make install</code>. That is, an easy-straight-forward path to create something you can test. When you dip your toes in the water of a new project, this is exactly what you you want to do. Or?</p>\n<p>Now, if we focus on shipdriver (we should) this is actually likewise simple, ending up in a instruction how to import a plugin. This part should IMHO be the \"front page\" of the plugin project, directly visible in the README. It should be short enough to not scare anyone away. </p>\n<p>If the prospective dev starts asking question abdout CI builds and publishing in the catalog she is already on the hook and these docs could be much less prominent, available as links</p>\n</blockquote>",
        "id": 564884790,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1766311428
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"399510\">Alec Leamas</span> <a href=\"#narrow/dm/399510,725680,881165-group/near/564882882\">said</a>:</p>\n<blockquote>\n<p>To put some flesh on the bones: a sketch</p>\n<hr>\n<p>- Install build deps -- Must be a link, otherwise it becomes too much<br>\n  - Build the plugin</p>\n<div class=\"codehilite\"><pre><span></span><code>$ git clone ...\n$ cd demo-plugin\n$ mkdir build\n$ cd build\n$ cmake ..\n$ cmake --build . --target tarball\n</code></pre></div>\n<p>- Import and test plugin (screenshots)</p>\n<hr>\n<p>This should be  simple enough to not scare anyone away. In the end we could add a link to more comprehensive instructions including Windows VS setup,  making  CI builds  and catalog updates.</p>\n<p>The scary part is actually to install build deps. Debian/Ubuntu  is reasonably simple, Windows and MacOS not. Some scripts could perhaps be helpful here (?)</p>\n</blockquote>",
        "id": 564884814,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1766311459
    },
    {
        "content": "<p>When you dip your toes in the water of a new project, this is exactly what you you want to do. <br>\nAgree.<br>\nFor me, I'd look for a demo or sample that takes care of all the setup and dependencies.  I would hope to find a few simple entry points where I could start experimenting in a local clone. I would also hope that the code will be almost \"baby-talk\" style, not using the most cutting edge features of c++, but simple extremely literal code constructs that almost any dev could understand immediately.  Think \"Hello world\" style.</p>",
        "id": 564900391,
        "sender_full_name": "Dave Register",
        "timestamp": 1766331482
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"399510\">Alec Leamas</span> <a href=\"#narrow/channel/332168-Master/topic/Demo.20plugin/near/564884814\">said</a>:</p>\n<blockquote>\n<p>The scary part is actually to install build deps. Debian/Ubuntu  is reasonably simple, Windows and MacOS not. Some scripts could perhaps be helpful here (?)</p>\n</blockquote>\n<p>Hi Alec. I mostly agree with you. Except I’m not sure that build deps on the dev machine are necessarily the right approach.   Developers install all sorts of things on their dev machines. And are installing new stuff constantly. Those things may or may not clash with whatever OpenCPN or plugins want in order to build correctly. Would it not be better to build in containers? That way, the container would contain  precisely what is needed - no more, no less. </p>\n<p>I think I saw build instructions somewhere for building in a container, but they are not very prominent, nobody seems to use them, and I suspect that only works for Linux. Should container builds not be the default way to build?</p>\n<p>Thoughts?</p>",
        "id": 564902237,
        "sender_full_name": "Quinton Hoole",
        "timestamp": 1766333704
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"517002\">Dave Register</span> <a href=\"#narrow/channel/332168-Master/topic/Demo.20plugin/near/564900391\">said</a>:</p>\n<blockquote>\n<p>simple extremely literal code constructs that almost any dev could understand immediately.  Think \"Hello world\" style.</p>\n</blockquote>\n<p>I agree. A written tutorial (or alternatively extensive in-code comments) in a github repo, containing a working plugin with no more than a single page of well-commented code that (for example) displays \"Hello World\" on a chart might be a good start. Then incremental steps from there to do additional things like add dialogs, or whatever.</p>\n<p>Perhaps this is in fact a good starting point:</p>\n<ol>\n<li>Agree on what the user experience will be for that first \"Hello World\" plugin.  As a strawman, I propose the new developer be allowed to build on either Linux, Windows or Mac, and not have to install any dependencies on their machine (i.e. use a container to build).  And they should not have to solve the complexities of building OpenCPN from source.  They should be able to import their plugin into the latest standard released OpenCPN download.</li>\n<li>Agree on roughly what the following tutorials would be.  (2) Draw a shape on a chart? (3) Add a configurable option for the plugin? (4) Display output from the plugin in a separate window?</li>\n</ol>",
        "id": 564903087,
        "sender_full_name": "Quinton Hoole",
        "timestamp": 1766334750
    },
    {
        "content": "<p>Just a wild thought here. If we had a well-defined and clean interface description and documented minimum plug-in requirements, it ought to be possible to ask a good AI to write a \"Hello World\" plugin and generate something that works. You could know your documentation/interface description is adequate if an AI can take it and create a runnable plugin project based on an example prompt. So, while not as much fun, it might make good sense to focus on written plugin requirements and clearer API documentation before writing a hello world plugin. If an AI cannot write a simple runnable \"hello world\" plugin based on the written requirements/documentation, then probably a human cannot do it very well either.</p>",
        "id": 564910252,
        "sender_full_name": "Dan Dickey",
        "timestamp": 1766344004
    },
    {
        "content": "<p>I think that’s a good idea. Personally I’m would not be able to write good documentation until I’d been through the process myself, at least once. But if someone who’s more familiar with the api and build tools could update the docs in the mean time, while I put together the “Hello World” plugin by hand, we could compare the output of the AI with the hand generated stuff and move forward from there?</p>",
        "id": 564919074,
        "sender_full_name": "Quinton Hoole",
        "timestamp": 1766356879
    },
    {
        "content": "<p><span class=\"user-mention\" data-user-id=\"881165\">@Quinton Hoole</span>  said</p>\n<blockquote>\n<p>I mostly agree with you. Except I’m not sure that build deps on the dev machine are necessarily the right approach. Developers install all sorts of things on their dev machines. </p>\n</blockquote>\n<p>Build deps a k a <em>build dependencies</em>  are by definition neither personal nor optional. They are described in  the {manual](<a href=\"https://opencpn-manuals.github.io/main/AlternativeWorkflow/Local-Build.htmll\">https://opencpn-manuals.github.io/main/AlternativeWorkflow/Local-Build.htmll</a>). I see no way to avoid this platform specific step.</p>",
        "id": 564979215,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1766400991
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"399510\">Alec Leamas</span> <a href=\"#narrow/channel/332168-Master/topic/Demo.20plugin/near/564979215\">said</a>:</p>\n<blockquote>\n<p><span class=\"user-mention silent\" data-user-id=\"881165\">Quinton Hoole</span>  said</p>\n<blockquote>\n<p>I mostly agree with you. Except I’m not sure that build deps on the dev machine are necessarily the right approach. Developers install all sorts of things on their dev machines. </p>\n</blockquote>\n<p>Build deps a k a <em>build dependencies</em>  are by definition neither personal nor optional. They are described in  the {manual](<a href=\"https://opencpn-manuals.github.io/main/AlternativeWorkflow/Local-Build.htmll\">https://opencpn-manuals.github.io/main/AlternativeWorkflow/Local-Build.htmll</a>). I see no way to avoid this platform specific step.</p>\n</blockquote>\n<p>Contactainers are the alternative I suggested above. I don’t have much experience with containers on Windows, but in the worst case we can use a VM instead. </p>\n<p>The problem with using the local machine that  build is that it’s too easy to compromise the dependencies (wrong version, or multiple versions of e.g. wxWidgets, or any other library).  The letter is almost unavoidable if the local machine is used for building other software than OpenCPN. And those are specifically the kinds of developers we want to attract (those who have worked, or are working on other programming projects too). Hence I suggest using containers need to build instead. That way we know precisely what’s in the container, and precisely what the build will produce. </p>\n<p>I’ve seen numerous cases where people build OpenCPN and/or plugins locally and see symptoms that others are unable to reproduce. Clearly some of that can be due to variations in hardware, software configurations etc, but some of it is definitely due to local build variances, which we definitely want to avoid.</p>",
        "id": 565030370,
        "sender_full_name": "Quinton Hoole",
        "timestamp": 1766418832
    },
    {
        "content": "<p>IMHO requiring a container or,  worse, a VM will scare potential devs away. </p>\n<p>Have you seen any project out there   actually requiring that the build is done in a container or dedicated VM? \"Curious\"</p>",
        "id": 565031404,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1766419198
    },
    {
        "content": "<p>Nor requiring, but strongly recommending. That’s become the de facto “good practice” for some years now.</p>",
        "id": 565040635,
        "sender_full_name": "Quinton Hoole",
        "timestamp": 1766422676
    },
    {
        "content": "<p>Still, most projects does not mention this on their front page. Requiring containers just to compile \"Hello world\"  will raise the barrier for new devs. If possible it should not be used unless really required, keeping it simple.</p>\n<p>This is not to say that we should not document a containerized build process, in particular for MacOS which seems to have some challenges. But that should if at all possible IMHO be avoided in the initial steps.</p>",
        "id": 565049566,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1766426684
    },
    {
        "content": "<p>The problem is that, as you've mentioned, installing prerequisits is difficult and error prone. And because of that, the build process is also more complex than necessary, and error prone.  What I don't want is that we end up wasting our own and potential plugin developers time trying to debug why their hello world plugin won't build, or won't run correctly.  That would defeat the whole purpose of the exercise. Using containers, the only prerequisite becomes docker, and everything else takes care of itself.  Pavel has already kindly documented the process:</p>\n<p><a href=\"https://opencpn-manuals.github.io/main/opencpn-dev/docker.html\">https://opencpn-manuals.github.io/main/opencpn-dev/docker.html</a></p>\n<p>Notice how much simpler it is than installing all the required dependencies.  And it actually works, I believe. Perhaps try it out? I haven't recently, but am very happy to do so and fix whatever problems it has.</p>",
        "id": 565050454,
        "sender_full_name": "Quinton Hoole",
        "timestamp": 1766427091
    },
    {
        "content": "<p>I'm comfortable w containers, that's not the problem. </p>\n<p>Also, for Linux installing build deps is simple and not error prone.  We use containers mostly in cross compiling setups. In short, on Linux containers solves a non existent problem for the demo plugin</p>\n<p>I know too little about containers on windows to say anything meaningful about it. Here, installing build deps is more error prone, but at a glance running containers seems more complicated. And in any case, Windows devs want to run VS, probably not easy in a container.</p>\n<p>Which basically boils down to that containers could be a viable thing on MacOS. Here it is easy to run, and it actually solves a recurring problem.  I rest my case, MacOS is not my home turf</p>",
        "id": 565054257,
        "sender_full_name": "Alec Leamas",
        "timestamp": 1766429034
    },
    {
        "content": "<p>OK, I tell you what.  As a compromise I'll do both.  I have existing machines with Trixie, Windows 11 and MacOS.  I'll try to make them all work correctly, building both on containers, and local builds. We can pick (or developers can pick) whichever they prefer.</p>\n<p>I suspect that we're going to experience cases of \"I followed your instructions for local builds, and ran into problem X\".  As soon as that happens, I think we're going to want to revert to the container build, which should be 100% reproducible.</p>",
        "id": 565056655,
        "sender_full_name": "Quinton Hoole",
        "timestamp": 1766430207
    },
    {
        "content": "<p>I will confess that most of my development experience on OpenCPN has been on MacOS, and a plugin based on testplugin_pi templates.  Getting all that to work correctly was nothing short of a nightmare.</p>",
        "id": 565056922,
        "sender_full_name": "Quinton Hoole",
        "timestamp": 1766430340
    },
    {
        "content": "<p>Windows wasn't much better. Linux was, unsurprisingly, straightforward.</p>",
        "id": 565057009,
        "sender_full_name": "Quinton Hoole",
        "timestamp": 1766430386
    },
    {
        "content": "<p>In between basting the turkey....</p>\n<p>A few comments:<br>\nContainers, Virtual Machines: Agree with Alec. For example which VM environment? I'm a Windows guy, so there are at least three choices; Hyper-V, VMWare, VirtualBox ?  Similarly for containers, Docker, Kubernetes ?</p>\n<p>And for NMEA 2000, although admittedly I haven't played around with this for such a long time, I'm not sure if a VM provides access to USB or PCI CAN bus adapters. It should work for WiFi NMEA 2000 gateways such as Actisense &amp; Yacht Devices, but I personally don't play with those. </p>\n<p>For Windows and the typical Windows user , there is a \"subtle\" problem/difference between building on a local machine vs building in CI. On a local machine, it's pretty damn easy to download the prerequisites (Visual Studio, git, cmake, poedit/gettext, wxWidgets, nsis etc.) directly from the web via a browser and then to install from the UI.  On the other hand CI without any interactive UI uses scripts, installs chocolately package manager to subsequently install the prerequisites. </p>\n<p>It's a while since I dug out my old Mac mini to release the first version of TwoCan for OSX, but as a similarly \"user friendly\" environment as Windows, it would suffer from the same subtle differences; namely users would download and install the prerequisites via Safari and Finder. </p>\n<p>Much of the documentation and toolsets are geared towards the Linux development environment.  For example when I read the instructions for updating the documentation, my eyes glaze over with the result that I've given up on writing/publishing documentation for the new Audiopilot plugin.  Although given that it is aimed at visually impaired sailors, probably more practical and far easier to provide audio based  documentation!</p>\n<p>And when I see comments in <a href=\"https://opencpn-manuals.github.io/main/opencpn-plugins/authoring/tools.html\">pages</a> such as  </p>\n<blockquote>\n<p>VS Code is based on the open-sourced vscode project, but adds some features like a C# debugger and anti-features like telemetry</p>\n</blockquote>\n<p>the anti Microsoft sentiment is quite obvious.  BTW for whoever wrote this, telemetry can be disabled using</p>\n<div class=\"codehilite\" data-code-language=\"Text only\"><pre><span></span><code>telemetry:telemetryLevel:Off\n</code></pre></div>\n<p>While the use of scripts reduces the risk of end-user errors, the problem often arises when they don't work. ie. if web download sites are unavailable, if other dependencies are not met or if it installs an older version . Then the task of debugging the script becomes quite onerous. </p>\n<p>Anyway, best wishes for the festive season to all.</p>",
        "id": 565230580,
        "sender_full_name": "TwoCan",
        "timestamp": 1766538854
    },
    {
        "content": "<p>It's as if no one realizes that for Windows we have a local build script that does all the gathering of dependencies and sets up the entire build environment with no user interaction required.  We have very simple build process for Linux. Mac has it's own issues but not too many PI developers code on Mac and those that do seem to be ok with the status quo. So what is the real problem we are trying to solve with all these big containers?</p>",
        "id": 565240273,
        "sender_full_name": "Dan Dickey",
        "timestamp": 1766550505
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"522729\">Dan Dickey</span> <a href=\"#narrow/channel/332168-Master/topic/Demo.20plugin/near/565240273\">said</a>:</p>\n<blockquote>\n<p>So what is the real problem we are trying to solve with all these big containers?</p>\n</blockquote>\n<p>In a nutshell, the goal is a well-defined build environment, isolated from the host machine.  Because if a host machine is used for building more than one system (e.g. OpenCPN and something else), and those systems have conflicting build requirements (e.g. one wants compiler or library version x, and another wants version y) then the two sets of requirements will inevitably stomp on each other. Whether or not either or both of them have scripts to automate their setup.  As soon as someone does something to their machine, after running your setup script, the results of your setup script can no longer be relied upon.  Because the user of the machine may have installed different things on top of the things your script installed. Perhaps even unbeknownst to them.</p>\n<p>However it's largely academic now, because such containers don't work sufficiently well on either Windows or MacOS to be practically useful in this case. So we'll just have to live with the build environments potentially being stomped on, or stomping on others.  Probably not worth discussing further.</p>",
        "id": 565254779,
        "sender_full_name": "Quinton Hoole",
        "timestamp": 1766563151
    },
    {
        "content": "<p>At least in the case of OpenCPN development on Windows, I have been able to demonstrate that no dependencies (aside from Visual Studio) need be shared with any other development environment.  Everything needed lives in one folder. You can completely delete that folder and it would be as if you never had a development environment for O on your computer. Plus, you can set up a build environment in a single folder in about 10 minutes with a decent internet connection. So, I guess what I'm saying is that I don't see any conflicts that need to be resolved. I routinely run 4-5 different isolated environments on Windows and run multiple instances of O simultaneously from different build branches just to prove it can be done.</p>",
        "id": 565286430,
        "sender_full_name": "Dan Dickey",
        "timestamp": 1766584566
    },
    {
        "content": "<p>Great! That’s really all I was hoping to achieve. There a write-up on how to do that? I’d love to try it and adapt as/if needed for plugins.</p>",
        "id": 565308490,
        "sender_full_name": "Quinton Hoole",
        "timestamp": 1766601190
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"881165\">Quinton Hoole</span> <a href=\"#narrow/channel/332168-Master/topic/Demo.20plugin/near/565308490\">said</a>:</p>\n<blockquote>\n<p>Great! That’s really all I was hoping to achieve. There a write-up on how to do that? I’d love to try it and adapt as/if needed for plugins.</p>\n</blockquote>\n<p><a href=\"https://opencpn-manuals.github.io/main/opencpn-dev/windows.html#_complete_builds_using_visual_studio_2026_community_edition_visual_studio_2022_community_edition_or_visual_studio_2019_community_edition\">https://opencpn-manuals.github.io/main/opencpn-dev/windows.html#_complete_builds_using_visual_studio_2026_community_edition_visual_studio_2022_community_edition_or_visual_studio_2019_community_edition</a></p>",
        "id": 565309432,
        "sender_full_name": "Dan Dickey",
        "timestamp": 1766602016
    }
]